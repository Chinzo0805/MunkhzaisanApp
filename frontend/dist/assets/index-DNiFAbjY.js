(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function cg(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Wt={},Wa=[],Mi=()=>{},vT=()=>!1,$d=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),ug=n=>n.startsWith("onUpdate:"),hr=Object.assign,hg=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},mb=Object.prototype.hasOwnProperty,Pt=(n,e)=>mb.call(n,e),rt=Array.isArray,Ga=n=>ru(n)==="[object Map]",Al=n=>ru(n)==="[object Set]",__=n=>ru(n)==="[object Date]",ft=n=>typeof n=="function",pn=n=>typeof n=="string",Vi=n=>typeof n=="symbol",qt=n=>n!==null&&typeof n=="object",_T=n=>(qt(n)||ft(n))&&ft(n.then)&&ft(n.catch),yT=Object.prototype.toString,ru=n=>yT.call(n),vb=n=>ru(n).slice(8,-1),ET=n=>ru(n)==="[object Object]",Kd=n=>pn(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,lc=cg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jd=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},_b=/-\w/g,ti=jd(n=>n.replace(_b,e=>e.slice(1).toUpperCase())),yb=/\B([A-Z])/g,aa=jd(n=>n.replace(yb,"-$1").toLowerCase()),Wd=jd(n=>n.charAt(0).toUpperCase()+n.slice(1)),up=jd(n=>n?`on${Wd(n)}`:""),io=(n,e)=>!Object.is(n,e),Ih=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},TT=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},Gd=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let y_;const qd=()=>y_||(y_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Nt(n){if(rt(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=pn(r)?Ab(r):Nt(r);if(i)for(const s in i)e[s]=i[s]}return e}else if(pn(n)||qt(n))return n}const Eb=/;(?![^(]*\))/g,Tb=/:([^]+)/,wb=/\/\*[^]*?\*\//g;function Ab(n){const e={};return n.replace(wb,"").split(Eb).forEach(t=>{if(t){const r=t.split(Tb);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Tt(n){let e="";if(pn(n))e=n;else if(rt(n))for(let t=0;t<n.length;t++){const r=Tt(n[t]);r&&(e+=r+" ")}else if(qt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const Cb="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Sb=cg(Cb);function wT(n){return!!n||n===""}function Ib(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=iu(n[r],e[r]);return t}function iu(n,e){if(n===e)return!0;let t=__(n),r=__(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=Vi(n),r=Vi(e),t||r)return n===e;if(t=rt(n),r=rt(e),t||r)return t&&r?Ib(n,e):!1;if(t=qt(n),r=qt(e),t||r){if(!t||!r)return!1;const i=Object.keys(n).length,s=Object.keys(e).length;if(i!==s)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!iu(n[o],e[o]))return!1}}return String(n)===String(e)}function dg(n,e){return n.findIndex(t=>iu(t,e))}const AT=n=>!!(n&&n.__v_isRef===!0),Y=n=>pn(n)?n:n==null?"":rt(n)||qt(n)&&(n.toString===yT||!ft(n.toString))?AT(n)?Y(n.value):JSON.stringify(n,CT,2):String(n),CT=(n,e)=>AT(e)?CT(n,e.value):Ga(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,i],s)=>(t[hp(r,s)+" =>"]=i,t),{})}:Al(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>hp(t))}:Vi(e)?hp(e):qt(e)&&!rt(e)&&!ET(e)?String(e):e,hp=(n,e="")=>{var t;return Vi(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let tr;class ST{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=tr,!e&&tr&&(this.index=(tr.scopes||(tr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=tr;try{return tr=this,e()}finally{tr=t}}}on(){++this._on===1&&(this.prevScope=tr,tr=this)}off(){this._on>0&&--this._on===0&&(tr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function IT(n){return new ST(n)}function xT(){return tr}function xb(n,e=!1){tr&&tr.cleanups.push(n)}let zt;const dp=new WeakSet;class RT{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,tr&&tr.active&&tr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,dp.has(this)&&(dp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||kT(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,E_(this),PT(this);const e=zt,t=hi;zt=this,hi=!0;try{return this.fn()}finally{OT(this),zt=e,hi=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)gg(e);this.deps=this.depsTail=void 0,E_(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?dp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Jp(this)&&this.run()}get dirty(){return Jp(this)}}let bT=0,cc,uc;function kT(n,e=!1){if(n.flags|=8,e){n.next=uc,uc=n;return}n.next=cc,cc=n}function fg(){bT++}function pg(){if(--bT>0)return;if(uc){let e=uc;for(uc=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;cc;){let e=cc;for(cc=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function PT(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function OT(n){let e,t=n.depsTail,r=t;for(;r;){const i=r.prevDep;r.version===-1?(r===t&&(t=i),gg(r),Rb(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}n.deps=e,n.depsTail=t}function Jp(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(NT(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function NT(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Dc)||(n.globalVersion=Dc,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Jp(n))))return;n.flags|=2;const e=n.dep,t=zt,r=hi;zt=n,hi=!0;try{PT(n);const i=n.fn(n._value);(e.version===0||io(i,n._value))&&(n.flags|=128,n._value=i,e.version++)}catch(i){throw e.version++,i}finally{zt=t,hi=r,OT(n),n.flags&=-3}}function gg(n,e=!1){const{dep:t,prevSub:r,nextSub:i}=n;if(r&&(r.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)gg(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Rb(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let hi=!0;const DT=[];function Ts(){DT.push(hi),hi=!1}function ws(){const n=DT.pop();hi=n===void 0?!0:n}function E_(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=zt;zt=void 0;try{e()}finally{zt=t}}}let Dc=0;class bb{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class mg{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!zt||!hi||zt===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==zt)t=this.activeLink=new bb(zt,this),zt.deps?(t.prevDep=zt.depsTail,zt.depsTail.nextDep=t,zt.depsTail=t):zt.deps=zt.depsTail=t,MT(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=zt.depsTail,t.nextDep=void 0,zt.depsTail.nextDep=t,zt.depsTail=t,zt.deps===t&&(zt.deps=r)}return t}trigger(e){this.version++,Dc++,this.notify(e)}notify(e){fg();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{pg()}}}function MT(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)MT(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const jh=new WeakMap,Vo=Symbol(""),Zp=Symbol(""),Mc=Symbol("");function ir(n,e,t){if(hi&&zt){let r=jh.get(n);r||jh.set(n,r=new Map);let i=r.get(t);i||(r.set(t,i=new mg),i.map=r,i.key=t),i.track()}}function ss(n,e,t,r,i,s){const o=jh.get(n);if(!o){Dc++;return}const a=l=>{l&&l.trigger()};if(fg(),e==="clear")o.forEach(a);else{const l=rt(n),c=l&&Kd(t);if(l&&t==="length"){const u=Number(r);o.forEach((f,p)=>{(p==="length"||p===Mc||!Vi(p)&&p>=u)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(Mc)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Vo)),Ga(n)&&a(o.get(Zp)));break;case"delete":l||(a(o.get(Vo)),Ga(n)&&a(o.get(Zp)));break;case"set":Ga(n)&&a(o.get(Vo));break}}pg()}function kb(n,e){const t=jh.get(n);return t&&t.get(e)}function Ca(n){const e=It(n);return e===n?e:(ir(e,"iterate",Mc),Yr(n)?e:e.map(_i))}function zd(n){return ir(n=It(n),"iterate",Mc),n}function qs(n,e){return As(n)?fs(n)?il(_i(e)):il(e):_i(e)}const Pb={__proto__:null,[Symbol.iterator](){return fp(this,Symbol.iterator,n=>qs(this,n))},concat(...n){return Ca(this).concat(...n.map(e=>rt(e)?Ca(e):e))},entries(){return fp(this,"entries",n=>(n[1]=qs(this,n[1]),n))},every(n,e){return Zi(this,"every",n,e,void 0,arguments)},filter(n,e){return Zi(this,"filter",n,e,t=>t.map(r=>qs(this,r)),arguments)},find(n,e){return Zi(this,"find",n,e,t=>qs(this,t),arguments)},findIndex(n,e){return Zi(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Zi(this,"findLast",n,e,t=>qs(this,t),arguments)},findLastIndex(n,e){return Zi(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Zi(this,"forEach",n,e,void 0,arguments)},includes(...n){return pp(this,"includes",n)},indexOf(...n){return pp(this,"indexOf",n)},join(n){return Ca(this).join(n)},lastIndexOf(...n){return pp(this,"lastIndexOf",n)},map(n,e){return Zi(this,"map",n,e,void 0,arguments)},pop(){return Ql(this,"pop")},push(...n){return Ql(this,"push",n)},reduce(n,...e){return T_(this,"reduce",n,e)},reduceRight(n,...e){return T_(this,"reduceRight",n,e)},shift(){return Ql(this,"shift")},some(n,e){return Zi(this,"some",n,e,void 0,arguments)},splice(...n){return Ql(this,"splice",n)},toReversed(){return Ca(this).toReversed()},toSorted(n){return Ca(this).toSorted(n)},toSpliced(...n){return Ca(this).toSpliced(...n)},unshift(...n){return Ql(this,"unshift",n)},values(){return fp(this,"values",n=>qs(this,n))}};function fp(n,e,t){const r=zd(n),i=r[e]();return r!==n&&!Yr(n)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.done||(s.value=t(s.value)),s}),i}const Ob=Array.prototype;function Zi(n,e,t,r,i,s){const o=zd(n),a=o!==n&&!Yr(n),l=o[e];if(l!==Ob[e]){const f=l.apply(n,s);return a?_i(f):f}let c=t;o!==n&&(a?c=function(f,p){return t.call(this,qs(n,f),p,n)}:t.length>2&&(c=function(f,p){return t.call(this,f,p,n)}));const u=l.call(o,c,r);return a&&i?i(u):u}function T_(n,e,t,r){const i=zd(n);let s=t;return i!==n&&(Yr(n)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,n)}):s=function(o,a,l){return t.call(this,o,qs(n,a),l,n)}),i[e](s,...r)}function pp(n,e,t){const r=It(n);ir(r,"iterate",Mc);const i=r[e](...t);return(i===-1||i===!1)&&Yd(t[0])?(t[0]=It(t[0]),r[e](...t)):i}function Ql(n,e,t=[]){Ts(),fg();const r=It(n)[e].apply(n,t);return pg(),ws(),r}const Nb=cg("__proto__,__v_isRef,__isVue"),FT=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Vi));function Db(n){Vi(n)||(n=String(n));const e=It(this);return ir(e,"has",n),e.hasOwnProperty(n)}class LT{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(i?s?jb:HT:s?VT:BT).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=rt(e);if(!i){let l;if(o&&(l=Pb[t]))return l;if(t==="hasOwnProperty")return Db}const a=Reflect.get(e,t,cn(e)?e:r);if((Vi(t)?FT.has(t):Nb(t))||(i||ir(e,"get",t),s))return a;if(cn(a)){const l=o&&Kd(t)?a:a.value;return i&&qt(l)?t0(l):l}return qt(a)?i?t0(a):su(a):a}}class UT extends LT{constructor(e=!1){super(!1,e)}set(e,t,r,i){let s=e[t];const o=rt(e)&&Kd(t);if(!this._isShallow){const c=As(s);if(!Yr(r)&&!As(r)&&(s=It(s),r=It(r)),!o&&cn(s)&&!cn(r))return c||(s.value=r),!0}const a=o?Number(t)<e.length:Pt(e,t),l=Reflect.set(e,t,r,cn(e)?e:i);return e===It(i)&&(a?io(r,s)&&ss(e,"set",t,r):ss(e,"add",t,r)),l}deleteProperty(e,t){const r=Pt(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&ss(e,"delete",t,void 0),i}has(e,t){const r=Reflect.has(e,t);return(!Vi(t)||!FT.has(t))&&ir(e,"has",t),r}ownKeys(e){return ir(e,"iterate",rt(e)?"length":Vo),Reflect.ownKeys(e)}}class Mb extends LT{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Fb=new UT,Lb=new Mb,Ub=new UT(!0);const e0=n=>n,Zu=n=>Reflect.getPrototypeOf(n);function Bb(n,e,t){return function(...r){const i=this.__v_raw,s=It(i),o=Ga(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=i[n](...r),u=t?e0:e?il:_i;return!e&&ir(s,"iterate",l?Zp:Vo),{next(){const{value:f,done:p}=c.next();return p?{value:f,done:p}:{value:a?[u(f[0]),u(f[1])]:u(f),done:p}},[Symbol.iterator](){return this}}}}function eh(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function Vb(n,e){const t={get(i){const s=this.__v_raw,o=It(s),a=It(i);n||(io(i,a)&&ir(o,"get",i),ir(o,"get",a));const{has:l}=Zu(o),c=e?e0:n?il:_i;if(l.call(o,i))return c(s.get(i));if(l.call(o,a))return c(s.get(a));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!n&&ir(It(i),"iterate",Vo),i.size},has(i){const s=this.__v_raw,o=It(s),a=It(i);return n||(io(i,a)&&ir(o,"has",i),ir(o,"has",a)),i===a?s.has(i):s.has(i)||s.has(a)},forEach(i,s){const o=this,a=o.__v_raw,l=It(a),c=e?e0:n?il:_i;return!n&&ir(l,"iterate",Vo),a.forEach((u,f)=>i.call(s,c(u),c(f),o))}};return hr(t,n?{add:eh("add"),set:eh("set"),delete:eh("delete"),clear:eh("clear")}:{add(i){!e&&!Yr(i)&&!As(i)&&(i=It(i));const s=It(this);return Zu(s).has.call(s,i)||(s.add(i),ss(s,"add",i,i)),this},set(i,s){!e&&!Yr(s)&&!As(s)&&(s=It(s));const o=It(this),{has:a,get:l}=Zu(o);let c=a.call(o,i);c||(i=It(i),c=a.call(o,i));const u=l.call(o,i);return o.set(i,s),c?io(s,u)&&ss(o,"set",i,s):ss(o,"add",i,s),this},delete(i){const s=It(this),{has:o,get:a}=Zu(s);let l=o.call(s,i);l||(i=It(i),l=o.call(s,i)),a&&a.call(s,i);const c=s.delete(i);return l&&ss(s,"delete",i,void 0),c},clear(){const i=It(this),s=i.size!==0,o=i.clear();return s&&ss(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=Bb(i,n,e)}),t}function vg(n,e){const t=Vb(n,e);return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(Pt(t,i)&&i in r?t:r,i,s)}const Hb={get:vg(!1,!1)},$b={get:vg(!1,!0)},Kb={get:vg(!0,!1)};const BT=new WeakMap,VT=new WeakMap,HT=new WeakMap,jb=new WeakMap;function Wb(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Gb(n){return n.__v_skip||!Object.isExtensible(n)?0:Wb(vb(n))}function su(n){return As(n)?n:_g(n,!1,Fb,Hb,BT)}function $T(n){return _g(n,!1,Ub,$b,VT)}function t0(n){return _g(n,!0,Lb,Kb,HT)}function _g(n,e,t,r,i){if(!qt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=Gb(n);if(s===0)return n;const o=i.get(n);if(o)return o;const a=new Proxy(n,s===2?r:t);return i.set(n,a),a}function fs(n){return As(n)?fs(n.__v_raw):!!(n&&n.__v_isReactive)}function As(n){return!!(n&&n.__v_isReadonly)}function Yr(n){return!!(n&&n.__v_isShallow)}function Yd(n){return n?!!n.__v_raw:!1}function It(n){const e=n&&n.__v_raw;return e?It(e):n}function yg(n){return!Pt(n,"__v_skip")&&Object.isExtensible(n)&&TT(n,"__v_skip",!0),n}const _i=n=>qt(n)?su(n):n,il=n=>qt(n)?t0(n):n;function cn(n){return n?n.__v_isRef===!0:!1}function Se(n){return KT(n,!1)}function qb(n){return KT(n,!0)}function KT(n,e){return cn(n)?n:new zb(n,e)}class zb{constructor(e,t){this.dep=new mg,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:It(e),this._value=t?e:_i(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||Yr(e)||As(e);e=r?e:It(e),io(e,t)&&(this._rawValue=e,this._value=r?e:_i(e),this.dep.trigger())}}function jt(n){return cn(n)?n.value:n}const Yb={get:(n,e,t)=>e==="__v_raw"?n:jt(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return cn(i)&&!cn(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function jT(n){return fs(n)?n:new Proxy(n,Yb)}function Qb(n){const e=rt(n)?new Array(n.length):{};for(const t in n)e[t]=Jb(n,t);return e}class Xb{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0,this._raw=It(e);let i=!0,s=e;if(!rt(e)||!Kd(String(t)))do i=!Yd(s)||Yr(s);while(i&&(s=s.__v_raw));this._shallow=i}get value(){let e=this._object[this._key];return this._shallow&&(e=jt(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&cn(this._raw[this._key])){const t=this._object[this._key];if(cn(t)){t.value=e;return}}this._object[this._key]=e}get dep(){return kb(this._raw,this._key)}}function Jb(n,e,t){return new Xb(n,e,t)}class Zb{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new mg(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Dc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&zt!==this)return kT(this,!0),!0}get value(){const e=this.dep.track();return NT(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function e2(n,e,t=!1){let r,i;return ft(n)?r=n:(r=n.get,i=n.set),new Zb(r,i,t)}const th={},Wh=new WeakMap;let Oo;function t2(n,e=!1,t=Oo){if(t){let r=Wh.get(t);r||Wh.set(t,r=[]),r.push(n)}}function n2(n,e,t=Wt){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:a,call:l}=t,c=R=>i?R:Yr(R)||i===!1||i===0?os(R,1):os(R);let u,f,p,g,m=!1,v=!1;if(cn(n)?(f=()=>n.value,m=Yr(n)):fs(n)?(f=()=>c(n),m=!0):rt(n)?(v=!0,m=n.some(R=>fs(R)||Yr(R)),f=()=>n.map(R=>{if(cn(R))return R.value;if(fs(R))return c(R);if(ft(R))return l?l(R,2):R()})):ft(n)?e?f=l?()=>l(n,2):n:f=()=>{if(p){Ts();try{p()}finally{ws()}}const R=Oo;Oo=u;try{return l?l(n,3,[g]):n(g)}finally{Oo=R}}:f=Mi,e&&i){const R=f,B=i===!0?1/0:i;f=()=>os(R(),B)}const _=xT(),D=()=>{u.stop(),_&&_.active&&hg(_.effects,u)};if(s&&e){const R=e;e=(...B)=>{R(...B),D()}}let b=v?new Array(n.length).fill(th):th;const T=R=>{if(!(!(u.flags&1)||!u.dirty&&!R))if(e){const B=u.run();if(i||m||(v?B.some((W,A)=>io(W,b[A])):io(B,b))){p&&p();const W=Oo;Oo=u;try{const A=[B,b===th?void 0:v&&b[0]===th?[]:b,g];b=B,l?l(e,3,A):e(...A)}finally{Oo=W}}}else u.run()};return a&&a(T),u=new RT(f),u.scheduler=o?()=>o(T,!1):T,g=R=>t2(R,!1,u),p=u.onStop=()=>{const R=Wh.get(u);if(R){if(l)l(R,4);else for(const B of R)B();Wh.delete(u)}},e?r?T(!0):b=u.run():o?o(T.bind(null,!0),!0):u.run(),D.pause=u.pause.bind(u),D.resume=u.resume.bind(u),D.stop=D,D}function os(n,e=1/0,t){if(e<=0||!qt(n)||n.__v_skip||(t=t||new Map,(t.get(n)||0)>=e))return n;if(t.set(n,e),e--,cn(n))os(n.value,e,t);else if(rt(n))for(let r=0;r<n.length;r++)os(n[r],e,t);else if(Al(n)||Ga(n))n.forEach(r=>{os(r,e,t)});else if(ET(n)){for(const r in n)os(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&os(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ou(n,e,t,r){try{return r?n(...r):n()}catch(i){Qd(i,e,t)}}function Hi(n,e,t,r){if(ft(n)){const i=ou(n,e,t,r);return i&&_T(i)&&i.catch(s=>{Qd(s,e,t)}),i}if(rt(n)){const i=[];for(let s=0;s<n.length;s++)i.push(Hi(n[s],e,t,r));return i}}function Qd(n,e,t,r=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Wt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const u=a.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](n,l,c)===!1)return}a=a.parent}if(s){Ts(),ou(s,null,10,[n,l,c]),ws();return}}r2(n,t,i,r,o)}function r2(n,e,t,r=!0,i=!1){if(i)throw n;console.error(n)}const Tr=[];let bi=-1;const qa=[];let zs=null,ka=0;const WT=Promise.resolve();let Gh=null;function Xd(n){const e=Gh||WT;return n?e.then(this?n.bind(this):n):e}function i2(n){let e=bi+1,t=Tr.length;for(;e<t;){const r=e+t>>>1,i=Tr[r],s=Fc(i);s<n||s===n&&i.flags&2?e=r+1:t=r}return e}function Eg(n){if(!(n.flags&1)){const e=Fc(n),t=Tr[Tr.length-1];!t||!(n.flags&2)&&e>=Fc(t)?Tr.push(n):Tr.splice(i2(e),0,n),n.flags|=1,GT()}}function GT(){Gh||(Gh=WT.then(zT))}function s2(n){rt(n)?qa.push(...n):zs&&n.id===-1?zs.splice(ka+1,0,n):n.flags&1||(qa.push(n),n.flags|=1),GT()}function w_(n,e,t=bi+1){for(;t<Tr.length;t++){const r=Tr[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Tr.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function qT(n){if(qa.length){const e=[...new Set(qa)].sort((t,r)=>Fc(t)-Fc(r));if(qa.length=0,zs){zs.push(...e);return}for(zs=e,ka=0;ka<zs.length;ka++){const t=zs[ka];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}zs=null,ka=0}}const Fc=n=>n.id==null?n.flags&2?-1:1/0:n.id;function zT(n){try{for(bi=0;bi<Tr.length;bi++){const e=Tr[bi];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),ou(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;bi<Tr.length;bi++){const e=Tr[bi];e&&(e.flags&=-2)}bi=-1,Tr.length=0,qT(),Gh=null,(Tr.length||qa.length)&&zT()}}let Wr=null,YT=null;function qh(n){const e=Wr;return Wr=n,YT=n&&n.type.__scopeId||null,e}function o2(n,e=Wr,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&Qh(-1);const s=qh(e);let o;try{o=n(...i)}finally{qh(s),r._d&&Qh(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Ie(n,e){if(Wr===null)return n;const t=tf(Wr),r=n.dirs||(n.dirs=[]);for(let i=0;i<e.length;i++){let[s,o,a,l=Wt]=e[i];s&&(ft(s)&&(s={mounted:s,updated:s}),s.deep&&os(o),r.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function ko(n,e,t,r){const i=n.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let l=a.dir[r];l&&(Ts(),Hi(l,t,8,[n.el,a,n,e]),ws())}}function xh(n,e){if(ar){let t=ar.provides;const r=ar.parent&&ar.parent.provides;r===t&&(t=ar.provides=Object.create(r)),t[n]=e}}function di(n,e,t=!1){const r=Aw();if(r||$o){let i=$o?$o._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return t&&ft(e)?e.call(r&&r.proxy):e}}function a2(){return!!(Aw()||$o)}const l2=Symbol.for("v-scx"),c2=()=>di(l2);function Ho(n,e,t){return QT(n,e,t)}function QT(n,e,t=Wt){const{immediate:r,deep:i,flush:s,once:o}=t,a=hr({},t),l=e&&r||!e&&s!=="post";let c;if(Uc){if(s==="sync"){const g=c2();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!l){const g=()=>{};return g.stop=Mi,g.resume=Mi,g.pause=Mi,g}}const u=ar;a.call=(g,m,v)=>Hi(g,u,m,v);let f=!1;s==="post"?a.scheduler=g=>{mr(g,u&&u.suspense)}:s!=="sync"&&(f=!0,a.scheduler=(g,m)=>{m?g():Eg(g)}),a.augmentJob=g=>{e&&(g.flags|=4),f&&(g.flags|=2,u&&(g.id=u.uid,g.i=u))};const p=n2(n,e,a);return Uc&&(c?c.push(p):l&&p()),p}function u2(n,e,t){const r=this.proxy,i=pn(n)?n.includes(".")?XT(r,n):()=>r[n]:n.bind(r,r);let s;ft(e)?s=e:(s=e.handler,t=e);const o=au(this),a=QT(i,s.bind(r),t);return o(),a}function XT(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}const JT=Symbol("_vte"),h2=n=>n.__isTeleport,hc=n=>n&&(n.disabled||n.disabled===""),A_=n=>n&&(n.defer||n.defer===""),C_=n=>typeof SVGElement<"u"&&n instanceof SVGElement,S_=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,n0=(n,e)=>{const t=n&&n.to;return pn(t)?e?e(t):null:t},ZT={name:"Teleport",__isTeleport:!0,process(n,e,t,r,i,s,o,a,l,c){const{mc:u,pc:f,pbc:p,o:{insert:g,querySelector:m,createText:v,createComment:_}}=c,D=hc(e.props);let{shapeFlag:b,children:T,dynamicChildren:R}=e;if(n==null){const B=e.el=v(""),W=e.anchor=v("");g(B,t,r),g(W,t,r);const A=(E,C)=>{b&16&&u(T,E,C,i,s,o,a,l)},w=()=>{const E=e.target=n0(e.props,m),C=ew(E,e,v,g);E&&(o!=="svg"&&C_(E)?o="svg":o!=="mathml"&&S_(E)&&(o="mathml"),i&&i.isCE&&(i.ce._teleportTargets||(i.ce._teleportTargets=new Set)).add(E),D||(A(E,C),Rh(e,!1)))};D&&(A(t,W),Rh(e,!0)),A_(e.props)?(e.el.__isMounted=!1,mr(()=>{w(),delete e.el.__isMounted},s)):w()}else{if(A_(e.props)&&n.el.__isMounted===!1){mr(()=>{ZT.process(n,e,t,r,i,s,o,a,l,c)},s);return}e.el=n.el,e.targetStart=n.targetStart;const B=e.anchor=n.anchor,W=e.target=n.target,A=e.targetAnchor=n.targetAnchor,w=hc(n.props),E=w?t:W,C=w?B:A;if(o==="svg"||C_(W)?o="svg":(o==="mathml"||S_(W))&&(o="mathml"),R?(p(n.dynamicChildren,R,E,i,s,o,a),Cg(n,e,!0)):l||f(n,e,E,C,i,s,o,a,!1),D)w?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):nh(e,t,B,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const I=e.target=n0(e.props,m);I&&nh(e,I,null,c,0)}else w&&nh(e,W,A,c,1);Rh(e,D)}},remove(n,e,t,{um:r,o:{remove:i}},s){const{shapeFlag:o,children:a,anchor:l,targetStart:c,targetAnchor:u,target:f,props:p}=n;if(f&&(i(c),i(u)),s&&i(l),o&16){const g=s||!hc(p);for(let m=0;m<a.length;m++){const v=a[m];r(v,e,t,g,!!v.dynamicChildren)}}},move:nh,hydrate:d2};function nh(n,e,t,{o:{insert:r},m:i},s=2){s===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=n,f=s===2;if(f&&r(o,e,t),(!f||hc(u))&&l&16)for(let p=0;p<c.length;p++)i(c[p],e,t,2);f&&r(a,e,t)}function d2(n,e,t,r,i,s,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:c,createText:u}},f){function p(v,_,D,b){_.anchor=f(o(v),_,a(v),t,r,i,s),_.targetStart=D,_.targetAnchor=b}const g=e.target=n0(e.props,l),m=hc(e.props);if(g){const v=g._lpa||g.firstChild;if(e.shapeFlag&16)if(m)p(n,e,v,v&&o(v));else{e.anchor=o(n);let _=v;for(;_;){if(_&&_.nodeType===8){if(_.data==="teleport start anchor")e.targetStart=_;else if(_.data==="teleport anchor"){e.targetAnchor=_,g._lpa=e.targetAnchor&&o(e.targetAnchor);break}}_=o(_)}e.targetAnchor||ew(g,e,u,c),f(v&&o(v),e,g,t,r,i,s)}Rh(e,m)}else m&&e.shapeFlag&16&&p(n,e,n,o(n));return e.anchor&&o(e.anchor)}const f2=ZT;function Rh(n,e){const t=n.ctx;if(t&&t.ut){let r,i;for(e?(r=n.el,i=n.anchor):(r=n.targetStart,i=n.targetAnchor);r&&r!==i;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}function ew(n,e,t,r){const i=e.targetStart=t(""),s=e.targetAnchor=t("");return i[JT]=s,n&&(r(i,n),r(s,n)),s}const p2=Symbol("_leaveCb");function Tg(n,e){n.shapeFlag&6&&n.component?(n.transition=e,Tg(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function tw(n,e){return ft(n)?hr({name:n.name},e,{setup:n}):n}function nw(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const zh=new WeakMap;function dc(n,e,t,r,i=!1){if(rt(n)){n.forEach((m,v)=>dc(m,e&&(rt(e)?e[v]:e),t,r,i));return}if(fc(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&dc(n,e,t,r.component.subTree);return}const s=r.shapeFlag&4?tf(r.component):r.el,o=i?null:s,{i:a,r:l}=n,c=e&&e.r,u=a.refs===Wt?a.refs={}:a.refs,f=a.setupState,p=It(f),g=f===Wt?vT:m=>Pt(p,m);if(c!=null&&c!==l){if(I_(e),pn(c))u[c]=null,g(c)&&(f[c]=null);else if(cn(c)){c.value=null;const m=e;m.k&&(u[m.k]=null)}}if(ft(l))ou(l,a,12,[o,u]);else{const m=pn(l),v=cn(l);if(m||v){const _=()=>{if(n.f){const D=m?g(l)?f[l]:u[l]:l.value;if(i)rt(D)&&hg(D,s);else if(rt(D))D.includes(s)||D.push(s);else if(m)u[l]=[s],g(l)&&(f[l]=u[l]);else{const b=[s];l.value=b,n.k&&(u[n.k]=b)}}else m?(u[l]=o,g(l)&&(f[l]=o)):v&&(l.value=o,n.k&&(u[n.k]=o))};if(o){const D=()=>{_(),zh.delete(n)};D.id=-1,zh.set(n,D),mr(D,t)}else I_(n),_()}}}function I_(n){const e=zh.get(n);e&&(e.flags|=8,zh.delete(n))}qd().requestIdleCallback;qd().cancelIdleCallback;const fc=n=>!!n.type.__asyncLoader,rw=n=>n.type.__isKeepAlive;function g2(n,e){iw(n,"a",e)}function m2(n,e){iw(n,"da",e)}function iw(n,e,t=ar){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(Jd(e,r,t),t){let i=t.parent;for(;i&&i.parent;)rw(i.parent.vnode)&&v2(r,e,t,i),i=i.parent}}function v2(n,e,t,r){const i=Jd(e,n,r,!0);sw(()=>{hg(r[e],i)},t)}function Jd(n,e,t=ar,r=!1){if(t){const i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{Ts();const a=au(t),l=Hi(e,t,n,o);return a(),ws(),l});return r?i.unshift(s):i.push(s),s}}const Os=n=>(e,t=ar)=>{(!Uc||n==="sp")&&Jd(n,(...r)=>e(...r),t)},_2=Os("bm"),Dr=Os("m"),y2=Os("bu"),E2=Os("u"),T2=Os("bum"),sw=Os("um"),w2=Os("sp"),A2=Os("rtg"),C2=Os("rtc");function S2(n,e=ar){Jd("ec",n,e)}const I2="components";function x2(n,e){return b2(I2,n,!0,e)||n}const R2=Symbol.for("v-ndc");function b2(n,e,t=!0,r=!1){const i=Wr||ar;if(i){const s=i.type;{const a=fk(s,!1);if(a&&(a===e||a===ti(e)||a===Wd(ti(e))))return s}const o=x_(i[n]||s[n],e)||x_(i.appContext[n],e);return!o&&r?s:o}}function x_(n,e){return n&&(n[e]||n[ti(e)]||n[Wd(ti(e))])}function rn(n,e,t,r){let i;const s=t,o=rt(n);if(o||pn(n)){const a=o&&fs(n);let l=!1,c=!1;a&&(l=!Yr(n),c=As(n),n=zd(n)),i=new Array(n.length);for(let u=0,f=n.length;u<f;u++)i[u]=e(l?c?il(_i(n[u])):_i(n[u]):n[u],u,void 0,s)}else if(typeof n=="number"){i=new Array(n);for(let a=0;a<n;a++)i[a]=e(a+1,a,void 0,s)}else if(qt(n))if(n[Symbol.iterator])i=Array.from(n,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(n);i=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];i[l]=e(n[u],u,l,s)}}else i=[];return i}const r0=n=>n?Cw(n)?tf(n):r0(n.parent):null,pc=hr(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>r0(n.parent),$root:n=>r0(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>aw(n),$forceUpdate:n=>n.f||(n.f=()=>{Eg(n.update)}),$nextTick:n=>n.n||(n.n=Xd.bind(n.proxy)),$watch:n=>u2.bind(n)}),gp=(n,e)=>n!==Wt&&!n.__isScriptSetup&&Pt(n,e),k2={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:l}=n;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(gp(r,e))return o[e]=1,r[e];if(i!==Wt&&Pt(i,e))return o[e]=2,i[e];if(Pt(s,e))return o[e]=3,s[e];if(t!==Wt&&Pt(t,e))return o[e]=4,t[e];i0&&(o[e]=0)}}const c=pc[e];let u,f;if(c)return e==="$attrs"&&ir(n.attrs,"get",""),c(n);if((u=a.__cssModules)&&(u=u[e]))return u;if(t!==Wt&&Pt(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,Pt(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:s}=n;return gp(i,e)?(i[e]=t,!0):r!==Wt&&Pt(r,e)?(r[e]=t,!0):Pt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,props:s,type:o}},a){let l;return!!(t[a]||n!==Wt&&a[0]!=="$"&&Pt(n,a)||gp(e,a)||Pt(s,a)||Pt(r,a)||Pt(pc,a)||Pt(i.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Pt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function R_(n){return rt(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let i0=!0;function P2(n){const e=aw(n),t=n.proxy,r=n.ctx;i0=!1,e.beforeCreate&&b_(e.beforeCreate,n,"bc");const{data:i,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:f,mounted:p,beforeUpdate:g,updated:m,activated:v,deactivated:_,beforeDestroy:D,beforeUnmount:b,destroyed:T,unmounted:R,render:B,renderTracked:W,renderTriggered:A,errorCaptured:w,serverPrefetch:E,expose:C,inheritAttrs:I,components:x,directives:P,filters:ie}=e;if(c&&O2(c,r,null),o)for(const Ae in o){const Oe=o[Ae];ft(Oe)&&(r[Ae]=Oe.bind(t))}if(i){const Ae=i.call(t,t);qt(Ae)&&(n.data=su(Ae))}if(i0=!0,s)for(const Ae in s){const Oe=s[Ae],Ce=ft(Oe)?Oe.bind(t,t):ft(Oe.get)?Oe.get.bind(t,t):Mi,fe=!ft(Oe)&&ft(Oe.set)?Oe.set.bind(t):Mi,F=it({get:Ce,set:fe});Object.defineProperty(r,Ae,{enumerable:!0,configurable:!0,get:()=>F.value,set:O=>F.value=O})}if(a)for(const Ae in a)ow(a[Ae],r,t,Ae);if(l){const Ae=ft(l)?l.call(t):l;Reflect.ownKeys(Ae).forEach(Oe=>{xh(Oe,Ae[Oe])})}u&&b_(u,n,"c");function ae(Ae,Oe){rt(Oe)?Oe.forEach(Ce=>Ae(Ce.bind(t))):Oe&&Ae(Oe.bind(t))}if(ae(_2,f),ae(Dr,p),ae(y2,g),ae(E2,m),ae(g2,v),ae(m2,_),ae(S2,w),ae(C2,W),ae(A2,A),ae(T2,b),ae(sw,R),ae(w2,E),rt(C))if(C.length){const Ae=n.exposed||(n.exposed={});C.forEach(Oe=>{Object.defineProperty(Ae,Oe,{get:()=>t[Oe],set:Ce=>t[Oe]=Ce,enumerable:!0})})}else n.exposed||(n.exposed={});B&&n.render===Mi&&(n.render=B),I!=null&&(n.inheritAttrs=I),x&&(n.components=x),P&&(n.directives=P),E&&nw(n)}function O2(n,e,t=Mi){rt(n)&&(n=s0(n));for(const r in n){const i=n[r];let s;qt(i)?"default"in i?s=di(i.from||r,i.default,!0):s=di(i.from||r):s=di(i),cn(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function b_(n,e,t){Hi(rt(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function ow(n,e,t,r){let i=r.includes(".")?XT(t,r):()=>t[r];if(pn(n)){const s=e[n];ft(s)&&Ho(i,s)}else if(ft(n))Ho(i,n.bind(t));else if(qt(n))if(rt(n))n.forEach(s=>ow(s,e,t,r));else{const s=ft(n.handler)?n.handler.bind(t):e[n.handler];ft(s)&&Ho(i,s,n)}}function aw(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!i.length&&!t&&!r?l=e:(l={},i.length&&i.forEach(c=>Yh(l,c,o,!0)),Yh(l,e,o)),qt(e)&&s.set(e,l),l}function Yh(n,e,t,r=!1){const{mixins:i,extends:s}=e;s&&Yh(n,s,t,!0),i&&i.forEach(o=>Yh(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=N2[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const N2={data:k_,props:P_,emits:P_,methods:nc,computed:nc,beforeCreate:gr,created:gr,beforeMount:gr,mounted:gr,beforeUpdate:gr,updated:gr,beforeDestroy:gr,beforeUnmount:gr,destroyed:gr,unmounted:gr,activated:gr,deactivated:gr,errorCaptured:gr,serverPrefetch:gr,components:nc,directives:nc,watch:M2,provide:k_,inject:D2};function k_(n,e){return e?n?function(){return hr(ft(n)?n.call(this,this):n,ft(e)?e.call(this,this):e)}:e:n}function D2(n,e){return nc(s0(n),s0(e))}function s0(n){if(rt(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function gr(n,e){return n?[...new Set([].concat(n,e))]:e}function nc(n,e){return n?hr(Object.create(null),n,e):e}function P_(n,e){return n?rt(n)&&rt(e)?[...new Set([...n,...e])]:hr(Object.create(null),R_(n),R_(e??{})):e}function M2(n,e){if(!n)return e;if(!e)return n;const t=hr(Object.create(null),n);for(const r in e)t[r]=gr(n[r],e[r]);return t}function lw(){return{app:null,config:{isNativeTag:vT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let F2=0;function L2(n,e){return function(r,i=null){ft(r)||(r=hr({},r)),i!=null&&!qt(i)&&(i=null);const s=lw(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:F2++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:gk,get config(){return s.config},set config(u){},use(u,...f){return o.has(u)||(u&&ft(u.install)?(o.add(u),u.install(c,...f)):ft(u)&&(o.add(u),u(c,...f))),c},mixin(u){return s.mixins.includes(u)||s.mixins.push(u),c},component(u,f){return f?(s.components[u]=f,c):s.components[u]},directive(u,f){return f?(s.directives[u]=f,c):s.directives[u]},mount(u,f,p){if(!l){const g=c._ceVNode||fn(r,i);return g.appContext=s,p===!0?p="svg":p===!1&&(p=void 0),n(g,u,p),l=!0,c._container=u,u.__vue_app__=c,tf(g.component)}},onUnmount(u){a.push(u)},unmount(){l&&(Hi(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(u,f){return s.provides[u]=f,c},runWithContext(u){const f=$o;$o=c;try{return u()}finally{$o=f}}};return c}}let $o=null;const U2=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${ti(e)}Modifiers`]||n[`${aa(e)}Modifiers`];function B2(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Wt;let i=t;const s=e.startsWith("update:"),o=s&&U2(r,e.slice(7));o&&(o.trim&&(i=t.map(u=>pn(u)?u.trim():u)),o.number&&(i=t.map(Gd)));let a,l=r[a=up(e)]||r[a=up(ti(e))];!l&&s&&(l=r[a=up(aa(e))]),l&&Hi(l,n,6,i);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Hi(c,n,6,i)}}const V2=new WeakMap;function cw(n,e,t=!1){const r=t?V2:e.emitsCache,i=r.get(n);if(i!==void 0)return i;const s=n.emits;let o={},a=!1;if(!ft(n)){const l=c=>{const u=cw(c,e,!0);u&&(a=!0,hr(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(qt(n)&&r.set(n,null),null):(rt(s)?s.forEach(l=>o[l]=null):hr(o,s),qt(n)&&r.set(n,o),o)}function Zd(n,e){return!n||!$d(e)?!1:(e=e.slice(2).replace(/Once$/,""),Pt(n,e[0].toLowerCase()+e.slice(1))||Pt(n,aa(e))||Pt(n,e))}function O_(n){const{type:e,vnode:t,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:f,data:p,setupState:g,ctx:m,inheritAttrs:v}=n,_=qh(n);let D,b;try{if(t.shapeFlag&4){const R=i||r,B=R;D=ki(c.call(B,R,u,f,g,p,m)),b=a}else{const R=e;D=ki(R.length>1?R(f,{attrs:a,slots:o,emit:l}):R(f,null)),b=e.props?a:H2(a)}}catch(R){gc.length=0,Qd(R,n,1),D=fn(ho)}let T=D;if(b&&v!==!1){const R=Object.keys(b),{shapeFlag:B}=T;R.length&&B&7&&(s&&R.some(ug)&&(b=$2(b,s)),T=sl(T,b,!1,!0))}return t.dirs&&(T=sl(T,null,!1,!0),T.dirs=T.dirs?T.dirs.concat(t.dirs):t.dirs),t.transition&&Tg(T,t.transition),D=T,qh(_),D}const H2=n=>{let e;for(const t in n)(t==="class"||t==="style"||$d(t))&&((e||(e={}))[t]=n[t]);return e},$2=(n,e)=>{const t={};for(const r in n)(!ug(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function K2(n,e,t){const{props:r,children:i,component:s}=n,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?N_(r,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const p=u[f];if(o[p]!==r[p]&&!Zd(c,p))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?N_(r,o,c):!0:!!o;return!1}function N_(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==n[s]&&!Zd(t,s))return!0}return!1}function j2({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const uw={},hw=()=>Object.create(uw),dw=n=>Object.getPrototypeOf(n)===uw;function W2(n,e,t,r=!1){const i={},s=hw();n.propsDefaults=Object.create(null),fw(n,e,i,s);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);t?n.props=r?i:$T(i):n.type.props?n.props=i:n.props=s,n.attrs=s}function G2(n,e,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=n,a=It(i),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let f=0;f<u.length;f++){let p=u[f];if(Zd(n.emitsOptions,p))continue;const g=e[p];if(l)if(Pt(s,p))g!==s[p]&&(s[p]=g,c=!0);else{const m=ti(p);i[m]=o0(l,a,m,g,n,!1)}else g!==s[p]&&(s[p]=g,c=!0)}}}else{fw(n,e,i,s)&&(c=!0);let u;for(const f in a)(!e||!Pt(e,f)&&((u=aa(f))===f||!Pt(e,u)))&&(l?t&&(t[f]!==void 0||t[u]!==void 0)&&(i[f]=o0(l,a,f,void 0,n,!0)):delete i[f]);if(s!==a)for(const f in s)(!e||!Pt(e,f))&&(delete s[f],c=!0)}c&&ss(n.attrs,"set","")}function fw(n,e,t,r){const[i,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(lc(l))continue;const c=e[l];let u;i&&Pt(i,u=ti(l))?!s||!s.includes(u)?t[u]=c:(a||(a={}))[u]=c:Zd(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(s){const l=It(t),c=a||Wt;for(let u=0;u<s.length;u++){const f=s[u];t[f]=o0(i,l,f,c[f],n,!Pt(c,f))}}return o}function o0(n,e,t,r,i,s){const o=n[t];if(o!=null){const a=Pt(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ft(l)){const{propsDefaults:c}=i;if(t in c)r=c[t];else{const u=au(i);r=c[t]=l.call(null,e),u()}}else r=l;i.ce&&i.ce._setProp(t,r)}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===aa(t))&&(r=!0))}return r}const q2=new WeakMap;function pw(n,e,t=!1){const r=t?q2:e.propsCache,i=r.get(n);if(i)return i;const s=n.props,o={},a=[];let l=!1;if(!ft(n)){const u=f=>{l=!0;const[p,g]=pw(f,e,!0);hr(o,p),g&&a.push(...g)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!s&&!l)return qt(n)&&r.set(n,Wa),Wa;if(rt(s))for(let u=0;u<s.length;u++){const f=ti(s[u]);D_(f)&&(o[f]=Wt)}else if(s)for(const u in s){const f=ti(u);if(D_(f)){const p=s[u],g=o[f]=rt(p)||ft(p)?{type:p}:hr({},p),m=g.type;let v=!1,_=!0;if(rt(m))for(let D=0;D<m.length;++D){const b=m[D],T=ft(b)&&b.name;if(T==="Boolean"){v=!0;break}else T==="String"&&(_=!1)}else v=ft(m)&&m.name==="Boolean";g[0]=v,g[1]=_,(v||Pt(g,"default"))&&a.push(f)}}const c=[o,a];return qt(n)&&r.set(n,c),c}function D_(n){return n[0]!=="$"&&!lc(n)}const wg=n=>n==="_"||n==="_ctx"||n==="$stable",Ag=n=>rt(n)?n.map(ki):[ki(n)],z2=(n,e,t)=>{if(e._n)return e;const r=o2((...i)=>Ag(e(...i)),t);return r._c=!1,r},gw=(n,e,t)=>{const r=n._ctx;for(const i in n){if(wg(i))continue;const s=n[i];if(ft(s))e[i]=z2(i,s,r);else if(s!=null){const o=Ag(s);e[i]=()=>o}}},mw=(n,e)=>{const t=Ag(e);n.slots.default=()=>t},vw=(n,e,t)=>{for(const r in e)(t||!wg(r))&&(n[r]=e[r])},Y2=(n,e,t)=>{const r=n.slots=hw();if(n.vnode.shapeFlag&32){const i=e._;i?(vw(r,e,t),t&&TT(r,"_",i,!0)):gw(e,r)}else e&&mw(n,e)},Q2=(n,e,t)=>{const{vnode:r,slots:i}=n;let s=!0,o=Wt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:vw(i,e,t):(s=!e.$stable,gw(e,i)),o=e}else e&&(mw(n,e),o={default:1});if(s)for(const a in i)!wg(a)&&o[a]==null&&delete i[a]},mr=tk;function X2(n){return J2(n)}function J2(n,e){const t=qd();t.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:p,setScopeId:g=Mi,insertStaticContent:m}=n,v=(k,L,z,ge=null,ye=null,re=null,Me=void 0,Fe=null,De=!!L.dynamicChildren)=>{if(k===L)return;k&&!Xl(k,L)&&(ge=ne(k),O(k,ye,re,!0),k=null),L.patchFlag===-2&&(De=!1,L.dynamicChildren=null);const{type:Re,ref:Je,shapeFlag:je}=L;switch(Re){case ef:_(k,L,z,ge);break;case ho:D(k,L,z,ge);break;case bh:k==null&&b(L,z,ge,Me);break;case wt:x(k,L,z,ge,ye,re,Me,Fe,De);break;default:je&1?B(k,L,z,ge,ye,re,Me,Fe,De):je&6?P(k,L,z,ge,ye,re,Me,Fe,De):(je&64||je&128)&&Re.process(k,L,z,ge,ye,re,Me,Fe,De,H)}Je!=null&&ye?dc(Je,k&&k.ref,re,L||k,!L):Je==null&&k&&k.ref!=null&&dc(k.ref,null,re,k,!0)},_=(k,L,z,ge)=>{if(k==null)r(L.el=a(L.children),z,ge);else{const ye=L.el=k.el;L.children!==k.children&&c(ye,L.children)}},D=(k,L,z,ge)=>{k==null?r(L.el=l(L.children||""),z,ge):L.el=k.el},b=(k,L,z,ge)=>{[k.el,k.anchor]=m(k.children,L,z,ge,k.el,k.anchor)},T=({el:k,anchor:L},z,ge)=>{let ye;for(;k&&k!==L;)ye=p(k),r(k,z,ge),k=ye;r(L,z,ge)},R=({el:k,anchor:L})=>{let z;for(;k&&k!==L;)z=p(k),i(k),k=z;i(L)},B=(k,L,z,ge,ye,re,Me,Fe,De)=>{if(L.type==="svg"?Me="svg":L.type==="math"&&(Me="mathml"),k==null)W(L,z,ge,ye,re,Me,Fe,De);else{const Re=k.el&&k.el._isVueCE?k.el:null;try{Re&&Re._beginPatch(),E(k,L,ye,re,Me,Fe,De)}finally{Re&&Re._endPatch()}}},W=(k,L,z,ge,ye,re,Me,Fe)=>{let De,Re;const{props:Je,shapeFlag:je,transition:Ye,dirs:nt}=k;if(De=k.el=o(k.type,re,Je&&Je.is,Je),je&8?u(De,k.children):je&16&&w(k.children,De,null,ge,ye,mp(k,re),Me,Fe),nt&&ko(k,null,ge,"created"),A(De,k,k.scopeId,Me,ge),Je){for(const ot in Je)ot!=="value"&&!lc(ot)&&s(De,ot,null,Je[ot],re,ge);"value"in Je&&s(De,"value",null,Je.value,re),(Re=Je.onVnodeBeforeMount)&&Ci(Re,ge,k)}nt&&ko(k,null,ge,"beforeMount");const Ze=Z2(ye,Ye);Ze&&Ye.beforeEnter(De),r(De,L,z),((Re=Je&&Je.onVnodeMounted)||Ze||nt)&&mr(()=>{Re&&Ci(Re,ge,k),Ze&&Ye.enter(De),nt&&ko(k,null,ge,"mounted")},ye)},A=(k,L,z,ge,ye)=>{if(z&&g(k,z),ge)for(let re=0;re<ge.length;re++)g(k,ge[re]);if(ye){let re=ye.subTree;if(L===re||Ew(re.type)&&(re.ssContent===L||re.ssFallback===L)){const Me=ye.vnode;A(k,Me,Me.scopeId,Me.slotScopeIds,ye.parent)}}},w=(k,L,z,ge,ye,re,Me,Fe,De=0)=>{for(let Re=De;Re<k.length;Re++){const Je=k[Re]=Fe?Ys(k[Re]):ki(k[Re]);v(null,Je,L,z,ge,ye,re,Me,Fe)}},E=(k,L,z,ge,ye,re,Me)=>{const Fe=L.el=k.el;let{patchFlag:De,dynamicChildren:Re,dirs:Je}=L;De|=k.patchFlag&16;const je=k.props||Wt,Ye=L.props||Wt;let nt;if(z&&Po(z,!1),(nt=Ye.onVnodeBeforeUpdate)&&Ci(nt,z,L,k),Je&&ko(L,k,z,"beforeUpdate"),z&&Po(z,!0),(je.innerHTML&&Ye.innerHTML==null||je.textContent&&Ye.textContent==null)&&u(Fe,""),Re?C(k.dynamicChildren,Re,Fe,z,ge,mp(L,ye),re):Me||Oe(k,L,Fe,null,z,ge,mp(L,ye),re,!1),De>0){if(De&16)I(Fe,je,Ye,z,ye);else if(De&2&&je.class!==Ye.class&&s(Fe,"class",null,Ye.class,ye),De&4&&s(Fe,"style",je.style,Ye.style,ye),De&8){const Ze=L.dynamicProps;for(let ot=0;ot<Ze.length;ot++){const pt=Ze[ot],Cn=je[pt],mn=Ye[pt];(mn!==Cn||pt==="value")&&s(Fe,pt,Cn,mn,ye,z)}}De&1&&k.children!==L.children&&u(Fe,L.children)}else!Me&&Re==null&&I(Fe,je,Ye,z,ye);((nt=Ye.onVnodeUpdated)||Je)&&mr(()=>{nt&&Ci(nt,z,L,k),Je&&ko(L,k,z,"updated")},ge)},C=(k,L,z,ge,ye,re,Me)=>{for(let Fe=0;Fe<L.length;Fe++){const De=k[Fe],Re=L[Fe],Je=De.el&&(De.type===wt||!Xl(De,Re)||De.shapeFlag&198)?f(De.el):z;v(De,Re,Je,null,ge,ye,re,Me,!0)}},I=(k,L,z,ge,ye)=>{if(L!==z){if(L!==Wt)for(const re in L)!lc(re)&&!(re in z)&&s(k,re,L[re],null,ye,ge);for(const re in z){if(lc(re))continue;const Me=z[re],Fe=L[re];Me!==Fe&&re!=="value"&&s(k,re,Fe,Me,ye,ge)}"value"in z&&s(k,"value",L.value,z.value,ye)}},x=(k,L,z,ge,ye,re,Me,Fe,De)=>{const Re=L.el=k?k.el:a(""),Je=L.anchor=k?k.anchor:a("");let{patchFlag:je,dynamicChildren:Ye,slotScopeIds:nt}=L;nt&&(Fe=Fe?Fe.concat(nt):nt),k==null?(r(Re,z,ge),r(Je,z,ge),w(L.children||[],z,Je,ye,re,Me,Fe,De)):je>0&&je&64&&Ye&&k.dynamicChildren&&k.dynamicChildren.length===Ye.length?(C(k.dynamicChildren,Ye,z,ye,re,Me,Fe),(L.key!=null||ye&&L===ye.subTree)&&Cg(k,L,!0)):Oe(k,L,z,Je,ye,re,Me,Fe,De)},P=(k,L,z,ge,ye,re,Me,Fe,De)=>{L.slotScopeIds=Fe,k==null?L.shapeFlag&512?ye.ctx.activate(L,z,ge,Me,De):ie(L,z,ge,ye,re,Me,De):Q(k,L,De)},ie=(k,L,z,ge,ye,re,Me)=>{const Fe=k.component=lk(k,ge,ye);if(rw(k)&&(Fe.ctx.renderer=H),ck(Fe,!1,Me),Fe.asyncDep){if(ye&&ye.registerDep(Fe,ae,Me),!k.el){const De=Fe.subTree=fn(ho);D(null,De,L,z),k.placeholder=De.el}}else ae(Fe,k,L,z,ye,re,Me)},Q=(k,L,z)=>{const ge=L.component=k.component;if(K2(k,L,z))if(ge.asyncDep&&!ge.asyncResolved){Ae(ge,L,z);return}else ge.next=L,ge.update();else L.el=k.el,ge.vnode=L},ae=(k,L,z,ge,ye,re,Me)=>{const Fe=()=>{if(k.isMounted){let{next:je,bu:Ye,u:nt,parent:Ze,vnode:ot}=k;{const Sn=_w(k);if(Sn){je&&(je.el=ot.el,Ae(k,je,Me)),Sn.asyncDep.then(()=>{k.isUnmounted||Fe()});return}}let pt=je,Cn;Po(k,!1),je?(je.el=ot.el,Ae(k,je,Me)):je=ot,Ye&&Ih(Ye),(Cn=je.props&&je.props.onVnodeBeforeUpdate)&&Ci(Cn,Ze,je,ot),Po(k,!0);const mn=O_(k),pr=k.subTree;k.subTree=mn,v(pr,mn,f(pr.el),ne(pr),k,ye,re),je.el=mn.el,pt===null&&j2(k,mn.el),nt&&mr(nt,ye),(Cn=je.props&&je.props.onVnodeUpdated)&&mr(()=>Ci(Cn,Ze,je,ot),ye)}else{let je;const{el:Ye,props:nt}=L,{bm:Ze,m:ot,parent:pt,root:Cn,type:mn}=k,pr=fc(L);Po(k,!1),Ze&&Ih(Ze),!pr&&(je=nt&&nt.onVnodeBeforeMount)&&Ci(je,pt,L),Po(k,!0);{Cn.ce&&Cn.ce._def.shadowRoot!==!1&&Cn.ce._injectChildStyle(mn);const Sn=k.subTree=O_(k);v(null,Sn,z,ge,k,ye,re),L.el=Sn.el}if(ot&&mr(ot,ye),!pr&&(je=nt&&nt.onVnodeMounted)){const Sn=L;mr(()=>Ci(je,pt,Sn),ye)}(L.shapeFlag&256||pt&&fc(pt.vnode)&&pt.vnode.shapeFlag&256)&&k.a&&mr(k.a,ye),k.isMounted=!0,L=z=ge=null}};k.scope.on();const De=k.effect=new RT(Fe);k.scope.off();const Re=k.update=De.run.bind(De),Je=k.job=De.runIfDirty.bind(De);Je.i=k,Je.id=k.uid,De.scheduler=()=>Eg(Je),Po(k,!0),Re()},Ae=(k,L,z)=>{L.component=k;const ge=k.vnode.props;k.vnode=L,k.next=null,G2(k,L.props,ge,z),Q2(k,L.children,z),Ts(),w_(k),ws()},Oe=(k,L,z,ge,ye,re,Me,Fe,De=!1)=>{const Re=k&&k.children,Je=k?k.shapeFlag:0,je=L.children,{patchFlag:Ye,shapeFlag:nt}=L;if(Ye>0){if(Ye&128){fe(Re,je,z,ge,ye,re,Me,Fe,De);return}else if(Ye&256){Ce(Re,je,z,ge,ye,re,Me,Fe,De);return}}nt&8?(Je&16&&ce(Re,ye,re),je!==Re&&u(z,je)):Je&16?nt&16?fe(Re,je,z,ge,ye,re,Me,Fe,De):ce(Re,ye,re,!0):(Je&8&&u(z,""),nt&16&&w(je,z,ge,ye,re,Me,Fe,De))},Ce=(k,L,z,ge,ye,re,Me,Fe,De)=>{k=k||Wa,L=L||Wa;const Re=k.length,Je=L.length,je=Math.min(Re,Je);let Ye;for(Ye=0;Ye<je;Ye++){const nt=L[Ye]=De?Ys(L[Ye]):ki(L[Ye]);v(k[Ye],nt,z,null,ye,re,Me,Fe,De)}Re>Je?ce(k,ye,re,!0,!1,je):w(L,z,ge,ye,re,Me,Fe,De,je)},fe=(k,L,z,ge,ye,re,Me,Fe,De)=>{let Re=0;const Je=L.length;let je=k.length-1,Ye=Je-1;for(;Re<=je&&Re<=Ye;){const nt=k[Re],Ze=L[Re]=De?Ys(L[Re]):ki(L[Re]);if(Xl(nt,Ze))v(nt,Ze,z,null,ye,re,Me,Fe,De);else break;Re++}for(;Re<=je&&Re<=Ye;){const nt=k[je],Ze=L[Ye]=De?Ys(L[Ye]):ki(L[Ye]);if(Xl(nt,Ze))v(nt,Ze,z,null,ye,re,Me,Fe,De);else break;je--,Ye--}if(Re>je){if(Re<=Ye){const nt=Ye+1,Ze=nt<Je?L[nt].el:ge;for(;Re<=Ye;)v(null,L[Re]=De?Ys(L[Re]):ki(L[Re]),z,Ze,ye,re,Me,Fe,De),Re++}}else if(Re>Ye)for(;Re<=je;)O(k[Re],ye,re,!0),Re++;else{const nt=Re,Ze=Re,ot=new Map;for(Re=Ze;Re<=Ye;Re++){const vn=L[Re]=De?Ys(L[Re]):ki(L[Re]);vn.key!=null&&ot.set(vn.key,Re)}let pt,Cn=0;const mn=Ye-Ze+1;let pr=!1,Sn=0;const ii=new Array(mn);for(Re=0;Re<mn;Re++)ii[Re]=0;for(Re=nt;Re<=je;Re++){const vn=k[Re];if(Cn>=mn){O(vn,ye,re,!0);continue}let Sr;if(vn.key!=null)Sr=ot.get(vn.key);else for(pt=Ze;pt<=Ye;pt++)if(ii[pt-Ze]===0&&Xl(vn,L[pt])){Sr=pt;break}Sr===void 0?O(vn,ye,re,!0):(ii[Sr-Ze]=Re+1,Sr>=Sn?Sn=Sr:pr=!0,v(vn,L[Sr],z,null,ye,re,Me,Fe,De),Cn++)}const Ls=pr?ek(ii):Wa;for(pt=Ls.length-1,Re=mn-1;Re>=0;Re--){const vn=Ze+Re,Sr=L[vn],_a=L[vn+1],qi=vn+1<Je?_a.el||yw(_a):ge;ii[Re]===0?v(null,Sr,z,qi,ye,re,Me,Fe,De):pr&&(pt<0||Re!==Ls[pt]?F(Sr,z,qi,2):pt--)}}},F=(k,L,z,ge,ye=null)=>{const{el:re,type:Me,transition:Fe,children:De,shapeFlag:Re}=k;if(Re&6){F(k.component.subTree,L,z,ge);return}if(Re&128){k.suspense.move(L,z,ge);return}if(Re&64){Me.move(k,L,z,H);return}if(Me===wt){r(re,L,z);for(let je=0;je<De.length;je++)F(De[je],L,z,ge);r(k.anchor,L,z);return}if(Me===bh){T(k,L,z);return}if(ge!==2&&Re&1&&Fe)if(ge===0)Fe.beforeEnter(re),r(re,L,z),mr(()=>Fe.enter(re),ye);else{const{leave:je,delayLeave:Ye,afterLeave:nt}=Fe,Ze=()=>{k.ctx.isUnmounted?i(re):r(re,L,z)},ot=()=>{re._isLeaving&&re[p2](!0),je(re,()=>{Ze(),nt&&nt()})};Ye?Ye(re,Ze,ot):ot()}else r(re,L,z)},O=(k,L,z,ge=!1,ye=!1)=>{const{type:re,props:Me,ref:Fe,children:De,dynamicChildren:Re,shapeFlag:Je,patchFlag:je,dirs:Ye,cacheIndex:nt}=k;if(je===-2&&(ye=!1),Fe!=null&&(Ts(),dc(Fe,null,z,k,!0),ws()),nt!=null&&(L.renderCache[nt]=void 0),Je&256){L.ctx.deactivate(k);return}const Ze=Je&1&&Ye,ot=!fc(k);let pt;if(ot&&(pt=Me&&Me.onVnodeBeforeUnmount)&&Ci(pt,L,k),Je&6)X(k.component,z,ge);else{if(Je&128){k.suspense.unmount(z,ge);return}Ze&&ko(k,null,L,"beforeUnmount"),Je&64?k.type.remove(k,L,z,H,ge):Re&&!Re.hasOnce&&(re!==wt||je>0&&je&64)?ce(Re,L,z,!1,!0):(re===wt&&je&384||!ye&&Je&16)&&ce(De,L,z),ge&&Z(k)}(ot&&(pt=Me&&Me.onVnodeUnmounted)||Ze)&&mr(()=>{pt&&Ci(pt,L,k),Ze&&ko(k,null,L,"unmounted")},z)},Z=k=>{const{type:L,el:z,anchor:ge,transition:ye}=k;if(L===wt){q(z,ge);return}if(L===bh){R(k);return}const re=()=>{i(z),ye&&!ye.persisted&&ye.afterLeave&&ye.afterLeave()};if(k.shapeFlag&1&&ye&&!ye.persisted){const{leave:Me,delayLeave:Fe}=ye,De=()=>Me(z,re);Fe?Fe(k.el,re,De):De()}else re()},q=(k,L)=>{let z;for(;k!==L;)z=p(k),i(k),k=z;i(L)},X=(k,L,z)=>{const{bum:ge,scope:ye,job:re,subTree:Me,um:Fe,m:De,a:Re}=k;M_(De),M_(Re),ge&&Ih(ge),ye.stop(),re&&(re.flags|=8,O(Me,k,L,z)),Fe&&mr(Fe,L),mr(()=>{k.isUnmounted=!0},L)},ce=(k,L,z,ge=!1,ye=!1,re=0)=>{for(let Me=re;Me<k.length;Me++)O(k[Me],L,z,ge,ye)},ne=k=>{if(k.shapeFlag&6)return ne(k.component.subTree);if(k.shapeFlag&128)return k.suspense.next();const L=p(k.anchor||k.el),z=L&&L[JT];return z?p(z):L};let ve=!1;const se=(k,L,z)=>{let ge;k==null?L._vnode&&(O(L._vnode,null,null,!0),ge=L._vnode.component):v(L._vnode||null,k,L,null,null,null,z),L._vnode=k,ve||(ve=!0,w_(ge),qT(),ve=!1)},H={p:v,um:O,m:F,r:Z,mt:ie,mc:w,pc:Oe,pbc:C,n:ne,o:n};return{render:se,hydrate:void 0,createApp:L2(se)}}function mp({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Po({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function Z2(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function Cg(n,e,t=!1){const r=n.children,i=e.children;if(rt(r)&&rt(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=Ys(i[s]),a.el=o.el),!t&&a.patchFlag!==-2&&Cg(o,a)),a.type===ef&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=s+(n.type===wt?1:0)),a.type===ho&&!a.el&&(a.el=o.el)}}function ek(n){const e=n.slice(),t=[0];let r,i,s,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(i=t[t.length-1],n[i]<c){e[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<c?s=a+1:o=a;c<n[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function _w(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:_w(e)}function M_(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}function yw(n){if(n.placeholder)return n.placeholder;const e=n.component;return e?yw(e.subTree):null}const Ew=n=>n.__isSuspense;function tk(n,e){e&&e.pendingBranch?rt(n)?e.effects.push(...n):e.effects.push(n):s2(n)}const wt=Symbol.for("v-fgt"),ef=Symbol.for("v-txt"),ho=Symbol.for("v-cmt"),bh=Symbol.for("v-stc"),gc=[];let Gr=null;function ee(n=!1){gc.push(Gr=n?null:[])}function nk(){gc.pop(),Gr=gc[gc.length-1]||null}let Lc=1;function Qh(n,e=!1){Lc+=n,n<0&&Gr&&e&&(Gr.hasOnce=!0)}function Tw(n){return n.dynamicChildren=Lc>0?Gr||Wa:null,nk(),Lc>0&&Gr&&Gr.push(n),n}function te(n,e,t,r,i,s){return Tw(d(n,e,t,r,i,s,!0))}function Sg(n,e,t,r,i){return Tw(fn(n,e,t,r,i,!0))}function Xh(n){return n?n.__v_isVNode===!0:!1}function Xl(n,e){return n.type===e.type&&n.key===e.key}const ww=({key:n})=>n??null,kh=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?pn(n)||cn(n)||ft(n)?{i:Wr,r:n,k:e,f:!!t}:n:null);function d(n,e=null,t=null,r=0,i=null,s=n===wt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&ww(e),ref:e&&kh(e),scopeId:YT,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Wr};return a?(Ig(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=pn(t)?8:16),Lc>0&&!o&&Gr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Gr.push(l),l}const fn=rk;function rk(n,e=null,t=null,r=0,i=null,s=!1){if((!n||n===R2)&&(n=ho),Xh(n)){const a=sl(n,e,!0);return t&&Ig(a,t),Lc>0&&!s&&Gr&&(a.shapeFlag&6?Gr[Gr.indexOf(n)]=a:Gr.push(a)),a.patchFlag=-2,a}if(pk(n)&&(n=n.__vccOpts),e){e=ik(e);let{class:a,style:l}=e;a&&!pn(a)&&(e.class=Tt(a)),qt(l)&&(Yd(l)&&!rt(l)&&(l=hr({},l)),e.style=Nt(l))}const o=pn(n)?1:Ew(n)?128:h2(n)?64:qt(n)?4:ft(n)?2:0;return d(n,e,t,r,i,o,s,!0)}function ik(n){return n?Yd(n)||dw(n)?hr({},n):n:null}function sl(n,e,t=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:a,transition:l}=n,c=e?sk(i||{},e):i,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&ww(c),ref:e&&e.ref?t&&s?rt(s)?s.concat(kh(e)):[s,kh(e)]:kh(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==wt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&sl(n.ssContent),ssFallback:n.ssFallback&&sl(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&Tg(u,l.clone(u)),u}function wr(n=" ",e=0){return fn(ef,null,n,e)}function Cs(n,e){const t=fn(bh,null,n);return t.staticCount=e,t}function Ke(n="",e=!1){return e?(ee(),Sg(ho,null,n)):fn(ho,null,n)}function ki(n){return n==null||typeof n=="boolean"?fn(ho):rt(n)?fn(wt,null,n.slice()):Xh(n)?Ys(n):fn(ef,null,String(n))}function Ys(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:sl(n)}function Ig(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(rt(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),Ig(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!dw(e)?e._ctx=Wr:i===3&&Wr&&(Wr.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else ft(e)?(e={default:e,_ctx:Wr},t=32):(e=String(e),r&64?(t=16,e=[wr(e)]):t=8);n.children=e,n.shapeFlag|=t}function sk(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=Tt([e.class,r.class]));else if(i==="style")e.style=Nt([e.style,r.style]);else if($d(i)){const s=e[i],o=r[i];o&&s!==o&&!(rt(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function Ci(n,e,t,r=null){Hi(n,e,7,[t,r])}const ok=lw();let ak=0;function lk(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||ok,s={uid:ak++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ST(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:pw(r,i),emitsOptions:cw(r,i),emit:null,emitted:null,propsDefaults:Wt,inheritAttrs:r.inheritAttrs,ctx:Wt,data:Wt,props:Wt,attrs:Wt,slots:Wt,refs:Wt,setupState:Wt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=B2.bind(null,s),n.ce&&n.ce(s),s}let ar=null;const Aw=()=>ar||Wr;let Jh,a0;{const n=qd(),e=(t,r)=>{let i;return(i=n[t])||(i=n[t]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};Jh=e("__VUE_INSTANCE_SETTERS__",t=>ar=t),a0=e("__VUE_SSR_SETTERS__",t=>Uc=t)}const au=n=>{const e=ar;return Jh(n),n.scope.on(),()=>{n.scope.off(),Jh(e)}},F_=()=>{ar&&ar.scope.off(),Jh(null)};function Cw(n){return n.vnode.shapeFlag&4}let Uc=!1;function ck(n,e=!1,t=!1){e&&a0(e);const{props:r,children:i}=n.vnode,s=Cw(n);W2(n,r,s,e),Y2(n,i,t||e);const o=s?uk(n,e):void 0;return e&&a0(!1),o}function uk(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,k2);const{setup:r}=t;if(r){Ts();const i=n.setupContext=r.length>1?dk(n):null,s=au(n),o=ou(r,n,0,[n.props,i]),a=_T(o);if(ws(),s(),(a||n.sp)&&!fc(n)&&nw(n),a){if(o.then(F_,F_),e)return o.then(l=>{L_(n,l)}).catch(l=>{Qd(l,n,0)});n.asyncDep=o}else L_(n,o)}else Sw(n)}function L_(n,e,t){ft(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:qt(e)&&(n.setupState=jT(e)),Sw(n)}function Sw(n,e,t){const r=n.type;n.render||(n.render=r.render||Mi);{const i=au(n);Ts();try{P2(n)}finally{ws(),i()}}}const hk={get(n,e){return ir(n,"get",""),n[e]}};function dk(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,hk),slots:n.slots,emit:n.emit,expose:e}}function tf(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(jT(yg(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in pc)return pc[t](n)},has(e,t){return t in e||t in pc}})):n.proxy}function fk(n,e=!0){return ft(n)?n.displayName||n.name:n.name||e&&n.__name}function pk(n){return ft(n)&&"__vccOpts"in n}const it=(n,e)=>e2(n,e,Uc);function Iw(n,e,t){try{Qh(-1);const r=arguments.length;return r===2?qt(e)&&!rt(e)?Xh(e)?fn(n,null,[e]):fn(n,e):fn(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Xh(t)&&(t=[t]),fn(n,e,t))}finally{Qh(1)}}const gk="3.5.26";/**
* @vue/runtime-dom v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let l0;const U_=typeof window<"u"&&window.trustedTypes;if(U_)try{l0=U_.createPolicy("vue",{createHTML:n=>n})}catch{}const xw=l0?n=>l0.createHTML(n):n=>n,mk="http://www.w3.org/2000/svg",vk="http://www.w3.org/1998/Math/MathML",rs=typeof document<"u"?document:null,B_=rs&&rs.createElement("template"),_k={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e==="svg"?rs.createElementNS(mk,n):e==="mathml"?rs.createElementNS(vk,n):t?rs.createElement(n,{is:t}):rs.createElement(n);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>rs.createTextNode(n),createComment:n=>rs.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>rs.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{B_.innerHTML=xw(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=B_.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},yk=Symbol("_vtc");function Ek(n,e,t){const r=n[yk];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const V_=Symbol("_vod"),Tk=Symbol("_vsh"),wk=Symbol(""),Ak=/(?:^|;)\s*display\s*:/;function Ck(n,e,t){const r=n.style,i=pn(t);let s=!1;if(t&&!i){if(e)if(pn(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Ph(r,a,"")}else for(const o in e)t[o]==null&&Ph(r,o,"");for(const o in t)o==="display"&&(s=!0),Ph(r,o,t[o])}else if(i){if(e!==t){const o=r[wk];o&&(t+=";"+o),r.cssText=t,s=Ak.test(t)}}else e&&n.removeAttribute("style");V_ in n&&(n[V_]=s?r.display:"",n[Tk]&&(r.display="none"))}const H_=/\s*!important$/;function Ph(n,e,t){if(rt(t))t.forEach(r=>Ph(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=Sk(n,e);H_.test(t)?n.setProperty(aa(r),t.replace(H_,""),"important"):n[r]=t}}const $_=["Webkit","Moz","ms"],vp={};function Sk(n,e){const t=vp[e];if(t)return t;let r=ti(e);if(r!=="filter"&&r in n)return vp[e]=r;r=Wd(r);for(let i=0;i<$_.length;i++){const s=$_[i]+r;if(s in n)return vp[e]=s}return e}const K_="http://www.w3.org/1999/xlink";function j_(n,e,t,r,i,s=Sb(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(K_,e.slice(6,e.length)):n.setAttributeNS(K_,e,t):t==null||s&&!wT(t)?n.removeAttribute(e):n.setAttribute(e,s?"":Vi(t)?String(t):t)}function W_(n,e,t,r,i){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?xw(t):t);return}const s=n.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=wT(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(i||e)}function Xs(n,e,t,r){n.addEventListener(e,t,r)}function Ik(n,e,t,r){n.removeEventListener(e,t,r)}const G_=Symbol("_vei");function xk(n,e,t,r,i=null){const s=n[G_]||(n[G_]={}),o=s[e];if(r&&o)o.value=r;else{const[a,l]=Rk(e);if(r){const c=s[e]=Pk(r,i);Xs(n,a,c,l)}else o&&(Ik(n,a,o,l),s[e]=void 0)}}const q_=/(?:Once|Passive|Capture)$/;function Rk(n){let e;if(q_.test(n)){e={};let r;for(;r=n.match(q_);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):aa(n.slice(2)),e]}let _p=0;const bk=Promise.resolve(),kk=()=>_p||(bk.then(()=>_p=0),_p=Date.now());function Pk(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Hi(Ok(r,t.value),e,5,[r])};return t.value=n,t.attached=kk(),t}function Ok(n,e){if(rt(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const z_=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Nk=(n,e,t,r,i,s)=>{const o=i==="svg";e==="class"?Ek(n,r,o):e==="style"?Ck(n,t,r):$d(e)?ug(e)||xk(n,e,t,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Dk(n,e,r,o))?(W_(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&j_(n,e,r,o,s,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!pn(r))?W_(n,ti(e),r,s,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),j_(n,e,r,o))};function Dk(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&z_(e)&&ft(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&n.tagName==="IFRAME"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return z_(e)&&pn(t)?!1:e in n}const ol=n=>{const e=n.props["onUpdate:modelValue"]||!1;return rt(e)?t=>Ih(e,t):e};function Mk(n){n.target.composing=!0}function Y_(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ps=Symbol("_assign");function Q_(n,e,t){return e&&(n=n.trim()),t&&(n=Gd(n)),n}const Ge={created(n,{modifiers:{lazy:e,trim:t,number:r}},i){n[ps]=ol(i);const s=r||i.props&&i.props.type==="number";Xs(n,e?"change":"input",o=>{o.target.composing||n[ps](Q_(n.value,t,s))}),(t||s)&&Xs(n,"change",()=>{n.value=Q_(n.value,t,s)}),e||(Xs(n,"compositionstart",Mk),Xs(n,"compositionend",Y_),Xs(n,"change",Y_))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:i,number:s}},o){if(n[ps]=ol(o),n.composing)return;const a=(s||n.type==="number")&&!/^0\d/.test(n.value)?Gd(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||i&&n.value.trim()===l)||(n.value=l))}},Oh={deep:!0,created(n,e,t){n[ps]=ol(t),Xs(n,"change",()=>{const r=n._modelValue,i=Bc(n),s=n.checked,o=n[ps];if(rt(r)){const a=dg(r,i),l=a!==-1;if(s&&!l)o(r.concat(i));else if(!s&&l){const c=[...r];c.splice(a,1),o(c)}}else if(Al(r)){const a=new Set(r);s?a.add(i):a.delete(i),o(a)}else o(Rw(n,s))})},mounted:X_,beforeUpdate(n,e,t){n[ps]=ol(t),X_(n,e,t)}};function X_(n,{value:e,oldValue:t},r){n._modelValue=e;let i;if(rt(e))i=dg(e,r.props.value)>-1;else if(Al(e))i=e.has(r.props.value);else{if(e===t)return;i=iu(e,Rw(n,!0))}n.checked!==i&&(n.checked=i)}const _t={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const i=Al(e);Xs(n,"change",()=>{const s=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?Gd(Bc(o)):Bc(o));n[ps](n.multiple?i?new Set(s):s:s[0]),n._assigning=!0,Xd(()=>{n._assigning=!1})}),n[ps]=ol(r)},mounted(n,{value:e}){J_(n,e)},beforeUpdate(n,e,t){n[ps]=ol(t)},updated(n,{value:e}){n._assigning||J_(n,e)}};function J_(n,e){const t=n.multiple,r=rt(e);if(!(t&&!r&&!Al(e))){for(let i=0,s=n.options.length;i<s;i++){const o=n.options[i],a=Bc(o);if(t)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=dg(e,a)>-1}else o.selected=e.has(a);else if(iu(Bc(o),e)){n.selectedIndex!==i&&(n.selectedIndex=i);return}}!t&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function Bc(n){return"_value"in n?n._value:n.value}function Rw(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const Fk=["ctrl","shift","alt","meta"],Lk={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>Fk.some(t=>n[`${t}Key`]&&!e.includes(t))},ni=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(i,...s)=>{for(let o=0;o<e.length;o++){const a=Lk[e[o]];if(a&&a(i,e))return}return n(i,...s)})},Uk=hr({patchProp:Nk},_k);let Z_;function Bk(){return Z_||(Z_=X2(Uk))}const Vk=(...n)=>{const e=Bk().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=$k(r);if(!i)return;const s=e._component;!ft(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,Hk(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Hk(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function $k(n){return pn(n)?document.querySelector(n):n}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let bw;const nf=n=>bw=n,kw=Symbol();function c0(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var mc;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(mc||(mc={}));function Kk(){const n=IT(!0),e=n.run(()=>Se({}));let t=[],r=[];const i=yg({install(s){nf(i),i._a=s,s.provide(kw,i),s.config.globalProperties.$pinia=i,r.forEach(o=>t.push(o)),r=[]},use(s){return this._a?t.push(s):r.push(s),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return i}const Pw=()=>{};function ey(n,e,t,r=Pw){n.push(e);const i=()=>{const s=n.indexOf(e);s>-1&&(n.splice(s,1),r())};return!t&&xT()&&xb(i),i}function Sa(n,...e){n.slice().forEach(t=>{t(...e)})}const jk=n=>n(),ty=Symbol(),yp=Symbol();function u0(n,e){n instanceof Map&&e instanceof Map?e.forEach((t,r)=>n.set(r,t)):n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],i=n[t];c0(i)&&c0(r)&&n.hasOwnProperty(t)&&!cn(r)&&!fs(r)?n[t]=u0(i,r):n[t]=r}return n}const Wk=Symbol();function Gk(n){return!c0(n)||!n.hasOwnProperty(Wk)}const{assign:Ws}=Object;function qk(n){return!!(cn(n)&&n.effect)}function zk(n,e,t,r){const{state:i,actions:s,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=i?i():{});const u=Qb(t.state.value[n]);return Ws(u,s,Object.keys(o||{}).reduce((f,p)=>(f[p]=yg(it(()=>{nf(t);const g=t._s.get(n);return o[p].call(g,g)})),f),{}))}return l=Ow(n,c,e,t,r,!0),l}function Ow(n,e,t={},r,i,s){let o;const a=Ws({actions:{}},t),l={deep:!0};let c,u,f=[],p=[],g;const m=r.state.value[n];!s&&!m&&(r.state.value[n]={}),Se({});let v;function _(w){let E;c=u=!1,typeof w=="function"?(w(r.state.value[n]),E={type:mc.patchFunction,storeId:n,events:g}):(u0(r.state.value[n],w),E={type:mc.patchObject,payload:w,storeId:n,events:g});const C=v=Symbol();Xd().then(()=>{v===C&&(c=!0)}),u=!0,Sa(f,E,r.state.value[n])}const D=s?function(){const{state:E}=t,C=E?E():{};this.$patch(I=>{Ws(I,C)})}:Pw;function b(){o.stop(),f=[],p=[],r._s.delete(n)}const T=(w,E="")=>{if(ty in w)return w[yp]=E,w;const C=function(){nf(r);const I=Array.from(arguments),x=[],P=[];function ie(Ae){x.push(Ae)}function Q(Ae){P.push(Ae)}Sa(p,{args:I,name:C[yp],store:B,after:ie,onError:Q});let ae;try{ae=w.apply(this&&this.$id===n?this:B,I)}catch(Ae){throw Sa(P,Ae),Ae}return ae instanceof Promise?ae.then(Ae=>(Sa(x,Ae),Ae)).catch(Ae=>(Sa(P,Ae),Promise.reject(Ae))):(Sa(x,ae),ae)};return C[ty]=!0,C[yp]=E,C},R={_p:r,$id:n,$onAction:ey.bind(null,p),$patch:_,$reset:D,$subscribe(w,E={}){const C=ey(f,w,E.detached,()=>I()),I=o.run(()=>Ho(()=>r.state.value[n],x=>{(E.flush==="sync"?u:c)&&w({storeId:n,type:mc.direct,events:g},x)},Ws({},l,E)));return C},$dispose:b},B=su(R);r._s.set(n,B);const A=(r._a&&r._a.runWithContext||jk)(()=>r._e.run(()=>(o=IT()).run(()=>e({action:T}))));for(const w in A){const E=A[w];if(cn(E)&&!qk(E)||fs(E))s||(m&&Gk(E)&&(cn(E)?E.value=m[w]:u0(E,m[w])),r.state.value[n][w]=E);else if(typeof E=="function"){const C=T(E,w);A[w]=C,a.actions[w]=E}}return Ws(B,A),Ws(It(B),A),Object.defineProperty(B,"$state",{get:()=>r.state.value[n],set:w=>{_(E=>{Ws(E,w)})}}),r._p.forEach(w=>{Ws(B,o.run(()=>w({store:B,app:r._a,pinia:r,options:a})))}),m&&s&&t.hydrate&&t.hydrate(B.$state,m),c=!0,u=!0,B}/*! #__NO_SIDE_EFFECTS__ */function la(n,e,t){let r,i;const s=typeof e=="function";typeof n=="string"?(r=n,i=s?t:e):(i=n,r=n.id);function o(a,l){const c=a2();return a=a||(c?di(kw,null):null),a&&nf(a),a=bw,a._s.has(r)||(s?Ow(r,e,i,a):zk(r,i,a)),a._s.get(r)}return o.$id=r,o}const Yk="modulepreload",Qk=function(n){return"/"+n},ny={},ry=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(l=>{if(l=Qk(l),l in ny)return;ny[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":Yk,c||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),c)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var iy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Xk=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Dw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,u=s>>2,f=(s&3)<<4|a>>4;let p=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(p=64)),r.push(t[u],t[f],t[p],t[g])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Nw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Xk(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||c==null||f==null)throw new Jk;const p=s<<2|a>>4;if(r.push(p),c!==64){const g=a<<4&240|c>>2;if(r.push(g),f!==64){const m=c<<6&192|f;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Jk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zk=function(n){const e=Nw(n);return Dw.encodeByteArray(e,!0)},Zh=function(n){return Zk(n).replace(/\./g,"")},Mw=function(n){try{return Dw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=()=>eP().__FIREBASE_DEFAULTS__,nP=()=>{if(typeof process>"u"||typeof iy>"u")return;const n=iy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},rP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Mw(n[1]);return e&&JSON.parse(e)},rf=()=>{try{return tP()||nP()||rP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Fw=n=>{var e,t;return(t=(e=rf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},iP=n=>{const e=Fw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Lw=()=>{var n;return(n=rf())===null||n===void 0?void 0:n.config},Uw=n=>{var e;return(e=rf())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Zh(JSON.stringify(t)),Zh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dr())}function lP(){var n;const e=(n=rf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function hP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dP(){const n=dr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function fP(){return!lP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pP(){try{return typeof indexedDB=="object"}catch{return!1}}function gP(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP="FirebaseError";class Ns extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=mP,Object.setPrototypeOf(this,Ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lu.prototype.create)}}class lu{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?vP(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ns(i,a,r)}}function vP(n,e){return n.replace(_P,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const _P=/\{\$([^}]+)}/g;function yP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ed(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(sy(s)&&sy(o)){if(!ed(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function sy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function EP(n,e){const t=new TP(n,e);return t.subscribe.bind(t)}class TP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");wP(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ep),i.error===void 0&&(i.error=Ep),i.complete===void 0&&(i.complete=Ep);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wP(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ep(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(n){return n&&n._delegate?n._delegate:n}class Go{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new sP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SP(e))try{this.getOrInitializeService({instanceIdentifier:No})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=No){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=No){return this.instances.has(e)}getOptions(e=No){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:CP(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=No){return this.component?this.component.multipleInstances?e:No:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CP(n){return n===No?void 0:n}function SP(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new AP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Et||(Et={}));const xP={debug:Et.DEBUG,verbose:Et.VERBOSE,info:Et.INFO,warn:Et.WARN,error:Et.ERROR,silent:Et.SILENT},RP=Et.INFO,bP={[Et.DEBUG]:"log",[Et.VERBOSE]:"log",[Et.INFO]:"info",[Et.WARN]:"warn",[Et.ERROR]:"error"},kP=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=bP[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let xg=class{constructor(e){this.name=e,this._logLevel=RP,this._logHandler=kP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Et.DEBUG,...e),this._logHandler(this,Et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Et.VERBOSE,...e),this._logHandler(this,Et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Et.INFO,...e),this._logHandler(this,Et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Et.WARN,...e),this._logHandler(this,Et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Et.ERROR,...e),this._logHandler(this,Et.ERROR,...e)}};const PP=(n,e)=>e.some(t=>n instanceof t);let oy,ay;function OP(){return oy||(oy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function NP(){return ay||(ay=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bw=new WeakMap,h0=new WeakMap,Vw=new WeakMap,Tp=new WeakMap,Rg=new WeakMap;function DP(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(so(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Bw.set(t,n)}).catch(()=>{}),Rg.set(e,n),e}function MP(n){if(h0.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});h0.set(n,e)}let d0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return h0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Vw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return so(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function FP(n){d0=n(d0)}function LP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(wp(this),e,...t);return Vw.set(r,e.sort?e.sort():[e]),so(r)}:NP().includes(n)?function(...e){return n.apply(wp(this),e),so(Bw.get(this))}:function(...e){return so(n.apply(wp(this),e))}}function UP(n){return typeof n=="function"?LP(n):(n instanceof IDBTransaction&&MP(n),PP(n,OP())?new Proxy(n,d0):n)}function so(n){if(n instanceof IDBRequest)return DP(n);if(Tp.has(n))return Tp.get(n);const e=UP(n);return e!==n&&(Tp.set(n,e),Rg.set(e,n)),e}const wp=n=>Rg.get(n);function BP(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=so(o);return r&&o.addEventListener("upgradeneeded",l=>{r(so(o.result),l.oldVersion,l.newVersion,so(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const VP=["get","getKey","getAll","getAllKeys","count"],HP=["put","add","delete","clear"],Ap=new Map;function ly(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ap.get(e))return Ap.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=HP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||VP.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),i&&l.done]))[0]};return Ap.set(e,s),s}FP(n=>({...n,get:(e,t,r)=>ly(e,t)||n.get(e,t,r),has:(e,t)=>!!ly(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(KP(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function KP(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const f0="@firebase/app",cy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=new xg("@firebase/app"),jP="@firebase/app-compat",WP="@firebase/analytics-compat",GP="@firebase/analytics",qP="@firebase/app-check-compat",zP="@firebase/app-check",YP="@firebase/auth",QP="@firebase/auth-compat",XP="@firebase/database",JP="@firebase/data-connect",ZP="@firebase/database-compat",eO="@firebase/functions",tO="@firebase/functions-compat",nO="@firebase/installations",rO="@firebase/installations-compat",iO="@firebase/messaging",sO="@firebase/messaging-compat",oO="@firebase/performance",aO="@firebase/performance-compat",lO="@firebase/remote-config",cO="@firebase/remote-config-compat",uO="@firebase/storage",hO="@firebase/storage-compat",dO="@firebase/firestore",fO="@firebase/vertexai-preview",pO="@firebase/firestore-compat",gO="firebase",mO="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="[DEFAULT]",vO={[f0]:"fire-core",[jP]:"fire-core-compat",[GP]:"fire-analytics",[WP]:"fire-analytics-compat",[zP]:"fire-app-check",[qP]:"fire-app-check-compat",[YP]:"fire-auth",[QP]:"fire-auth-compat",[XP]:"fire-rtdb",[JP]:"fire-data-connect",[ZP]:"fire-rtdb-compat",[eO]:"fire-fn",[tO]:"fire-fn-compat",[nO]:"fire-iid",[rO]:"fire-iid-compat",[iO]:"fire-fcm",[sO]:"fire-fcm-compat",[oO]:"fire-perf",[aO]:"fire-perf-compat",[lO]:"fire-rc",[cO]:"fire-rc-compat",[uO]:"fire-gcs",[hO]:"fire-gcs-compat",[dO]:"fire-fst",[pO]:"fire-fst-compat",[fO]:"fire-vertex","fire-js":"fire-js",[gO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=new Map,_O=new Map,g0=new Map;function uy(n,e){try{n.container.addComponent(e)}catch(t){Ss.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function al(n){const e=n.name;if(g0.has(e))return Ss.debug(`There were multiple attempts to register component ${e}.`),!1;g0.set(e,n);for(const t of td.values())uy(t,n);for(const t of _O.values())uy(t,n);return!0}function bg(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ni(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oo=new lu("app","Firebase",yO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Go("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=mO;function Hw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:p0,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw oo.create("bad-app-name",{appName:String(i)});if(t||(t=Lw()),!t)throw oo.create("no-options");const s=td.get(i);if(s){if(ed(t,s.options)&&ed(r,s.config))return s;throw oo.create("duplicate-app",{appName:i})}const o=new IP(i);for(const l of g0.values())o.addComponent(l);const a=new EO(t,r,o);return td.set(i,a),a}function $w(n=p0){const e=td.get(n);if(!e&&n===p0&&Lw())return Hw();if(!e)throw oo.create("no-app",{appName:n});return e}function ao(n,e,t){var r;let i=(r=vO[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ss.warn(a.join(" "));return}al(new Go(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO="firebase-heartbeat-database",wO=1,Vc="firebase-heartbeat-store";let Cp=null;function Kw(){return Cp||(Cp=BP(TO,wO,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Vc)}catch(t){console.warn(t)}}}}).catch(n=>{throw oo.create("idb-open",{originalErrorMessage:n.message})})),Cp}async function AO(n){try{const t=(await Kw()).transaction(Vc),r=await t.objectStore(Vc).get(jw(n));return await t.done,r}catch(e){if(e instanceof Ns)Ss.warn(e.message);else{const t=oo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ss.warn(t.message)}}}async function hy(n,e){try{const r=(await Kw()).transaction(Vc,"readwrite");await r.objectStore(Vc).put(e,jw(n)),await r.done}catch(t){if(t instanceof Ns)Ss.warn(t.message);else{const r=oo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ss.warn(r.message)}}}function jw(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO=1024,SO=30*24*60*60*1e3;class IO{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new RO(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=dy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=SO}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ss.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=dy(),{heartbeatsToSend:r,unsentEntries:i}=xO(this._heartbeatsCache.heartbeats),s=Zh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ss.warn(t),""}}}function dy(){return new Date().toISOString().substring(0,10)}function xO(n,e=CO){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),fy(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),fy(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class RO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pP()?gP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await AO(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return hy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return hy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function fy(n){return Zh(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(n){al(new Go("platform-logger",e=>new $P(e),"PRIVATE")),al(new Go("heartbeat",e=>new IO(e),"PRIVATE")),ao(f0,cy,n),ao(f0,cy,"esm2017"),ao("fire-js","")}bO("");function kg(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Ww(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kO=Ww,Gw=new lu("auth","Firebase",Ww());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd=new xg("@firebase/auth");function PO(n,...e){nd.logLevel<=Et.WARN&&nd.warn(`Auth (${Cl}): ${n}`,...e)}function Nh(n,...e){nd.logLevel<=Et.ERROR&&nd.error(`Auth (${Cl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(n,...e){throw Og(n,...e)}function fi(n,...e){return Og(n,...e)}function Pg(n,e,t){const r=Object.assign(Object.assign({},kO()),{[e]:t});return new lu("auth","Firebase",r).create(e,{appName:n.name})}function lo(n){return Pg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function OO(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&$i(n,"argument-error"),Pg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Og(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Gw.create(n,...e)}function lt(n,e,...t){if(!n)throw Og(e,...t)}function ls(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Nh(e),new Error(e)}function Is(n,e){n||ls(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function NO(){return py()==="http:"||py()==="https:"}function py(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(NO()||uP()||"connection"in navigator)?navigator.onLine:!0}function MO(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Is(t>e,"Short delay should be less than long delay!"),this.isMobile=aP()||hP()}get(){return DO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(n,e){Is(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ls("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ls("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ls("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=new uu(3e4,6e4);function sf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Sl(n,e,t,r,i={}){return zw(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=cu(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},s);return cP()||(c.referrerPolicy="no-referrer"),qw.fetch()(Qw(n,n.config.apiHost,t,a),c)})}async function zw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},FO),e);try{const i=new UO(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw rh(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw rh(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw rh(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw rh(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Pg(n,u,c);$i(n,u)}}catch(i){if(i instanceof Ns)throw i;$i(n,"network-request-failed",{message:String(i)})}}async function Yw(n,e,t,r,i={}){const s=await Sl(n,e,t,r,i);return"mfaPendingCredential"in s&&$i(n,"multi-factor-auth-required",{_serverResponse:s}),s}function Qw(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Ng(n.config,i):`${n.config.apiScheme}://${i}`}class UO{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(fi(this.auth,"network-request-failed")),LO.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rh(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=fi(n,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BO(n,e){return Sl(n,"POST","/v1/accounts:delete",e)}async function Xw(n,e){return Sl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function VO(n,e=!1){const t=Ln(n),r=await t.getIdToken(e),i=Dg(r);lt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:vc(Sp(i.auth_time)),issuedAtTime:vc(Sp(i.iat)),expirationTime:vc(Sp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Sp(n){return Number(n)*1e3}function Dg(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Nh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Mw(t);return i?JSON.parse(i):(Nh("Failed to decode base64 JWT payload"),null)}catch(i){return Nh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function gy(n){const e=Dg(n);return lt(e,"internal-error"),lt(typeof e.exp<"u","internal-error"),lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ns&&HO(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function HO({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vc(this.lastLoginAt),this.creationTime=vc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rd(n){var e;const t=n.auth,r=await n.getIdToken(),i=await Hc(n,Xw(t,{idToken:r}));lt(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Jw(s.providerUserInfo):[],a=jO(n.providerData,o),l=n.isAnonymous,c=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new v0(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,f)}async function KO(n){const e=Ln(n);await rd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jO(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Jw(n){return n.map(e=>{var{providerId:t}=e,r=kg(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WO(n,e){const t=await zw(n,{},async()=>{const r=cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=Qw(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",qw.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function GO(n,e){return Sl(n,"POST","/v2/accounts:revokeToken",sf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){lt(e.idToken,"internal-error"),lt(typeof e.idToken<"u","internal-error"),lt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){lt(e.length!==0,"internal-error");const t=gy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await WO(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new za;return r&&(lt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(lt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(lt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new za,this.toJSON())}_performRefresh(){return ls("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(n,e){lt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class cs{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=kg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $O(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new v0(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Hc(this,this.stsTokenManager.getToken(this.auth,e));return lt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return VO(this,e)}reload(){return KO(this)}_assign(e){this!==e&&(lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new cs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await rd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ni(this.auth.app))return Promise.reject(lo(this.auth));const e=await this.getIdToken();return await Hc(this,BO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,l,c,u;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,g=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=t.photoURL)!==null&&o!==void 0?o:void 0,v=(a=t.tenantId)!==null&&a!==void 0?a:void 0,_=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,D=(c=t.createdAt)!==null&&c!==void 0?c:void 0,b=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:T,emailVerified:R,isAnonymous:B,providerData:W,stsTokenManager:A}=t;lt(T&&A,e,"internal-error");const w=za.fromJSON(this.name,A);lt(typeof T=="string",e,"internal-error"),$s(f,e.name),$s(p,e.name),lt(typeof R=="boolean",e,"internal-error"),lt(typeof B=="boolean",e,"internal-error"),$s(g,e.name),$s(m,e.name),$s(v,e.name),$s(_,e.name),$s(D,e.name),$s(b,e.name);const E=new cs({uid:T,auth:e,email:p,emailVerified:R,displayName:f,isAnonymous:B,photoURL:m,phoneNumber:g,tenantId:v,stsTokenManager:w,createdAt:D,lastLoginAt:b});return W&&Array.isArray(W)&&(E.providerData=W.map(C=>Object.assign({},C))),_&&(E._redirectEventId=_),E}static async _fromIdTokenResponse(e,t,r=!1){const i=new za;i.updateFromServerResponse(t);const s=new cs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await rd(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];lt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Jw(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new za;a.updateFromIdToken(r);const l=new cs({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new v0(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my=new Map;function us(n){Is(n instanceof Function,"Expected a class definition");let e=my.get(n);return e?(Is(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,my.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Zw.type="NONE";const vy=Zw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(n,e,t){return`firebase:${n}:${e}:${t}`}class Ya{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Dh(this.userKey,i.apiKey,s),this.fullPersistenceKey=Dh("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?cs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ya(us(vy),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||us(vy);const o=Dh(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){const f=cs._fromJSON(e,u);c!==s&&(a=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ya(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Ya(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sA(e))return"Blackberry";if(oA(e))return"Webos";if(tA(e))return"Safari";if((e.includes("chrome/")||nA(e))&&!e.includes("edge/"))return"Chrome";if(iA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function eA(n=dr()){return/firefox\//i.test(n)}function tA(n=dr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nA(n=dr()){return/crios\//i.test(n)}function rA(n=dr()){return/iemobile/i.test(n)}function iA(n=dr()){return/android/i.test(n)}function sA(n=dr()){return/blackberry/i.test(n)}function oA(n=dr()){return/webos/i.test(n)}function Mg(n=dr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function qO(n=dr()){var e;return Mg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function zO(){return dP()&&document.documentMode===10}function aA(n=dr()){return Mg(n)||iA(n)||oA(n)||sA(n)||/windows phone/i.test(n)||rA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(n,e=[]){let t;switch(n){case"Browser":t=_y(dr());break;case"Worker":t=`${_y(dr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Cl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QO(n,e={}){return Sl(n,"GET","/v2/passwordPolicy",sf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=6;class JO{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:XO,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yy(this),this.idTokenSubscription=new yy(this),this.beforeStateQueue=new YO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=us(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Ya.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Xw(this,{idToken:e}),r=await cs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ni(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await rd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ni(this.app))return Promise.reject(lo(this));const t=e?Ln(e):null;return t&&lt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ni(this.app)?Promise.reject(lo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ni(this.app)?Promise.reject(lo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(us(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await QO(this),t=new JO(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new lu("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await GO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&us(e)||this._popupRedirectResolver;lt(t,this,"argument-error"),this.redirectPersistenceManager=await Ya.create(this,[us(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(lt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&PO(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function hu(n){return Ln(n)}class yy{constructor(e){this.auth=e,this.observer=null,this.addObserver=EP(t=>this.observer=t)}get next(){return lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eN(n){Fg=n}function tN(n){return Fg.loadJS(n)}function nN(){return Fg.gapiScript}function rN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(n,e){const t=bg(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(ed(s,e??{}))return i;$i(i,"already-initialized")}return t.initialize({options:e})}function sN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(us);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function oN(n,e,t){const r=hu(n);lt(r._canInitEmulator,r,"emulator-config-failed"),lt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=cA(e),{host:o,port:a}=aN(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),lN()}function cA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function aN(n){const e=cA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Ey(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Ey(o)}}}function Ey(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function lN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ls("not implemented")}_getIdTokenResponse(e){return ls("not implemented")}_linkToIdToken(e,t){return ls("not implemented")}_getReauthenticationResolver(e){return ls("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qa(n,e){return Yw(n,"POST","/v1/accounts:signInWithIdp",sf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN="http://localhost";class qo extends uA{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):$i("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=kg(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new qo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Qa(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Qa(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qa(e,t)}buildRequest(){const e={requestUri:cN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=cu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends Lg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends du{constructor(){super("facebook.com")}static credential(e){return qo._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Js.credential(e.oauthAccessToken)}catch{return null}}}Js.FACEBOOK_SIGN_IN_METHOD="facebook.com";Js.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as extends du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qo._fromParams({providerId:as.PROVIDER_ID,signInMethod:as.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return as.credentialFromTaggedObject(e)}static credentialFromError(e){return as.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return as.credential(t,r)}catch{return null}}}as.GOOGLE_SIGN_IN_METHOD="google.com";as.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs extends du{constructor(){super("github.com")}static credential(e){return qo._fromParams({providerId:Zs.PROVIDER_ID,signInMethod:Zs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zs.credentialFromTaggedObject(e)}static credentialFromError(e){return Zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zs.credential(e.oauthAccessToken)}catch{return null}}}Zs.GITHUB_SIGN_IN_METHOD="github.com";Zs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends du{constructor(){super("twitter.com")}static credential(e,t){return qo._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return eo.credential(t,r)}catch{return null}}}eo.TWITTER_SIGN_IN_METHOD="twitter.com";eo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uN(n,e){return Yw(n,"POST","/v1/accounts:signUp",sf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await cs._fromIdTokenResponse(e,r,i),o=Ty(r);return new fo({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=Ty(r);return new fo({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function Ty(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wy(n){var e;if(Ni(n.app))return Promise.reject(lo(n));const t=hu(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new fo({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await uN(t,{returnSecureToken:!0}),i=await fo._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id extends Ns{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,id.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new id(e,t,r,i)}}function hA(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?id._fromErrorAndOperation(n,s,e,r):s})}async function hN(n,e,t=!1){const r=await Hc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fo._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dN(n,e,t=!1){const{auth:r}=n;if(Ni(r.app))return Promise.reject(lo(r));const i="reauthenticate";try{const s=await Hc(n,hA(r,i,e,n),t);lt(s.idToken,r,"internal-error");const o=Dg(s.idToken);lt(o,r,"internal-error");const{sub:a}=o;return lt(n.uid===a,r,"user-mismatch"),fo._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&$i(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fN(n,e,t=!1){if(Ni(n.app))return Promise.reject(lo(n));const r="signIn",i=await hA(n,r,e),s=await fo._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function pN(n,e,t,r){return Ln(n).onIdTokenChanged(e,t,r)}function gN(n,e,t){return Ln(n).beforeAuthStateChanged(e,t)}function mN(n,e,t,r){return Ln(n).onAuthStateChanged(e,t,r)}function vN(n){return Ln(n).signOut()}const sd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sd,"1"),this.storage.removeItem(sd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N=1e3,yN=10;class fA extends dA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=aA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);zO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,yN):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},_N)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fA.type="LOCAL";const EN=fA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA extends dA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}pA.type="SESSION";const gA=pA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new of(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(t.origin,s)),l=await TN(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}of.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=Ug("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(){return window}function AN(n){Fi().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mA(){return typeof Fi().WorkerGlobalScope<"u"&&typeof Fi().importScripts=="function"}async function CN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function SN(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function IN(){return mA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="firebaseLocalStorageDb",xN=1,od="firebaseLocalStorage",_A="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function af(n,e){return n.transaction([od],e?"readwrite":"readonly").objectStore(od)}function RN(){const n=indexedDB.deleteDatabase(vA);return new fu(n).toPromise()}function _0(){const n=indexedDB.open(vA,xN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(od,{keyPath:_A})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(od)?e(r):(r.close(),await RN(),e(await _0()))})})}async function Ay(n,e,t){const r=af(n,!0).put({[_A]:e,value:t});return new fu(r).toPromise()}async function bN(n,e){const t=af(n,!1).get(e),r=await new fu(t).toPromise();return r===void 0?null:r.value}function Cy(n,e){const t=af(n,!0).delete(e);return new fu(t).toPromise()}const kN=800,PN=3;class yA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>PN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=of._getInstance(IN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await CN(),!this.activeServiceWorker)return;this.sender=new wN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||SN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _0();return await Ay(e,sd,"1"),await Cy(e,sd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ay(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>bN(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Cy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=af(i,!1).getAll();return new fu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yA.type="LOCAL";const ON=yA;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(n,e){return e?us(e):(lt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg extends uA{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qa(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qa(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qa(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function NN(n){return fN(n.auth,new Bg(n),n.bypassAuthState)}function DN(n){const{auth:e,user:t}=n;return lt(t,e,"internal-error"),dN(t,new Bg(n),n.bypassAuthState)}async function MN(n){const{auth:e,user:t}=n;return lt(t,e,"internal-error"),hN(t,new Bg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NN;case"linkViaPopup":case"linkViaRedirect":return MN;case"reauthViaPopup":case"reauthViaRedirect":return DN;default:$i(this.auth,"internal-error")}}resolve(e){Is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=new uu(2e3,1e4);async function LN(n,e,t){if(Ni(n.app))return Promise.reject(fi(n,"operation-not-supported-in-this-environment"));const r=hu(n);OO(n,e,Lg);const i=EA(r,t);return new Mo(r,"signInViaPopup",e,i).executeNotNull()}class Mo extends TA{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Mo.currentPopupAction&&Mo.currentPopupAction.cancel(),Mo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return lt(e,this.auth,"internal-error"),e}async onExecution(){Is(this.filter.length===1,"Popup operations only handle one event");const e=Ug();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(fi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(fi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Mo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,FN.get())};e()}}Mo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="pendingRedirect",Mh=new Map;class BN extends TA{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Mh.get(this.auth._key());if(!e){try{const r=await VN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Mh.set(this.auth._key(),e)}return this.bypassAuthState||Mh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VN(n,e){const t=KN(e),r=$N(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function HN(n,e){Mh.set(n._key(),e)}function $N(n){return us(n._redirectPersistence)}function KN(n){return Dh(UN,n.config.apiKey,n.name)}async function jN(n,e,t=!1){if(Ni(n.app))return Promise.reject(lo(n));const r=hu(n),i=EA(r,e),o=await new BN(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN=10*60*1e3;class GN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qN(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!wA(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(fi(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WN&&this.cachedEventUids.clear(),this.cachedEventUids.has(Sy(e))}saveEventToCache(e){this.cachedEventUids.add(Sy(e)),this.lastProcessedEventTime=Date.now()}}function Sy(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wA({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qN(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zN(n,e={}){return Sl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QN=/^https?/;async function XN(n){if(n.config.emulator)return;const{authorizedDomains:e}=await zN(n);for(const t of e)try{if(JN(t))return}catch{}$i(n,"unauthorized-domain")}function JN(n){const e=m0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!QN.test(t))return!1;if(YN.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=new uu(3e4,6e4);function Iy(){const n=Fi().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function eD(n){return new Promise((e,t)=>{var r,i,s;function o(){Iy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Iy(),t(fi(n,"network-request-failed"))},timeout:ZN.get()})}if(!((i=(r=Fi().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Fi().gapi)===null||s===void 0)&&s.load)o();else{const a=rN("iframefcb");return Fi()[a]=()=>{gapi.load?o():t(fi(n,"network-request-failed"))},tN(`${nN()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Fh=null,e})}let Fh=null;function tD(n){return Fh=Fh||eD(n),Fh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD=new uu(5e3,15e3),rD="__/auth/iframe",iD="emulator/auth/iframe",sD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aD(n){const e=n.config;lt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ng(e,iD):`https://${n.config.authDomain}/${rD}`,r={apiKey:e.apiKey,appName:n.name,v:Cl},i=oD.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${cu(r).slice(1)}`}async function lD(n){const e=await tD(n),t=Fi().gapi;return lt(t,n,"internal-error"),e.open({where:document.body,url:aD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sD,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=fi(n,"network-request-failed"),a=Fi().setTimeout(()=>{s(o)},nD.get());function l(){Fi().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uD=500,hD=600,dD="_blank",fD="http://localhost";class xy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pD(n,e,t,r=uD,i=hD){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},cD),{width:r.toString(),height:i.toString(),top:s,left:o}),c=dr().toLowerCase();t&&(a=nA(c)?dD:t),eA(c)&&(e=e||fD,l.scrollbars="yes");const u=Object.entries(l).reduce((p,[g,m])=>`${p}${g}=${m},`,"");if(qO(c)&&a!=="_self")return gD(e||"",a),new xy(null);const f=window.open(e||"",a,u);lt(f,n,"popup-blocked");try{f.focus()}catch{}return new xy(f)}function gD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD="__/auth/handler",vD="emulator/auth/handler",_D=encodeURIComponent("fac");async function Ry(n,e,t,r,i,s){lt(n.config.authDomain,n,"auth-domain-config-required"),lt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Cl,eventId:i};if(e instanceof Lg){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",yP(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries({}))o[u]=f}if(e instanceof du){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${_D}=${encodeURIComponent(l)}`:"";return`${yD(n)}?${cu(a).slice(1)}${c}`}function yD({config:n}){return n.emulator?Ng(n,vD):`https://${n.authDomain}/${mD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="webStorageSupport";class ED{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gA,this._completeRedirectFn=jN,this._overrideRedirectResult=HN}async _openPopup(e,t,r,i){var s;Is((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Ry(e,t,r,m0(),i);return pD(e,o,Ug())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await Ry(e,t,r,m0(),i);return AN(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Is(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await lD(e),r=new GN(e);return t.register("authEvent",i=>(lt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ip,{type:Ip},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Ip];o!==void 0&&t(!!o),$i(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=XN(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return aA()||tA()||Mg()}}const TD=ED;var by="@firebase/auth",ky="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function CD(n){al(new Go("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;lt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lA(n)},c=new ZO(r,i,s,l);return sN(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),al(new Go("auth-internal",e=>{const t=hu(e.getProvider("auth").getImmediate());return(r=>new wD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ao(by,ky,AD(n)),ao(by,ky,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=5*60,ID=Uw("authIdTokenMaxAge")||SD;let Py=null;const xD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>ID)return;const i=t==null?void 0:t.token;Py!==i&&(Py=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function RD(n=$w()){const e=bg(n,"auth");if(e.isInitialized())return e.getImmediate();const t=iN(n,{popupRedirectResolver:TD,persistence:[ON,EN,gA]}),r=Uw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=xD(s.toString());gN(t,o,()=>o(t.currentUser)),pN(t,a=>o(a))}}const i=Fw("auth");return i&&oN(t,`http://${i}`),t}function bD(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}eN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=fi("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",bD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});CD("Browser");var Oy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ko,AA;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,w){function E(){}E.prototype=w.prototype,A.D=w.prototype,A.prototype=new E,A.prototype.constructor=A,A.C=function(C,I,x){for(var P=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)P[ie-2]=arguments[ie];return w.prototype[I].apply(C,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,w,E){E||(E=0);var C=Array(16);if(typeof w=="string")for(var I=0;16>I;++I)C[I]=w.charCodeAt(E++)|w.charCodeAt(E++)<<8|w.charCodeAt(E++)<<16|w.charCodeAt(E++)<<24;else for(I=0;16>I;++I)C[I]=w[E++]|w[E++]<<8|w[E++]<<16|w[E++]<<24;w=A.g[0],E=A.g[1],I=A.g[2];var x=A.g[3],P=w+(x^E&(I^x))+C[0]+3614090360&4294967295;w=E+(P<<7&4294967295|P>>>25),P=x+(I^w&(E^I))+C[1]+3905402710&4294967295,x=w+(P<<12&4294967295|P>>>20),P=I+(E^x&(w^E))+C[2]+606105819&4294967295,I=x+(P<<17&4294967295|P>>>15),P=E+(w^I&(x^w))+C[3]+3250441966&4294967295,E=I+(P<<22&4294967295|P>>>10),P=w+(x^E&(I^x))+C[4]+4118548399&4294967295,w=E+(P<<7&4294967295|P>>>25),P=x+(I^w&(E^I))+C[5]+1200080426&4294967295,x=w+(P<<12&4294967295|P>>>20),P=I+(E^x&(w^E))+C[6]+2821735955&4294967295,I=x+(P<<17&4294967295|P>>>15),P=E+(w^I&(x^w))+C[7]+4249261313&4294967295,E=I+(P<<22&4294967295|P>>>10),P=w+(x^E&(I^x))+C[8]+1770035416&4294967295,w=E+(P<<7&4294967295|P>>>25),P=x+(I^w&(E^I))+C[9]+2336552879&4294967295,x=w+(P<<12&4294967295|P>>>20),P=I+(E^x&(w^E))+C[10]+4294925233&4294967295,I=x+(P<<17&4294967295|P>>>15),P=E+(w^I&(x^w))+C[11]+2304563134&4294967295,E=I+(P<<22&4294967295|P>>>10),P=w+(x^E&(I^x))+C[12]+1804603682&4294967295,w=E+(P<<7&4294967295|P>>>25),P=x+(I^w&(E^I))+C[13]+4254626195&4294967295,x=w+(P<<12&4294967295|P>>>20),P=I+(E^x&(w^E))+C[14]+2792965006&4294967295,I=x+(P<<17&4294967295|P>>>15),P=E+(w^I&(x^w))+C[15]+1236535329&4294967295,E=I+(P<<22&4294967295|P>>>10),P=w+(I^x&(E^I))+C[1]+4129170786&4294967295,w=E+(P<<5&4294967295|P>>>27),P=x+(E^I&(w^E))+C[6]+3225465664&4294967295,x=w+(P<<9&4294967295|P>>>23),P=I+(w^E&(x^w))+C[11]+643717713&4294967295,I=x+(P<<14&4294967295|P>>>18),P=E+(x^w&(I^x))+C[0]+3921069994&4294967295,E=I+(P<<20&4294967295|P>>>12),P=w+(I^x&(E^I))+C[5]+3593408605&4294967295,w=E+(P<<5&4294967295|P>>>27),P=x+(E^I&(w^E))+C[10]+38016083&4294967295,x=w+(P<<9&4294967295|P>>>23),P=I+(w^E&(x^w))+C[15]+3634488961&4294967295,I=x+(P<<14&4294967295|P>>>18),P=E+(x^w&(I^x))+C[4]+3889429448&4294967295,E=I+(P<<20&4294967295|P>>>12),P=w+(I^x&(E^I))+C[9]+568446438&4294967295,w=E+(P<<5&4294967295|P>>>27),P=x+(E^I&(w^E))+C[14]+3275163606&4294967295,x=w+(P<<9&4294967295|P>>>23),P=I+(w^E&(x^w))+C[3]+4107603335&4294967295,I=x+(P<<14&4294967295|P>>>18),P=E+(x^w&(I^x))+C[8]+1163531501&4294967295,E=I+(P<<20&4294967295|P>>>12),P=w+(I^x&(E^I))+C[13]+2850285829&4294967295,w=E+(P<<5&4294967295|P>>>27),P=x+(E^I&(w^E))+C[2]+4243563512&4294967295,x=w+(P<<9&4294967295|P>>>23),P=I+(w^E&(x^w))+C[7]+1735328473&4294967295,I=x+(P<<14&4294967295|P>>>18),P=E+(x^w&(I^x))+C[12]+2368359562&4294967295,E=I+(P<<20&4294967295|P>>>12),P=w+(E^I^x)+C[5]+4294588738&4294967295,w=E+(P<<4&4294967295|P>>>28),P=x+(w^E^I)+C[8]+2272392833&4294967295,x=w+(P<<11&4294967295|P>>>21),P=I+(x^w^E)+C[11]+1839030562&4294967295,I=x+(P<<16&4294967295|P>>>16),P=E+(I^x^w)+C[14]+4259657740&4294967295,E=I+(P<<23&4294967295|P>>>9),P=w+(E^I^x)+C[1]+2763975236&4294967295,w=E+(P<<4&4294967295|P>>>28),P=x+(w^E^I)+C[4]+1272893353&4294967295,x=w+(P<<11&4294967295|P>>>21),P=I+(x^w^E)+C[7]+4139469664&4294967295,I=x+(P<<16&4294967295|P>>>16),P=E+(I^x^w)+C[10]+3200236656&4294967295,E=I+(P<<23&4294967295|P>>>9),P=w+(E^I^x)+C[13]+681279174&4294967295,w=E+(P<<4&4294967295|P>>>28),P=x+(w^E^I)+C[0]+3936430074&4294967295,x=w+(P<<11&4294967295|P>>>21),P=I+(x^w^E)+C[3]+3572445317&4294967295,I=x+(P<<16&4294967295|P>>>16),P=E+(I^x^w)+C[6]+76029189&4294967295,E=I+(P<<23&4294967295|P>>>9),P=w+(E^I^x)+C[9]+3654602809&4294967295,w=E+(P<<4&4294967295|P>>>28),P=x+(w^E^I)+C[12]+3873151461&4294967295,x=w+(P<<11&4294967295|P>>>21),P=I+(x^w^E)+C[15]+530742520&4294967295,I=x+(P<<16&4294967295|P>>>16),P=E+(I^x^w)+C[2]+3299628645&4294967295,E=I+(P<<23&4294967295|P>>>9),P=w+(I^(E|~x))+C[0]+4096336452&4294967295,w=E+(P<<6&4294967295|P>>>26),P=x+(E^(w|~I))+C[7]+1126891415&4294967295,x=w+(P<<10&4294967295|P>>>22),P=I+(w^(x|~E))+C[14]+2878612391&4294967295,I=x+(P<<15&4294967295|P>>>17),P=E+(x^(I|~w))+C[5]+4237533241&4294967295,E=I+(P<<21&4294967295|P>>>11),P=w+(I^(E|~x))+C[12]+1700485571&4294967295,w=E+(P<<6&4294967295|P>>>26),P=x+(E^(w|~I))+C[3]+2399980690&4294967295,x=w+(P<<10&4294967295|P>>>22),P=I+(w^(x|~E))+C[10]+4293915773&4294967295,I=x+(P<<15&4294967295|P>>>17),P=E+(x^(I|~w))+C[1]+2240044497&4294967295,E=I+(P<<21&4294967295|P>>>11),P=w+(I^(E|~x))+C[8]+1873313359&4294967295,w=E+(P<<6&4294967295|P>>>26),P=x+(E^(w|~I))+C[15]+4264355552&4294967295,x=w+(P<<10&4294967295|P>>>22),P=I+(w^(x|~E))+C[6]+2734768916&4294967295,I=x+(P<<15&4294967295|P>>>17),P=E+(x^(I|~w))+C[13]+1309151649&4294967295,E=I+(P<<21&4294967295|P>>>11),P=w+(I^(E|~x))+C[4]+4149444226&4294967295,w=E+(P<<6&4294967295|P>>>26),P=x+(E^(w|~I))+C[11]+3174756917&4294967295,x=w+(P<<10&4294967295|P>>>22),P=I+(w^(x|~E))+C[2]+718787259&4294967295,I=x+(P<<15&4294967295|P>>>17),P=E+(x^(I|~w))+C[9]+3951481745&4294967295,A.g[0]=A.g[0]+w&4294967295,A.g[1]=A.g[1]+(I+(P<<21&4294967295|P>>>11))&4294967295,A.g[2]=A.g[2]+I&4294967295,A.g[3]=A.g[3]+x&4294967295}r.prototype.u=function(A,w){w===void 0&&(w=A.length);for(var E=w-this.blockSize,C=this.B,I=this.h,x=0;x<w;){if(I==0)for(;x<=E;)i(this,A,x),x+=this.blockSize;if(typeof A=="string"){for(;x<w;)if(C[I++]=A.charCodeAt(x++),I==this.blockSize){i(this,C),I=0;break}}else for(;x<w;)if(C[I++]=A[x++],I==this.blockSize){i(this,C),I=0;break}}this.h=I,this.o+=w},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var w=1;w<A.length-8;++w)A[w]=0;var E=8*this.o;for(w=A.length-8;w<A.length;++w)A[w]=E&255,E/=256;for(this.u(A),A=Array(16),w=E=0;4>w;++w)for(var C=0;32>C;C+=8)A[E++]=this.g[w]>>>C&255;return A};function s(A,w){var E=a;return Object.prototype.hasOwnProperty.call(E,A)?E[A]:E[A]=w(A)}function o(A,w){this.h=w;for(var E=[],C=!0,I=A.length-1;0<=I;I--){var x=A[I]|0;C&&x==w||(E[I]=x,C=!1)}this.g=E}var a={};function l(A){return-128<=A&&128>A?s(A,function(w){return new o([w|0],0>w?-1:0)}):new o([A|0],0>A?-1:0)}function c(A){if(isNaN(A)||!isFinite(A))return f;if(0>A)return _(c(-A));for(var w=[],E=1,C=0;A>=E;C++)w[C]=A/E|0,E*=4294967296;return new o(w,0)}function u(A,w){if(A.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(A.charAt(0)=="-")return _(u(A.substring(1),w));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=c(Math.pow(w,8)),C=f,I=0;I<A.length;I+=8){var x=Math.min(8,A.length-I),P=parseInt(A.substring(I,I+x),w);8>x?(x=c(Math.pow(w,x)),C=C.j(x).add(c(P))):(C=C.j(E),C=C.add(c(P)))}return C}var f=l(0),p=l(1),g=l(16777216);n=o.prototype,n.m=function(){if(v(this))return-_(this).m();for(var A=0,w=1,E=0;E<this.g.length;E++){var C=this.i(E);A+=(0<=C?C:4294967296+C)*w,w*=4294967296}return A},n.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(m(this))return"0";if(v(this))return"-"+_(this).toString(A);for(var w=c(Math.pow(A,6)),E=this,C="";;){var I=R(E,w).g;E=D(E,I.j(w));var x=((0<E.g.length?E.g[0]:E.h)>>>0).toString(A);if(E=I,m(E))return x+C;for(;6>x.length;)x="0"+x;C=x+C}},n.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function m(A){if(A.h!=0)return!1;for(var w=0;w<A.g.length;w++)if(A.g[w]!=0)return!1;return!0}function v(A){return A.h==-1}n.l=function(A){return A=D(this,A),v(A)?-1:m(A)?0:1};function _(A){for(var w=A.g.length,E=[],C=0;C<w;C++)E[C]=~A.g[C];return new o(E,~A.h).add(p)}n.abs=function(){return v(this)?_(this):this},n.add=function(A){for(var w=Math.max(this.g.length,A.g.length),E=[],C=0,I=0;I<=w;I++){var x=C+(this.i(I)&65535)+(A.i(I)&65535),P=(x>>>16)+(this.i(I)>>>16)+(A.i(I)>>>16);C=P>>>16,x&=65535,P&=65535,E[I]=P<<16|x}return new o(E,E[E.length-1]&-2147483648?-1:0)};function D(A,w){return A.add(_(w))}n.j=function(A){if(m(this)||m(A))return f;if(v(this))return v(A)?_(this).j(_(A)):_(_(this).j(A));if(v(A))return _(this.j(_(A)));if(0>this.l(g)&&0>A.l(g))return c(this.m()*A.m());for(var w=this.g.length+A.g.length,E=[],C=0;C<2*w;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var I=0;I<A.g.length;I++){var x=this.i(C)>>>16,P=this.i(C)&65535,ie=A.i(I)>>>16,Q=A.i(I)&65535;E[2*C+2*I]+=P*Q,b(E,2*C+2*I),E[2*C+2*I+1]+=x*Q,b(E,2*C+2*I+1),E[2*C+2*I+1]+=P*ie,b(E,2*C+2*I+1),E[2*C+2*I+2]+=x*ie,b(E,2*C+2*I+2)}for(C=0;C<w;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=w;C<2*w;C++)E[C]=0;return new o(E,0)};function b(A,w){for(;(A[w]&65535)!=A[w];)A[w+1]+=A[w]>>>16,A[w]&=65535,w++}function T(A,w){this.g=A,this.h=w}function R(A,w){if(m(w))throw Error("division by zero");if(m(A))return new T(f,f);if(v(A))return w=R(_(A),w),new T(_(w.g),_(w.h));if(v(w))return w=R(A,_(w)),new T(_(w.g),w.h);if(30<A.g.length){if(v(A)||v(w))throw Error("slowDivide_ only works with positive integers.");for(var E=p,C=w;0>=C.l(A);)E=B(E),C=B(C);var I=W(E,1),x=W(C,1);for(C=W(C,2),E=W(E,2);!m(C);){var P=x.add(C);0>=P.l(A)&&(I=I.add(E),x=P),C=W(C,1),E=W(E,1)}return w=D(A,I.j(w)),new T(I,w)}for(I=f;0<=A.l(w);){for(E=Math.max(1,Math.floor(A.m()/w.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),x=c(E),P=x.j(w);v(P)||0<P.l(A);)E-=C,x=c(E),P=x.j(w);m(x)&&(x=p),I=I.add(x),A=D(A,P)}return new T(I,A)}n.A=function(A){return R(this,A).h},n.and=function(A){for(var w=Math.max(this.g.length,A.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)&A.i(C);return new o(E,this.h&A.h)},n.or=function(A){for(var w=Math.max(this.g.length,A.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)|A.i(C);return new o(E,this.h|A.h)},n.xor=function(A){for(var w=Math.max(this.g.length,A.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)^A.i(C);return new o(E,this.h^A.h)};function B(A){for(var w=A.g.length+1,E=[],C=0;C<w;C++)E[C]=A.i(C)<<1|A.i(C-1)>>>31;return new o(E,A.h)}function W(A,w){var E=w>>5;w%=32;for(var C=A.g.length-E,I=[],x=0;x<C;x++)I[x]=0<w?A.i(x+E)>>>w|A.i(x+E+1)<<32-w:A.i(x+E);return new o(I,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,AA=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Ko=o}).apply(typeof Oy<"u"?Oy:typeof self<"u"?self:typeof window<"u"?window:{});var ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var CA,rc,SA,Lh,y0,IA,xA,RA;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,S){return h==Array.prototype||h==Object.prototype||(h[y]=S.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ih=="object"&&ih];for(var y=0;y<h.length;++y){var S=h[y];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var r=t(this);function i(h,y){if(y)e:{var S=r;h=h.split(".");for(var M=0;M<h.length-1;M++){var oe=h[M];if(!(oe in S))break e;S=S[oe]}h=h[h.length-1],M=S[h],y=y(M),y!=M&&y!=null&&e(S,h,{configurable:!0,writable:!0,value:y})}}function s(h,y){h instanceof String&&(h+="");var S=0,M=!1,oe={next:function(){if(!M&&S<h.length){var _e=S++;return{value:y(_e,h[_e]),done:!1}}return M=!0,{done:!0,value:void 0}}};return oe[Symbol.iterator]=function(){return oe},oe}i("Array.prototype.values",function(h){return h||function(){return s(this,function(y,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function c(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function u(h,y,S){return h.call.apply(h.bind,arguments)}function f(h,y,S){if(!h)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var oe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(oe,M),h.apply(y,oe)}}return function(){return h.apply(y,arguments)}}function p(h,y,S){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,p.apply(null,arguments)}function g(h,y){var S=Array.prototype.slice.call(arguments,1);return function(){var M=S.slice();return M.push.apply(M,arguments),h.apply(this,M)}}function m(h,y){function S(){}S.prototype=y.prototype,h.aa=y.prototype,h.prototype=new S,h.prototype.constructor=h,h.Qb=function(M,oe,_e){for(var $e=Array(arguments.length-2),Kt=2;Kt<arguments.length;Kt++)$e[Kt-2]=arguments[Kt];return y.prototype[oe].apply(M,$e)}}function v(h){const y=h.length;if(0<y){const S=Array(y);for(let M=0;M<y;M++)S[M]=h[M];return S}return[]}function _(h,y){for(let S=1;S<arguments.length;S++){const M=arguments[S];if(l(M)){const oe=h.length||0,_e=M.length||0;h.length=oe+_e;for(let $e=0;$e<_e;$e++)h[oe+$e]=M[$e]}else h.push(M)}}class D{constructor(y,S){this.i=y,this.j=S,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function b(h){return/^[\s\xa0]*$/.test(h)}function T(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function R(h){return R[" "](h),h}R[" "]=function(){};var B=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function W(h,y,S){for(const M in h)y.call(S,h[M],M,h)}function A(h,y){for(const S in h)y.call(void 0,h[S],S,h)}function w(h){const y={};for(const S in h)y[S]=h[S];return y}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(h,y){let S,M;for(let oe=1;oe<arguments.length;oe++){M=arguments[oe];for(S in M)h[S]=M[S];for(let _e=0;_e<E.length;_e++)S=E[_e],Object.prototype.hasOwnProperty.call(M,S)&&(h[S]=M[S])}}function I(h){var y=1;h=h.split(":");const S=[];for(;0<y&&h.length;)S.push(h.shift()),y--;return h.length&&S.push(h.join(":")),S}function x(h){a.setTimeout(()=>{throw h},0)}function P(){var h=Ce;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class ie{constructor(){this.h=this.g=null}add(y,S){const M=Q.get();M.set(y,S),this.h?this.h.next=M:this.g=M,this.h=M}}var Q=new D(()=>new ae,h=>h.reset());class ae{constructor(){this.next=this.g=this.h=null}set(y,S){this.h=y,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,Oe=!1,Ce=new ie,fe=()=>{const h=a.Promise.resolve(void 0);Ae=()=>{h.then(F)}};var F=()=>{for(var h;h=P();){try{h.h.call(h.g)}catch(S){x(S)}var y=Q;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}Oe=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Z(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}Z.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const S=()=>{};a.addEventListener("test",S,y),a.removeEventListener("test",S,y)}catch{}return h}();function X(h,y){if(Z.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var S=this.type=h.type,M=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(B){e:{try{R(y.nodeName);var oe=!0;break e}catch{}oe=!1}oe||(y=null)}}else S=="mouseover"?y=h.fromElement:S=="mouseout"&&(y=h.toElement);this.relatedTarget=y,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ce[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&X.aa.h.call(this)}}m(X,Z);var ce={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),ve=0;function se(h,y,S,M,oe){this.listener=h,this.proxy=null,this.src=y,this.type=S,this.capture=!!M,this.ha=oe,this.key=++ve,this.da=this.fa=!1}function H(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function J(h){this.src=h,this.g={},this.h=0}J.prototype.add=function(h,y,S,M,oe){var _e=h.toString();h=this.g[_e],h||(h=this.g[_e]=[],this.h++);var $e=L(h,y,M,oe);return-1<$e?(y=h[$e],S||(y.fa=!1)):(y=new se(y,this.src,_e,!!M,oe),y.fa=S,h.push(y)),y};function k(h,y){var S=y.type;if(S in h.g){var M=h.g[S],oe=Array.prototype.indexOf.call(M,y,void 0),_e;(_e=0<=oe)&&Array.prototype.splice.call(M,oe,1),_e&&(H(y),h.g[S].length==0&&(delete h.g[S],h.h--))}}function L(h,y,S,M){for(var oe=0;oe<h.length;++oe){var _e=h[oe];if(!_e.da&&_e.listener==y&&_e.capture==!!S&&_e.ha==M)return oe}return-1}var z="closure_lm_"+(1e6*Math.random()|0),ge={};function ye(h,y,S,M,oe){if(Array.isArray(y)){for(var _e=0;_e<y.length;_e++)ye(h,y[_e],S,M,oe);return null}return S=nt(S),h&&h[ne]?h.K(y,S,c(M)?!!M.capture:!1,oe):re(h,y,S,!1,M,oe)}function re(h,y,S,M,oe,_e){if(!y)throw Error("Invalid event type");var $e=c(oe)?!!oe.capture:!!oe,Kt=je(h);if(Kt||(h[z]=Kt=new J(h)),S=Kt.add(y,S,M,$e,_e),S.proxy)return S;if(M=Me(),S.proxy=M,M.src=h,M.listener=S,h.addEventListener)q||(oe=$e),oe===void 0&&(oe=!1),h.addEventListener(y.toString(),M,oe);else if(h.attachEvent)h.attachEvent(Re(y.toString()),M);else if(h.addListener&&h.removeListener)h.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Me(){function h(S){return y.call(h.src,h.listener,S)}const y=Je;return h}function Fe(h,y,S,M,oe){if(Array.isArray(y))for(var _e=0;_e<y.length;_e++)Fe(h,y[_e],S,M,oe);else M=c(M)?!!M.capture:!!M,S=nt(S),h&&h[ne]?(h=h.i,y=String(y).toString(),y in h.g&&(_e=h.g[y],S=L(_e,S,M,oe),-1<S&&(H(_e[S]),Array.prototype.splice.call(_e,S,1),_e.length==0&&(delete h.g[y],h.h--)))):h&&(h=je(h))&&(y=h.g[y.toString()],h=-1,y&&(h=L(y,S,M,oe)),(S=-1<h?y[h]:null)&&De(S))}function De(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[ne])k(y.i,h);else{var S=h.type,M=h.proxy;y.removeEventListener?y.removeEventListener(S,M,h.capture):y.detachEvent?y.detachEvent(Re(S),M):y.addListener&&y.removeListener&&y.removeListener(M),(S=je(y))?(k(S,h),S.h==0&&(S.src=null,y[z]=null)):H(h)}}}function Re(h){return h in ge?ge[h]:ge[h]="on"+h}function Je(h,y){if(h.da)h=!0;else{y=new X(y,this);var S=h.listener,M=h.ha||h.src;h.fa&&De(h),h=S.call(M,y)}return h}function je(h){return h=h[z],h instanceof J?h:null}var Ye="__closure_events_fn_"+(1e9*Math.random()>>>0);function nt(h){return typeof h=="function"?h:(h[Ye]||(h[Ye]=function(y){return h.handleEvent(y)}),h[Ye])}function Ze(){O.call(this),this.i=new J(this),this.M=this,this.F=null}m(Ze,O),Ze.prototype[ne]=!0,Ze.prototype.removeEventListener=function(h,y,S,M){Fe(this,h,y,S,M)};function ot(h,y){var S,M=h.F;if(M)for(S=[];M;M=M.F)S.push(M);if(h=h.M,M=y.type||y,typeof y=="string")y=new Z(y,h);else if(y instanceof Z)y.target=y.target||h;else{var oe=y;y=new Z(M,h),C(y,oe)}if(oe=!0,S)for(var _e=S.length-1;0<=_e;_e--){var $e=y.g=S[_e];oe=pt($e,M,!0,y)&&oe}if($e=y.g=h,oe=pt($e,M,!0,y)&&oe,oe=pt($e,M,!1,y)&&oe,S)for(_e=0;_e<S.length;_e++)$e=y.g=S[_e],oe=pt($e,M,!1,y)&&oe}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var S=h.g[y],M=0;M<S.length;M++)H(S[M]);delete h.g[y],h.h--}}this.F=null},Ze.prototype.K=function(h,y,S,M){return this.i.add(String(h),y,!1,S,M)},Ze.prototype.L=function(h,y,S,M){return this.i.add(String(h),y,!0,S,M)};function pt(h,y,S,M){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var oe=!0,_e=0;_e<y.length;++_e){var $e=y[_e];if($e&&!$e.da&&$e.capture==S){var Kt=$e.listener,Vn=$e.ha||$e.src;$e.fa&&k(h.i,$e),oe=Kt.call(Vn,M)!==!1&&oe}}return oe&&!M.defaultPrevented}function Cn(h,y,S){if(typeof h=="function")S&&(h=p(h,S));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:a.setTimeout(h,y||0)}function mn(h){h.g=Cn(()=>{h.g=null,h.i&&(h.i=!1,mn(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class pr extends O{constructor(y,S){super(),this.m=y,this.l=S,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:mn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sn(h){O.call(this),this.h=h,this.g={}}m(Sn,O);var ii=[];function Ls(h){W(h.g,function(y,S){this.g.hasOwnProperty(S)&&De(y)},h),h.g={}}Sn.prototype.N=function(){Sn.aa.N.call(this),Ls(this)},Sn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vn=a.JSON.stringify,Sr=a.JSON.parse,_a=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function qi(){}qi.prototype.h=null;function Vl(h){return h.h||(h.h=h.i())}function Hl(){}var Co={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $l(){Z.call(this,"d")}m($l,Z);function Us(){Z.call(this,"c")}m(Us,Z);var zi={},Uu=null;function ya(){return Uu=Uu||new Ze}zi.La="serverreachability";function Bu(h){Z.call(this,zi.La,h)}m(Bu,Z);function So(h){const y=ya();ot(y,new Bu(y))}zi.STAT_EVENT="statevent";function Vu(h,y){Z.call(this,zi.STAT_EVENT,h),this.stat=y}m(Vu,Z);function Bn(h){const y=ya();ot(y,new Vu(y,h))}zi.Ma="timingevent";function Hu(h,y){Z.call(this,zi.Ma,h),this.size=y}m(Hu,Z);function Yi(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},y)}function Io(){this.g=!0}Io.prototype.xa=function(){this.g=!1};function np(h,y,S,M,oe,_e){h.info(function(){if(h.g)if(_e)for(var $e="",Kt=_e.split("&"),Vn=0;Vn<Kt.length;Vn++){var St=Kt[Vn].split("=");if(1<St.length){var Jn=St[0];St=St[1];var Zn=Jn.split("_");$e=2<=Zn.length&&Zn[1]=="type"?$e+(Jn+"="+St+"&"):$e+(Jn+"=redacted&")}}else $e=null;else $e=_e;return"XMLHTTP REQ ("+M+") [attempt "+oe+"]: "+y+`
`+S+`
`+$e})}function rp(h,y,S,M,oe,_e,$e){h.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+oe+"]: "+y+`
`+S+`
`+_e+" "+$e})}function N(h,y,S,M){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+U(h,S)+(M?" "+M:"")})}function K(h,y){h.info(function(){return"TIMEOUT: "+y})}Io.prototype.info=function(){};function U(h,y){if(!h.g)return y;if(!y)return null;try{var S=JSON.parse(y);if(S){for(h=0;h<S.length;h++)if(Array.isArray(S[h])){var M=S[h];if(!(2>M.length)){var oe=M[1];if(Array.isArray(oe)&&!(1>oe.length)){var _e=oe[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(var $e=1;$e<oe.length;$e++)oe[$e]=""}}}}return vn(S)}catch{return y}}var V={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},j={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},G;function ue(){}m(ue,qi),ue.prototype.g=function(){return new XMLHttpRequest},ue.prototype.i=function(){return{}},G=new ue;function Ee(h,y,S,M){this.j=h,this.i=y,this.l=S,this.R=M||1,this.U=new Sn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new he}function he(){this.i=null,this.g="",this.h=!1}var de={},pe={};function Pe(h,y,S){h.L=1,h.v=ju(Xi(y)),h.m=S,h.P=!0,He(h,null)}function He(h,y){h.F=Date.now(),We(h),h.A=Xi(h.v);var S=h.A,M=h.R;Array.isArray(M)||(M=[String(M)]),Qv(S.i,"t",M),h.C=0,S=h.j.J,h.h=new he,h.g=p_(h.j,S?y:null,!h.m),0<h.O&&(h.M=new pr(p(h.Y,h,h.g),h.O)),y=h.U,S=h.g,M=h.ca;var oe="readystatechange";Array.isArray(oe)||(oe&&(ii[0]=oe.toString()),oe=ii);for(var _e=0;_e<oe.length;_e++){var $e=ye(S,oe[_e],M||y.handleEvent,!1,y.h||y);if(!$e)break;y.g[$e.key]=$e}y=h.H?w(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),So(),np(h.i,h.u,h.A,h.l,h.R,h.m)}Ee.prototype.ca=function(h){h=h.target;const y=this.M;y&&Ji(h)==3?y.j():this.Y(h)},Ee.prototype.Y=function(h){try{if(h==this.g)e:{const Zn=Ji(this.g);var y=this.g.Ba();const Aa=this.g.Z();if(!(3>Zn)&&(Zn!=3||this.g&&(this.h.h||this.g.oa()||r_(this.g)))){this.J||Zn!=4||y==7||(y==8||0>=Aa?So(3):So(2)),$t(this);var S=this.g.Z();this.X=S;t:if(qe(this)){var M=r_(this.g);h="";var oe=M.length,_e=Ji(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tn(this),Ot(this);var $e="";break t}this.h.i=new a.TextDecoder}for(y=0;y<oe;y++)this.h.h=!0,h+=this.h.i.decode(M[y],{stream:!(_e&&y==oe-1)});M.length=0,this.h.g+=h,this.C=0,$e=this.h.g}else $e=this.g.oa();if(this.o=S==200,rp(this.i,this.u,this.A,this.l,this.R,Zn,S),this.o){if(this.T&&!this.K){t:{if(this.g){var Kt,Vn=this.g;if((Kt=Vn.g?Vn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Kt)){var St=Kt;break t}}St=null}if(S=St)N(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qi(this,S);else{this.o=!1,this.s=3,Bn(12),tn(this),Ot(this);break e}}if(this.P){S=!0;let si;for(;!this.J&&this.C<$e.length;)if(si=Le(this,$e),si==pe){Zn==4&&(this.s=4,Bn(14),S=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(si==de){this.s=4,Bn(15),N(this.i,this.l,$e,"[Invalid Chunk]"),S=!1;break}else N(this.i,this.l,si,null),Qi(this,si);if(qe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zn!=4||$e.length!=0||this.h.h||(this.s=1,Bn(16),S=!1),this.o=this.o&&S,!S)N(this.i,this.l,$e,"[Invalid Chunked Response]"),tn(this),Ot(this);else if(0<$e.length&&!this.W){this.W=!0;var Jn=this.j;Jn.g==this&&Jn.ba&&!Jn.M&&(Jn.j.info("Great, no buffering proxy detected. Bytes received: "+$e.length),lp(Jn),Jn.M=!0,Bn(11))}}else N(this.i,this.l,$e,null),Qi(this,$e);Zn==4&&tn(this),this.o&&!this.J&&(Zn==4?u_(this.j,this):(this.o=!1,We(this)))}else pb(this.g),S==400&&0<$e.indexOf("Unknown SID")?(this.s=3,Bn(12)):(this.s=0,Bn(13)),tn(this),Ot(this)}}}catch{}finally{}};function qe(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Le(h,y){var S=h.C,M=y.indexOf(`
`,S);return M==-1?pe:(S=Number(y.substring(S,M)),isNaN(S)?de:(M+=1,M+S>y.length?pe:(y=y.slice(M,M+S),h.C=M+S,y)))}Ee.prototype.cancel=function(){this.J=!0,tn(this)};function We(h){h.S=Date.now()+h.I,at(h,h.I)}function at(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Yi(p(h.ba,h),y)}function $t(h){h.B&&(a.clearTimeout(h.B),h.B=null)}Ee.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(K(this.i,this.A),this.L!=2&&(So(),Bn(17)),tn(this),this.s=2,Ot(this)):at(this,this.S-h)};function Ot(h){h.j.G==0||h.J||u_(h.j,h)}function tn(h){$t(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Ls(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Qi(h,y){try{var S=h.j;if(S.G!=0&&(S.g==h||Mr(S.h,h))){if(!h.K&&Mr(S.h,h)&&S.G==3){try{var M=S.Da.g.parse(y)}catch{M=null}if(Array.isArray(M)&&M.length==3){var oe=M;if(oe[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<h.F)Qu(S),zu(S);else break e;ap(S),Bn(18)}}else S.za=oe[1],0<S.za-S.T&&37500>oe[2]&&S.F&&S.v==0&&!S.C&&(S.C=Yi(p(S.Za,S),6e3));if(1>=Ea(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else bo(S,11)}else if((h.K||S.g==h)&&Qu(S),!b(y))for(oe=S.Da.g.parse(y),y=0;y<oe.length;y++){let St=oe[y];if(S.T=St[0],St=St[1],S.G==2)if(St[0]=="c"){S.K=St[1],S.ia=St[2];const Jn=St[3];Jn!=null&&(S.la=Jn,S.j.info("VER="+S.la));const Zn=St[4];Zn!=null&&(S.Aa=Zn,S.j.info("SVER="+S.Aa));const Aa=St[5];Aa!=null&&typeof Aa=="number"&&0<Aa&&(M=1.5*Aa,S.L=M,S.j.info("backChannelRequestTimeoutMs_="+M)),M=S;const si=h.g;if(si){const Ju=si.g?si.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ju){var _e=M.h;_e.g||Ju.indexOf("spdy")==-1&&Ju.indexOf("quic")==-1&&Ju.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(ip(_e,_e.h),_e.h=null))}if(M.D){const cp=si.g?si.g.getResponseHeader("X-HTTP-Session-Id"):null;cp&&(M.ya=cp,Yt(M.I,M.D,cp))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-h.F,S.j.info("Handshake RTT: "+S.R+"ms")),M=S;var $e=h;if(M.qa=f_(M,M.J?M.ia:null,M.W),$e.K){$v(M.h,$e);var Kt=$e,Vn=M.L;Vn&&(Kt.I=Vn),Kt.B&&($t(Kt),We(Kt)),M.g=$e}else l_(M);0<S.i.length&&Yu(S)}else St[0]!="stop"&&St[0]!="close"||bo(S,7);else S.G==3&&(St[0]=="stop"||St[0]=="close"?St[0]=="stop"?bo(S,7):op(S):St[0]!="noop"&&S.l&&S.l.ta(St),S.v=0)}}So(4)}catch{}}var xo=class{constructor(h,y){this.g=h,this.map=y}};function Bs(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ai(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ea(h){return h.h?1:h.g?h.g.size:0}function Mr(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function ip(h,y){h.g?h.g.add(y):h.h=y}function $v(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Bs.prototype.cancel=function(){if(this.i=Kv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Kv(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const S of h.g.values())y=y.concat(S.D);return y}return v(h.i)}function ZR(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var y=[],S=h.length,M=0;M<S;M++)y.push(h[M]);return y}y=[],S=0;for(M in h)y[S++]=h[M];return y}function eb(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var y=[];h=h.length;for(var S=0;S<h;S++)y.push(S);return y}y=[],S=0;for(const M in h)y[S++]=M;return y}}}function jv(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var S=eb(h),M=ZR(h),oe=M.length,_e=0;_e<oe;_e++)y.call(void 0,M[_e],S&&S[_e],h)}var Wv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tb(h,y){if(h){h=h.split("&");for(var S=0;S<h.length;S++){var M=h[S].indexOf("="),oe=null;if(0<=M){var _e=h[S].substring(0,M);oe=h[S].substring(M+1)}else _e=h[S];y(_e,oe?decodeURIComponent(oe.replace(/\+/g," ")):"")}}}function Ro(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Ro){this.h=h.h,$u(this,h.j),this.o=h.o,this.g=h.g,Ku(this,h.s),this.l=h.l;var y=h.i,S=new Wl;S.i=y.i,y.g&&(S.g=new Map(y.g),S.h=y.h),Gv(this,S),this.m=h.m}else h&&(y=String(h).match(Wv))?(this.h=!1,$u(this,y[1]||"",!0),this.o=Kl(y[2]||""),this.g=Kl(y[3]||"",!0),Ku(this,y[4]),this.l=Kl(y[5]||"",!0),Gv(this,y[6]||"",!0),this.m=Kl(y[7]||"")):(this.h=!1,this.i=new Wl(null,this.h))}Ro.prototype.toString=function(){var h=[],y=this.j;y&&h.push(jl(y,qv,!0),":");var S=this.g;return(S||y=="file")&&(h.push("//"),(y=this.o)&&h.push(jl(y,qv,!0),"@"),h.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&h.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&h.push("/"),h.push(jl(S,S.charAt(0)=="/"?ib:rb,!0))),(S=this.i.toString())&&h.push("?",S),(S=this.m)&&h.push("#",jl(S,ob)),h.join("")};function Xi(h){return new Ro(h)}function $u(h,y,S){h.j=S?Kl(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ku(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function Gv(h,y,S){y instanceof Wl?(h.i=y,ab(h.i,h.h)):(S||(y=jl(y,sb)),h.i=new Wl(y,h.h))}function Yt(h,y,S){h.i.set(y,S)}function ju(h){return Yt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Kl(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function jl(h,y,S){return typeof h=="string"?(h=encodeURI(h).replace(y,nb),S&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function nb(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var qv=/[#\/\?@]/g,rb=/[#\?:]/g,ib=/[#\?]/g,sb=/[#\?@]/g,ob=/#/g;function Wl(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Vs(h){h.g||(h.g=new Map,h.h=0,h.i&&tb(h.i,function(y,S){h.add(decodeURIComponent(y.replace(/\+/g," ")),S)}))}n=Wl.prototype,n.add=function(h,y){Vs(this),this.i=null,h=Ta(this,h);var S=this.g.get(h);return S||this.g.set(h,S=[]),S.push(y),this.h+=1,this};function zv(h,y){Vs(h),y=Ta(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function Yv(h,y){return Vs(h),y=Ta(h,y),h.g.has(y)}n.forEach=function(h,y){Vs(this),this.g.forEach(function(S,M){S.forEach(function(oe){h.call(y,oe,M,this)},this)},this)},n.na=function(){Vs(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),S=[];for(let M=0;M<y.length;M++){const oe=h[M];for(let _e=0;_e<oe.length;_e++)S.push(y[M])}return S},n.V=function(h){Vs(this);let y=[];if(typeof h=="string")Yv(this,h)&&(y=y.concat(this.g.get(Ta(this,h))));else{h=Array.from(this.g.values());for(let S=0;S<h.length;S++)y=y.concat(h[S])}return y},n.set=function(h,y){return Vs(this),this.i=null,h=Ta(this,h),Yv(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Qv(h,y,S){zv(h,y),0<S.length&&(h.i=null,h.g.set(Ta(h,y),v(S)),h.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var S=0;S<y.length;S++){var M=y[S];const _e=encodeURIComponent(String(M)),$e=this.V(M);for(M=0;M<$e.length;M++){var oe=_e;$e[M]!==""&&(oe+="="+encodeURIComponent(String($e[M]))),h.push(oe)}}return this.i=h.join("&")};function Ta(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function ab(h,y){y&&!h.j&&(Vs(h),h.i=null,h.g.forEach(function(S,M){var oe=M.toLowerCase();M!=oe&&(zv(this,M),Qv(this,oe,S))},h)),h.j=y}function lb(h,y){const S=new Io;if(a.Image){const M=new Image;M.onload=g(Hs,S,"TestLoadImage: loaded",!0,y,M),M.onerror=g(Hs,S,"TestLoadImage: error",!1,y,M),M.onabort=g(Hs,S,"TestLoadImage: abort",!1,y,M),M.ontimeout=g(Hs,S,"TestLoadImage: timeout",!1,y,M),a.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=h}else y(!1)}function cb(h,y){const S=new Io,M=new AbortController,oe=setTimeout(()=>{M.abort(),Hs(S,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:M.signal}).then(_e=>{clearTimeout(oe),_e.ok?Hs(S,"TestPingServer: ok",!0,y):Hs(S,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(oe),Hs(S,"TestPingServer: error",!1,y)})}function Hs(h,y,S,M,oe){try{oe&&(oe.onload=null,oe.onerror=null,oe.onabort=null,oe.ontimeout=null),M(S)}catch{}}function ub(){this.g=new _a}function hb(h,y,S){const M=S||"";try{jv(h,function(oe,_e){let $e=oe;c(oe)&&($e=vn(oe)),y.push(M+_e+"="+encodeURIComponent($e))})}catch(oe){throw y.push(M+"type="+encodeURIComponent("_badmap")),oe}}function Wu(h){this.l=h.Ub||null,this.j=h.eb||!1}m(Wu,qi),Wu.prototype.g=function(){return new Gu(this.l,this.j)},Wu.prototype.i=function(h){return function(){return h}}({});function Gu(h,y){Ze.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(Gu,Ze),n=Gu.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,ql(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||a).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Gl(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ql(this)),this.g&&(this.readyState=3,ql(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Xv(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Xv(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Gl(this):ql(this),this.readyState==3&&Xv(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Gl(this))},n.Qa=function(h){this.g&&(this.response=h,Gl(this))},n.ga=function(){this.g&&Gl(this)};function Gl(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ql(h)}n.setRequestHeader=function(h,y){this.u.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var S=y.next();!S.done;)S=S.value,h.push(S[0]+": "+S[1]),S=y.next();return h.join(`\r
`)};function ql(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Gu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Jv(h){let y="";return W(h,function(S,M){y+=M,y+=":",y+=S,y+=`\r
`}),y}function sp(h,y,S){e:{for(M in S){var M=!1;break e}M=!0}M||(S=Jv(S),typeof h=="string"?S!=null&&encodeURIComponent(String(S)):Yt(h,y,S))}function on(h){Ze.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(on,Ze);var db=/^https?$/i,fb=["POST","PUT"];n=on.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,y,S,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():G.g(),this.v=this.o?Vl(this.o):Vl(G),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(_e){Zv(this,_e);return}if(h=S||"",S=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var oe in M)S.set(oe,M[oe]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const _e of M.keys())S.set(_e,M.get(_e));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(S.keys()).find(_e=>_e.toLowerCase()=="content-type"),oe=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(fb,y,void 0))||M||oe||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,$e]of S)this.g.setRequestHeader(_e,$e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{n_(this),this.u=!0,this.g.send(h),this.u=!1}catch(_e){Zv(this,_e)}};function Zv(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,e_(h),qu(h)}function e_(h){h.A||(h.A=!0,ot(h,"complete"),ot(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,ot(this,"complete"),ot(this,"abort"),qu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qu(this,!0)),on.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?t_(this):this.bb())},n.bb=function(){t_(this)};function t_(h){if(h.h&&typeof o<"u"&&(!h.v[1]||Ji(h)!=4||h.Z()!=2)){if(h.u&&Ji(h)==4)Cn(h.Ea,0,h);else if(ot(h,"readystatechange"),Ji(h)==4){h.h=!1;try{const $e=h.Z();e:switch($e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var S;if(!(S=y)){var M;if(M=$e===0){var oe=String(h.D).match(Wv)[1]||null;!oe&&a.self&&a.self.location&&(oe=a.self.location.protocol.slice(0,-1)),M=!db.test(oe?oe.toLowerCase():"")}S=M}if(S)ot(h,"complete"),ot(h,"success");else{h.m=6;try{var _e=2<Ji(h)?h.g.statusText:""}catch{_e=""}h.l=_e+" ["+h.Z()+"]",e_(h)}}finally{qu(h)}}}}function qu(h,y){if(h.g){n_(h);const S=h.g,M=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||ot(h,"ready");try{S.onreadystatechange=M}catch{}}}function n_(h){h.I&&(a.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Ji(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Ji(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Sr(y)}};function r_(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function pb(h){const y={};h=(h.g&&2<=Ji(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<h.length;M++){if(b(h[M]))continue;var S=I(h[M]);const oe=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const _e=y[oe]||[];y[oe]=_e,_e.push(S)}A(y,function(M){return M.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zl(h,y,S){return S&&S.internalChannelParams&&S.internalChannelParams[h]||y}function i_(h){this.Aa=0,this.i=[],this.j=new Io,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zl("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zl("baseRetryDelayMs",5e3,h),this.cb=zl("retryDelaySeedMs",1e4,h),this.Wa=zl("forwardChannelMaxRetries",2,h),this.wa=zl("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Bs(h&&h.concurrentRequestLimit),this.Da=new ub,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=i_.prototype,n.la=8,n.G=1,n.connect=function(h,y,S,M){Bn(0),this.W=h,this.H=y||{},S&&M!==void 0&&(this.H.OSID=S,this.H.OAID=M),this.F=this.X,this.I=f_(this,null,this.W),Yu(this)};function op(h){if(s_(h),h.G==3){var y=h.U++,S=Xi(h.I);if(Yt(S,"SID",h.K),Yt(S,"RID",y),Yt(S,"TYPE","terminate"),Yl(h,S),y=new Ee(h,h.j,y),y.L=2,y.v=ju(Xi(S)),S=!1,a.navigator&&a.navigator.sendBeacon)try{S=a.navigator.sendBeacon(y.v.toString(),"")}catch{}!S&&a.Image&&(new Image().src=y.v,S=!0),S||(y.g=p_(y.j,null),y.g.ea(y.v)),y.F=Date.now(),We(y)}d_(h)}function zu(h){h.g&&(lp(h),h.g.cancel(),h.g=null)}function s_(h){zu(h),h.u&&(a.clearTimeout(h.u),h.u=null),Qu(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function Yu(h){if(!Ai(h.h)&&!h.s){h.s=!0;var y=h.Ga;Ae||fe(),Oe||(Ae(),Oe=!0),Ce.add(y,h),h.B=0}}function gb(h,y){return Ea(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Yi(p(h.Ga,h,y),h_(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const oe=new Ee(this,this.j,h);let _e=this.o;if(this.S&&(_e?(_e=w(_e),C(_e,this.S)):_e=this.S),this.m!==null||this.O||(oe.H=_e,_e=null),this.P)e:{for(var y=0,S=0;S<this.i.length;S++){t:{var M=this.i[S];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(y+=M,4096<y){y=S;break e}if(y===4096||S===this.i.length-1){y=S+1;break e}}y=1e3}else y=1e3;y=a_(this,oe,y),S=Xi(this.I),Yt(S,"RID",h),Yt(S,"CVER",22),this.D&&Yt(S,"X-HTTP-Session-Id",this.D),Yl(this,S),_e&&(this.O?y="headers="+encodeURIComponent(String(Jv(_e)))+"&"+y:this.m&&sp(S,this.m,_e)),ip(this.h,oe),this.Ua&&Yt(S,"TYPE","init"),this.P?(Yt(S,"$req",y),Yt(S,"SID","null"),oe.T=!0,Pe(oe,S,null)):Pe(oe,S,y),this.G=2}}else this.G==3&&(h?o_(this,h):this.i.length==0||Ai(this.h)||o_(this))};function o_(h,y){var S;y?S=y.l:S=h.U++;const M=Xi(h.I);Yt(M,"SID",h.K),Yt(M,"RID",S),Yt(M,"AID",h.T),Yl(h,M),h.m&&h.o&&sp(M,h.m,h.o),S=new Ee(h,h.j,S,h.B+1),h.m===null&&(S.H=h.o),y&&(h.i=y.D.concat(h.i)),y=a_(h,S,1e3),S.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),ip(h.h,S),Pe(S,M,y)}function Yl(h,y){h.H&&W(h.H,function(S,M){Yt(y,M,S)}),h.l&&jv({},function(S,M){Yt(y,M,S)})}function a_(h,y,S){S=Math.min(h.i.length,S);var M=h.l?p(h.l.Na,h.l,h):null;e:{var oe=h.i;let _e=-1;for(;;){const $e=["count="+S];_e==-1?0<S?(_e=oe[0].g,$e.push("ofs="+_e)):_e=0:$e.push("ofs="+_e);let Kt=!0;for(let Vn=0;Vn<S;Vn++){let St=oe[Vn].g;const Jn=oe[Vn].map;if(St-=_e,0>St)_e=Math.max(0,oe[Vn].g-100),Kt=!1;else try{hb(Jn,$e,"req"+St+"_")}catch{M&&M(Jn)}}if(Kt){M=$e.join("&");break e}}}return h=h.i.splice(0,S),y.D=h,M}function l_(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;Ae||fe(),Oe||(Ae(),Oe=!0),Ce.add(y,h),h.v=0}}function ap(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Yi(p(h.Fa,h),h_(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,c_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Yi(p(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Bn(10),zu(this),c_(this))};function lp(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function c_(h){h.g=new Ee(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=Xi(h.qa);Yt(y,"RID","rpc"),Yt(y,"SID",h.K),Yt(y,"AID",h.T),Yt(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&Yt(y,"TO",h.ja),Yt(y,"TYPE","xmlhttp"),Yl(h,y),h.m&&h.o&&sp(y,h.m,h.o),h.L&&(h.g.I=h.L);var S=h.g;h=h.ia,S.L=1,S.v=ju(Xi(y)),S.m=null,S.P=!0,He(S,h)}n.Za=function(){this.C!=null&&(this.C=null,zu(this),ap(this),Bn(19))};function Qu(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function u_(h,y){var S=null;if(h.g==y){Qu(h),lp(h),h.g=null;var M=2}else if(Mr(h.h,y))S=y.D,$v(h.h,y),M=1;else return;if(h.G!=0){if(y.o)if(M==1){S=y.m?y.m.length:0,y=Date.now()-y.F;var oe=h.B;M=ya(),ot(M,new Hu(M,S)),Yu(h)}else l_(h);else if(oe=y.s,oe==3||oe==0&&0<y.X||!(M==1&&gb(h,y)||M==2&&ap(h)))switch(S&&0<S.length&&(y=h.h,y.i=y.i.concat(S)),oe){case 1:bo(h,5);break;case 4:bo(h,10);break;case 3:bo(h,6);break;default:bo(h,2)}}}function h_(h,y){let S=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(S*=2),S*y}function bo(h,y){if(h.j.info("Error code "+y),y==2){var S=p(h.fb,h),M=h.Xa;const oe=!M;M=new Ro(M||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||$u(M,"https"),ju(M),oe?lb(M.toString(),S):cb(M.toString(),S)}else Bn(2);h.G=0,h.l&&h.l.sa(y),d_(h),s_(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Bn(2)):(this.j.info("Failed to ping google.com"),Bn(1))};function d_(h){if(h.G=0,h.ka=[],h.l){const y=Kv(h.h);(y.length!=0||h.i.length!=0)&&(_(h.ka,y),_(h.ka,h.i),h.h.i.length=0,v(h.i),h.i.length=0),h.l.ra()}}function f_(h,y,S){var M=S instanceof Ro?Xi(S):new Ro(S);if(M.g!="")y&&(M.g=y+"."+M.g),Ku(M,M.s);else{var oe=a.location;M=oe.protocol,y=y?y+"."+oe.hostname:oe.hostname,oe=+oe.port;var _e=new Ro(null);M&&$u(_e,M),y&&(_e.g=y),oe&&Ku(_e,oe),S&&(_e.l=S),M=_e}return S=h.D,y=h.ya,S&&y&&Yt(M,S,y),Yt(M,"VER",h.la),Yl(h,M),M}function p_(h,y,S){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new on(new Wu({eb:S})):new on(h.pa),y.Ha(h.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function g_(){}n=g_.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Xu(){}Xu.prototype.g=function(h,y){return new Fr(h,y)};function Fr(h,y){Ze.call(this),this.g=new i_(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!b(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!b(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new wa(this)}m(Fr,Ze),Fr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fr.prototype.close=function(){op(this.g)},Fr.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var S={};S.__data__=h,h=S}else this.u&&(S={},S.__data__=vn(h),h=S);y.i.push(new xo(y.Ya++,h)),y.G==3&&Yu(y)},Fr.prototype.N=function(){this.g.l=null,delete this.j,op(this.g),delete this.g,Fr.aa.N.call(this)};function m_(h){$l.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const S in y){h=S;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}m(m_,$l);function v_(){Us.call(this),this.status=1}m(v_,Us);function wa(h){this.g=h}m(wa,g_),wa.prototype.ua=function(){ot(this.g,"a")},wa.prototype.ta=function(h){ot(this.g,new m_(h))},wa.prototype.sa=function(h){ot(this.g,new v_)},wa.prototype.ra=function(){ot(this.g,"b")},Xu.prototype.createWebChannel=Xu.prototype.g,Fr.prototype.send=Fr.prototype.o,Fr.prototype.open=Fr.prototype.m,Fr.prototype.close=Fr.prototype.close,RA=function(){return new Xu},xA=function(){return ya()},IA=zi,y0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},V.NO_ERROR=0,V.TIMEOUT=8,V.HTTP_ERROR=6,Lh=V,j.COMPLETE="complete",SA=j,Hl.EventType=Co,Co.OPEN="a",Co.CLOSE="b",Co.ERROR="c",Co.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,rc=Hl,on.prototype.listenOnce=on.prototype.L,on.prototype.getLastError=on.prototype.Ka,on.prototype.getLastErrorCode=on.prototype.Ba,on.prototype.getStatus=on.prototype.Z,on.prototype.getResponseJson=on.prototype.Oa,on.prototype.getResponseText=on.prototype.oa,on.prototype.send=on.prototype.ea,on.prototype.setWithCredentials=on.prototype.Ha,CA=on}).apply(typeof ih<"u"?ih:typeof self<"u"?self:typeof window<"u"?window:{});const Ny="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rr.UNAUTHENTICATED=new rr(null),rr.GOOGLE_CREDENTIALS=new rr("google-credentials-uid"),rr.FIRST_PARTY=new rr("first-party-uid"),rr.MOCK_USER=new rr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Il="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo=new xg("@firebase/firestore");function Jl(){return zo.logLevel}function Xe(n,...e){if(zo.logLevel<=Et.DEBUG){const t=e.map(Vg);zo.debug(`Firestore (${Il}): ${n}`,...t)}}function xs(n,...e){if(zo.logLevel<=Et.ERROR){const t=e.map(Vg);zo.error(`Firestore (${Il}): ${n}`,...t)}}function Yo(n,...e){if(zo.logLevel<=Et.WARN){const t=e.map(Vg);zo.warn(`Firestore (${Il}): ${n}`,...t)}}function Vg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(n="Unexpected state"){const e=`FIRESTORE (${Il}) INTERNAL ASSERTION FAILED: `+n;throw xs(e),new Error(e)}function Ut(n,e){n||ct()}function dt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ze extends Ns{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(rr.UNAUTHENTICATED))}shutdown(){}}class kD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class PD{constructor(e){this.t=e,this.currentUser=rr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ut(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new gs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new gs,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new gs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ut(typeof r.accessToken=="string"),new bA(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ut(e===null||typeof e=="string"),new rr(e)}}class OD{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=rr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ND{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new OD(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(rr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class DD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class MD{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ut(this.o===void 0);const r=s=>{s.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Xe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ut(typeof t.token=="string"),this.R=t.token,new DD(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=FD(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function Rt(n,e){return n<e?-1:n>e?1:0}function ll(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ze(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ze(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ze(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ze(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Tn.fromMillis(Date.now())}static fromDate(e){return Tn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Tn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Rt(this.nanoseconds,e.nanoseconds):Rt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ht(e)}static min(){return new ht(new Tn(0,0))}static max(){return new ht(new Tn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t,r){t===void 0?t=0:t>e.length&&ct(),r===void 0?r=e.length-t:r>e.length-t&&ct(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return $c.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $c?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Jt extends $c{construct(e,t,r){return new Jt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ze(xe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Jt(t)}static emptyPath(){return new Jt([])}}const LD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nn extends $c{construct(e,t,r){return new Nn(e,t,r)}static isValidIdentifier(e){return LD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Nn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ze(xe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ze(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ze(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ze(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nn(t)}static emptyPath(){return new Nn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.path=e}static fromPath(e){return new et(Jt.fromString(e))}static fromName(e){return new et(Jt.fromString(e).popFirst(5))}static empty(){return new et(Jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Jt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Jt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new Jt(e.slice()))}}function UD(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ht.fromTimestamp(r===1e9?new Tn(t+1,0):new Tn(t,r));return new po(i,et.empty(),e)}function BD(n){return new po(n.readTime,n.key,-1)}class po{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new po(ht.min(),et.empty(),-1)}static max(){return new po(ht.max(),et.empty(),-1)}}function VD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=et.comparator(n.documentKey,e.documentKey),t!==0?t:Rt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $D{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pu(n){if(n.code!==xe.FAILED_PRECONDITION||n.message!==HD)throw n;Xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ct(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ke((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ke?t:ke.resolve(t)}catch(t){return ke.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ke.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ke.reject(t)}static resolve(e){return new ke((t,r)=>{t(e)})}static reject(e){return new ke((t,r)=>{r(e)})}static waitFor(e){return new ke((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=ke.resolve(!1);for(const r of e)t=t.next(i=>i?ke.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new ke((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,t){return new ke((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function KD(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function gu(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}$g.oe=-1;function lf(n){return n==null}function ad(n){return n===0&&1/n==-1/0}function jD(n){return typeof n=="number"&&Number.isInteger(n)&&!ad(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ca(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function PA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,t){this.comparator=e,this.root=t||jn.EMPTY}insert(e,t){return new sn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,jn.BLACK,null,null))}remove(e){return new sn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sh(this.root,e,this.comparator,!1)}getReverseIterator(){return new sh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sh(this.root,e,this.comparator,!0)}}class sh{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??jn.RED,this.left=i??jn.EMPTY,this.right=s??jn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new jn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return jn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return jn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ct();const e=this.left.check();if(e!==this.right.check())throw ct();return e+(this.isRed()?0:1)}}jn.EMPTY=null,jn.RED=!0,jn.BLACK=!1;jn.EMPTY=new class{constructor(){this.size=0}get key(){throw ct()}get value(){throw ct()}get color(){throw ct()}get left(){throw ct()}get right(){throw ct()}copy(e,t,r,i,s){return this}insert(e,t,r){return new jn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.comparator=e,this.data=new sn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new My(this.data.getIterator())}getIteratorFrom(e){return new My(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new zn(this.comparator);return t.data=e,t}}class My{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this.fields=e,e.sort(Nn.comparator)}static empty(){return new qr([])}unionWith(e){let t=new zn(Nn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new qr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ll(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new OA("Invalid base64 string: "+s):s}}(e);return new Un(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Un(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Rt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Un.EMPTY_BYTE_STRING=new Un("");const WD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(n){if(Ut(!!n),typeof n=="string"){let e=0;const t=WD.exec(n);if(Ut(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:hn(n.seconds),nanos:hn(n.nanos)}}function hn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Qo(n){return typeof n=="string"?Un.fromBase64String(n):Un.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function jg(n){const e=n.mapValue.fields.__previous_value__;return Kg(e)?jg(e):e}function Kc(n){const e=go(n.mapValue.fields.__local_write_time__.timestampValue);return new Tn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,t,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class cl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new cl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof cl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh={mapValue:{}};function Xo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Kg(n)?4:zD(n)?9007199254740991:qD(n)?10:11:ct()}function Ki(n,e){if(n===e)return!0;const t=Xo(n);if(t!==Xo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kc(n).isEqual(Kc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=go(i.timestampValue),a=go(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Qo(i.bytesValue).isEqual(Qo(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return hn(i.geoPointValue.latitude)===hn(s.geoPointValue.latitude)&&hn(i.geoPointValue.longitude)===hn(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return hn(i.integerValue)===hn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=hn(i.doubleValue),a=hn(s.doubleValue);return o===a?ad(o)===ad(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ll(n.arrayValue.values||[],e.arrayValue.values||[],Ki);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Dy(o)!==Dy(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Ki(o[l],a[l])))return!1;return!0}(n,e);default:return ct()}}function jc(n,e){return(n.values||[]).find(t=>Ki(t,e))!==void 0}function ul(n,e){if(n===e)return 0;const t=Xo(n),r=Xo(e);if(t!==r)return Rt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Rt(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=hn(s.integerValue||s.doubleValue),l=hn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return Fy(n.timestampValue,e.timestampValue);case 4:return Fy(Kc(n),Kc(e));case 5:return Rt(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Qo(s),l=Qo(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Rt(a[c],l[c]);if(u!==0)return u}return Rt(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Rt(hn(s.latitude),hn(o.latitude));return a!==0?a:Rt(hn(s.longitude),hn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Ly(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,u;const f=s.fields||{},p=o.fields||{},g=(a=f.value)===null||a===void 0?void 0:a.arrayValue,m=(l=p.value)===null||l===void 0?void 0:l.arrayValue,v=Rt(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:Ly(g,m)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===oh.mapValue&&o===oh.mapValue)return 0;if(s===oh.mapValue)return 1;if(o===oh.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const p=Rt(l[f],u[f]);if(p!==0)return p;const g=ul(a[l[f]],c[u[f]]);if(g!==0)return g}return Rt(l.length,u.length)}(n.mapValue,e.mapValue);default:throw ct()}}function Fy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Rt(n,e);const t=go(n),r=go(e),i=Rt(t.seconds,r.seconds);return i!==0?i:Rt(t.nanos,r.nanos)}function Ly(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=ul(t[i],r[i]);if(s)return s}return Rt(t.length,r.length)}function hl(n){return E0(n)}function E0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=go(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Qo(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return et.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=E0(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${E0(t.fields[o])}`;return i+"}"}(n.mapValue):ct()}function Uy(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function T0(n){return!!n&&"integerValue"in n}function Wg(n){return!!n&&"arrayValue"in n}function By(n){return!!n&&"nullValue"in n}function Vy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Uh(n){return!!n&&"mapValue"in n}function qD(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function _c(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ca(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=_c(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_c(n.arrayValue.values[t]);return e}return Object.assign({},n)}function zD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.value=e}static empty(){return new Ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Uh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_c(t)}setAll(e){let t=Nn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=_c(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Uh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ki(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Uh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ca(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ir(_c(this.value))}}function NA(n){const e=[];return ca(n.fields,(t,r)=>{const i=new Nn([t]);if(Uh(r)){const s=NA(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new qr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new sr(e,0,ht.min(),ht.min(),ht.min(),Ir.empty(),0)}static newFoundDocument(e,t,r,i){return new sr(e,1,t,ht.min(),r,i,0)}static newNoDocument(e,t){return new sr(e,2,t,ht.min(),ht.min(),Ir.empty(),0)}static newUnknownDocument(e,t){return new sr(e,3,t,ht.min(),ht.min(),Ir.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ht.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ht.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof sr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new sr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,t){this.position=e,this.inclusive=t}}function Hy(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=et.comparator(et.fromName(o.referenceValue),t.key):r=ul(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function $y(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ki(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,t="asc"){this.field=e,this.dir=t}}function YD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{}class En extends DA{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new XD(e,t,r):t==="array-contains"?new eM(e,r):t==="in"?new tM(e,r):t==="not-in"?new nM(e,r):t==="array-contains-any"?new rM(e,r):new En(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new JD(e,r):new ZD(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ul(t,this.value)):t!==null&&Xo(this.value)===Xo(t)&&this.matchesComparison(ul(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ct()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yi extends DA{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new yi(e,t)}matches(e){return MA(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function MA(n){return n.op==="and"}function FA(n){return QD(n)&&MA(n)}function QD(n){for(const e of n.filters)if(e instanceof yi)return!1;return!0}function w0(n){if(n instanceof En)return n.field.canonicalString()+n.op.toString()+hl(n.value);if(FA(n))return n.filters.map(e=>w0(e)).join(",");{const e=n.filters.map(t=>w0(t)).join(",");return`${n.op}(${e})`}}function LA(n,e){return n instanceof En?function(r,i){return i instanceof En&&r.op===i.op&&r.field.isEqual(i.field)&&Ki(r.value,i.value)}(n,e):n instanceof yi?function(r,i){return i instanceof yi&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&LA(o,i.filters[a]),!0):!1}(n,e):void ct()}function UA(n){return n instanceof En?function(t){return`${t.field.canonicalString()} ${t.op} ${hl(t.value)}`}(n):n instanceof yi?function(t){return t.op.toString()+" {"+t.getFilters().map(UA).join(" ,")+"}"}(n):"Filter"}class XD extends En{constructor(e,t,r){super(e,t,r),this.key=et.fromName(r.referenceValue)}matches(e){const t=et.comparator(e.key,this.key);return this.matchesComparison(t)}}class JD extends En{constructor(e,t){super(e,"in",t),this.keys=BA("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ZD extends En{constructor(e,t){super(e,"not-in",t),this.keys=BA("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function BA(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>et.fromName(r.referenceValue))}class eM extends En{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wg(t)&&jc(t.arrayValue,this.value)}}class tM extends En{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&jc(this.value.arrayValue,t)}}class nM extends En{constructor(e,t){super(e,"not-in",t)}matches(e){if(jc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!jc(this.value.arrayValue,t)}}class rM extends En{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>jc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Ky(n,e=null,t=[],r=[],i=null,s=null,o=null){return new iM(n,e,t,r,i,s,o)}function Gg(n){const e=dt(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>w0(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>hl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>hl(r)).join(",")),e.ue=t}return e.ue}function qg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!YD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!LA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!$y(n.startAt,e.startAt)&&$y(n.endAt,e.endAt)}function A0(n){return et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function sM(n,e,t,r,i,s,o,a){return new xl(n,e,t,r,i,s,o,a)}function cf(n){return new xl(n)}function jy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function VA(n){return n.collectionGroup!==null}function yc(n){const e=dt(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new zn(Nn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Wc(s,r))}),t.has(Nn.keyField().canonicalString())||e.ce.push(new Wc(Nn.keyField(),r))}return e.ce}function Li(n){const e=dt(n);return e.le||(e.le=oM(e,yc(n))),e.le}function oM(n,e){if(n.limitType==="F")return Ky(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Wc(i.field,s)});const t=n.endAt?new ld(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ld(n.startAt.position,n.startAt.inclusive):null;return Ky(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function C0(n,e){const t=n.filters.concat([e]);return new xl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function S0(n,e,t){return new xl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uf(n,e){return qg(Li(n),Li(e))&&n.limitType===e.limitType}function HA(n){return`${Gg(Li(n))}|lt:${n.limitType}`}function Pa(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>UA(i)).join(", ")}]`),lf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>hl(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>hl(i)).join(",")),`Target(${r})`}(Li(n))}; limitType=${n.limitType})`}function hf(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):et.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of yc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=Hy(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,yc(r),i)||r.endAt&&!function(o,a,l){const c=Hy(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,yc(r),i))}(n,e)}function aM(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function $A(n){return(e,t)=>{let r=!1;for(const i of yc(n)){const s=lM(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function lM(n,e,t){const r=n.field.isKeyField()?et.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ul(l,c):ct()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ct()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ca(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return PA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=new sn(et.comparator);function Rs(){return cM}const KA=new sn(et.comparator);function ic(...n){let e=KA;for(const t of n)e=e.insert(t.key,t);return e}function jA(n){let e=KA;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Fo(){return Ec()}function WA(){return Ec()}function Ec(){return new Rl(n=>n.toString(),(n,e)=>n.isEqual(e))}const uM=new sn(et.comparator),hM=new zn(et.comparator);function yt(...n){let e=hM;for(const t of n)e=e.add(t);return e}const dM=new zn(Rt);function fM(){return dM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ad(e)?"-0":e}}function GA(n){return{integerValue:""+n}}function pM(n,e){return jD(e)?GA(e):zg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(){this._=void 0}}function gM(n,e,t){return n instanceof cd?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Kg(s)&&(s=jg(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Gc?zA(n,e):n instanceof qc?YA(n,e):function(i,s){const o=qA(i,s),a=Wy(o)+Wy(i.Pe);return T0(o)&&T0(i.Pe)?GA(a):zg(i.serializer,a)}(n,e)}function mM(n,e,t){return n instanceof Gc?zA(n,e):n instanceof qc?YA(n,e):t}function qA(n,e){return n instanceof ud?function(r){return T0(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class cd extends df{}class Gc extends df{constructor(e){super(),this.elements=e}}function zA(n,e){const t=QA(e);for(const r of n.elements)t.some(i=>Ki(i,r))||t.push(r);return{arrayValue:{values:t}}}class qc extends df{constructor(e){super(),this.elements=e}}function YA(n,e){let t=QA(e);for(const r of n.elements)t=t.filter(i=>!Ki(i,r));return{arrayValue:{values:t}}}class ud extends df{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Wy(n){return hn(n.integerValue||n.doubleValue)}function QA(n){return Wg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function vM(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Gc&&i instanceof Gc||r instanceof qc&&i instanceof qc?ll(r.elements,i.elements,Ki):r instanceof ud&&i instanceof ud?Ki(r.Pe,i.Pe):r instanceof cd&&i instanceof cd}(n.transform,e.transform)}class _M{constructor(e,t){this.version=e,this.transformResults=t}}class pi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new pi}static exists(e){return new pi(void 0,e)}static updateTime(e){return new pi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ff{}function XA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Yg(n.key,pi.none()):new mu(n.key,n.data,pi.none());{const t=n.data,r=Ir.empty();let i=new zn(Nn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new wo(n.key,r,new qr(i.toArray()),pi.none())}}function yM(n,e,t){n instanceof mu?function(i,s,o){const a=i.value.clone(),l=qy(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof wo?function(i,s,o){if(!Bh(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=qy(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(JA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Tc(n,e,t,r){return n instanceof mu?function(s,o,a,l){if(!Bh(s.precondition,o))return a;const c=s.value.clone(),u=zy(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof wo?function(s,o,a,l){if(!Bh(s.precondition,o))return a;const c=zy(s.fieldTransforms,l,o),u=o.data;return u.setAll(JA(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,a){return Bh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function EM(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=qA(r.transform,i||null);s!=null&&(t===null&&(t=Ir.empty()),t.set(r.field,s))}return t||null}function Gy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ll(r,i,(s,o)=>vM(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class mu extends ff{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class wo extends ff{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function JA(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function qy(n,e,t){const r=new Map;Ut(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,mM(o,a,t[i]))}return r}function zy(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,gM(s,o,e))}return r}class Yg extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TM extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&yM(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Tc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Tc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=WA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=XA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ht.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),yt())}isEqual(e){return this.batchId===e.batchId&&ll(this.mutations,e.mutations,(t,r)=>Gy(t,r))&&ll(this.baseMutations,e.baseMutations,(t,r)=>Gy(t,r))}}class Qg{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ut(e.mutations.length===r.length);let i=function(){return uM}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Qg(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn,At;function SM(n){switch(n){default:return ct();case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0}}function ZA(n){if(n===void 0)return xs("GRPC error has no .code"),xe.UNKNOWN;switch(n){case yn.OK:return xe.OK;case yn.CANCELLED:return xe.CANCELLED;case yn.UNKNOWN:return xe.UNKNOWN;case yn.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case yn.INTERNAL:return xe.INTERNAL;case yn.UNAVAILABLE:return xe.UNAVAILABLE;case yn.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case yn.NOT_FOUND:return xe.NOT_FOUND;case yn.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case yn.ABORTED:return xe.ABORTED;case yn.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case yn.DATA_LOSS:return xe.DATA_LOSS;default:return ct()}}(At=yn||(yn={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM=new Ko([4294967295,4294967295],0);function Yy(n){const e=IM().encode(n),t=new AA;return t.update(e),new Uint8Array(t.digest())}function Qy(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ko([t,r],0),new Ko([i,s],0)]}class Xg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new sc(`Invalid padding: ${t}`);if(r<0)throw new sc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new sc(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ko.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ko.fromNumber(r)));return i.compare(xM)===1&&(i=new Ko([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Yy(e),[r,i]=Qy(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Xg(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=Yy(e),[r,i]=Qy(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,vu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new pf(ht.min(),i,new sn(Rt),Rs(),yt())}}class vu{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new vu(r,t,yt(),yt(),yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class eC{constructor(e,t){this.targetId=e,this.me=t}}class tC{constructor(e,t,r=Un.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Xy{constructor(){this.fe=0,this.ge=Zy(),this.pe=Un.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=yt(),t=yt(),r=yt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ct()}}),new vu(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Zy()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ut(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class RM{constructor(e){this.Le=e,this.Be=new Map,this.ke=Rs(),this.qe=Jy(),this.Qe=new sn(Rt)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:ct()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(A0(s))if(r===0){const o=new et(s.path);this.Ue(t,o,sr.newNoDocument(o,ht.min()))}else Ut(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=Qo(r).toUint8Array()}catch(l){if(l instanceof OA)return Yo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Xg(o,i,s)}catch(l){return Yo(l instanceof sc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&A0(a.target)){const l=new et(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,sr.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=yt();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new pf(e,t,this.Qe,this.ke,r);return this.ke=Rs(),this.qe=Jy(),this.Qe=new sn(Rt),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Xy,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new zn(Rt),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||Xe("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Xy),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Jy(){return new sn(et.comparator)}function Zy(){return new sn(et.comparator)}const bM={asc:"ASCENDING",desc:"DESCENDING"},kM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PM={and:"AND",or:"OR"};class OM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function I0(n,e){return n.useProto3Json||lf(e)?e:{value:e}}function hd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nC(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function NM(n,e){return hd(n,e.toTimestamp())}function Ui(n){return Ut(!!n),ht.fromTimestamp(function(t){const r=go(t);return new Tn(r.seconds,r.nanos)}(n))}function Jg(n,e){return x0(n,e).canonicalString()}function x0(n,e){const t=function(i){return new Jt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function rC(n){const e=Jt.fromString(n);return Ut(lC(e)),e}function R0(n,e){return Jg(n.databaseId,e.path)}function xp(n,e){const t=rC(e);if(t.get(1)!==n.databaseId.projectId)throw new ze(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ze(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new et(sC(t))}function iC(n,e){return Jg(n.databaseId,e)}function DM(n){const e=rC(n);return e.length===4?Jt.emptyPath():sC(e)}function b0(n){return new Jt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function sC(n){return Ut(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function e1(n,e,t){return{name:R0(n,e),fields:t.value.mapValue.fields}}function MM(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ct()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(Ut(u===void 0||typeof u=="string"),Un.fromBase64String(u||"")):(Ut(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Un.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?xe.UNKNOWN:ZA(c.code);return new ze(u,c.message||"")}(o);t=new tC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=xp(n,r.document.name),s=Ui(r.document.updateTime),o=r.document.createTime?Ui(r.document.createTime):ht.min(),a=new Ir({mapValue:{fields:r.document.fields}}),l=sr.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Vh(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=xp(n,r.document),s=r.readTime?Ui(r.readTime):ht.min(),o=sr.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Vh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=xp(n,r.document),s=r.removedTargetIds||[];t=new Vh([],s,i,null)}else{if(!("filter"in e))return ct();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new CM(i,s),a=r.targetId;t=new eC(a,o)}}return t}function FM(n,e){let t;if(e instanceof mu)t={update:e1(n,e.key,e.value)};else if(e instanceof Yg)t={delete:R0(n,e.key)};else if(e instanceof wo)t={update:e1(n,e.key,e.data),updateMask:WM(e.fieldMask)};else{if(!(e instanceof TM))return ct();t={verify:R0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof cd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof qc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ud)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ct()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:NM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ct()}(n,e.precondition)),t}function LM(n,e){return n&&n.length>0?(Ut(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Ui(i.updateTime):Ui(s);return o.isEqual(ht.min())&&(o=Ui(s)),new _M(o,i.transformResults||[])}(t,e))):[]}function UM(n,e){return{documents:[iC(n,e.path)]}}function BM(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=iC(n,i);const s=function(c){if(c.length!==0)return aC(yi.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(u=>function(p){return{field:Oa(p.field),direction:$M(p.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=I0(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:i}}function VM(n){let e=DM(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ut(r===1);const u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(f){const p=oC(f);return p instanceof yi&&FA(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(m){return new Wc(Na(m.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,lf(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new ld(g,p)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const p=!f.before,g=f.values||[];return new ld(g,p)}(t.endAt)),sM(e,i,o,s,a,"F",l,c)}function HM(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ct()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function oC(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Na(t.unaryFilter.field);return En.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Na(t.unaryFilter.field);return En.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Na(t.unaryFilter.field);return En.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Na(t.unaryFilter.field);return En.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ct()}}(n):n.fieldFilter!==void 0?function(t){return En.create(Na(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ct()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return yi.create(t.compositeFilter.filters.map(r=>oC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ct()}}(t.compositeFilter.op))}(n):ct()}function $M(n){return bM[n]}function KM(n){return kM[n]}function jM(n){return PM[n]}function Oa(n){return{fieldPath:n.canonicalString()}}function Na(n){return Nn.fromServerFormat(n.fieldPath)}function aC(n){return n instanceof En?function(t){if(t.op==="=="){if(Vy(t.value))return{unaryFilter:{field:Oa(t.field),op:"IS_NAN"}};if(By(t.value))return{unaryFilter:{field:Oa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Vy(t.value))return{unaryFilter:{field:Oa(t.field),op:"IS_NOT_NAN"}};if(By(t.value))return{unaryFilter:{field:Oa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oa(t.field),op:KM(t.op),value:t.value}}}(n):n instanceof yi?function(t){const r=t.getFilters().map(i=>aC(i));return r.length===1?r[0]:{compositeFilter:{op:jM(t.op),filters:r}}}(n):ct()}function WM(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function lC(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,t,r,i,s=ht.min(),o=ht.min(),a=Un.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new to(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e){this.ct=e}}function qM(n){const e=VM({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?S0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(){this.un=new YM}addToCollectionParentIndex(e,t){return this.un.add(t),ke.resolve()}getCollectionParents(e,t){return ke.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ke.resolve()}deleteFieldIndex(e,t){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,t){return ke.resolve()}getDocumentsMatchingTarget(e,t){return ke.resolve(null)}getIndexType(e,t){return ke.resolve(0)}getFieldIndexes(e,t){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,t){return ke.resolve(po.min())}getMinOffsetFromCollectionGroup(e,t){return ke.resolve(po.min())}updateCollectionGroup(e,t,r){return ke.resolve()}updateIndexEntries(e,t){return ke.resolve()}}class YM{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new zn(Jt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new zn(Jt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new dl(0)}static kn(){return new dl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(){this.changes=new Rl(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,sr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ke.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Tc(r.mutation,i,qr.empty(),Tn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,yt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=yt()){const i=Fo();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=ic();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Fo();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,yt()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Rs();const o=Ec(),a=function(){return Ec()}();return t.forEach((l,c)=>{const u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof wo)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Tc(u.mutation,c,u.mutation.getFieldMask(),Tn.now())):o.set(c.key,qr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>{var f;return a.set(c,new XM(u,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Ec();let i=new sn((o,a)=>o-a),s=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||qr.empty();u=a.applyToLocalView(c,u),r.set(l,u);const f=(i.get(a.batchId)||yt()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,f=WA();u.forEach(p=>{if(!s.has(p)){const g=XA(t.get(p),r.get(p));g!==null&&f.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return ke.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return et.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):VA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):ke.resolve(Fo());let a=-1,l=s;return o.next(c=>ke.forEach(c,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(u)?ke.resolve():this.remoteDocumentCache.getEntry(e,u).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,yt())).next(u=>({batchId:a,changes:jA(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new et(t)).next(r=>{let i=ic();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=ic();return this.indexManager.getCollectionParents(e,s).next(a=>ke.forEach(a,l=>{const c=function(f,p){return new xl(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(u=>{u.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,sr.newInvalidDocument(u)))});let a=ic();return o.forEach((l,c)=>{const u=s.get(l);u!==void 0&&Tc(u.mutation,c,qr.empty(),Tn.now()),hf(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ke.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ui(i.createTime)}}(t)),ke.resolve()}getNamedQuery(e,t){return ke.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:qM(i.bundledQuery),readTime:Ui(i.readTime)}}(t)),ke.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(){this.overlays=new sn(et.comparator),this.Ir=new Map}getOverlay(e,t){return ke.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Fo();return ke.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),ke.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),ke.resolve()}getOverlaysForCollection(e,t,r){const i=Fo(),s=t.length+1,o=new et(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return ke.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new sn((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=Fo(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Fo(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=i)););return ke.resolve(a)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new AM(t,r));let s=this.Ir.get(t);s===void 0&&(s=yt(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(){this.sessionToken=Un.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(){this.Tr=new zn(kn.Er),this.dr=new zn(kn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new kn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new kn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new et(new Jt([])),r=new kn(t,e),i=new kn(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new et(new Jt([])),r=new kn(t,e),i=new kn(t,e+1);let s=yt();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new kn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class kn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return et.comparator(e.key,t.key)||Rt(e.wr,t.wr)}static Ar(e,t){return Rt(e.wr,t.wr)||et.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new zn(kn.Er)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new wM(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new kn(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ke.resolve(o)}lookupMutationBatch(e,t){return ke.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return ke.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new kn(t,0),i=new kn(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),ke.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new zn(Rt);return t.forEach(i=>{const s=new kn(i,0),o=new kn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),ke.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;et.isDocumentKey(s)||(s=s.child(""));const o=new kn(new et(s),0);let a=new zn(Rt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.wr)),!0)},o),ke.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Ut(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return ke.forEach(t.mutations,i=>{const s=new kn(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new kn(t,0),i=this.br.firstAfterOrEqual(r);return ke.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e){this.Mr=e,this.docs=function(){return new sn(et.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ke.resolve(r?r.document.mutableCopy():sr.newInvalidDocument(t))}getEntries(e,t){let r=Rs();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():sr.newInvalidDocument(i))}),ke.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Rs();const o=t.path,a=new et(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||VD(BD(u),r)<=0||(i.has(u.key)||hf(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return ke.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ct()}Or(e,t){return ke.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new i4(this)}getSize(e){return ke.resolve(this.size)}}class i4 extends QM{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),ke.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{constructor(e){this.persistence=e,this.Nr=new Rl(t=>Gg(t),qg),this.lastRemoteSnapshotVersion=ht.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zg,this.targetCount=0,this.kr=dl.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),ke.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new dl(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ke.resolve()}updateTargetData(e,t){return this.Kn(t),ke.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ke.waitFor(s).next(()=>i)}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return ke.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),ke.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ke.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ke.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return ke.resolve(r)}containsKey(e,t){return ke.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e,t){this.qr={},this.overlays={},this.Qr=new $g(0),this.Kr=!1,this.Kr=!0,this.$r=new t4,this.referenceDelegate=e(this),this.Ur=new s4(this),this.indexManager=new zM,this.remoteDocumentCache=function(i){return new r4(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new GM(t),this.Gr=new ZM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new e4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new n4(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){Xe("MemoryPersistence","Starting transaction:",e);const i=new a4(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return ke.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class a4 extends $D{constructor(e){super(),this.currentSequenceNumber=e}}class em{constructor(e){this.persistence=e,this.Jr=new Zg,this.Yr=null}static Zr(e){return new em(e)}get Xr(){if(this.Yr)return this.Yr;throw ct()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),ke.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),ke.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ke.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.Xr,r=>{const i=et.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,ht.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return ke.or([()=>ke.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=yt(),i=yt();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new tm(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return fP()?8:KD(dr())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new l4;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Jl()<=Et.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",Pa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ke.resolve()):(Jl()<=Et.DEBUG&&Xe("QueryEngine","Query:",Pa(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Jl()<=Et.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",Pa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Li(t))):ke.resolve())}Yi(e,t){if(jy(t))return ke.resolve(null);let r=Li(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=S0(t,null,"F"),r=Li(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=yt(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(t,a);return this.ns(t,c,o,l.readTime)?this.Yi(e,S0(t,null,"F")):this.rs(e,c,t,l)}))})))}Zi(e,t,r,i){return jy(t)||i.isEqual(ht.min())?ke.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?ke.resolve(null):(Jl()<=Et.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pa(t)),this.rs(e,o,t,UD(i,-1)).next(a=>a))})}ts(e,t){let r=new zn($A(e));return t.forEach((i,s)=>{hf(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Jl()<=Et.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",Pa(t)),this.Ji.getDocumentsMatchingQuery(e,t,po.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new sn(Rt),this._s=new Rl(s=>Gg(s),qg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JM(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function h4(n,e,t,r){return new u4(n,e,t,r)}async function cC(n,e){const t=dt(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=yt();for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function d4(n,e){const t=dt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const f=c.batch,p=f.keys();let g=ke.resolve();return p.forEach(m=>{g=g.next(()=>u.getEntry(l,m)).next(v=>{const _=c.docVersions.get(m);Ut(_!==null),v.version.compareTo(_)<0&&(f.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=yt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function uC(n){const e=dt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function f4(n,e){const t=dt(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const a=[];e.targetChanges.forEach((u,f)=>{const p=i.get(f);if(!p)return;a.push(t.Ur.removeMatchingKeys(s,u.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(s,u.addedDocuments,f)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(Un.EMPTY_BYTE_STRING,ht.min()).withLastLimboFreeSnapshotVersion(ht.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,r)),i=i.insert(f,g),function(v,_,D){return v.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:D.addedDocuments.size+D.modifiedDocuments.size+D.removedDocuments.size>0}(p,g,u)&&a.push(t.Ur.updateTargetData(s,g))});let l=Rs(),c=yt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(p4(s,o,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!r.isEqual(ht.min())){const u=t.Ur.getLastRemoteSnapshotVersion(s).next(f=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return ke.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.os=i,s))}function p4(n,e,t){let r=yt(),i=yt();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Rs();return t.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ht.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Xe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function g4(n,e){const t=dt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function m4(n,e){const t=dt(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,ke.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new to(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function k0(n,e,t){const r=dt(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!gu(o))throw o;Xe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function t1(n,e,t){const r=dt(n);let i=ht.min(),s=yt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const f=dt(l),p=f._s.get(u);return p!==void 0?ke.resolve(f.os.get(p)):f.Ur.getTargetData(c,u)}(r,o,Li(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:ht.min(),t?s:yt())).next(a=>(v4(r,aM(e),a),{documents:a,Ts:s})))}function v4(n,e,t){let r=n.us.get(e)||ht.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class n1{constructor(){this.activeTargetIds=fM()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _4{constructor(){this.so=new n1,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new n1,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Xe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Xe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ah=null;function Rp(){return ah===null?ah=function(){return 268435456+Math.round(2147483648*Math.random())}():ah++,"0x"+ah.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er="WebChannelConnection";class w4 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const a=Rp(),l=this.xo(t,r.toUriEncodedString());Xe("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(t,l,c,i).then(u=>(Xe("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw Yo("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",l,"request:",i),u})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Il}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=E4[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=Rp();return new Promise((o,a)=>{const l=new CA;l.setWithCredentials(!0),l.listenOnce(SA.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Lh.NO_ERROR:const u=l.getResponseJson();Xe(er,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case Lh.TIMEOUT:Xe(er,`RPC '${e}' ${s} timed out`),a(new ze(xe.DEADLINE_EXCEEDED,"Request time out"));break;case Lh.HTTP_ERROR:const f=l.getStatus();if(Xe(er,`RPC '${e}' ${s} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const m=function(_){const D=_.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(D)>=0?D:xe.UNKNOWN}(g.status);a(new ze(m,g.message))}else a(new ze(xe.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ze(xe.UNAVAILABLE,"Connection failed."));break;default:ct()}}finally{Xe(er,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Xe(er,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",c,r,15)})}Bo(e,t,r){const i=Rp(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=RA(),a=xA(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=s.join("");Xe(er,`Creating RPC '${e}' stream ${i}: ${u}`,l);const f=o.createWebChannel(u,l);let p=!1,g=!1;const m=new T4({Io:_=>{g?Xe(er,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(p||(Xe(er,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),Xe(er,`RPC '${e}' stream ${i} sending:`,_),f.send(_))},To:()=>f.close()}),v=(_,D,b)=>{_.listen(D,T=>{try{b(T)}catch(R){setTimeout(()=>{throw R},0)}})};return v(f,rc.EventType.OPEN,()=>{g||(Xe(er,`RPC '${e}' stream ${i} transport opened.`),m.yo())}),v(f,rc.EventType.CLOSE,()=>{g||(g=!0,Xe(er,`RPC '${e}' stream ${i} transport closed`),m.So())}),v(f,rc.EventType.ERROR,_=>{g||(g=!0,Yo(er,`RPC '${e}' stream ${i} transport errored:`,_),m.So(new ze(xe.UNAVAILABLE,"The operation could not be completed")))}),v(f,rc.EventType.MESSAGE,_=>{var D;if(!g){const b=_.data[0];Ut(!!b);const T=b,R=T.error||((D=T[0])===null||D===void 0?void 0:D.error);if(R){Xe(er,`RPC '${e}' stream ${i} received error:`,R);const B=R.status;let W=function(E){const C=yn[E];if(C!==void 0)return ZA(C)}(B),A=R.message;W===void 0&&(W=xe.INTERNAL,A="Unknown error status: "+B+" with message "+R.message),g=!0,m.So(new ze(W,A)),f.close()}else Xe(er,`RPC '${e}' stream ${i} received:`,b),m.bo(b)}}),v(a,IA.STAT_EVENT,_=>{_.stat===y0.PROXY?Xe(er,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===y0.NOPROXY&&Xe(er,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}function bp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(n){return new OM(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&Xe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,t,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new hC(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===xe.RESOURCE_EXHAUSTED?(xs(t.toString()),xs("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new ze(xe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Xe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(Xe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class A4 extends dC{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=MM(this.serializer,e),r=function(s){if(!("targetChange"in s))return ht.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ht.min():o.readTime?Ui(o.readTime):ht.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=b0(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=A0(l)?{documents:UM(s,l)}:{query:BM(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=nC(s,o.resumeToken);const c=I0(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ht.min())>0){a.readTime=hd(s,o.snapshotVersion.toTimestamp());const c=I0(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=HM(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=b0(this.serializer),t.removeTarget=e,this.a_(t)}}class C4 extends dC{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ut(!!e.streamToken),this.lastStreamToken=e.streamToken,Ut(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ut(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=LM(e.writeResults,e.commitTime),r=Ui(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=b0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>FM(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4 extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ze(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,x0(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ze(xe.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,x0(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ze(xe.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class I4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(xs(t),this.D_=!1):Xe("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{ua(this)&&(Xe("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=dt(l);c.L_.add(4),await _u(c),c.q_.set("Unknown"),c.L_.delete(4),await mf(c)}(this))})}),this.q_=new I4(r,i)}}async function mf(n){if(ua(n))for(const e of n.B_)await e(!0)}async function _u(n){for(const e of n.B_)await e(!1)}function fC(n,e){const t=dt(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),sm(t)?im(t):bl(t).r_()&&rm(t,e))}function nm(n,e){const t=dt(n),r=bl(t);t.N_.delete(e),r.r_()&&pC(t,e),t.N_.size===0&&(r.r_()?r.o_():ua(t)&&t.q_.set("Unknown"))}function rm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ht.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}bl(n).A_(e)}function pC(n,e){n.Q_.xe(e),bl(n).R_(e)}function im(n){n.Q_=new RM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),bl(n).start(),n.q_.v_()}function sm(n){return ua(n)&&!bl(n).n_()&&n.N_.size>0}function ua(n){return dt(n).L_.size===0}function gC(n){n.Q_=void 0}async function R4(n){n.q_.set("Online")}async function b4(n){n.N_.forEach((e,t)=>{rm(n,e)})}async function k4(n,e){gC(n),sm(n)?(n.q_.M_(e),im(n)):n.q_.set("Unknown")}async function P4(n,e,t){if(n.q_.set("Online"),e instanceof tC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(n,e)}catch(r){Xe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await dd(n,r)}else if(e instanceof Vh?n.Q_.Ke(e):e instanceof eC?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ht.min()))try{const r=await uC(n.localStore);t.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.N_.get(c);u&&s.N_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=s.N_.get(l);if(!u)return;s.N_.set(l,u.withResumeToken(Un.EMPTY_BYTE_STRING,u.snapshotVersion)),pC(s,l);const f=new to(u.target,l,c,u.sequenceNumber);rm(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){Xe("RemoteStore","Failed to raise snapshot:",r),await dd(n,r)}}async function dd(n,e,t){if(!gu(e))throw e;n.L_.add(1),await _u(n),n.q_.set("Offline"),t||(t=()=>uC(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Xe("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await mf(n)})}function mC(n,e){return e().catch(t=>dd(n,t,e))}async function vf(n){const e=dt(n),t=mo(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;O4(e);)try{const i=await g4(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,N4(e,i)}catch(i){await dd(e,i)}vC(e)&&_C(e)}function O4(n){return ua(n)&&n.O_.length<10}function N4(n,e){n.O_.push(e);const t=mo(n);t.r_()&&t.V_&&t.m_(e.mutations)}function vC(n){return ua(n)&&!mo(n).n_()&&n.O_.length>0}function _C(n){mo(n).start()}async function D4(n){mo(n).p_()}async function M4(n){const e=mo(n);for(const t of n.O_)e.m_(t.mutations)}async function F4(n,e,t){const r=n.O_.shift(),i=Qg.from(r,e,t);await mC(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await vf(n)}async function L4(n,e){e&&mo(n).V_&&await async function(r,i){if(function(o){return SM(o)&&o!==xe.ABORTED}(i.code)){const s=r.O_.shift();mo(r).s_(),await mC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await vf(r)}}(n,e),vC(n)&&_C(n)}async function i1(n,e){const t=dt(n);t.asyncQueue.verifyOperationInProgress(),Xe("RemoteStore","RemoteStore received new credentials");const r=ua(t);t.L_.add(3),await _u(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await mf(t)}async function U4(n,e){const t=dt(n);e?(t.L_.delete(2),await mf(t)):e||(t.L_.add(2),await _u(t),t.q_.set("Unknown"))}function bl(n){return n.K_||(n.K_=function(t,r,i){const s=dt(t);return s.w_(),new A4(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:R4.bind(null,n),Ro:b4.bind(null,n),mo:k4.bind(null,n),d_:P4.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),sm(n)?im(n):n.q_.set("Unknown")):(await n.K_.stop(),gC(n))})),n.K_}function mo(n){return n.U_||(n.U_=function(t,r,i){const s=dt(t);return s.w_(),new C4(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:D4.bind(null,n),mo:L4.bind(null,n),f_:M4.bind(null,n),g_:F4.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await vf(n)):(await n.U_.stop(),n.O_.length>0&&(Xe("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new om(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ze(xe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function am(n,e){if(xs("AsyncQueue",`${e}: ${n}`),gu(n))return new ze(xe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e){this.comparator=e?(t,r)=>e(t,r)||et.comparator(t.key,r.key):(t,r)=>et.comparator(t.key,r.key),this.keyedMap=ic(),this.sortedSet=new sn(this.comparator)}static emptySet(e){return new Xa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Xa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(){this.W_=new sn(et.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ct():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class fl{constructor(e,t,r,i,s,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new fl(e,t,Xa.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class V4{constructor(){this.queries=o1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=dt(t),s=i.queries;i.queries=o1(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new ze(xe.ABORTED,"Firestore shutting down"))}}function o1(){return new Rl(n=>HA(n),uf)}async function lm(n,e){const t=dt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new B4,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=am(o,`Initialization of query '${Pa(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&um(t)}async function cm(n,e){const t=dt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function H4(n,e){const t=dt(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&um(t)}function $4(n,e,t){const r=dt(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function um(n){n.Y_.forEach(e=>{e.next()})}var P0,a1;(a1=P0||(P0={})).ea="default",a1.Cache="cache";class hm{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new fl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=fl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==P0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.key=e}}class EC{constructor(e){this.key=e}}class K4{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=yt(),this.mutatedKeys=yt(),this.Aa=$A(e),this.Ra=new Xa(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new s1,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,f)=>{const p=i.get(u),g=hf(this.query,f)?f:null,m=!!p&&this.mutatedKeys.has(p.key),v=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let _=!1;p&&g?p.data.isEqual(g.data)?m!==v&&(r.track({type:3,doc:g}),_=!0):this.ga(p,g)||(r.track({type:2,doc:g}),_=!0,(l&&this.Aa(g,l)>0||c&&this.Aa(g,c)<0)&&(a=!0)):!p&&g?(r.track({type:0,doc:g}),_=!0):p&&!g&&(r.track({type:1,doc:p}),_=!0,(l||c)&&(a=!0)),_&&(g?(o=o.add(g),s=v?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,f)=>function(g,m){const v=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ct()}};return v(g)-v(m)}(u.type,f.type)||this.Aa(u.doc,f.doc)),this.pa(r),i=i!=null&&i;const a=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new fl(this.query,e.Ra,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new s1,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=yt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new EC(r))}),this.da.forEach(r=>{e.has(r)||t.push(new yC(r))}),t}ba(e){this.Ta=e.Ts,this.da=yt();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return fl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class j4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class W4{constructor(e){this.key=e,this.va=!1}}class G4{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Rl(a=>HA(a),uf),this.Ma=new Map,this.xa=new Set,this.Oa=new sn(et.comparator),this.Na=new Map,this.La=new Zg,this.Ba={},this.ka=new Map,this.qa=dl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function q4(n,e,t=!0){const r=IC(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await TC(r,e,t,!0),i}async function z4(n,e){const t=IC(n);await TC(t,e,!0,!1)}async function TC(n,e,t,r){const i=await m4(n.localStore,Li(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return r&&(a=await Y4(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&fC(n.remoteStore,i),a}async function Y4(n,e,t,r,i){n.Ka=(f,p,g)=>async function(v,_,D,b){let T=_.view.ma(D);T.ns&&(T=await t1(v.localStore,_.query,!1).then(({documents:A})=>_.view.ma(A,T)));const R=b&&b.targetChanges.get(_.targetId),B=b&&b.targetMismatches.get(_.targetId)!=null,W=_.view.applyChanges(T,v.isPrimaryClient,R,B);return c1(v,_.targetId,W.wa),W.snapshot}(n,f,p,g);const s=await t1(n.localStore,e,!0),o=new K4(e,s.Ts),a=o.ma(s.documents),l=vu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=o.applyChanges(a,n.isPrimaryClient,l);c1(n,t,c.wa);const u=new j4(e,t,o);return n.Fa.set(e,u),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function Q4(n,e,t){const r=dt(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!uf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await k0(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&nm(r.remoteStore,i.targetId),O0(r,i.targetId)}).catch(pu)):(O0(r,i.targetId),await k0(r.localStore,i.targetId,!0))}async function X4(n,e){const t=dt(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),nm(t.remoteStore,r.targetId))}async function J4(n,e,t){const r=sF(n);try{const i=await function(o,a){const l=dt(o),c=Tn.now(),u=a.reduce((g,m)=>g.add(m.key),yt());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let m=Rs(),v=yt();return l.cs.getEntries(g,u).next(_=>{m=_,m.forEach((D,b)=>{b.isValidDocument()||(v=v.add(D))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,m)).next(_=>{f=_;const D=[];for(const b of a){const T=EM(b,f.get(b.key).overlayedDocument);T!=null&&D.push(new wo(b.key,T,NA(T.value.mapValue),pi.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,D,a)}).next(_=>{p=_;const D=_.applyToLocalDocumentSet(f,v);return l.documentOverlayCache.saveOverlays(g,_.batchId,D)})}).then(()=>({batchId:p.batchId,changes:jA(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new sn(Rt)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,t),await yu(r,i.changes),await vf(r.remoteStore)}catch(i){const s=am(i,"Failed to persist write");t.reject(s)}}async function wC(n,e){const t=dt(n);try{const r=await f4(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(Ut(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Ut(o.va):i.removedDocuments.size>0&&(Ut(o.va),o.va=!1))}),await yu(t,r,e)}catch(r){await pu(r)}}function l1(n,e,t){const r=dt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=dt(o);l.onlineState=a;let c=!1;l.queries.forEach((u,f)=>{for(const p of f.j_)p.Z_(a)&&(c=!0)}),c&&um(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Z4(n,e,t){const r=dt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new sn(et.comparator);o=o.insert(s,sr.newNoDocument(s,ht.min()));const a=yt().add(s),l=new pf(ht.min(),new Map,new sn(Rt),o,a);await wC(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),dm(r)}else await k0(r.localStore,e,!1).then(()=>O0(r,e,t)).catch(pu)}async function eF(n,e){const t=dt(n),r=e.batch.batchId;try{const i=await d4(t.localStore,e);CC(t,r,null),AC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await yu(t,i)}catch(i){await pu(i)}}async function tF(n,e,t){const r=dt(n);try{const i=await function(o,a){const l=dt(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Ut(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);CC(r,e,t),AC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await yu(r,i)}catch(i){await pu(i)}}function AC(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function CC(n,e,t){const r=dt(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function O0(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||SC(n,r)})}function SC(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(nm(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),dm(n))}function c1(n,e,t){for(const r of t)r instanceof yC?(n.La.addReference(r.key,e),nF(n,r)):r instanceof EC?(Xe("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||SC(n,r.key)):ct()}function nF(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(Xe("SyncEngine","New document in limbo: "+t),n.xa.add(r),dm(n))}function dm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new et(Jt.fromString(e)),r=n.qa.next();n.Na.set(r,new W4(t)),n.Oa=n.Oa.insert(t,r),fC(n.remoteStore,new to(Li(cf(t.path)),r,"TargetPurposeLimboResolution",$g.oe))}}async function yu(n,e,t){const r=dt(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(c=>{var u;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){i.push(c);const f=tm.Wi(l.targetId,c);s.push(f)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,c){const u=dt(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ke.forEach(c,p=>ke.forEach(p.$i,g=>u.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>ke.forEach(p.Ui,g=>u.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!gu(f))throw f;Xe("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const p=f.targetId;if(!f.fromCache){const g=u.os.get(p),m=g.snapshotVersion,v=g.withLastLimboFreeSnapshotVersion(m);u.os=u.os.insert(p,v)}}}(r.localStore,s))}async function rF(n,e){const t=dt(n);if(!t.currentUser.isEqual(e)){Xe("SyncEngine","User change. New user:",e.toKey());const r=await cC(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new ze(xe.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await yu(t,r.hs)}}function iF(n,e){const t=dt(n),r=t.Na.get(e);if(r&&r.va)return yt().add(r.key);{let i=yt();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function IC(n){const e=dt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=wC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Z4.bind(null,e),e.Ca.d_=H4.bind(null,e.eventManager),e.Ca.$a=$4.bind(null,e.eventManager),e}function sF(n){const e=dt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tF.bind(null,e),e}class fd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return h4(this.persistence,new c4,e.initialUser,this.serializer)}Ga(e){return new o4(em.Zr,this.serializer)}Wa(e){return new _4}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fd.provider={build:()=>new fd};class N0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>l1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=rF.bind(null,this.syncEngine),await U4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new V4}()}createDatastore(e){const t=gf(e.databaseInfo.databaseId),r=function(s){return new w4(s)}(e.databaseInfo);return function(s,o,a,l){return new S4(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new x4(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>l1(this.syncEngine,t,0),function(){return r1.D()?new r1:new y4}())}createSyncEngine(e,t){return function(i,s,o,a,l,c,u){const f=new G4(i,s,o,a,l,c);return u&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=dt(i);Xe("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await _u(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}N0.provider={build:()=>new N0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):xs("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=rr.UNAUTHENTICATED,this.clientId=Hg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Xe("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Xe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=am(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function kp(n,e){n.asyncQueue.verifyOperationInProgress(),Xe("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await cC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function u1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await aF(n);Xe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>i1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>i1(e.remoteStore,i)),n._onlineComponents=e}async function aF(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Xe("FirestoreClient","Using user provided OfflineComponentProvider");try{await kp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===xe.FAILED_PRECONDITION||i.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Yo("Error using user provided cache. Falling back to memory cache: "+t),await kp(n,new fd)}}else Xe("FirestoreClient","Using default OfflineComponentProvider"),await kp(n,new fd);return n._offlineComponents}async function xC(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Xe("FirestoreClient","Using user provided OnlineComponentProvider"),await u1(n,n._uninitializedComponentsProvider._online)):(Xe("FirestoreClient","Using default OnlineComponentProvider"),await u1(n,new N0))),n._onlineComponents}function lF(n){return xC(n).then(e=>e.syncEngine)}async function pd(n){const e=await xC(n),t=e.eventManager;return t.onListen=q4.bind(null,e.syncEngine),t.onUnlisten=Q4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=z4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=X4.bind(null,e.syncEngine),t}function cF(n,e,t={}){const r=new gs;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const u=new fm({next:p=>{u.Za(),o.enqueueAndForget(()=>cm(s,f));const g=p.docs.has(a);!g&&p.fromCache?c.reject(new ze(xe.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?c.reject(new ze(xe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),f=new hm(cf(a.path),u,{includeMetadataChanges:!0,_a:!0});return lm(s,f)}(await pd(n),n.asyncQueue,e,t,r)),r.promise}function uF(n,e,t={}){const r=new gs;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const u=new fm({next:p=>{u.Za(),o.enqueueAndForget(()=>cm(s,f)),p.fromCache&&l.source==="server"?c.reject(new ze(xe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),f=new hm(a,u,{includeMetadataChanges:!0,_a:!0});return lm(s,f)}(await pd(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(n,e,t){if(!t)throw new ze(xe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function kC(n,e,t,r){if(e===!0&&r===!0)throw new ze(xe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function d1(n){if(!et.isDocumentKey(n))throw new ze(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function f1(n){if(et.isDocumentKey(n))throw new ze(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function _f(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ct()}function Rr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ze(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=_f(n);throw new ze(xe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ze(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ze(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RC((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ze(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ze(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ze(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class yf{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new p1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ze(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ze(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new p1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new kA;switch(r.type){case"firstParty":return new ND(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ze(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=h1.get(t);r&&(Xe("ComponentProvider","Removing Datastore"),h1.delete(t),r.terminate())}(this),Promise.resolve()}}function PC(n,e,t,r={}){var i;const s=(n=Rr(n,yf))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Yo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=rr.MOCK_USER;else{a=oP(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new ze(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new rr(c)}n._authCredentials=new kD(new bA(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ds(this.firestore,e,this._query)}}class Yn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yn(this.firestore,e,this._key)}}class ms extends Ds{constructor(e,t,r){super(e,t,cf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yn(this.firestore,null,new et(e))}withConverter(e){return new ms(this.firestore,e,this._path)}}function Pn(n,e,...t){if(n=Ln(n),bC("collection","path",e),n instanceof yf){const r=Jt.fromString(e,...t);return f1(r),new ms(n,null,r)}{if(!(n instanceof Yn||n instanceof ms))throw new ze(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Jt.fromString(e,...t));return f1(r),new ms(n.firestore,null,r)}}function co(n,e,...t){if(n=Ln(n),arguments.length===1&&(e=Hg.newId()),bC("doc","path",e),n instanceof yf){const r=Jt.fromString(e,...t);return d1(r),new Yn(n,null,new et(r))}{if(!(n instanceof Yn||n instanceof ms))throw new ze(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Jt.fromString(e,...t));return d1(r),new Yn(n.firestore,n instanceof ms?n.converter:null,new et(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new hC(this,"async_queue_retry"),this.Vu=()=>{const r=bp();r&&Xe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=bp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=bp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new gs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!gu(e))throw e;Xe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw xs("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=om.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ct()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function m1(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class bs extends yf{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new g1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new g1(e),this._firestoreClient=void 0,await e}}}function pm(n,e){const t=typeof n=="object"?n:$w(),r=typeof n=="string"?n:"(default)",i=bg(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=iP("firestore");s&&PC(i,...s)}return i}function Eu(n){if(n._terminated)throw new ze(xe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||hF(n),n._firestoreClient}function hF(n){var e,t,r;const i=n._freezeSettings(),s=function(a,l,c,u){return new GD(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,RC(u.experimentalLongPollingOptions),u.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new oF(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jo(Un.fromBase64String(e))}catch(t){throw new ze(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jo(Un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ze(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ze(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ze(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Rt(this._lat,e._lat)||Rt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF=/^__.*__$/;class fF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new wo(e,this.data,this.fieldMask,t,this.fieldTransforms):new mu(e,this.data,t,this.fieldTransforms)}}class OC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new wo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function NC(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ct()}}class gm{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new gm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return gd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(NC(this.Cu)&&dF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class pF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||gf(e)}Qu(e,t,r,i=!1){return new gm({Cu:e,methodName:t,qu:r,path:Nn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mm(n){const e=n._freezeSettings(),t=gf(n._databaseId);return new pF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function gF(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);vm("Data must be an object, but it was:",o,r);const a=DC(r,o);let l,c;if(s.merge)l=new qr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const f of s.mergeFields){const p=D0(e,f,t);if(!o.contains(p))throw new ze(xe.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);FC(u,p)||u.push(p)}l=new qr(u),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new fF(new Ir(a),l,c)}class Af extends Ef{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Af}}function mF(n,e,t,r){const i=n.Qu(1,e,t);vm("Data must be an object, but it was:",i,r);const s=[],o=Ir.empty();ca(r,(l,c)=>{const u=_m(e,l,t);c=Ln(c);const f=i.Nu(u);if(c instanceof Af)s.push(u);else{const p=wu(c,f);p!=null&&(s.push(u),o.set(u,p))}});const a=new qr(s);return new OC(o,a,i.fieldTransforms)}function vF(n,e,t,r,i,s){const o=n.Qu(1,e,t),a=[D0(e,r,t)],l=[i];if(s.length%2!=0)throw new ze(xe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(D0(e,s[p])),l.push(s[p+1]);const c=[],u=Ir.empty();for(let p=a.length-1;p>=0;--p)if(!FC(c,a[p])){const g=a[p];let m=l[p];m=Ln(m);const v=o.Nu(g);if(m instanceof Af)c.push(g);else{const _=wu(m,v);_!=null&&(c.push(g),u.set(g,_))}}const f=new qr(c);return new OC(u,f,o.fieldTransforms)}function _F(n,e,t,r=!1){return wu(t,n.Qu(r?4:3,e))}function wu(n,e){if(MC(n=Ln(n)))return vm("Unsupported field value:",e,n),DC(n,e);if(n instanceof Ef)return function(r,i){if(!NC(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=wu(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Ln(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pM(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Tn.fromDate(r);return{timestampValue:hd(i.serializer,s)}}if(r instanceof Tn){const s=new Tn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:hd(i.serializer,s)}}if(r instanceof Tf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jo)return{bytesValue:nC(i.serializer,r._byteString)};if(r instanceof Yn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Jg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof wf)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return zg(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${_f(r)}`)}(n,e)}function DC(n,e){const t={};return PA(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ca(n,(r,i)=>{const s=wu(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function MC(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Tn||n instanceof Tf||n instanceof Jo||n instanceof Yn||n instanceof Ef||n instanceof wf)}function vm(n,e,t){if(!MC(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=_f(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function D0(n,e,t){if((e=Ln(e))instanceof Tu)return e._internalPath;if(typeof e=="string")return _m(n,e);throw gd("Field path arguments must be of type string or ",n,!1,void 0,t)}const yF=new RegExp("[~\\*/\\[\\]]");function _m(n,e,t){if(e.search(yF)>=0)throw gd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Tu(...e.split("."))._internalPath}catch{throw gd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function gd(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ze(xe.INVALID_ARGUMENT,a+n+l)}function FC(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new EF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Cf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class EF extends LC{data(){return super.data()}}function Cf(n,e){return typeof e=="string"?_m(n,e):e instanceof Tu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ze(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ym{}class Em extends ym{}function ei(n,e,...t){let r=[];e instanceof ym&&r.push(e),r=r.concat(t),function(s){const o=s.filter(l=>l instanceof Sf).length,a=s.filter(l=>l instanceof Au).length;if(o>1||o>0&&a>0)throw new ze(xe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class Au extends Em{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Au(e,t,r)}_apply(e){const t=this._parse(e);return VC(e._query,t),new Ds(e.firestore,e.converter,C0(e._query,t))}_parse(e){const t=mm(e.firestore);return function(s,o,a,l,c,u,f){let p;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ze(xe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){_1(f,u);const g=[];for(const m of f)g.push(v1(l,s,m));p={arrayValue:{values:g}}}else p=v1(l,s,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||_1(f,u),p=_F(a,o,f,u==="in"||u==="not-in");return En.create(c,u,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Vr(n,e,t){const r=e,i=Cf("where",n);return Au._create(i,r,t)}class Sf extends ym{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Sf(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:yi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)VC(o,l),o=C0(o,l)}(e._query,t),new Ds(e.firestore,e.converter,C0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class If extends Em{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new If(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new ze(xe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ze(xe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Wc(s,o)}(e._query,this._field,this._direction);return new Ds(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new xl(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function BC(n,e="asc"){const t=e,r=Cf("orderBy",n);return If._create(r,t)}function v1(n,e,t){if(typeof(t=Ln(t))=="string"){if(t==="")throw new ze(xe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!VA(e)&&t.indexOf("/")!==-1)throw new ze(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Jt.fromString(t));if(!et.isDocumentKey(r))throw new ze(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Uy(n,new et(r))}if(t instanceof Yn)return Uy(n,t._key);throw new ze(xe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_f(t)}.`)}function _1(n,e){if(!Array.isArray(n)||n.length===0)throw new ze(xe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VC(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ze(xe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ze(xe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class HC{convertValue(e,t="none"){switch(Xo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Qo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ct()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ca(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>hn(o.doubleValue));return new wf(s)}convertGeoPoint(e){return new Tf(hn(e.latitude),hn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=jg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Kc(e));default:return null}}convertTimestamp(e){const t=go(e);return new Tn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Jt.fromString(e);Ut(lC(r));const i=new cl(r.get(1),r.get(3)),s=new et(r.popFirst(5));return i.isEqual(t)||xs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(n,e,t){let r;return r=n?n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Tm extends LC{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Cf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class wc extends Tm{data(e={}){return super.data(e)}}class wm{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Va(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wc(this._firestore,this._userDataWriter,r.key,r,new Va(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ze(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new wc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Va(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new wc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Va(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:wF(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function wF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ct()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(n){n=Rr(n,Yn);const e=Rr(n.firestore,bs);return cF(Eu(e),n._key).then(t=>jC(e,n,t))}class Cm extends HC{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yn(this.firestore,null,t)}}function Wn(n){n=Rr(n,Ds);const e=Rr(n.firestore,bs),t=Eu(e),r=new Cm(e);return UC(n._query),uF(t,n._query).then(i=>new wm(e,r,n,i))}function $C(n,e,t){n=Rr(n,Yn);const r=Rr(n.firestore,bs),i=TF(n.converter,e);return Rf(r,[gF(mm(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,pi.none())])}function xf(n,e,t,...r){n=Rr(n,Yn);const i=Rr(n.firestore,bs),s=mm(i);let o;return o=typeof(e=Ln(e))=="string"||e instanceof Tu?vF(s,"updateDoc",n._key,e,t,r):mF(s,"updateDoc",n._key,e),Rf(i,[o.toMutation(n._key,pi.exists(!0))])}function AF(n){return Rf(Rr(n.firestore,bs),[new Yg(n._key,pi.none())])}function KC(n,...e){var t,r,i;n=Ln(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||m1(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(m1(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let l,c,u;if(n instanceof Yn)c=Rr(n.firestore,bs),u=cf(n._key.path),l={next:f=>{e[o]&&e[o](jC(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Rr(n,Ds);c=Rr(f.firestore,bs),u=f._query;const p=new Cm(c);l={next:g=>{e[o]&&e[o](new wm(c,p,f,g))},error:e[o+1],complete:e[o+2]},UC(n._query)}return function(p,g,m,v){const _=new fm(v),D=new hm(g,_,m);return p.asyncQueue.enqueueAndForget(async()=>lm(await pd(p),D)),()=>{_.Za(),p.asyncQueue.enqueueAndForget(async()=>cm(await pd(p),D))}}(Eu(c),u,a,l)}function Rf(n,e){return function(r,i){const s=new gs;return r.asyncQueue.enqueueAndForget(async()=>J4(await lF(r),i,s)),s.promise}(Eu(n),e)}function jC(n,e,t){const r=t.docs.get(e._key),i=new Cm(n);return new Tm(n,i,e._key,r,new Va(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Il=i})(Cl),al(new Go("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new bs(new PD(r.getProvider("auth-internal")),new MD(r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ze(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cl(c.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ao(Ny,"4.7.3",e),ao(Ny,"4.7.3","esm2017")})();const y1=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:HC,Bytes:Jo,CollectionReference:ms,DocumentReference:Yn,DocumentSnapshot:Tm,FieldPath:Tu,FieldValue:Ef,Firestore:bs,FirestoreError:ze,GeoPoint:Tf,Query:Ds,QueryCompositeFilterConstraint:Sf,QueryConstraint:Em,QueryDocumentSnapshot:wc,QueryFieldFilterConstraint:Au,QueryOrderByConstraint:If,QuerySnapshot:wm,SnapshotMetadata:Va,Timestamp:Tn,VectorValue:wf,_AutoId:Hg,_ByteString:Un,_DatabaseId:cl,_DocumentKey:et,_EmptyAuthCredentialsProvider:kA,_FieldPath:Nn,_cast:Rr,_logWarn:Yo,_validateIsNotUsedTogether:kC,collection:Pn,connectFirestoreEmulator:PC,deleteDoc:AF,doc:co,ensureFirestoreConfigured:Eu,executeWrite:Rf,getDoc:Am,getDocs:Wn,getFirestore:pm,onSnapshot:KC,orderBy:BC,query:ei,setDoc:$C,updateDoc:xf,where:Vr},Symbol.toStringTag,{value:"Module"}));var CF="firebase",SF="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ao(CF,SF,"app");const IF={apiKey:"AIzaSyCizwhrXubtiUaasWh8y-9u-plTltyT3v0",authDomain:"munkh-zaisan.firebaseapp.com",projectId:"munkh-zaisan",storageBucket:"munkh-zaisan.firebasestorage.app",messagingSenderId:"168681350058",appId:"1:168681350058:web:a6f34f9e5ee6362b2e01d3",measurementId:"G-BEWRJ14YC5"},WC=Hw(IF),Da=RD(WC),Xt=pm(WC),xF=new as;/*! @azure/msal-common v14.16.1 2025-08-05 */const Te={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},lh={CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},kl=[Te.OPENID_SCOPE,Te.PROFILE_SCOPE,Te.OFFLINE_ACCESS_SCOPE],E1=[...kl,Te.EMAIL_SCOPE],_r={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},bn={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},uo={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},ch={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},On={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},T1={PLAIN:"plain",S256:"S256"},Cu={QUERY:"query",FRAGMENT:"fragment"},RF={...Cu},GC={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},uh={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},or={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},ut={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},Sm="appmetadata",bF="client_info",Ac="1",md={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Lr={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Hn={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Ht={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Cc={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},w1={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},A1={username:"username",password:"password"},hh={httpSuccess:200,httpBadRequest:400},Ia={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Pp={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Gs={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},kF={Pop:"pop"},PF=300;/*! @azure/msal-common v14.16.1 2025-08-05 */const Im="unexpected_error",OF="post_request_failed";/*! @azure/msal-common v14.16.1 2025-08-05 */const C1={[Im]:"Unexpected error in authentication.",[OF]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Zt extends Error{constructor(e,t,r){const i=t?`${e}: ${t}`:e;super(i),Object.setPrototypeOf(this,Zt.prototype),this.errorCode=e||Te.EMPTY_STRING,this.errorMessage=t||Te.EMPTY_STRING,this.subError=r||Te.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function qC(n,e){return new Zt(n,e?`${C1[n]} ${e}`:C1[n])}/*! @azure/msal-common v14.16.1 2025-08-05 */const xm="client_info_decoding_error",zC="client_info_empty_error",Rm="token_parsing_error",YC="null_or_empty_token",is="endpoints_resolution_error",QC="network_error",XC="openid_config_error",JC="hash_not_deserialized",pl="invalid_state",ZC="state_mismatch",vd="state_not_found",eS="nonce_mismatch",bm="auth_time_not_found",tS="max_age_transpired",NF="multiple_matching_tokens",DF="multiple_matching_accounts",nS="multiple_matching_appMetadata",rS="request_cannot_be_made",iS="cannot_remove_empty_scope",sS="cannot_append_scopeset",M0="empty_input_scopeset",MF="device_code_polling_cancelled",FF="device_code_expired",LF="device_code_unknown_error",km="no_account_in_silent_request",oS="invalid_cache_record",Pm="invalid_cache_environment",F0="no_account_found",L0="no_crypto_object",U0="unexpected_credential_type",UF="invalid_assertion",BF="invalid_client_credential",hs="token_refresh_required",VF="user_timeout_reached",aS="token_claims_cnf_required_for_signedjwt",lS="authorization_code_missing_from_server_response",HF="binding_key_not_removed",cS="end_session_endpoint_not_supported",Om="key_id_missing",$F="no_network_connectivity",KF="user_canceled",jF="missing_tenant_id_error",vt="method_not_implemented",WF="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.16.1 2025-08-05 */const S1={[xm]:"The client info could not be parsed/decoded correctly",[zC]:"The client info was empty",[Rm]:"Token cannot be parsed",[YC]:"The token is null or empty",[is]:"Endpoints cannot be resolved",[QC]:"Network request failed",[XC]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[JC]:"The hash parameters could not be deserialized",[pl]:"State was not the expected format",[ZC]:"State mismatch error",[vd]:"State not found",[eS]:"Nonce mismatch error",[bm]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[tS]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[NF]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[DF]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[nS]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[rS]:"Token request cannot be made without authorization code or refresh token.",[iS]:"Cannot remove null or empty scope from ScopeSet",[sS]:"Cannot append ScopeSet",[M0]:"Empty input ScopeSet cannot be processed",[MF]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[FF]:"Device code is expired.",[LF]:"Device code stopped polling for unknown reasons.",[km]:"Please pass an account object, silent flow is not supported without account information",[oS]:"Cache record object was null or undefined.",[Pm]:"Invalid environment when attempting to create cache entry",[F0]:"No account found in cache for given key.",[L0]:"No crypto object detected.",[U0]:"Unexpected credential type.",[UF]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[BF]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[hs]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[VF]:"User defined timeout for device code polling reached",[aS]:"Cannot generate a POP jwt if the token_claims are not populated",[lS]:"Server response does not contain an authorization code to proceed",[HF]:"Could not remove the credential's binding key from storage.",[cS]:"The provided authority does not support logout",[Om]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[$F]:"No network connectivity. Check your internet connection.",[KF]:"User cancelled the flow.",[jF]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[vt]:"This method has not been implemented",[WF]:"The nested app auth bridge is disabled"};class bf extends Zt{constructor(e,t){super(e,t?`${S1[e]}: ${t}`:S1[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,bf.prototype)}}function Ne(n,e){return new bf(n,e)}/*! @azure/msal-common v14.16.1 2025-08-05 */const _d={createNewGuid:()=>{throw Ne(vt)},base64Decode:()=>{throw Ne(vt)},base64Encode:()=>{throw Ne(vt)},base64UrlEncode:()=>{throw Ne(vt)},encodeKid:()=>{throw Ne(vt)},async getPublicKeyThumbprint(){throw Ne(vt)},async removeTokenBindingKey(){throw Ne(vt)},async clearKeystore(){throw Ne(vt)},async signJwt(){throw Ne(vt)},async hashString(){throw Ne(vt)}};/*! @azure/msal-common v14.16.1 2025-08-05 */var nn;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(nn||(nn={}));class vo{constructor(e,t,r){this.level=nn.Info;const i=()=>{},s=e||vo.createDefaultLoggerOptions();this.localCallback=s.loggerCallback||i,this.piiLoggingEnabled=s.piiLoggingEnabled||!1,this.level=typeof s.logLevel=="number"?s.logLevel:nn.Info,this.correlationId=s.correlationId||Te.EMPTY_STRING,this.packageName=t||Te.EMPTY_STRING,this.packageVersion=r||Te.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:nn.Info}}clone(e,t,r){return new vo({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const s=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${nn[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,s,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:nn.Error,containsPii:!1,correlationId:t||Te.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:nn.Error,containsPii:!0,correlationId:t||Te.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:nn.Warning,containsPii:!1,correlationId:t||Te.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:nn.Warning,containsPii:!0,correlationId:t||Te.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:nn.Info,containsPii:!1,correlationId:t||Te.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:nn.Info,containsPii:!0,correlationId:t||Te.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:nn.Verbose,containsPii:!1,correlationId:t||Te.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:nn.Verbose,containsPii:!0,correlationId:t||Te.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:nn.Trace,containsPii:!1,correlationId:t||Te.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:nn.Trace,containsPii:!0,correlationId:t||Te.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.16.1 2025-08-05 */const uS="@azure/msal-common",Nm="14.16.1";/*! @azure/msal-common v14.16.1 2025-08-05 */const Dm={None:"none"};/*! @azure/msal-common v14.16.1 2025-08-05 */function ha(n,e){const t=GF(n);try{const r=e(t);return JSON.parse(r)}catch{throw Ne(Rm)}}function GF(n){if(!n)throw Ne(YC);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw Ne(Rm);return t[2]}function hS(n,e){if(e===0||Date.now()-3e5>n+e)throw Ne(tS)}/*! @azure/msal-common v14.16.1 2025-08-05 */function ji(){return Math.round(new Date().getTime()/1e3)}function B0(n,e){const t=Number(n)||0;return ji()+e>t}function qF(n){return Number(n)>ji()}/*! @azure/msal-common v14.16.1 2025-08-05 */function Ha(n){return[zF(n),YF(n),QF(n),XF(n),JF(n)].join(or.CACHE_KEY_SEPARATOR).toLowerCase()}function kf(n,e,t,r,i){return{credentialType:ut.ID_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t,realm:i}}function Pf(n,e,t,r,i,s,o,a,l,c,u,f,p,g,m){var _,D;const v={homeAccountId:n,credentialType:ut.ACCESS_TOKEN,secret:t,cachedAt:ji().toString(),expiresOn:o.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:i,target:s,tokenType:u||Ht.BEARER};if(f&&(v.userAssertionHash=f),c&&(v.refreshOn=c.toString()),g&&(v.requestedClaims=g,v.requestedClaimsHash=m),((_=v.tokenType)==null?void 0:_.toLowerCase())!==Ht.BEARER.toLowerCase())switch(v.credentialType=ut.ACCESS_TOKEN_WITH_AUTH_SCHEME,v.tokenType){case Ht.POP:const b=ha(t,l);if(!((D=b==null?void 0:b.cnf)!=null&&D.kid))throw Ne(aS);v.keyId=b.cnf.kid;break;case Ht.SSH:v.keyId=p}return v}function dS(n,e,t,r,i,s,o){const a={credentialType:ut.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t};return s&&(a.userAssertionHash=s),i&&(a.familyId=i),o&&(a.expiresOn=o.toString()),a}function Mm(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function I1(n){return n?Mm(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===ut.ACCESS_TOKEN||n.credentialType===ut.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function x1(n){return n?Mm(n)&&n.hasOwnProperty("realm")&&n.credentialType===ut.ID_TOKEN:!1}function R1(n){return n?Mm(n)&&n.credentialType===ut.REFRESH_TOKEN:!1}function zF(n){return[n.homeAccountId,n.environment].join(or.CACHE_KEY_SEPARATOR).toLowerCase()}function YF(n){const e=n.credentialType===ut.REFRESH_TOKEN&&n.familyId||n.clientId;return[n.credentialType,e,n.realm||""].join(or.CACHE_KEY_SEPARATOR).toLowerCase()}function QF(n){return(n.target||"").toLowerCase()}function XF(n){return(n.requestedClaimsHash||"").toLowerCase()}function JF(n){return n.tokenType&&n.tokenType.toLowerCase()!==Ht.BEARER.toLowerCase()?n.tokenType.toLowerCase():""}function ZF(n,e){const t=n.indexOf(Hn.CACHE_KEY)===0;let r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&r}function eL(n,e){let t=!1;n&&(t=n.indexOf(Cc.THROTTLING_PREFIX)===0);let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),t&&r}function tL({environment:n,clientId:e}){return[Sm,n,e].join(or.CACHE_KEY_SEPARATOR).toLowerCase()}function nL(n,e){return e?n.indexOf(Sm)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function rL(n,e){return e?n.indexOf(md.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function b1(){return ji()+md.REFRESH_TIME_SECONDS}function dh(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function Op(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function k1(n){return n.expiresAt<=ji()}/*! @azure/msal-common v14.16.1 2025-08-05 */const fS="redirect_uri_empty",iL="claims_request_parsing_error",pS="authority_uri_insecure",oc="url_parse_error",gS="empty_url_error",mS="empty_input_scopes_error",vS="invalid_prompt_value",Fm="invalid_claims",_S="token_request_empty",yS="logout_request_empty",ES="invalid_code_challenge_method",Lm="pkce_params_missing",Um="invalid_cloud_discovery_metadata",TS="invalid_authority_metadata",wS="untrusted_authority",Of="missing_ssh_jwk",AS="missing_ssh_kid",sL="missing_nonce_authentication_header",oL="invalid_authentication_header",CS="cannot_set_OIDCOptions",SS="cannot_allow_native_broker",IS="authority_mismatch";/*! @azure/msal-common v14.16.1 2025-08-05 */const aL={[fS]:"A redirect URI is required for all calls, and none has been set.",[iL]:"Could not parse the given claims request object.",[pS]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[oc]:"URL could not be parsed into appropriate segments.",[gS]:"URL was empty or null.",[mS]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[vS]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Fm]:"Given claims parameter must be a stringified JSON object.",[_S]:"Token request was empty and not found in cache.",[yS]:"The logout request was null or undefined.",[ES]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Lm]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Um]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[TS]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[wS]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Of]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[AS]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[sL]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[oL]:"Invalid authentication header provided",[CS]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[SS]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[IS]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Bm extends Zt{constructor(e){super(e,aL[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Bm.prototype)}}function Gt(n){return new Bm(n)}/*! @azure/msal-common v14.16.1 2025-08-05 */class gi{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),i=s=>decodeURIComponent(s.replace(/\+/g," "));return r.forEach(s=>{if(s.trim()){const[o,a]=s.split(/=(.+)/g,2);o&&a&&(t[i(o)]=i(a))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class dn{constructor(e){const t=e?gi.trimArrayEntries([...e]):[],r=t?gi.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(i=>this.scopes.add(i))}static fromString(e){const r=(e||Te.EMPTY_STRING).split(" ");return new dn(r)}static createSearchScopes(e){const t=new dn(e);return t.containsOnlyOIDCScopes()?t.removeScope(Te.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Gt(mS)}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new dn(t);return e?r.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return E1.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw Ne(sS)}}removeScope(e){if(!e)throw Ne(iS);this.scopes.delete(e.trim())}removeOIDCScopes(){E1.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw Ne(M0);const t=new Set;return e.scopes.forEach(r=>t.add(r.toLowerCase())),this.scopes.forEach(r=>t.add(r.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw Ne(M0);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),i=this.getScopeCount();return t.size<i+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):Te.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.16.1 2025-08-05 */function yd(n,e){if(!n)throw Ne(zC);try{const t=e(n);return JSON.parse(t)}catch{throw Ne(xm)}}function $a(n){if(!n)throw Ne(xm);const e=n.split(or.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?Te.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.16.1 2025-08-05 */function Ed(n,e){return!!n&&!!e&&n===e.split(".")[1]}function Vm(n,e,t,r){if(r){const{oid:i,sub:s,tid:o,name:a,tfp:l,acr:c}=r,u=o||l||c||"";return{tenantId:u,localAccountId:i||s||"",name:a,isHomeTenant:Ed(u,n)}}else return{tenantId:t,localAccountId:e,isHomeTenant:Ed(t,n)}}function Hm(n,e,t,r){let i=n;if(e){const{isHomeTenant:s,...o}=e;i={...n,...o}}if(t){const{isHomeTenant:s,...o}=Vm(n.homeAccountId,n.localAccountId,n.tenantId,t);return i={...i,...o,idTokenClaims:t,idToken:r},i}return i}/*! @azure/msal-common v14.16.1 2025-08-05 */const li={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.16.1 2025-08-05 */function xS(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v14.16.1 2025-08-05 */const vs={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.16.1 2025-08-05 */class Rn{generateAccountId(){return[this.homeAccountId,this.environment].join(or.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Rn.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(or.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){var c,u,f,p,g,m;const i=new Rn;t.authorityType===li.Adfs?i.authorityType=uh.ADFS_ACCOUNT_TYPE:t.protocolMode===vs.AAD?i.authorityType=uh.MSSTS_ACCOUNT_TYPE:i.authorityType=uh.GENERIC_ACCOUNT_TYPE;let s;e.clientInfo&&r&&(s=yd(e.clientInfo,r)),i.clientInfo=e.clientInfo,i.homeAccountId=e.homeAccountId,i.nativeAccountId=e.nativeAccountId;const o=e.environment||t&&t.getPreferredCache();if(!o)throw Ne(Pm);i.environment=o,i.realm=(s==null?void 0:s.utid)||xS(e.idTokenClaims)||"",i.localAccountId=(s==null?void 0:s.uid)||((c=e.idTokenClaims)==null?void 0:c.oid)||((u=e.idTokenClaims)==null?void 0:u.sub)||"";const a=((f=e.idTokenClaims)==null?void 0:f.preferred_username)||((p=e.idTokenClaims)==null?void 0:p.upn),l=(g=e.idTokenClaims)!=null&&g.emails?e.idTokenClaims.emails[0]:null;if(i.username=a||l||"",i.name=((m=e.idTokenClaims)==null?void 0:m.name)||"",i.cloudGraphHostName=e.cloudGraphHostName,i.msGraphHost=e.msGraphHost,e.tenantProfiles)i.tenantProfiles=e.tenantProfiles;else{const v=Vm(e.homeAccountId,i.localAccountId,i.realm,e.idTokenClaims);i.tenantProfiles=[v]}return i}static createFromAccountInfo(e,t,r){var s;const i=new Rn;return i.authorityType=e.authorityType||uh.GENERIC_ACCOUNT_TYPE,i.homeAccountId=e.homeAccountId,i.localAccountId=e.localAccountId,i.nativeAccountId=e.nativeAccountId,i.realm=e.tenantId,i.environment=e.environment,i.username=e.username,i.name=e.name,i.cloudGraphHostName=t,i.msGraphHost=r,i.tenantProfiles=Array.from(((s=e.tenantProfiles)==null?void 0:s.values())||[]),i}static generateHomeAccountId(e,t,r,i,s){if(!(t===li.Adfs||t===li.Dsts)){if(e)try{const o=yd(e,i.base64Decode);if(o.uid&&o.utid)return`${o.uid}.${o.utid}`}catch{}r.warning("No client info in response")}return(s==null?void 0:s.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let i=!0;if(r){const s=e.idTokenClaims||{},o=t.idTokenClaims||{};i=s.iat===o.iat&&s.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i}}/*! @azure/msal-common v14.16.1 2025-08-05 */function RS(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function Td(n){if(!n||n.indexOf("=")<0)return null;try{const e=RS(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw Ne(JC)}return null}/*! @azure/msal-common v14.16.1 2025-08-05 */class Ct{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Gt(gS);e.includes("#")||(this._urlString=Ct.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return gi.endsWith(t,"?")?t=t.slice(0,-1):gi.endsWith(t,"?/")&&(t=t.slice(0,-2)),gi.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Gt(oc)}if(!e.HostNameAndPort||!e.PathSegments)throw Gt(oc);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Gt(pS)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Ct.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return e&&r.length!==0&&(r[0]===uo.COMMON||r[0]===uo.ORGANIZATIONS)&&(r[0]=e),Ct.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Gt(oc);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let i=r.AbsolutePath.split("/");return i=i.filter(s=>s&&s.length>0),r.PathSegments=i,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Gt(oc);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===Te.FORWARD_SLASH){const i=new Ct(t).getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Ct(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Td(e)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const bS={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},P1=bS.endpointMetadata,$m=bS.instanceDiscoveryMetadata,kS=new Set;$m.metadata.forEach(n=>{n.aliases.forEach(e=>{kS.add(e)})});function lL(n,e){var i;let t;const r=n.canonicalAuthority;if(r){const s=new Ct(r).getUrlComponents().HostNameAndPort;t=O1(s,(i=n.cloudDiscoveryMetadata)==null?void 0:i.metadata,Lr.CONFIG,e)||O1(s,$m.metadata,Lr.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function O1(n,e,t,r){if(r==null||r.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const i=wd(e,n);if(i)return r==null||r.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),i.aliases;r==null||r.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function cL(n){return wd($m.metadata,n)}function wd(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(r.aliases.includes(e))return r}return null}/*! @azure/msal-common v14.16.1 2025-08-05 */const Km="cache_quota_exceeded",jm="cache_error_unknown";/*! @azure/msal-common v14.16.1 2025-08-05 */const Np={[Km]:"Exceeded cache storage capacity.",[jm]:"Unexpected error occurred when using cache storage."};class Ja extends Error{constructor(e,t){const r=t||(Np[e]?Np[e]:Np[jm]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Ja.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}function PS(n){return n instanceof Error?n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED"||n.message.includes("exceeded the quota")?new Ja(Km):new Ja(n.name,n.message):new Ja(jm)}/*! @azure/msal-common v14.16.1 2025-08-05 */class gl{constructor(e,t,r,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(uS,Nm),this.staticAuthorityOptions=i}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(t||{},e),e,t)}getAccountInfoFilteredBy(e,t){const r=this.getAllAccounts(t,e);return r.length>1?r.sort(s=>s.idTokenClaims?-1:1)[0]:r.length===1?r[0]:null}getBaseAccountInfo(e,t){const r=this.getAccountsFilteredBy(e,t);return r.length>0?r[0].getAccountInfo():null}buildTenantProfiles(e,t,r){return e.flatMap(i=>this.getTenantProfilesFromAccountEntity(i,t,r==null?void 0:r.tenantId,r))}getTenantedAccountInfoByFilter(e,t,r,i,s){let o=null,a;if(s&&!this.tenantProfileMatchesFilter(r,s))return null;const l=this.getIdToken(e,i,t,r.tenantId);return l&&(a=ha(l.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,s))?null:(o=Hm(e,r,a,l==null?void 0:l.secret),o)}getTenantProfilesFromAccountEntity(e,t,r,i){const s=e.getAccountInfo();let o=s.tenantProfiles||new Map;const a=this.getTokenKeys();if(r){const c=o.get(r);if(c)o=new Map([[r,c]]);else return[]}const l=[];return o.forEach(c=>{const u=this.getTenantedAccountInfoByFilter(s,a,c,t,i);u&&l.push(u)}),l}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,r){var i;if(!e)throw Ne(oS);try{e.account&&this.setAccount(e.account,t),e.idToken&&(r==null?void 0:r.idToken)!==!1&&this.setIdTokenCredential(e.idToken,t),e.accessToken&&(r==null?void 0:r.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&(r==null?void 0:r.refreshToken)!==!1&&this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(s){throw(i=this.commonLogger)==null||i.error("CacheManager.saveCacheRecord: failed"),s instanceof Zt?s:PS(s)}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},i=this.getTokenKeys(),s=dn.fromString(e.target);i.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,r,!1))return;const a=this.getAccessTokenCredential(o,t);a&&this.credentialMatchesFilter(a,r)&&dn.fromString(a.target).intersectingScopeSets(s)&&this.removeAccessToken(o,t)}),this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const r=this.getAccountKeys(),i=[];return r.forEach(s=>{var c;if(!this.isAccountKey(s,e.homeAccountId))return;const o=this.getAccount(s,t,this.commonLogger);if(!o||e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId)||e.username&&!this.matchUsername(o.username,e.username)||e.environment&&!this.matchEnvironment(o,e.environment)||e.realm&&!this.matchRealm(o,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;const a={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},l=(c=o.tenantProfiles)==null?void 0:c.filter(u=>this.tenantProfileMatchesFilter(u,a));l&&l.length===0||i.push(o)}),i}isAccountKey(e,t,r){return!(e.split(or.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(or.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(t.indexOf(ut.ID_TOKEN.toLowerCase())===-1&&t.indexOf(ut.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(ut.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(ut.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(ut.REFRESH_TOKEN.toLowerCase())>-1){const r=`${ut.REFRESH_TOKEN}${or.CACHE_KEY_SEPARATOR}${this.clientId}${or.CACHE_KEY_SEPARATOR}`,i=`${ut.REFRESH_TOKEN}${or.CACHE_KEY_SEPARATOR}${Ac}${or.CACHE_KEY_SEPARATOR}`;if(t.indexOf(r.toLowerCase())===-1&&t.indexOf(i.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===ut.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===Ht.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach(i=>{if(!this.isAppMetadata(i))return;const s=this.getAppMetadata(i);s&&(e.environment&&!this.matchEnvironment(s,e.environment)||e.clientId&&!this.matchClientId(s,e.clientId)||(r[i]=s))}),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach(i=>{if(!this.isAuthorityMetadata(i)||i.indexOf(this.clientId)===-1)return;const s=this.getAuthorityMetadata(i);s&&s.aliases.indexOf(e)!==-1&&(r=s)}),r}async removeAllAccounts(e){const t=this.getAccountKeys(),r=[];t.forEach(i=>{r.push(this.removeAccount(i,e))}),await Promise.all(r)}async removeAccount(e,t){const r=this.getAccount(e,t,this.commonLogger);r&&(await this.removeAccountContext(r,t),this.removeItem(e,t))}async removeAccountContext(e,t){const r=this.getTokenKeys(),i=e.generateAccountId();r.idToken.forEach(s=>{s.indexOf(i)===0&&this.removeIdToken(s,t)}),r.accessToken.forEach(s=>{s.indexOf(i)===0&&this.removeAccessToken(s,t)}),r.refreshToken.forEach(s=>{s.indexOf(i)===0&&this.removeRefreshToken(s,t)}),this.getKeys().forEach(s=>{s.includes(i)&&this.removeItem(s,t)})}updateOutdatedCachedAccount(e,t,r,i){var s;if(t&&t.isSingleTenant()){(s=this.commonLogger)==null||s.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const o=this.getAccountKeys().filter(f=>f.startsWith(t.homeAccountId)),a=[];o.forEach(f=>{const p=this.getCachedAccountEntity(f,r);p&&a.push(p)});const l=a.find(f=>Ed(f.realm,f.homeAccountId))||a[0];l.tenantProfiles=a.map(f=>({tenantId:f.realm,localAccountId:f.localAccountId,name:f.name,isHomeTenant:Ed(f.realm,f.homeAccountId)}));const c=gl.toObject(new Rn,{...l}),u=c.generateAccountKey();return o.forEach(f=>{f!==u&&this.removeOutdatedAccount(e,r)}),this.setAccount(c,r),i==null||i.verbose("Updated an outdated account entity in the cache"),c}return t}removeAccessToken(e,t){const r=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),!r||r.credentialType.toLowerCase()!==ut.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||r.tokenType!==Ht.POP)return;const i=r.keyId;i&&this.cryptoImpl.removeTokenBindingKey(i).catch(()=>{this.commonLogger.error("Binding key could not be removed")})}removeAppMetadata(e){return this.getKeys().forEach(r=>{this.isAppMetadata(r)&&this.removeItem(r,e)}),!0}readAccountFromCache(e,t){const r=Rn.generateAccountCacheKey(e);return this.getAccount(r,t,this.commonLogger)}getIdToken(e,t,r,i,s){this.commonLogger.trace("CacheManager - getIdToken called");const o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ut.ID_TOKEN,clientId:this.clientId,realm:i},a=this.getIdTokensByFilter(o,t,r),l=a.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=a;if(!i){const u=new Map;a.forEach((p,g)=>{p.realm===e.tenantId&&u.set(g,p)});const f=u.size;if(f<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(f===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;c=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((u,f)=>{this.removeIdToken(f,t)}),s&&t&&s.addFields({multiMatchedID:a.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t,r){const i=r&&r.idToken||this.getTokenKeys().idToken,s=new Map;return i.forEach(o=>{if(!this.idTokenKeyMatchesFilter(o,{clientId:this.clientId,...e}))return;const a=this.getIdTokenCredential(o,t);a&&this.credentialMatchesFilter(a,e)&&s.set(o,a)}),s}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,r,i,s){this.commonLogger.trace("CacheManager - getAccessToken called");const o=dn.createSearchScopes(t.scopes),a=t.authenticationScheme||Ht.BEARER,l=a.toLowerCase()!==Ht.BEARER.toLowerCase()?ut.ACCESS_TOKEN_WITH_AUTH_SCHEME:ut.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:i||e.tenantId,target:o,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=r&&r.accessToken||this.getTokenKeys().accessToken,f=[];u.forEach(g=>{if(this.accessTokenKeyMatchesFilter(g,c,!0)){const m=this.getAccessTokenCredential(g,t.correlationId);m&&this.credentialMatchesFilter(m,c)&&f.push(m)}});const p=f.length;return p<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):p>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),f.forEach(g=>{this.removeAccessToken(Ha(g),t.correlationId)}),s&&t.correlationId&&s.addFields({multiMatchedAT:f.length},t.correlationId),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),f[0])}accessTokenKeyMatchesFilter(e,t,r){const i=e.toLowerCase();if(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&i.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&i.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const s=t.target.asArray();for(let o=0;o<s.length;o++){if(r&&!i.includes(s[o].toLowerCase()))return!1;if(!r&&i.includes(s[o].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const r=this.getTokenKeys(),i=[];return r.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,e,!0))return;const o=this.getAccessTokenCredential(s,t);o&&this.credentialMatchesFilter(o,e)&&i.push(o)}),i}getRefreshToken(e,t,r,i,s){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=t?Ac:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ut.REFRESH_TOKEN,clientId:this.clientId,familyId:o},l=i&&i.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(f=>{if(this.refreshTokenKeyMatchesFilter(f,a)){const p=this.getRefreshTokenCredential(f,r);p&&this.credentialMatchesFilter(p,a)&&c.push(p)}});const u=c.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&s&&r&&s.addFields({multiMatchedRT:u},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&r.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),i=Object.keys(r).map(o=>r[o]),s=i.length;if(s<1)return null;if(s>1)throw Ne(nS);return i[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Ac)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const r=e.oid||e.sub;return t===r}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var r;return t.toLowerCase()===((r=e.name)==null?void 0:r.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const i=lL(this.staticAuthorityOptions,this.commonLogger);if(i.includes(t)&&i.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var r;return((r=e.realm)==null?void 0:r.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==ut.ACCESS_TOKEN&&e.credentialType!==ut.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:dn.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(Sm)!==-1}isAuthorityMetadata(e){return e.indexOf(md.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${md.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class uL extends gl{setAccount(){throw Ne(vt)}getAccount(){throw Ne(vt)}getCachedAccountEntity(){throw Ne(vt)}setIdTokenCredential(){throw Ne(vt)}getIdTokenCredential(){throw Ne(vt)}setAccessTokenCredential(){throw Ne(vt)}getAccessTokenCredential(){throw Ne(vt)}setRefreshTokenCredential(){throw Ne(vt)}getRefreshTokenCredential(){throw Ne(vt)}setAppMetadata(){throw Ne(vt)}getAppMetadata(){throw Ne(vt)}setServerTelemetry(){throw Ne(vt)}getServerTelemetry(){throw Ne(vt)}setAuthorityMetadata(){throw Ne(vt)}getAuthorityMetadata(){throw Ne(vt)}getAuthorityMetadataKeys(){throw Ne(vt)}setThrottlingCache(){throw Ne(vt)}getThrottlingCache(){throw Ne(vt)}removeItem(){throw Ne(vt)}getKeys(){throw Ne(vt)}getAccountKeys(){throw Ne(vt)}getTokenKeys(){throw Ne(vt)}updateCredentialCacheKey(){throw Ne(vt)}removeOutdatedAccount(){throw Ne(vt)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const OS={tokenRenewalOffsetSeconds:PF,preventCorsPreflight:!1},hL={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:nn.Info,correlationId:Te.EMPTY_STRING},dL={claimsBasedCachingEnabled:!1},fL={async sendGetRequestAsync(){throw Ne(vt)},async sendPostRequestAsync(){throw Ne(vt)}},pL={sku:Te.SKU,version:Nm,cpu:Te.EMPTY_STRING,os:Te.EMPTY_STRING},gL={clientSecret:Te.EMPTY_STRING,clientAssertion:void 0},mL={azureCloudInstance:Dm.None,tenant:`${Te.DEFAULT_COMMON_TENANT}`},vL={application:{appName:"",appVersion:""}};function _L({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:r,storageInterface:i,networkInterface:s,cryptoInterface:o,clientCredentials:a,libraryInfo:l,telemetry:c,serverTelemetryManager:u,persistencePlugin:f,serializableCache:p}){const g={...hL,...t};return{authOptions:yL(n),systemOptions:{...OS,...e},loggerOptions:g,cacheOptions:{...dL,...r},storageInterface:i||new uL(n.clientId,_d,new vo(g)),networkInterface:s||fL,cryptoInterface:o||_d,clientCredentials:a||gL,libraryInfo:{...pL,...l},telemetry:{...vL,...c},serverTelemetryManager:u||null,persistencePlugin:f||null,serializableCache:p||null}}function yL(n){return{clientCapabilities:[],azureCloudOptions:mL,skipAuthorityMetadataCache:!1,instanceAware:!1,...n}}function V0(n){return n.authOptions.authority.options.protocolMode===vs.OIDC}/*! @azure/msal-common v14.16.1 2025-08-05 */const zr={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.16.1 2025-08-05 */const Zo="client_id",NS="redirect_uri",N1="response_type",EL="response_mode",TL="grant_type",wL="claims",AL="scope",CL="refresh_token",SL="state",IL="nonce",xL="prompt",RL="code",bL="code_challenge",kL="code_challenge_method",PL="code_verifier",OL="client-request-id",NL="x-client-SKU",DL="x-client-VER",ML="x-client-OS",FL="x-client-CPU",LL="x-client-current-telemetry",UL="x-client-last-telemetry",BL="x-ms-lib-capability",VL="x-app-name",HL="x-app-ver",$L="post_logout_redirect_uri",KL="id_token_hint",jL="device_code",WL="client_secret",GL="client_assertion",qL="client_assertion_type",D1="token_type",M1="req_cnf",zL="assertion",YL="requested_token_use",F1="return_spa_code",QL="nativebroker",XL="logout_hint",JL="sid",ZL="login_hint",e3="domain_hint",t3="x-client-xtra-sku",Wm="brk_client_id",H0="brk_redirect_uri";/*! @azure/msal-common v14.16.1 2025-08-05 */class Ma{static validateRedirectUri(e){if(!e)throw Gt(fS)}static validatePrompt(e){const t=[];for(const r in On)t.push(On[r]);if(t.indexOf(e)<0)throw Gt(vS)}static validateClaims(e){try{JSON.parse(e)}catch{throw Gt(Fm)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Gt(Lm);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([T1.PLAIN,T1.S256].indexOf(e)<0)throw Gt(ES)}}/*! @azure/msal-common v14.16.1 2025-08-05 */function n3(n,e,t){if(!e)return;const r=n.get(Zo);r&&n.has(Wm)&&(t==null||t.addFields({embeddedClientId:r,embeddedRedirectUri:n.get(NS)},e))}class Sc{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(N1,encodeURIComponent(Te.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(N1,encodeURIComponent(`${Te.TOKEN_RESPONSE_TYPE} ${Te.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(EL,encodeURIComponent(e||RF.QUERY))}addNativeBroker(){this.parameters.set(QL,encodeURIComponent("1"))}addScopes(e,t=!0,r=kl){t&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");const i=t?[...e||[],...r]:e||[],s=new dn(i);this.parameters.set(AL,encodeURIComponent(s.printScopes()))}addClientId(e){this.parameters.set(Zo,encodeURIComponent(e))}addRedirectUri(e){Ma.validateRedirectUri(e),this.parameters.set(NS,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Ma.validateRedirectUri(e),this.parameters.set($L,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(KL,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(e3,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(ZL,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(_r.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(_r.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(JL,encodeURIComponent(e))}addClaims(e,t){const r=this.addClientCapabilitiesToClaims(e,t);Ma.validateClaims(r),this.parameters.set(wL,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(OL,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(NL,e.sku),this.parameters.set(DL,e.version),e.os&&this.parameters.set(ML,e.os),e.cpu&&this.parameters.set(FL,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(VL,e.appName),e!=null&&e.appVersion&&this.parameters.set(HL,e.appVersion)}addPrompt(e){Ma.validatePrompt(e),this.parameters.set(`${xL}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(SL,encodeURIComponent(e))}addNonce(e){this.parameters.set(IL,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Ma.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(bL,encodeURIComponent(e)),this.parameters.set(kL,encodeURIComponent(t));else throw Gt(Lm)}addAuthorizationCode(e){this.parameters.set(RL,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(jL,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(CL,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(PL,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(WL,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(GL,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(qL,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(zL,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(YL,encodeURIComponent(e))}addGrantType(e){this.parameters.set(TL,encodeURIComponent(e))}addClientInfo(){this.parameters.set(bF,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,r])=>{!this.parameters.has(t)&&r&&this.parameters.set(t,r)})}addClientCapabilitiesToClaims(e,t){let r;if(!e)r={};else try{r=JSON.parse(e)}catch{throw Gt(Fm)}return t&&t.length>0&&(r.hasOwnProperty(ch.ACCESS_TOKEN)||(r[ch.ACCESS_TOKEN]={}),r[ch.ACCESS_TOKEN][ch.XMS_CC]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(A1.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(A1.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(D1,Ht.POP),this.parameters.set(M1,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(D1,Ht.SSH),this.parameters.set(M1,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(LL,e.generateCurrentRequestHeaderValue()),this.parameters.set(UL,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(BL,Cc.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(XL,encodeURIComponent(e))}addBrokerParameters(e){const t={};t[Wm]=e.brokerClientId,t[H0]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,r)=>{e.push(`${r}=${t}`)}),n3(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v14.16.1 2025-08-05 */function r3(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.16.1 2025-08-05 */function i3(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v14.16.1 2025-08-05 */function s3(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v14.16.1 2025-08-05 */const le={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},o3={InProgress:1};/*! @azure/msal-common v14.16.1 2025-08-05 */const da=(n,e,t,r,i)=>(...s)=>{t.trace(`Executing function ${e}`);const o=r==null?void 0:r.startMeasurement(e,i);if(i){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},i)}try{const a=n(...s);return o==null||o.end({success:!0}),t.trace(`Returning result from ${e}`),a}catch(a){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw o==null||o.end({success:!1},a),a}},Ve=(n,e,t,r,i)=>(...s)=>{t.trace(`Executing function ${e}`);const o=r==null?void 0:r.startMeasurement(e,i);if(i){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},i)}return r==null||r.setPreQueueTime(e,i),n(...s).then(a=>(t.trace(`Returning result from ${e}`),o==null||o.end({success:!0}),a)).catch(a=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw o==null||o.end({success:!1},a),a})};/*! @azure/msal-common v14.16.1 2025-08-05 */class Nf{constructor(e,t,r,i){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=i}async detectRegion(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(le.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)t.region_source=Ia.ENVIRONMENT_VARIABLE;else{const s=Nf.IMDS_OPTIONS;try{const o=await Ve(this.getRegionFromIMDS.bind(this),le.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(Te.IMDS_VERSION,s);if(o.status===hh.httpSuccess&&(r=o.body,t.region_source=Ia.IMDS),o.status===hh.httpBadRequest){const a=await Ve(this.getCurrentVersion.bind(this),le.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(s);if(!a)return t.region_source=Ia.FAILED_AUTO_DETECTION,null;const l=await Ve(this.getRegionFromIMDS.bind(this),le.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,s);l.status===hh.httpSuccess&&(r=l.body,t.region_source=Ia.IMDS)}}catch{return t.region_source=Ia.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=Ia.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(le.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${Te.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,Te.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(le.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${Te.IMDS_ENDPOINT}?format=json`,e);return r.status===hh.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}Nf.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.16.1 2025-08-05 */class nr{constructor(e,t,r,i,s,o,a,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=s,this.performanceClient=a,this.correlationId=o,this.managedIdentity=l||!1,this.regionDiscovery=new Nf(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(Te.CIAM_AUTH_URL))return li.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case Te.ADFS:return li.Adfs;case Te.DSTS:return li.Dsts}return li.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Ct(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Ne(is)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Ne(is)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Ne(is)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Ne(cS);return this.replacePath(this.metadata.end_session_endpoint)}else throw Ne(is)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Ne(is)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Ne(is)}canReplaceTenant(e){return e.PathSegments.length===1&&!nr.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===li.Default&&this.protocolMode===vs.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const i=new Ct(this.metadata.canonical_authority).getUrlComponents(),s=i.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,l)=>{let c=s[l];if(l===0&&this.canReplaceTenant(i)){const u=new Ct(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==u&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${u}`),c=u)}a!==c&&(t=t.replace(`/${c}/`,`/${a}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===li.Adfs||this.protocolMode!==vs.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var i,s;(i=this.performanceClient)==null||i.addQueueMeasurement(le.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await Ve(this.updateCloudDiscoveryMetadata.bind(this),le.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Ve(this.updateEndpointMetadata.bind(this),le.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),(s=this.performanceClient)==null||s.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:b1(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==Lr.CACHE&&(r==null?void 0:r.source)!==Lr.CACHE&&(e.expiresAt=b1(),e.canonical_authority=this.canonicalAuthority);const i=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(i,e),this.metadata=e}async updateEndpointMetadata(e){var i,s,o;(i=this.performanceClient)==null||i.addQueueMeasurement(le.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Lr.HARDCODED_VALUES&&(s=this.authorityOptions.azureRegionConfiguration)!=null&&s.azureRegion&&t.metadata){const a=await Ve(this.updateMetadataWithRegionalInformation.bind(this),le.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);dh(e,a,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let r=await Ve(this.getEndpointMetadataFromNetwork.bind(this),le.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return(o=this.authorityOptions.azureRegionConfiguration)!=null&&o.azureRegion&&(r=await Ve(this.updateMetadataWithRegionalInformation.bind(this),le.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),dh(e,r,!0),Lr.NETWORK;throw Ne(XC,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),dh(e,t,!1),{source:Lr.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const i=this.getEndpointMetadataFromHardcodedValues();if(i)return dh(e,i,!1),{source:Lr.HARDCODED_VALUES,metadata:i};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=k1(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Lr.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Ct(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Gt(TS)}return null}async getEndpointMetadataFromNetwork(){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(le.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const i=await this.networkInterface.sendGetRequestAsync(t,e);return r3(i.body)?i.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(i){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${i}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in P1?P1[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var r,i,s;(r=this.performanceClient)==null||r.addQueueMeasurement(le.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=(i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.azureRegion;if(t){if(t!==Te.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Pp.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,nr.replaceWithRegionalInformation(e,t);const o=await Ve(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),le.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((s=this.authorityOptions.azureRegionConfiguration)==null?void 0:s.environmentRegion,this.regionDiscoveryMetadata);if(o)return this.regionDiscoveryMetadata.region_outcome=Pp.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=o,nr.replaceWithRegionalInformation(e,o);this.regionDiscoveryMetadata.region_outcome=Pp.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(le.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await Ve(this.getCloudDiscoveryMetadataFromNetwork.bind(this),le.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return Op(e,r,!0),Lr.NETWORK;throw Gt(wS)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||Te.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||Te.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||Te.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Op(e,t,!1),Lr.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const i=cL(this.hostnameAndPort);if(i)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Op(e,i,!1),Lr.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=k1(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),Lr.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===li.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),nr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=wd(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Gt(Um)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),nr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(le.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${Te.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const s=await this.networkInterface.sendGetRequestAsync(e,t);let o,a;if(i3(s.body))o=s.body,a=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else if(s3(s.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${s.status}`),o=s.body,o.error===Te.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=wd(a,this.hostnameAndPort)}catch(s){if(s instanceof Zt)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${s.errorCode}
Error Description: ${s.errorMessage}`);else{const o=s;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${o.name}
Error Description: ${o.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=nr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&Ct.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==Dm.None){const i=t.tenant?t.tenant:Te.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${i}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return Te.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Ne(is)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return kS.has(e)}static isPublicCloudAuthority(e){return Te.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const i=new Ct(e);i.validateAsUri();const s=i.getUrlComponents();let o=`${t}.${s.HostNameAndPort}`;this.isPublicCloudAuthority(s.HostNameAndPort)&&(o=`${t}.${Te.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=Ct.constructAuthorityUriFromObject({...i.getUrlComponents(),HostNameAndPort:o}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=nr.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=nr.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=nr.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const i=new Ct(e).getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(Te.CIAM_AUTH_URL)){const s=i.HostNameAndPort.split(".")[0];t=`${t}${s}${Te.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}nr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",uo.COMMON,uo.CONSUMERS,uo.ORGANIZATIONS]);function a3(n){var i;const r=(i=new Ct(n).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:i.toLowerCase();switch(r){case uo.COMMON:case uo.ORGANIZATIONS:case uo.CONSUMERS:return;default:return r}}function DS(n){return n.endsWith(Te.FORWARD_SLASH)?n:`${n}${Te.FORWARD_SLASH}`}function l3(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw Gt(Um)}return{canonicalAuthority:n.authority?DS(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v14.16.1 2025-08-05 */async function MS(n,e,t,r,i,s,o){o==null||o.addQueueMeasurement(le.AuthorityFactoryCreateDiscoveredInstance,s);const a=nr.transformCIAMAuthority(DS(n)),l=new nr(a,e,t,r,i,s,o);try{return await Ve(l.resolveEndpointsAsync.bind(l),le.AuthorityResolveEndpointsAsync,i,o,s)(),l}catch{throw Ne(is)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class _o extends Zt{constructor(e,t,r,i,s){super(e,t,r),this.name="ServerError",this.errorNo=i,this.status=s,Object.setPrototypeOf(this,_o.prototype)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class Pi{static generateThrottlingStorageKey(e){return`${Cc.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,r){var o;const i=Pi.generateThrottlingStorageKey(t),s=e.getThrottlingCache(i);if(s){if(s.throttleTime<Date.now()){e.removeItem(i,r);return}throw new _o(((o=s.errorCodes)==null?void 0:o.join(" "))||Te.EMPTY_STRING,s.errorMessage,s.subError)}}static postProcess(e,t,r,i){if(Pi.checkResponseStatus(r)||Pi.checkResponseForRetryAfter(r)){const s={throttleTime:Pi.calculateThrottleTime(parseInt(r.headers[_r.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Pi.generateThrottlingStorageKey(t),s,i)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(_r.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(Math.min(r+(t||Cc.DEFAULT_THROTTLE_TIME_SECONDS),r+Cc.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,r,i){const s={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:i,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},o=this.generateThrottlingStorageKey(s);e.removeItem(o,r.correlationId)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class Df extends Zt{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Df.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function L1(n,e,t){return new Df(n,e,t)}/*! @azure/msal-common v14.16.1 2025-08-05 */class Gm{constructor(e,t){this.config=_L(e),this.logger=new vo(this.config.loggerOptions,uS,Nm),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[_r.CONTENT_TYPE]=Te.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case zr.HOME_ACCOUNT_ID:try{const r=$a(e.credential);t[_r.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case zr.UPN:t[_r.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,r,i,s,o){var l;o&&((l=this.performanceClient)==null||l.addQueueMeasurement(o,s));const a=await this.sendPostRequest(i,e,{body:t,headers:r},s);return this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,i){var o,a,l;Pi.preProcess(this.cacheManager,e,i);let s;try{s=await Ve(this.networkClient.sendPostRequestAsync.bind(this.networkClient),le.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,i)(t,r);const c=s.headers||{};(a=this.performanceClient)==null||a.addFields({refreshTokenSize:((o=s.body.refresh_token)==null?void 0:o.length)||0,httpVerToken:c[_r.X_MS_HTTP_VERSION]||"",requestId:c[_r.X_MS_REQUEST_ID]||""},i)}catch(c){if(c instanceof Df){const u=c.responseHeaders;throw u&&((l=this.performanceClient)==null||l.addFields({httpVerToken:u[_r.X_MS_HTTP_VERSION]||"",requestId:u[_r.X_MS_REQUEST_ID]||"",contentTypeHeader:u[_r.CONTENT_TYPE]||void 0,contentLengthHeader:u[_r.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},i)),c.error}throw c instanceof Zt?c:Ne(QC)}return Pi.postProcess(this.cacheManager,e,s,i),s}async updateAuthority(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(le.UpdateTokenEndpointAuthority,t);const r=`https://${e}/${this.authority.tenant}/`,i=await MS(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=i}createTokenQueryParameters(e){const t=new Sc(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}/*! @azure/msal-common v14.16.1 2025-08-05 */const Ad="no_tokens_found",FS="native_account_unavailable",qm="refresh_token_expired",c3="interaction_required",u3="consent_required",h3="login_required",Mf="bad_token";/*! @azure/msal-common v14.16.1 2025-08-05 */const U1=[c3,u3,h3,Mf],d3=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],f3={[Ad]:"No refresh token found in the cache. Please sign-in.",[FS]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[qm]:"Refresh token has expired.",[Mf]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class Ei extends Zt{constructor(e,t,r,i,s,o,a,l){super(e,t,r),Object.setPrototypeOf(this,Ei.prototype),this.timestamp=i||Te.EMPTY_STRING,this.traceId=s||Te.EMPTY_STRING,this.correlationId=o||Te.EMPTY_STRING,this.claims=a||Te.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function B1(n,e,t){const r=!!n&&U1.indexOf(n)>-1,i=!!t&&d3.indexOf(t)>-1,s=!!e&&U1.some(o=>e.indexOf(o)>-1);return r||s||i}function $0(n){return new Ei(n,f3[n])}/*! @azure/msal-common v14.16.1 2025-08-05 */class mi{static setRequestState(e,t,r){const i=mi.generateLibraryState(e,r);return t?`${i}${Te.RESOURCE_DELIM}${t}`:i}static generateLibraryState(e,t){if(!e)throw Ne(L0);const r={id:e.createNewGuid()};t&&(r.meta=t);const i=JSON.stringify(r);return e.base64Encode(i)}static parseRequestState(e,t){if(!e)throw Ne(L0);if(!t)throw Ne(pl);try{const r=t.split(Te.RESOURCE_DELIM),i=r[0],s=r.length>1?r.slice(1).join(Te.RESOURCE_DELIM):Te.EMPTY_STRING,o=e.base64Decode(i),a=JSON.parse(o);return{userRequestState:s||Te.EMPTY_STRING,libraryState:a}}catch{throw Ne(pl)}}}/*! @azure/msal-common v14.16.1 2025-08-05 */const p3={SW:"sw"};class ml{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(le.PopTokenGenerateCnf,e.correlationId);const r=await Ve(this.generateKid.bind(this),le.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),i=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:i}}async generateKid(e){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(le.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:p3.SW}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,i){const{resourceRequestMethod:s,resourceRequestUri:o,shrClaims:a,shrNonce:l,shrOptions:c}=r,u=o?new Ct(o):void 0,f=u==null?void 0:u.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:ji(),m:s==null?void 0:s.toUpperCase(),u:f==null?void 0:f.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:f==null?void 0:f.AbsolutePath,q:f!=null&&f.QueryString?[[],f.QueryString]:void 0,client_claims:a||void 0,...i},t,c,r.correlationId)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class g3{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.16.1 2025-08-05 */function m3(n){var r,i;const e="code=",t=(r=n.error_uri)==null?void 0:r.lastIndexOf(e);return t&&t>=0?(i=n.error_uri)==null?void 0:i.substring(t+e.length):void 0}class ea{constructor(e,t,r,i,s,o,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=i,this.serializableCache=s,this.persistencePlugin=o,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?Ne(vd,"Cached State"):Ne(vd,"Server State");let r,i;try{r=decodeURIComponent(e.state)}catch{throw Ne(pl,e.state)}try{i=decodeURIComponent(t)}catch{throw Ne(pl,e.state)}if(r!==i)throw Ne(ZC);if(e.error||e.error_description||e.suberror){const s=m3(e);throw B1(e.error,e.error_description,e.suberror)?new Ei(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",s):new _o(e.error||"",e.error_description,e.suberror,s)}}validateTokenResponse(e,t){var r;if(e.error||e.error_description||e.suberror){const i=`Error(s): ${e.error_codes||Te.NOT_AVAILABLE} - Timestamp: ${e.timestamp||Te.NOT_AVAILABLE} - Description: ${e.error_description||Te.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||Te.NOT_AVAILABLE} - Trace ID: ${e.trace_id||Te.NOT_AVAILABLE}`,s=(r=e.error_codes)!=null&&r.length?e.error_codes[0]:void 0,o=new _o(e.error,i,e.suberror,s,e.status);if(t&&e.status&&e.status>=lh.SERVER_ERROR_RANGE_START&&e.status<=lh.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${o}`);return}else if(t&&e.status&&e.status>=lh.CLIENT_ERROR_RANGE_START&&e.status<=lh.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${o}`);return}throw B1(e.error,e.error_description,e.suberror)?new Ei(e.error,e.error_description,e.suberror,e.timestamp||Te.EMPTY_STRING,e.trace_id||Te.EMPTY_STRING,e.correlation_id||Te.EMPTY_STRING,e.claims||Te.EMPTY_STRING,s):o}}async handleServerTokenResponse(e,t,r,i,s,o,a,l,c){var m;(m=this.performanceClient)==null||m.addQueueMeasurement(le.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=ha(e.id_token||Te.EMPTY_STRING,this.cryptoObj.base64Decode),s&&s.nonce&&u.nonce!==s.nonce)throw Ne(eS);if(i.maxAge||i.maxAge===0){const v=u.auth_time;if(!v)throw Ne(bm);hS(v,i.maxAge)}}this.homeAccountIdentifier=Rn.generateHomeAccountId(e.client_info||Te.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u);let f;s&&s.state&&(f=mi.parseRequestState(this.cryptoObj,s.state)),e.key_id=e.key_id||i.sshKid||void 0;const p=this.generateCacheRecord(e,t,r,i,u,o,s);let g;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new g3(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(g)),a&&!l&&p.account){const v=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(v,i.correlationId,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await ea.generateAuthenticationResult(this.cryptoObj,t,p,!1,i,u,f,void 0,c)}await this.cacheStorage.saveCacheRecord(p,i.correlationId,i.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&g&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(g))}return ea.generateAuthenticationResult(this.cryptoObj,t,p,!1,i,u,f,e,c)}generateCacheRecord(e,t,r,i,s,o,a){const l=t.getPreferredCache();if(!l)throw Ne(Pm);const c=xS(s);let u,f;e.id_token&&s&&(u=kf(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),f=zm(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i.correlationId,s,e.client_info,l,c,a,void 0,this.logger));let p=null;if(e.access_token){const v=e.scope?dn.fromString(e.scope):new dn(i.scopes||[]),_=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,D=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,b=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,T=r+_,R=T+D,B=b&&b>0?r+b:void 0;p=Pf(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",v.printScopes(),T,R,this.cryptoObj.base64Decode,B,e.token_type,o,e.key_id,i.claims,i.requestedClaimsHash)}let g=null;if(e.refresh_token){let v;if(e.refresh_token_expires_in){const _=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;v=r+_}g=dS(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,o,v)}let m=null;return e.foci&&(m={clientId:this.clientId,environment:l,familyId:e.foci}),{account:f,idToken:u,accessToken:p,refreshToken:g,appMetadata:m}}static async generateAuthenticationResult(e,t,r,i,s,o,a,l,c){var T,R,B,W,A;let u=Te.EMPTY_STRING,f=[],p=null,g,m,v=Te.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===Ht.POP&&!s.popKid){const w=new ml(e),{secret:E,keyId:C}=r.accessToken;if(!C)throw Ne(Om);u=await w.signPopToken(E,C,s)}else u=r.accessToken.secret;f=dn.fromString(r.accessToken.target).asArray(),p=new Date(Number(r.accessToken.expiresOn)*1e3),g=new Date(Number(r.accessToken.extendedExpiresOn)*1e3),r.accessToken.refreshOn&&(m=new Date(Number(r.accessToken.refreshOn)*1e3))}r.appMetadata&&(v=r.appMetadata.familyId===Ac?Ac:"");const _=(o==null?void 0:o.oid)||(o==null?void 0:o.sub)||"",D=(o==null?void 0:o.tid)||"";l!=null&&l.spa_accountid&&r.account&&(r.account.nativeAccountId=l==null?void 0:l.spa_accountid);const b=r.account?Hm(r.account.getAccountInfo(),void 0,o,(T=r.idToken)==null?void 0:T.secret):null;return{authority:t.canonicalAuthority,uniqueId:_,tenantId:D,scopes:f,account:b,idToken:((R=r==null?void 0:r.idToken)==null?void 0:R.secret)||"",idTokenClaims:o||{},accessToken:u,fromCache:i,expiresOn:p,extExpiresOn:g,refreshOn:m,correlationId:s.correlationId,requestId:c||Te.EMPTY_STRING,familyId:v,tokenType:((B=r.accessToken)==null?void 0:B.tokenType)||Te.EMPTY_STRING,state:a?a.userRequestState:Te.EMPTY_STRING,cloudGraphHostName:((W=r.account)==null?void 0:W.cloudGraphHostName)||Te.EMPTY_STRING,msGraphHost:((A=r.account)==null?void 0:A.msGraphHost)||Te.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function zm(n,e,t,r,i,s,o,a,l,c,u,f){f==null||f.verbose("setCachedAccount called");const g=n.getAccountKeys().find(b=>b.startsWith(t));let m=null;g&&(m=n.getAccount(g,i,f));const v=m||Rn.createAccount({homeAccountId:t,idTokenClaims:s,clientInfo:o,environment:a,cloudGraphHostName:c==null?void 0:c.cloud_graph_host_name,msGraphHost:c==null?void 0:c.msgraph_host,nativeAccountId:u},e,r),_=v.tenantProfiles||[],D=l||v.realm;if(D&&!_.find(b=>b.tenantId===D)){const b=Vm(t,v.localAccountId,D,s);_.push(b)}return v.tenantProfiles=_,v}/*! @azure/msal-common v14.16.1 2025-08-05 */async function LS(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v14.16.1 2025-08-05 */class US extends Gm{constructor(e,t){var r;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(r=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:r.defaultScopes}async getAuthCodeUrl(e){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(le.GetAuthCodeUrl,e.correlationId);const t=await Ve(this.createAuthCodeUrlQueryString.bind(this),le.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return Ct.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){var a,l;if((a=this.performanceClient)==null||a.addQueueMeasurement(le.AuthClientAcquireToken,e.correlationId),!e.code)throw Ne(rS);const r=ji(),i=await Ve(this.executeTokenRequest.bind(this),le.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),s=(l=i.headers)==null?void 0:l[_r.X_MS_REQUEST_ID],o=new ea(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return o.validateTokenResponse(i.body),Ve(o.handleServerTokenResponse.bind(o),le.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,r,e,t,void 0,void 0,void 0,s)}handleFragmentResponse(e,t){if(new ea(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw Ne(lS);return e}getLogoutUri(e){if(!e)throw Gt(yS);const t=this.createLogoutUrlQueryString(e);return Ct.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var c,u;(c=this.performanceClient)==null||c.addQueueMeasurement(le.AuthClientExecuteTokenRequest,t.correlationId);const r=this.createTokenQueryParameters(t),i=Ct.appendQueryString(e.tokenEndpoint,r),s=await Ve(this.createTokenRequestBody.bind(this),le.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let o;if(t.clientInfo)try{const f=yd(t.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${f.uid}${or.CLIENT_INFO_SEPARATOR}${f.utid}`,type:zr.HOME_ACCOUNT_ID}}catch(f){this.logger.verbose("Could not parse client info for CCS Header: "+f)}const a=this.createTokenRequestHeaders(o||t.ccsCredential),l={clientId:((u=t.tokenBodyParameters)==null?void 0:u.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return Ve(this.executePostToTokenEndpoint.bind(this),le.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(i,s,a,l,t.correlationId,le.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var i,s;(i=this.performanceClient)==null||i.addQueueMeasurement(le.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Sc(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||((s=e.tokenBodyParameters)==null?void 0:s[Zo])||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Ma.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!V0(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const o=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await LS(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(o.assertionType)}if(t.addGrantType(GC.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===Ht.POP){const o=new ml(this.cryptoUtils,this.performanceClient);let a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await Ve(o.generateCnf.bind(o),le.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}else if(e.authenticationScheme===Ht.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw Gt(Of);(!gi.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let r;if(e.clientInfo)try{const o=yd(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${o.uid}${or.CLIENT_INFO_SEPARATOR}${o.utid}`,type:zr.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case zr.HOME_ACCOUNT_ID:try{const o=$a(r.credential);t.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case zr.UPN:t.addCcsUpn(r.credential);break}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[F1])&&t.addExtraQueryParameters({[F1]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){var s,o;const t=e.correlationId||this.config.cryptoInterface.createNewGuid();(s=this.performanceClient)==null||s.addQueueMeasurement(le.AuthClientCreateQueryString,t);const r=new Sc(t,this.performanceClient);r.addClientId(e.embeddedClientId||((o=e.extraQueryParameters)==null?void 0:o[Zo])||this.config.authOptions.clientId);const i=[...e.scopes||[],...e.extraScopesToConsent||[]];if(r.addScopes(i,!0,this.oidcDefaultScopes),r.addRedirectUri(e.redirectUri),r.addCorrelationId(t),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),V0(this.config)||r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==On.SELECT_ACCOUNT)if(e.sid&&e.prompt===On.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){const a=this.extractAccountSid(e.account);let l=this.extractLoginHint(e.account);if(l&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(l);try{const c=$a(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&e.prompt===On.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(a);try{const c=$a(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{const c=$a(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,r),e.nativeBroker&&(r.addNativeBroker(),e.authenticationScheme===Ht.POP)){const a=new ml(this.cryptoUtils);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await Ve(a.generateCnf.bind(a),le.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}return r.createQueryString()}createLogoutUrlQueryString(e){const t=new Sc(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return((t=e.idTokenClaims)==null?void 0:t.sid)||null}extractLoginHint(e){var t;return((t=e.idTokenClaims)==null?void 0:t.login_hint)||null}}/*! @azure/msal-common v14.16.1 2025-08-05 */const v3=300;class K0 extends Gm{constructor(e,t){super(e,t)}async acquireToken(e){var o,a;(o=this.performanceClient)==null||o.addQueueMeasurement(le.RefreshTokenClientAcquireToken,e.correlationId);const t=ji(),r=await Ve(this.executeTokenRequest.bind(this),le.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=(a=r.headers)==null?void 0:a[_r.X_MS_REQUEST_ID],s=new ea(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return s.validateTokenResponse(r.body),Ve(s.handleServerTokenResponse.bind(s),le.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,i)}async acquireTokenByRefreshToken(e){var r;if(!e)throw Gt(_S);if((r=this.performanceClient)==null||r.addQueueMeasurement(le.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw Ne(km);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Ve(this.acquireTokenWithCachedRefreshToken.bind(this),le.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(i){const s=i instanceof Ei&&i.errorCode===Ad,o=i instanceof _o&&i.errorCode===w1.INVALID_GRANT_ERROR&&i.subError===w1.CLIENT_MISMATCH_ERROR;if(s||o)return Ve(this.acquireTokenWithCachedRefreshToken.bind(this),le.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw i}return Ve(this.acquireTokenWithCachedRefreshToken.bind(this),le.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(le.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const r=da(this.cacheManager.getRefreshToken.bind(this.cacheManager),le.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!r)throw $0(Ad);if(r.expiresOn&&B0(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||v3))throw $0(qm);const i={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Ht.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:zr.HOME_ACCOUNT_ID}};try{return await Ve(this.acquireToken.bind(this),le.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(i)}catch(o){if(o instanceof Ei&&o.subError===Mf){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const a=Ha(r);this.cacheManager.removeRefreshToken(a,e.correlationId)}throw o}}async executeTokenRequest(e,t){var l,c;(l=this.performanceClient)==null||l.addQueueMeasurement(le.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=this.createTokenQueryParameters(e),i=Ct.appendQueryString(t.tokenEndpoint,r),s=await Ve(this.createTokenRequestBody.bind(this),le.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),o=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:((c=e.tokenBodyParameters)==null?void 0:c.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return Ve(this.executePostToTokenEndpoint.bind(this),le.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(i,s,o,a,e.correlationId,le.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var i,s,o;(i=this.performanceClient)==null||i.addQueueMeasurement(le.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,r=new Sc(t,this.performanceClient);if(r.addClientId(e.embeddedClientId||((s=e.tokenBodyParameters)==null?void 0:s[Zo])||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,(o=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:o.defaultScopes),r.addGrantType(GC.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!V0(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await LS(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(a.assertionType)}if(e.authenticationScheme===Ht.POP){const a=new ml(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await Ve(a.generateCnf.bind(a),le.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}else if(e.authenticationScheme===Ht.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw Gt(Of);if((!gi.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case zr.HOME_ACCOUNT_ID:try{const a=$a(e.ccsCredential.credential);r.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case zr.UPN:r.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}/*! @azure/msal-common v14.16.1 2025-08-05 */class _3 extends Gm{constructor(e,t){super(e,t)}async acquireToken(e){var t;try{const[r,i]=await this.acquireCachedToken({...e,scopes:(t=e.scopes)!=null&&t.length?e.scopes:[...kl]});return i===Gs.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new K0(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),r}catch(r){if(r instanceof bf&&r.errorCode===hs)return new K0(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw r}}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(le.SilentFlowClientAcquireCachedToken,e.correlationId);let t=Gs.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!gi.isEmptyObj(e.claims))throw this.setCacheOutcome(Gs.FORCE_REFRESH_OR_CLAIMS,e.correlationId),Ne(hs);if(!e.account)throw Ne(km);const r=e.account.tenantId||a3(e.authority),i=this.cacheManager.getTokenKeys(),s=this.cacheManager.getAccessToken(e.account,e,i,r,this.performanceClient);if(s){if(qF(s.cachedAt)||B0(s.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Gs.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),Ne(hs);s.refreshOn&&B0(s.refreshOn,0)&&(t=Gs.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Gs.NO_CACHED_ACCESS_TOKEN,e.correlationId),Ne(hs);const o=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:s,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,i,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(o)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Ve(this.generateResultFromCacheRecord.bind(this),le.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){var r,i;(r=this.serverTelemetryManager)==null||r.setCacheOutcome(e),(i=this.performanceClient)==null||i.addFields({cacheOutcome:e},t),e!==Gs.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(le.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let r;if(e.idToken&&(r=ha(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const s=r==null?void 0:r.auth_time;if(!s)throw Ne(bm);hS(s,t.maxAge)}return ea.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const y3={sendGetRequestAsync:()=>Promise.reject(Ne(vt)),sendPostRequestAsync:()=>Promise.reject(Ne(vt))};/*! @azure/msal-common v14.16.1 2025-08-05 */const V1=",",BS="|";function E3(n){const{skus:e,libraryName:t,libraryVersion:r,extensionName:i,extensionVersion:s}=n,o=new Map([[0,[t,r]],[2,[i,s]]]);let a=[];if(e!=null&&e.length){if(a=e.split(V1),a.length<4)return e}else a=Array.from({length:4},()=>BS);return o.forEach((l,c)=>{var u,f;l.length===2&&((u=l[0])!=null&&u.length)&&((f=l[1])!=null&&f.length)&&T3({skuArr:a,index:c,skuName:l[0],skuVersion:l[1]})}),a.join(V1)}function T3(n){const{skuArr:e,index:t,skuName:r,skuVersion:i}=n;t>=e.length||(e[t]=[r,i].join(BS))}class zc{constructor(e,t){this.cacheOutcome=Gs.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Te.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Te.EMPTY_STRING,this.telemetryCacheKey=Hn.CACHE_KEY+or.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${Hn.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r!=null&&r.length&&t.push(`broker_error=${r}`);const i=t.join(Hn.VALUE_SEPARATOR),s=this.getRegionDiscoveryFields(),o=[e,s].join(Hn.VALUE_SEPARATOR);return[Hn.SCHEMA_VERSION,o,i].join(Hn.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=zc.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(Hn.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(Hn.VALUE_SEPARATOR),s=e.errors.length,o=t<s?Hn.OVERFLOW_TRUE:Hn.OVERFLOW_FALSE,a=[s,o].join(Hn.VALUE_SEPARATOR);return[Hn.SCHEMA_VERSION,e.cacheHits,r,i,a].join(Hn.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=Hn.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Zt?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Hn.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=zc.maxErrorsToSend(e),r=e.errors.length;if(t===r)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const i={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i,this.correlationId)}}static maxErrorsToSend(e){let t,r=0,i=0;const s=e.errors.length;for(t=0;t<s;t++){const o=e.failedRequests[2*t]||Te.EMPTY_STRING,a=e.failedRequests[2*t+1]||Te.EMPTY_STRING,l=e.errors[t]||Te.EMPTY_STRING;if(i+=o.toString().length+a.toString().length+l.length+3,i<Hn.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||Te.EMPTY_STRING),e.push(this.regionSource||Te.EMPTY_STRING),e.push(this.regionOutcome||Te.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return E3(e)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const VS="missing_kid_error",HS="missing_alg_error";/*! @azure/msal-common v14.16.1 2025-08-05 */const w3={[VS]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[HS]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Ym extends Zt{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Ym.prototype)}}function H1(n){return new Ym(n,w3[n])}/*! @azure/msal-common v14.16.1 2025-08-05 */class Qm{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw H1(VS);if(!e.alg)throw H1(HS);const t=new Qm({typ:e.typ||kF.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class $1{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class A3{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:o3.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new $1}}startPerformanceMeasurement(){return new $1}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Xm="pkce_not_created",j0="crypto_nonexistent",Ff="empty_navigate_uri",$S="hash_empty_error",Jm="no_state_in_hash",KS="hash_does_not_contain_known_properties",jS="unable_to_parse_state",WS="state_interaction_type_mismatch",GS="interaction_in_progress",qS="popup_window_error",zS="empty_window_error",ta="user_cancelled",C3="monitor_popup_timeout",YS="monitor_window_timeout",QS="redirect_in_iframe",XS="block_iframe_reload",JS="block_nested_popups",S3="iframe_closed_prematurely",Lf="silent_logout_unsupported",ZS="no_account_error",I3="silent_prompt_value_error",eI="no_token_request_cache_error",tI="unable_to_parse_token_request_cache_error",Zm="no_cached_authority_error",x3="auth_request_not_set_error",R3="invalid_cache_type",Uf="non_browser_environment",Fa="database_not_open",Cd="no_network_connectivity",nI="post_request_failed",rI="get_request_failed",W0="failed_to_parse_response",iI="unable_to_load_token",ev="crypto_key_not_found",sI="auth_code_required",oI="auth_code_or_nativeAccountId_required",aI="spa_code_and_nativeAccountId_present",tv="database_unavailable",lI="unable_to_acquire_token_from_native_platform",cI="native_handshake_timeout",uI="native_extension_not_installed",Su="native_connection_not_established",hI="uninitialized_public_client_application",dI="native_prompt_not_supported",fI="invalid_base64_string",pI="invalid_pop_token_request",gI="failed_to_build_headers",mI="failed_to_parse_headers";/*! @azure/msal-browser v3.30.0 2025-08-05 */const es="For more visit: aka.ms/msaljs/browser-errors",b3={[Xm]:"The PKCE code challenge and verifier could not be generated.",[j0]:"The crypto object or function is not available.",[Ff]:"Navigation URI is empty. Please check stack trace for more info.",[$S]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${es}`,[Jm]:"Hash does not contain state. Please verify that the request originated from msal.",[KS]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${es}`,[jS]:"Unable to parse state. Please verify that the request originated from msal.",[WS]:"Hash contains state but the interaction type does not match the caller.",[GS]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${es}`,[qS]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[zS]:"window.open returned null or undefined window object.",[ta]:"User cancelled the flow.",[C3]:`Token acquisition in popup failed due to timeout.  ${es}`,[YS]:`Token acquisition in iframe failed due to timeout.  ${es}`,[QS]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[XS]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${es}`,[JS]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[S3]:"The iframe being monitored was closed prematurely.",[Lf]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[ZS]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[I3]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[eI]:"No token request found in cache.",[tI]:"The cached token request could not be parsed.",[Zm]:"No cached authority found.",[x3]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[R3]:"Invalid cache type",[Uf]:"Login and token requests are not supported in non-browser environments.",[Fa]:"Database is not open!",[Cd]:"No network connectivity. Check your internet connection.",[nI]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[rI]:"Network request failed. Please check the network trace to determine root cause.",[W0]:"Failed to parse network response. Check network trace.",[iI]:"Error loading token to cache.",[ev]:"Cryptographic Key or Keypair not found in browser storage.",[sI]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[oI]:"An authorization code or nativeAccountId must be provided to this flow.",[aI]:"Request cannot contain both spa code and native account id.",[tv]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[lI]:`Unable to acquire token from native platform.  ${es}`,[cI]:"Timed out while attempting to establish connection to browser extension",[uI]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Su]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${es}`,[hI]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${es}`,[dI]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[fI]:"Invalid base64 encoded string.",[pI]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[gI]:"Failed to build request headers object.",[mI]:"Failed to parse response headers"};class Iu extends Zt{constructor(e,t){super(e,b3[e],t),Object.setPrototypeOf(this,Iu.prototype),this.name="BrowserAuthError"}}function Qe(n,e){return new Iu(n,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const $r={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Ka={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Lo={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},xr={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},K1={GET:"GET",POST:"POST"},Mt={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Xr={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys",VERSION:"msal.version"},fh={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Qt={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var tt;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})(tt||(tt={}));const j1={scopes:kl},vI="jwk",G0="msal.db",k3=1,P3=`${G0}.keys`,Ur={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},O3=[Ur.Default,Ur.Skip,Ur.RefreshTokenAndNetwork],N3="msal.browser.log.level",D3="msal.browser.log.pii";/*! @azure/msal-browser v3.30.0 2025-08-05 */function ph(n){return encodeURIComponent(nv(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Bf(n){return _I(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nv(n){return _I(new TextEncoder().encode(n))}function _I(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const M3="RSASSA-PKCS1-v1_5",yI="SHA-256",F3=2048,L3=new Uint8Array([1,0,1]),W1="0123456789abcdef",G1=new Uint32Array(1),U3="crypto_subtle_undefined",rv={name:M3,hash:yI,modulusLength:F3,publicExponent:L3};function B3(n){if(!window)throw Qe(Uf);if(!window.crypto)throw Qe(j0);if(!n&&!window.crypto.subtle)throw Qe(j0,U3)}async function EI(n,e,t){e==null||e.addQueueMeasurement(le.Sha256Digest,t);const i=new TextEncoder().encode(n);return window.crypto.subtle.digest(yI,i)}function V3(n){return window.crypto.getRandomValues(n)}function Dp(){return window.crypto.getRandomValues(G1),G1[0]}function Wi(){const n=Date.now(),e=Dp()*1024+(Dp()&1023),t=new Uint8Array(16),r=Math.trunc(e/2**30),i=e&2**30-1,s=Dp();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|r>>>8,t[7]=r,t[8]=128|i>>>24,t[9]=i>>>16,t[10]=i>>>8,t[11]=i,t[12]=s>>>24,t[13]=s>>>16,t[14]=s>>>8,t[15]=s;let o="";for(let a=0;a<t.length;a++)o+=W1.charAt(t[a]>>>4),o+=W1.charAt(t[a]&15),(a===3||a===5||a===7||a===9)&&(o+="-");return o}async function H3(n,e){return window.crypto.subtle.generateKey(rv,n,e)}async function Mp(n){return window.crypto.subtle.exportKey(vI,n)}async function $3(n,e,t){return window.crypto.subtle.importKey(vI,n,rv,e,t)}async function K3(n,e){return window.crypto.subtle.sign(rv,n,e)}async function TI(n){const e=await EI(n),t=new Uint8Array(e);return Bf(t)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const iv="storage_not_supported",j3="stubbed_public_client_application_called",wI="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.30.0 2025-08-05 */const W3={[iv]:"Given storage configuration option was not supported.",[j3]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[wI]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class sv extends Zt{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,sv.prototype)}}function ov(n){return new sv(n,W3[n])}/*! @azure/msal-browser v3.30.0 2025-08-05 */function G3(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function q3(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function av(){return window.parent!==window}function z3(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${$r.POPUP_NAME_PREFIX}.`)===0}function ds(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Y3(){const e=new Ct(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function Q3(){if(Ct.hashContainsKnownProperties(window.location.hash)&&av())throw Qe(XS)}function X3(n){if(av()&&!n)throw Qe(QS)}function J3(){if(z3())throw Qe(JS)}function AI(){if(typeof window>"u")throw Qe(Uf)}function CI(n){if(!n)throw Qe(hI)}function lv(n){AI(),Q3(),J3(),CI(n)}function q1(n,e){if(lv(n),X3(e.system.allowRedirectInIframe),e.cache.cacheLocation===xr.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw ov(wI)}function SI(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function Z3(){return Wi()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Sd{navigateInternal(e,t){return Sd.defaultNavigateWindow(e,t)}navigateExternal(e,t){return Sd.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(r=>{setTimeout(()=>{r(!0)},t.timeout)})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class eU{async sendGetRequestAsync(e,t){let r,i={},s=0;const o=z1(t);try{r=await fetch(e,{method:K1.GET,headers:o})}catch{throw Qe(window.navigator.onLine?rI:Cd)}i=Y1(r.headers);try{return s=r.status,{headers:i,body:await r.json(),status:s}}catch{throw L1(Qe(W0),s,i)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",i=z1(t);let s,o=0,a={};try{s=await fetch(e,{method:K1.POST,headers:i,body:r})}catch{throw Qe(window.navigator.onLine?nI:Cd)}a=Y1(s.headers);try{return o=s.status,{headers:a,body:await s.json(),status:o}}catch{throw L1(Qe(W0),o,a)}}}function z1(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([r,i])=>{e.append(r,i)}),e}catch{throw Qe(gI)}}function Y1(n){try{const e={};return n.forEach((t,r)=>{e[r]=t}),e}catch{throw Qe(mI)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const tU=6e4,q0=1e4,nU=3e4,rU=2e3;function iU({auth:n,cache:e,system:t,telemetry:r},i){const s={clientId:Te.EMPTY_STRING,authority:`${Te.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:Te.EMPTY_STRING,authorityMetadata:Te.EMPTY_STRING,redirectUri:typeof window<"u"?ds():"",postLogoutRedirectUri:Te.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:vs.AAD,OIDCOptions:{serverResponseType:Cu.FRAGMENT,defaultScopes:[Te.OPENID_SCOPE,Te.PROFILE_SCOPE,Te.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Dm.None,tenant:Te.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},o={cacheLocation:xr.SessionStorage,temporaryCacheLocation:xr.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===xr.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:nn.Info,piiLoggingEnabled:!1},c={...{...OS,loggerOptions:a,networkClient:i?new eU:y3,navigationClient:new Sd,loadFrameTimeout:0,windowHashTimeout:(t==null?void 0:t.loadFrameTimeout)||tU,iframeHashTimeout:(t==null?void 0:t.loadFrameTimeout)||q0,navigateFrameWait:0,redirectNavigationTimeout:nU,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(t==null?void 0:t.nativeBrokerHandshakeTimeout)||rU,pollIntervalMilliseconds:$r.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:(t==null?void 0:t.loggerOptions)||a},u={application:{appName:Te.EMPTY_STRING,appVersion:Te.EMPTY_STRING},client:new A3};if((n==null?void 0:n.protocolMode)!==vs.OIDC&&(n!=null&&n.OIDCOptions)&&new vo(c.loggerOptions).warning(JSON.stringify(Gt(CS))),n!=null&&n.protocolMode&&n.protocolMode!==vs.AAD&&(c!=null&&c.allowNativeBroker))throw Gt(SS);return{auth:{...s,...n,OIDCOptions:{...s.OIDCOptions,...n==null?void 0:n.OIDCOptions}},cache:{...o,...e},system:c,telemetry:{...u,...r}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const sU="@azure/msal-browser",vl="3.30.0";/*! @azure/msal-browser v3.30.0 2025-08-05 */class cv{static loggerCallback(e,t){switch(e){case nn.Error:console.error(t);return;case nn.Info:console.info(t);return;case nn.Verbose:console.debug(t);return;case nn.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=iU(e,this.browserEnvironment);let t;try{t=window[xr.SessionStorage]}catch{}const r=t==null?void 0:t.getItem(N3),i=(l=t==null?void 0:t.getItem(D3))==null?void 0:l.toLowerCase(),s=i==="true"?!0:i==="false"?!1:void 0,o={...this.config.system.loggerOptions},a=r&&Object.keys(nn).includes(r)?nn[r]:void 0;a&&(o.loggerCallback=cv.loggerCallback,o.logLevel=a),s!==void 0&&(o.piiLoggingEnabled=s),this.logger=new vo(o,sU,vl),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class na extends cv{getModuleName(){return na.MODULE_NAME}getId(){return na.ID}async initialize(){return this.available=typeof window<"u",this.available}}na.MODULE_NAME="";na.ID="StandardOperatingContext";/*! @azure/msal-browser v3.30.0 2025-08-05 */function Bi(n){return new TextDecoder().decode(oU(n))}function oU(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Qe(fI)}const t=atob(e);return Uint8Array.from(t,r=>r.codePointAt(0)||0)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class aU{constructor(){this.dbName=G0,this.version=k3,this.tableName=P3,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",i=>{i.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",i=>{const s=i;this.db=s.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>t(Qe(tv)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(Qe(Fa));const o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);o.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result)}),o.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((r,i)=>{if(!this.db)return i(Qe(Fa));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",l=>{this.closeConnection(),i(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(Qe(Fa));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);o.addEventListener("success",()=>{this.closeConnection(),t()}),o.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Qe(Fa));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();s.addEventListener("success",o=>{const a=o;this.closeConnection(),e(a.target.result)}),s.addEventListener("error",o=>{this.closeConnection(),t(o)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(Qe(Fa));const o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);o.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result===1)}),o.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const r=window.indexedDB.deleteDatabase(G0),i=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(i),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(i),e(!0))),r.addEventListener("error",()=>(clearTimeout(i),t(!1)))})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class z0{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class lU{constructor(e){this.inMemoryCache=new z0,this.indexedDBCache=new aU,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Iu&&e.errorCode===tv)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(r){this.handleDatabaseAccessError(r)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class _l{constructor(e,t,r){this.logger=e,B3(r??!1),this.cache=new lU(this.logger),this.performanceClient=t}createNewGuid(){return Wi()}base64Encode(e){return nv(e)}base64Decode(e){return Bi(e)}base64UrlEncode(e){return ph(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var u;const t=(u=this.performanceClient)==null?void 0:u.startMeasurement(le.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await H3(_l.EXTRACTABLE,_l.POP_KEY_USAGES),i=await Mp(r.publicKey),s={e:i.e,kty:i.kty,n:i.n},o=Q1(s),a=await this.hashString(o),l=await Mp(r.privateKey),c=await $3(l,!1,["sign"]);return await this.cache.setItem(a,{privateKey:c,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,i){var T;const s=(T=this.performanceClient)==null?void 0:T.startMeasurement(le.CryptoOptsSignJwt,i),o=await this.cache.getItem(t);if(!o)throw Qe(ev);const a=await Mp(o.publicKey),l=Q1(a),c=ph(JSON.stringify({kid:t})),u=Qm.getShrHeaderString({...r==null?void 0:r.header,alg:a.alg,kid:c}),f=ph(u);e.cnf={jwk:JSON.parse(l)};const p=ph(JSON.stringify(e)),g=`${f}.${p}`,v=new TextEncoder().encode(g),_=await K3(o.privateKey,v),D=Bf(new Uint8Array(_)),b=`${g}.${D}`;return s&&s.end({success:!0}),b}async hashString(e){return TI(e)}}_l.POP_KEY_USAGES=["sign","verify"];_l.EXTRACTABLE=!0;function Q1(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v3.30.0 2025-08-05 */class cU{constructor(){if(!window.localStorage)throw ov(iv)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class uU{constructor(){if(!window.sessionStorage)throw ov(iv)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function II(n,e){if(!e)return null;try{return mi.parseRequestState(n,e).libraryState.meta}catch{throw Ne(pl)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const hU=24*60*60*1e3;class dU{getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let i=0;i<r.length;i++){const s=r[i],[o,...a]=decodeURIComponent(s).trim().split("="),l=a.join("=");if(o===t)return l}return""}setItem(e,t,r,i=!0){let s=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(r){const o=fU(r);s+=`expires=${o};`}i&&(s+="Secure;"),document.cookie=s}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(r=>{const i=decodeURIComponent(r).trim().split("=");t.push(i[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function fU(n){const e=new Date;return new Date(e.getTime()+n*hU).toUTCString()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Y0 extends gl{constructor(e,t,r,i,s,o){super(e,r,i,s),this.cacheConfig=t,this.logger=i,this.internalStorage=new z0,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new dU,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=o}setupBrowserStorage(e){try{switch(e){case xr.LocalStorage:return new cU;case xr.SessionStorage:return new uU;case xr.MemoryStorage:default:break}}catch(t){this.logger.error(t)}return this.cacheConfig.cacheLocation=xr.MemoryStorage,new z0}migrateCacheEntries(){const e=this.browserStorage.getItem(Xr.VERSION);e&&this.logger.info(`MSAL.js was last initialized with version ${e}`),e!==vl&&this.browserStorage.setItem(Xr.VERSION,vl);const t=`${Te.CACHE_PREFIX}.${bn.ID_TOKEN}`,r=`${Te.CACHE_PREFIX}.${bn.CLIENT_INFO}`,i=`${Te.CACHE_PREFIX}.${bn.ERROR}`,s=`${Te.CACHE_PREFIX}.${bn.ERROR_DESC}`,o=this.browserStorage.getItem(t),a=this.browserStorage.getItem(r),l=this.browserStorage.getItem(i),c=this.browserStorage.getItem(s),u=[o,a,l,c];[bn.ID_TOKEN,bn.CLIENT_INFO,bn.ERROR,bn.ERROR_DESC].forEach((p,g)=>{const m=u[g];m&&this.setTemporaryCache(p,m,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.cryptoImpl.createNewGuid(),t=this.getItem(Xr.ACCOUNT_KEYS),r=this.getItem(`${Xr.TOKEN_KEYS}.${this.clientId}`);if(t&&r){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(s=>{if(this.isCredentialKey(s)){const o=this.getItem(s);if(o){const a=this.validateAndParseJson(o);if(a&&a.hasOwnProperty("credentialType"))switch(a.credentialType){case ut.ID_TOKEN:if(x1(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${s} found, saving key to token key map`);const l=a,c=this.updateCredentialCacheKey(s,l,e);this.addTokenKey(c,ut.ID_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${s}`);break;case ut.ACCESS_TOKEN:case ut.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(I1(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${s} found, saving key to token key map`);const l=a,c=this.updateCredentialCacheKey(s,l,e);this.addTokenKey(c,ut.ACCESS_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${s}`);break;case ut.REFRESH_TOKEN:if(R1(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${s} found, saving key to token key map`);const l=a,c=this.updateCredentialCacheKey(s,l,e);this.addTokenKey(c,ut.REFRESH_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${s}`);break}}}if(this.isAccountKey(s)){const o=this.getItem(s);if(o){const a=this.validateAndParseJson(o);a&&Rn.isAccountEntity(a)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${s} found, saving key to account key map`),this.addAccountKeyToMap(s,e))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t,r){let i=[];for(let o=0;o<=20;o++)try{this.browserStorage.setItem(e,t),o>0&&this.removeAccessTokenKeys(i.slice(0,o),r);break}catch(a){const l=PS(a);if(l.errorCode===Km&&o<20){if(i.length||(e===`${Xr.TOKEN_KEYS}.${this.clientId}`?i=JSON.parse(t).accessToken:i=this.getTokenKeys().accessToken),i.length<=o)throw l;this.removeAccessToken(i[o],r,!1)}else throw l}}getAccount(e,t,r){this.logger.trace("BrowserCacheManager.getAccount called");const i=this.getCachedAccountEntity(e,t);return this.updateOutdatedCachedAccount(e,i,t,r)}getCachedAccountEntity(e,t){const r=this.getItem(e);if(!r)return this.removeAccountKeyFromMap(e,t),null;const i=this.validateAndParseJson(r);return!i||!Rn.isAccountEntity(i)?null:gl.toObject(new Rn,i)}setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey();e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addAccountKeyToMap(r,t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(Xr.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const r=this.getAccountKeys();r.indexOf(e)===-1?(r.push(e),this.setItem(Xr.ACCOUNT_KEYS,JSON.stringify(r),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const r=this.getAccountKeys(),i=r.indexOf(e);if(i>-1){if(r.splice(i,1),r.length===0){this.removeItem(Xr.ACCOUNT_KEYS);return}else this.setItem(Xr.ACCOUNT_KEYS,JSON.stringify(r),t);this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeOutdatedAccount(e,t){this.removeItem(e),this.removeAccountKeyFromMap(e,t)}removeIdToken(e,t){super.removeIdToken(e,t),this.removeTokenKey(e,ut.ID_TOKEN,t)}removeAccessToken(e,t,r=!0){var i;super.removeAccessToken(e,t),(i=this.performanceClient)==null||i.incrementFields({accessTokensRemoved:1},t),r&&this.removeTokenKey(e,ut.ACCESS_TOKEN,t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");const r=this.getTokenKeys();let i=0;if(e.forEach(s=>{const o=r.accessToken.indexOf(s);o>-1&&(r.accessToken.splice(o,1),i++)}),i>0){this.logger.info(`removed ${i} accessToken keys from tokenKeys map`),this.setTokenKeys(r,t);return}}removeRefreshToken(e,t){super.removeRefreshToken(e,t),this.removeTokenKey(e,ut.REFRESH_TOKEN,t)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${Xr.TOKEN_KEYS}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}setTokenKeys(e,t){if(e.idToken.length===0&&e.accessToken.length===0&&e.refreshToken.length===0){this.removeItem(`${Xr.TOKEN_KEYS}.${this.clientId}`);return}else this.setItem(`${Xr.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(e),t)}addTokenKey(e,t,r){this.logger.trace("BrowserCacheManager addTokenKey called");const i=this.getTokenKeys();switch(t){case ut.ID_TOKEN:i.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(e));break;case ut.ACCESS_TOKEN:const s=i.accessToken.indexOf(e);s!==-1&&i.accessToken.splice(s,1),this.logger.trace(`access token ${s===-1?"added to":"updated in"} map`),i.accessToken.push(e);break;case ut.REFRESH_TOKEN:i.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Ne(U0)}this.setTokenKeys(i,r)}removeTokenKey(e,t,r,i=this.getTokenKeys()){switch(this.logger.trace("BrowserCacheManager removeTokenKey called"),t){case ut.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const s=i.idToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),i.idToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case ut.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=i.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),i.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case ut.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const a=i.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),i.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Ne(U0)}this.setTokenKeys(i,r)}getIdTokenCredential(e,t){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const i=this.validateAndParseJson(r);return!i||!x1(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),i)}setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=Ha(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,ut.ID_TOKEN,t)}getAccessTokenCredential(e,t){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,ut.ACCESS_TOKEN,t),null;const i=this.validateAndParseJson(r);return!i||!I1(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),i)}setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=Ha(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,ut.ACCESS_TOKEN,t)}getRefreshTokenCredential(e,t){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,ut.REFRESH_TOKEN,t),null;const i=this.validateAndParseJson(r);return!i||!R1(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),i)}setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=Ha(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,ut.REFRESH_TOKEN,t)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!nL(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r)}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const r=tL(e);this.setItem(r,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!ZF(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r)}setServerTelemetry(e,t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),r)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&rL(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(fh.WRAPPER_SKU,e),this.internalStorage.setItem(fh.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(fh.WRAPPER_SKU)||Te.EMPTY_STRING,t=this.internalStorage.getItem(fh.WRAPPER_VER)||Te.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(bn.ACTIVE_ACCOUNT_FILTERS),r=this.getItem(t);if(!r){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const s=this.generateCacheKey(bn.ACTIVE_ACCOUNT),o=this.getItem(s);if(!o)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const a=this.getAccountInfoFilteredBy({localAccountId:o},e);return a?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(a,e),a):null}const i=this.validateAndParseJson(r);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId,tenantId:i.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const r=this.generateCacheKey(bn.ACTIVE_ACCOUNT_FILTERS),i=this.generateCacheKey(bn.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const s={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Date.now().toString()};this.setItem(r,JSON.stringify(s),t),this.setItem(i,e.localAccountId,t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r),this.browserStorage.removeItem(i)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!eL(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r)}setThrottlingCache(e,t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),r)}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const s=this.cookieStorage.getItem(r);if(s)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),s}const i=this.temporaryCacheStorage.getItem(r);if(!i){if(this.cacheConfig.cacheLocation===xr.LocalStorage){const s=this.browserStorage.getItem(r);if(s)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),s}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i}setTemporaryCache(e,t,r){const i=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(i,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(i,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(e){await this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(t=>{(t.indexOf(Te.CACHE_PREFIX)!==-1||t.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(t)}),this.browserStorage.getKeys().forEach(t=>{(t.indexOf(Te.CACHE_PREFIX)!==-1||t.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(t)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(le.ClearTokensAndKeysWithClaims,t);const r=this.getTokenKeys();let i=0;r.accessToken.forEach(s=>{const o=this.getAccessTokenCredential(s,t);o!=null&&o.requestedClaimsHash&&s.includes(o.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(s,t),i++)}),i>0&&this.logger.warning(`${i} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):gi.startsWith(e,Te.CACHE_PREFIX)||gi.startsWith(e,bn.ADAL_ID_TOKEN)?e:`${Te.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=mi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Mt.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=mi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Mt.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=mi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Mt.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;const i=this.generateAuthorityKey(r);return this.getTemporaryCache(i)}updateCacheEntries(e,t,r,i,s){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const o=this.generateStateKey(e);this.setTemporaryCache(o,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,r,!1),s){const c={credential:s.homeAccountId,type:zr.HOME_ACCOUNT_ID};this.setTemporaryCache(Mt.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(i){const c={credential:i,type:zr.UPN};this.setTemporaryCache(Mt.CCS_CREDENTIAL,JSON.stringify(c),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(Mt.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Mt.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Mt.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Mt.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(Mt.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(Mt.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||Te.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(Mt.REQUEST_STATE)===-1)return;const r=this.temporaryCacheStorage.getItem(t);if(!r)return;const i=II(this.cryptoImpl,r);i&&i.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=nv(JSON.stringify(e));this.setTemporaryCache(Mt.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(Mt.REQUEST_PARAMS,!0);if(!t)throw Qe(eI);let r;try{r=JSON.parse(Bi(t))}catch(i){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${i}`),Qe(tI)}if(this.removeTemporaryItem(this.generateCacheKey(Mt.REQUEST_PARAMS)),!r.authority){const i=this.generateAuthorityKey(e),s=this.getTemporaryCache(i);if(!s)throw Qe(Zm);r.authority=s}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Mt.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${Te.CACHE_PREFIX}.${Mt.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${Te.CACHE_PREFIX}.${Mt.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Qe(GS);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(bn.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(bn.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(bn.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(bn.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=t||e;if(r){const i=ha(r,Bi);if(i.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.preferred_username;if(i.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t,r){const i=Ha(t);if(e!==i){const s=this.getItem(e);if(s)return this.browserStorage.removeItem(e),this.setItem(i,s,r),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),i;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){var a,l,c;const r=kf((a=e.account)==null?void 0:a.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let i;t.claims&&(i=await this.cryptoImpl.hashString(t.claims));const s=Pf((c=e.account)==null?void 0:c.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,Bi,void 0,e.tokenType,void 0,t.sshKid,t.claims,i),o={idToken:r,accessToken:s};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(i){if(i instanceof Ja&&this.performanceClient&&t)try{const s=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:s.refreshToken.length,cacheIdCount:s.idToken.length,cacheAtCount:s.accessToken.length},t)}catch{}throw i}}}const pU=(n,e)=>{const t={cacheLocation:xr.MemoryStorage,temporaryCacheLocation:xr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Y0(n,t,_d,e)};/*! @azure/msal-browser v3.30.0 2025-08-05 */function gU(n,e,t,r,i){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(r,i):[]}function mU(n,e,t,r){if(e.trace("getAccount called"),Object.keys(n).length===0)return e.warning("getAccount: No accountFilter provided"),null;const i=t.getAccountInfoFilteredBy(n,r);return i?(e.verbose("getAccount: Account matching provided filter found, returning"),i):(e.verbose("getAccount: No matching account found, returning null"),null)}function vU(n,e,t,r){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const i=t.getAccountInfoFilteredBy({username:n},r);return i?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),i):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function _U(n,e,t,r){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const i=t.getAccountInfoFilteredBy({homeAccountId:n},r);return i?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),i):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function yU(n,e,t,r){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const i=t.getAccountInfoFilteredBy({localAccountId:n},r);return i?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),i):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function EU(n,e,t){e.setActiveAccount(n,t)}function TU(n,e){return n.getActiveAccount(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const st={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.30.0 2025-08-05 */class wU{constructor(e){this.eventCallbacks=new Map,this.logger=e||new vo({})}addEventCallback(e,t,r){if(typeof window<"u"){const i=r||Z3();return this.eventCallbacks.has(i)?(this.logger.error(`Event callback with id: ${i} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(i,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${i}`),i)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,i){if(typeof window<"u"){const s={eventType:e,interactionType:t||null,payload:r||null,error:i||null,timestamp:Date.now()};this.eventCallbacks.forEach(([o,a],l)=>{(a.length===0||a.includes(e))&&(this.logger.verbose(`Emitting event to callback ${l}: ${e}`),o.apply(null,[s]))})}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class xI{constructor(e,t,r,i,s,o,a,l,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=s,this.navigationClient=o,this.nativeMessageHandler=l,this.correlationId=c||Wi(),this.logger=i.clone($r.MSAL_SKU,vl,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){Rn.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(this.correlationId),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,this.correlationId));try{await this.browserStorage.removeAccount(Rn.generateAccountCacheKey(e),this.correlationId),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(this.correlationId),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return Ct.getAbsoluteUrl(t,ds())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new zc(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(le.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const i={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.requestAuthority||this.config.auth.authority,o=r!=null&&r.length?r==="true":this.config.auth.instanceAware,a=t&&o?this.config.auth.authority.replace(Ct.getDomainFromUrl(s),t.environment):s,l=nr.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await Ve(MS,le.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,i,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Gt(IS);return c}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const AU=32;async function CU(n,e,t){n.addQueueMeasurement(le.GeneratePkceCodes,t);const r=da(SU,le.GenerateCodeVerifier,e,n,t)(n,e,t),i=await Ve(IU,le.GenerateCodeChallengeFromVerifier,e,n,t)(r,n,e,t);return{verifier:r,challenge:i}}function SU(n,e,t){try{const r=new Uint8Array(AU);return da(V3,le.GetRandomValues,e,n,t)(r),Bf(r)}catch{throw Qe(Xm)}}async function IU(n,e,t,r){e.addQueueMeasurement(le.GenerateCodeChallengeFromVerifier,r);try{const i=await Ve(EI,le.Sha256Digest,t,e,r)(n,e,r);return Bf(new Uint8Array(i))}catch{throw Qe(Xm)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function uv(n,e,t,r){t.addQueueMeasurement(le.InitializeBaseRequest,n.correlationId);const i=n.authority||e.auth.authority,s=[...n&&n.scopes||[]],o={...n,correlationId:n.correlationId,authority:i,scopes:s};if(!o.authenticationScheme)o.authenticationScheme=Ht.BEARER,r.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(o.authenticationScheme===Ht.SSH){if(!n.sshJwk)throw Gt(Of);if(!n.sshKid)throw Gt(AS)}r.verbose(`Authentication Scheme set to "${o.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!gi.isEmptyObj(n.claims)&&(o.requestedClaimsHash=await TI(n.claims)),o}async function xU(n,e,t,r,i){r.addQueueMeasurement(le.InitializeSilentRequest,n.correlationId);const s=await Ve(uv,le.InitializeBaseRequest,i,r,n.correlationId)(n,t,r,i);return{...n,...s,account:e,forceRefresh:n.forceRefresh||!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Pl extends xI{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(le.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const t=await Ve(CU,le.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:Te.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=Te.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const t={correlationId:this.correlationId||Wi(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Ct.getAbsoluteUrl(e.postLogoutRedirectUri,ds())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Ct.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ds())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Ct.getAbsoluteUrl(ds(),ds())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(le.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await Ve(this.getClientConfiguration.bind(this),le.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new US(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:i,requestExtraQueryParameters:s,account:o}=e;this.performanceClient.addQueueMeasurement(le.StandardInteractionClientGetClientConfiguration,this.correlationId);const a=await Ve(this.getDiscoveredAuthority.bind(this),le.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:i,requestExtraQueryParameters:s,account:o}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:$r.MSAL_SKU,version:vl,cpu:Te.EMPTY_STRING,os:Te.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(le.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),i={interactionType:t},s=mi.setRequestState(this.browserCrypto,e&&e.state||Te.EMPTY_STRING,i),a={...await Ve(uv,le.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:s,nonce:e.nonce||Wi(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return a;const l=e.account||this.browserStorage.getActiveAccount(this.correlationId);if(l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),a.account=l),!a.loginHint&&!l){const c=this.browserStorage.getLegacyLoginHint();c&&(a.loginHint=c)}return a}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const RU="ContentError",RI="user_switch";/*! @azure/msal-browser v3.30.0 2025-08-05 */const bU="USER_INTERACTION_REQUIRED",kU="USER_CANCEL",PU="NO_NETWORK",OU="PERSISTENT_ERROR",NU="DISABLED",DU="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.30.0 2025-08-05 */const MU=-2147186943,FU={[RI]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Oi extends Zt{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Oi.prototype),this.name="NativeAuthError",this.ext=r}}function La(n){if(n.ext&&n.ext.status&&(n.ext.status===OU||n.ext.status===NU)||n.ext&&n.ext.error&&n.ext.error===MU)return!0;switch(n.errorCode){case RU:return!0;default:return!1}}function Q0(n,e,t){if(t&&t.status)switch(t.status){case DU:return $0(FS);case bU:return new Ei(n,e);case kU:return Qe(ta);case PU:return Qe(Cd)}return new Oi(n,FU[n]||e,t)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class bI extends Pl{async acquireToken(e){this.performanceClient.addQueueMeasurement(le.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Qt.acquireTokenSilent_silentFlow),r=await Ve(this.getClientConfiguration.bind(this),le.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),i=new _3(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const o=(await Ve(i.acquireCachedToken.bind(i),le.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),o}catch(s){throw s instanceof Iu&&s.errorCode===ev&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),s}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t==null?void 0:t.account)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Za extends xI{constructor(e,t,r,i,s,o,a,l,c,u,f,p){var m;super(e,t,r,i,s,o,l,c,p),this.apiId=a,this.accountId=u,this.nativeMessageHandler=c,this.nativeStorageManager=f,this.silentCacheClient=new bI(e,this.nativeStorageManager,r,i,s,o,l,c,p),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const g=this.nativeMessageHandler.getExtensionId()===Ka.PREFERRED_EXTENSION_ID?"chrome":(m=this.nativeMessageHandler.getExtensionId())!=null&&m.length?"unknown":void 0;this.skus=zc.makeExtraSkuString({libraryName:$r.MSAL_SKU,libraryVersion:vl,extensionName:g,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[t3]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(le.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(le.NativeInteractionClientAcquireToken,e.correlationId),r=ji();try{const i=await this.initializeNativeRequest(e);try{const c=await this.acquireTokensFromCache(this.accountId,i);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),c}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...s}=i,o={method:Lo.GetToken,request:s},a=await this.nativeMessageHandler.sendMessage(o),l=this.validateNativeResponse(a);return await this.handleNativeResponse(l,i,r).then(c=>(t.end({success:!0,isNativeBroker:!0,requestId:c.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),c)).catch(c=>{throw t.end({success:!1,errorCode:c.errorCode,subErrorCode:c.subError,isNativeBroker:!0}),c})}catch(i){throw i instanceof Oi&&this.serverTelemetryManager.setNativeBrokerErrorCode(i.errorCode),i}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:dn.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Ne(F0);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},t.correlationId);if(!r)throw Ne(F0);try{const i=this.createSilentCacheRequest(t,r),s=await this.silentCacheClient.acquireToken(i),o={...r,idTokenClaims:s==null?void 0:s.idTokenClaims,idToken:s==null?void 0:s.idToken};return{...s,account:o}}catch(i){throw i}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const i=await this.initializeNativeRequest(r),s={method:Lo.GetToken,request:i};try{const l=await this.nativeMessageHandler.sendMessage(s);this.validateNativeResponse(l)}catch(l){if(l instanceof Oi&&(this.serverTelemetryManager.setNativeBrokerErrorCode(l.errorCode),La(l)))throw l}this.browserStorage.setTemporaryCache(Mt.NATIVE_REQUEST,JSON.stringify(i),!0);const o={apiId:Qt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,o)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(e==null||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:i,...s}=r;i&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Mt.NATIVE_REQUEST));const o={method:Lo.GetToken,request:s},a=ji();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(l);const c=this.handleNativeResponse(l,s,a);this.browserStorage.setInteractionInProgress(!1);const u=await c;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),u}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){var u;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const i=ha(e.id_token,Bi),s=this.createHomeAccountIdentifier(e,i),o=(u=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId))==null?void 0:u.homeAccountId;if(s!==o&&e.account.id!==t.accountId)throw Q0(RI);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=zm(this.browserStorage,a,s,Bi,this.correlationId,i,e.client_info,void 0,i.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,i,l,a.canonicalAuthority,r);return this.cacheAccount(l),this.cacheNativeTokens(e,t,s,i,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return Rn.generateHomeAccountId(e.client_info||Te.EMPTY_STRING,li.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?dn.fromString(e.scope):dn.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===Ht.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new ml(this.browserCrypto),i={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw Ne(Om);return r.signPopToken(e.access_token,t.keyId,i)}else return e.access_token}async generateAuthenticationResult(e,t,r,i,s,o){const a=this.addTelemetryFromNativeResponse(e),l=e.scope?dn.fromString(e.scope):dn.fromString(t.scope),c=e.account.properties||{},u=c.UID||r.oid||r.sub||Te.EMPTY_STRING,f=c.TenantId||r.tid||Te.EMPTY_STRING,p=Hm(i.getAccountInfo(),void 0,r,e.id_token);p.nativeAccountId!==e.account.id&&(p.nativeAccountId=e.account.id);const g=await this.generatePopAccessToken(e,t),m=t.tokenType===Ht.POP?Ht.POP:Ht.BEARER;return{authority:s,uniqueId:u,tenantId:f,scopes:l.asArray(),account:p,idToken:e.id_token,idTokenClaims:r,accessToken:g,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(o+e.expires_in)*1e3),tokenType:m,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,this.correlationId).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,r,i,s,o,a){const l=kf(r,t.authority,e.id_token||"",t.clientId,i.tid||""),c=t.tokenType===Ht.POP?Te.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,u=a+c,f=this.generateScopes(e,t),p=Pf(r,t.authority,s,t.clientId,i.tid||o,f.printScopes(),u,0,Bi,void 0,t.tokenType,void 0,t.keyId),g={idToken:l,accessToken:p};this.nativeStorageManager.saveCacheRecord(g,t.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw qC(Im,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new Ct(t);r.validateAsUri();const{scopes:i,...s}=e,o=new dn(i||[]);o.appendScopes(kl);const a=()=>{switch(this.apiId){case Qt.ssoSilent:case Qt.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),On.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case On.NONE:case On.CONSENT:case On.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Qe(dI)}},l={...s,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw Qe(pI);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=Ka.MATS_TELEMETRY,e.authenticationScheme===Ht.POP){const c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},u=new ml(this.browserCrypto);let f;if(l.keyId)f=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const p=await Ve(u.generateCnf.bind(u),le.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(c,this.logger);f=p.reqCnfString,l.keyId=p.kid,l.signPopToken=!0}l.reqCnf=f}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var s;const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Wm)&&e.extraParameters.hasOwnProperty(H0)&&e.extraParameters.hasOwnProperty(Zo);if(!e.embeddedClientId&&!t)return;let r="";const i=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[H0],r=e.extraParameters[Zo]),e.extraParameters={child_client_id:r,child_redirect_uri:i},(s=this.performanceClient)==null||s.addFields({embeddedClientId:r,embeddedRedirectUri:i},e.correlationId)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Di{constructor(e,t,r,i){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(le.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Ka.CHANNEL_ID,extensionId:this.extensionId,responseId:Wi(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((r,i)=>{this.resolvers.set(t.responseId,{resolve:r,reject:i})})}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const i=new Di(e,t,r,Ka.PREFERRED_EXTENSION_ID);return await i.sendHandshakeRequest(),i}catch{const s=new Di(e,t,r);return await s.sendHandshakeRequest(),s}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Ka.CHANNEL_ID,extensionId:this.extensionId,responseId:Wi(),body:{method:Lo.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Qe(cI)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Ka.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===Lo.HandshakeRequest){const r=this.handshakeResolvers.get(t.responseId);if(!r){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(Qe(uI))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{const s=t.body.method;if(s===Lo.Response){if(!r)return;const o=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(o)}`),o.status!=="Success")r.reject(Q0(o.code,o.description,o.ext));else if(o.result)o.result.code&&o.result.description?r.reject(Q0(o.result.code,o.result.description,o.result.ext)):r.resolve(o.result);else throw qC(Im,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(s===Lo.HandshakeResponse){if(!i){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(s){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${s}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(s):i&&i.reject(s)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,r,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case Ht.BEARER:case Ht.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class hv{constructor(e,t,r,i,s){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=i,this.performanceClient=s}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(le.HandleCodeResponse,t.correlationId);let r;try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(i){throw i instanceof _o&&i.subError===ta?Qe(ta):i}return Ve(this.handleCodeResponseFromServer.bind(this),le.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(le.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Ve(this.authModule.updateAuthority.bind(this.authModule),le.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const s=this.createCcsCredentials(t);s&&(this.authCodeRequest.ccsCredential=s)}return await Ve(this.authModule.acquireToken.bind(this.authModule),le.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:zr.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:zr.UPN}:null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function kI(n,e,t){const r=Td(n);if(!r)throw RS(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),Qe(KS)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Qe($S));return r}function LU(n,e,t){if(!n.state)throw Qe(Jm);const r=II(e,n.state);if(!r)throw Qe(jS);if(r.interactionType!==t)throw Qe(WS)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class UU extends Pl{constructor(e,t,r,i,s,o,a,l,c,u){super(e,t,r,i,s,o,a,c,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e){try{const r={popupName:this.generatePopupName(e.scopes||kl,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r))}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},i=e&&e.authority,s=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,s)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,i,s))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t){var s;this.logger.verbose("acquireTokenPopupAsync called");const r=this.initializeServerTelemetryManager(Qt.acquireTokenPopup),i=await Ve(this.initializeAuthorizationRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,tt.Popup);SI(i.authority);try{const o=await Ve(this.initializeAuthorizationCodeRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(i),a=await Ve(this.createAuthCodeClient.bind(this),le.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),l=Di.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let c;l&&(c=this.performanceClient.startMeasurement(le.FetchAccountIdWithNativeBroker,e.correlationId));const u=await a.getAuthCodeUrl({...i,nativeBroker:l}),f=new hv(a,this.browserStorage,o,this.logger,this.performanceClient),p=this.initiateAuthRequest(u,t);this.eventHandler.emitEvent(st.POPUP_OPENED,tt.Popup,{popupWindow:p},null);const g=await this.monitorPopupForHash(p,t.popupWindowParent),m=da(kI,le.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Pi.removeThrottle(this.browserStorage,this.config.auth.clientId,o),m.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Qe(Su);const _=new Za(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,m.accountId,this.nativeStorage,i.correlationId),{userRequestState:D}=mi.parseRequestState(this.browserCrypto,i.state);return await _.acquireToken({...i,state:D,prompt:void 0})}return await f.handleCodeResponse(m,i)}catch(o){throw(s=t.popup)==null||s.close(),o instanceof Zt&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),o}}async logoutPopupAsync(e,t,r,i){var o,a,l,c;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(st.LOGOUT_START,tt.Popup,e);const s=this.initializeServerTelemetryManager(Qt.logoutPopup);try{await this.clearCacheOnLogout(e.account);const u=await Ve(this.createAuthCodeClient.bind(this),le.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:r,account:e.account||void 0});try{u.authority.endSessionEndpoint}catch{if((o=e.account)!=null&&o.homeAccountId&&e.postLogoutRedirectUri&&u.authority.protocolMode===vs.OIDC){if(this.browserStorage.removeAccount((a=e.account)==null?void 0:a.homeAccountId,this.correlationId),this.eventHandler.emitEvent(st.LOGOUT_SUCCESS,tt.Popup,e),i){const g={apiId:Qt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},m=Ct.getAbsoluteUrl(i,ds());await this.navigationClient.navigateInternal(m,g)}(l=t.popup)==null||l.close();return}}const f=u.getLogoutUri(e);this.eventHandler.emitEvent(st.LOGOUT_SUCCESS,tt.Popup,e);const p=this.openPopup(f,t);if(this.eventHandler.emitEvent(st.POPUP_OPENED,tt.Popup,{popupWindow:p},null),await this.monitorPopupForHash(p,t.popupWindowParent).catch(()=>{}),i){const g={apiId:Qt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},m=Ct.getAbsoluteUrl(i,ds());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${m}`),await this.navigationClient.navigateInternal(m,g)}else this.logger.verbose("No main window navigation requested")}catch(u){throw(c=t.popup)==null||c.close(),u instanceof Zt&&(u.setCorrelationId(this.correlationId),s.cacheFailedRequest(u)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(st.LOGOUT_FAILURE,tt.Popup,null,u),this.eventHandler.emitEvent(st.LOGOUT_END,tt.Popup),u}this.eventHandler.emitEvent(st.LOGOUT_END,tt.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Qe(Ff)}monitorPopupForHash(e,t){return new Promise((r,i)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const s=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(s),i(Qe(ta));return}let o="";try{o=e.location.href}catch{}if(!o||o==="about:blank")return;clearInterval(s);let a="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===Cu.QUERY?a=e.location.search:a=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw Qe(zS);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),Qe(qS)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:i}){var g,m,v,_;const s=i.screenLeft?i.screenLeft:i.screenX,o=i.screenTop?i.screenTop:i.screenY,a=i.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=i.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=(g=r.popupSize)==null?void 0:g.width,u=(m=r.popupSize)==null?void 0:m.height,f=(v=r.popupPosition)==null?void 0:v.top,p=(_=r.popupPosition)==null?void 0:_.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=$r.POPUP_WIDTH),(!u||u<0||u>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=$r.POPUP_HEIGHT),(!f||f<0||f>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,l/2-$r.POPUP_HEIGHT/2+o)),(!p||p<0||p>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),p=Math.max(0,a/2-$r.POPUP_WIDTH/2+s)),i.open(e,t,`width=${c}, height=${u}, top=${f}, left=${p}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(tt.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${$r.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${$r.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class X1{constructor(e,t,r,i,s){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=i,this.performanceClient=s}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Mt.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Mt.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:Qt.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,r);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,r);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Qe(Ff)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),i=this.browserStorage.getTemporaryCache(r);if(!i)throw Ne(vd,"Cached State");let s;try{s=this.authModule.handleFragmentResponse(e,i)}catch(c){throw c instanceof _o&&c.subError===ta?Qe(ta):c}const o=this.browserStorage.generateNonceKey(i),a=this.browserStorage.getTemporaryCache(o);if(this.authCodeRequest.code=s.code,s.cloud_instance_host_name&&await Ve(this.authModule.updateAuthority.bind(this.authModule),le.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(s.cloud_instance_host_name,this.authCodeRequest.correlationId),s.nonce=a||void 0,s.state=i,s.client_info)this.authCodeRequest.clientInfo=s.client_info;else{const c=this.checkCcsCredentials();c&&(this.authCodeRequest.ccsCredential=c)}const l=await this.authModule.acquireToken(this.authCodeRequest,s);return this.browserStorage.cleanRequestByState(t),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(Mt.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function BU(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation"),e=n.length?n[0]:void 0;return e==null?void 0:e.type}class VU extends Pl{constructor(e,t,r,i,s,o,a,l,c,u){super(e,t,r,i,s,o,a,c,u),this.nativeStorage=l}async acquireToken(e){const t=await Ve(this.initializeAuthorizationRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,tt.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const r=this.initializeServerTelemetryManager(Qt.acquireTokenRedirect),i=s=>{s.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(st.RESTORE_FROM_BFCACHE,tt.Redirect))};try{const s=await Ve(this.initializeAuthorizationCodeRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),o=await Ve(this.createAuthCodeClient.bind(this),le.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new X1(o,this.browserStorage,s,this.logger,this.performanceClient),l=await o.getAuthCodeUrl({...t,nativeBroker:Di.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",i),await a.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(s){throw s instanceof Zt&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),window.removeEventListener("pageshow",i),this.browserStorage.cleanRequestByState(t.state),s}}async handleRedirectPromise(e="",t){const r=this.initializeServerTelemetryManager(Qt.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[i,s]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(tt.Redirect),BU()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const o=this.browserStorage.getTemporaryCache(Mt.ORIGIN_URI,!0)||Te.EMPTY_STRING,a=Ct.removeHashFromUrl(o),l=Ct.removeHashFromUrl(window.location.href);if(a===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),o.indexOf("#")>-1&&q3(o),await this.handleResponse(i,r);if(this.config.auth.navigateToLoginRequestUrl){if(!av()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Mt.URL_HASH,s,!0);const c={apiId:Qt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let u=!0;if(!o||o==="null"){const f=Y3();this.browserStorage.setTemporaryCache(Mt.ORIGIN_URI,f,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),u=await this.navigationClient.navigateInternal(f,c)}else this.logger.verbose(`Navigating to loginRequestUrl: ${o}`),u=await this.navigationClient.navigateInternal(o,c);if(!u)return await this.handleResponse(i,r)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,r);return null}catch(i){throw i instanceof Zt&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),this.browserStorage.cleanRequestByInteractionType(tt.Redirect),i}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===Cu.QUERY?t=window.location.search:t=window.location.hash);let r=Td(t);if(r){try{LU(r,this.browserCrypto,tt.Redirect)}catch(s){return s instanceof Zt&&this.logger.error(`Interaction type validation failed due to ${s.errorCode}: ${s.errorMessage}`),[null,""]}return G3(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const i=this.browserStorage.getTemporaryCache(Mt.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Mt.URL_HASH)),i&&(r=Td(i),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,i]):[null,""]}async handleResponse(e,t){const r=e.state;if(!r)throw Qe(Jm);const i=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Qe(Su);const l=new Za(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,i.correlationId),{userRequestState:c}=mi.parseRequestState(this.browserCrypto,r);return l.acquireToken({...i,state:c,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}const s=this.browserStorage.getCachedAuthority(r);if(!s)throw Qe(Zm);const o=await Ve(this.createAuthCodeClient.bind(this),le.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:s});return Pi.removeThrottle(this.browserStorage,this.config.auth.clientId,i),new X1(o,this.browserStorage,i,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){var i,s;this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Qt.logout);try{this.eventHandler.emitEvent(st.LOGOUT_START,tt.Redirect,e),await this.clearCacheOnLogout(t.account);const o={apiId:Qt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await Ve(this.createAuthCodeClient.bind(this),le.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===vs.OIDC)try{a.authority.endSessionEndpoint}catch{if((i=t.account)!=null&&i.homeAccountId){this.browserStorage.removeAccount((s=t.account)==null?void 0:s.homeAccountId,this.correlationId),this.eventHandler.emitEvent(st.LOGOUT_SUCCESS,tt.Redirect,t);return}}const l=a.getLogoutUri(t);if(this.eventHandler.emitEvent(st.LOGOUT_SUCCESS,tt.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,o);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,o);return}}catch(o){throw o instanceof Zt&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),this.eventHandler.emitEvent(st.LOGOUT_FAILURE,tt.Redirect,null,o),this.eventHandler.emitEvent(st.LOGOUT_END,tt.Redirect),o}this.eventHandler.emitEvent(st.LOGOUT_END,tt.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Ct.getAbsoluteUrl(t,ds())}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function HU(n,e,t,r,i){if(e.addQueueMeasurement(le.SilentHandlerInitiateAuthRequest,r),!n)throw t.info("Navigate url is empty"),Qe(Ff);return i?Ve(KU,le.SilentHandlerLoadFrame,t,e,r)(n,i,e,r):da(jU,le.SilentHandlerLoadFrameSync,t,e,r)(n)}async function $U(n,e,t,r,i,s,o){return r.addQueueMeasurement(le.SilentHandlerMonitorIframeForHash,s),new Promise((a,l)=>{e<q0&&i.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${q0}ms). This may result in timeouts.`);const c=window.setTimeout(()=>{window.clearInterval(u),l(Qe(YS))},e),u=window.setInterval(()=>{let f="";const p=n.contentWindow;try{f=p?p.location.href:""}catch{}if(!f||f==="about:blank")return;let g="";p&&(o===Cu.QUERY?g=p.location.search:g=p.location.hash),window.clearTimeout(c),window.clearInterval(u),a(g)},t)}).finally(()=>{da(WU,le.RemoveHiddenIframe,i,r,s)(n)})}function KU(n,e,t,r){return t.addQueueMeasurement(le.SilentHandlerLoadFrame,r),new Promise((i,s)=>{const o=PI();window.setTimeout(()=>{if(!o){s("Unable to load iframe");return}o.src=n,i(o)},e)})}function jU(n){const e=PI();return e.src=n,e}function PI(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function WU(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class GU extends Pl{constructor(e,t,r,i,s,o,a,l,c,u,f){super(e,t,r,i,s,o,l,u,f),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(le.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==On.NONE&&t.prompt!==On.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${On.NONE}`),t.prompt=On.NONE):t.prompt=On.NONE;const r=await Ve(this.initializeAuthorizationRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,tt.Silent);SI(r.authority);const i=this.initializeServerTelemetryManager(this.apiId);let s;try{return s=await Ve(this.createAuthCodeClient.bind(this),le.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:i,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),await Ve(this.silentTokenHelper.bind(this),le.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(s,r)}catch(o){if(o instanceof Zt&&(o.setCorrelationId(this.correlationId),i.cacheFailedRequest(o)),!s||!(o instanceof Zt)||o.errorCode!==$r.INVALID_GRANT_ERROR)throw o;this.performanceClient.addFields({retryError:o.errorCode},this.correlationId);const a=await Ve(this.initializeAuthorizationRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,tt.Silent);return await Ve(this.silentTokenHelper.bind(this),le.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(s,a)}}logout(){return Promise.reject(Qe(Lf))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(le.SilentIframeClientTokenHelper,r);const i=await Ve(this.initializeAuthorizationCodeRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(t),s=await Ve(e.getAuthCodeUrl.bind(e),le.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...t,nativeBroker:Di.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),o=new hv(e,this.browserStorage,i,this.logger,this.performanceClient),a=await Ve(HU,le.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(s,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,c=await Ve($U,le.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,l),u=da(kI,le.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(c,l,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Qe(Su);const f=new Za(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,r),{userRequestState:p}=mi.parseRequestState(this.browserCrypto,t.state);return Ve(f.acquireToken.bind(f),le.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...t,state:p,prompt:t.prompt||On.NONE})}return Ve(o.handleCodeResponse.bind(o),le.HandleCodeResponse,this.logger,this.performanceClient,r)(u,t)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class qU extends Pl{async acquireToken(e){this.performanceClient.addQueueMeasurement(le.SilentRefreshClientAcquireToken,e.correlationId);const t=await Ve(uv,le.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const i=this.initializeServerTelemetryManager(Qt.acquireTokenSilent_silentFlow),s=await this.createRefreshTokenClient({serverTelemetryManager:i,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Ve(s.acquireTokenByRefreshToken.bind(s),le.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(o=>{throw o.setCorrelationId(this.correlationId),i.cacheFailedRequest(o),o})}logout(){return Promise.reject(Qe(Lf))}async createRefreshTokenClient(e){const t=await Ve(this.getClientConfiguration.bind(this),le.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new K0(t,this.performanceClient)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class zU{constructor(e,t,r,i){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=r,this.cryptoObj=i}loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw Qe(Uf);const i=e.correlationId||Wi(),s=t.id_token?ha(t.id_token,Bi):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new nr(nr.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||Wi()):void 0,l=this.loadAccount(e,r.clientInfo||t.client_info||"",i,s,a),c=this.loadIdToken(t,l.homeAccountId,l.environment,l.realm,i),u=this.loadAccessToken(e,t,l.homeAccountId,l.environment,l.realm,r,i),f=this.loadRefreshToken(t,l.homeAccountId,l.environment,i);return this.generateAuthenticationResult(e,{account:l,idToken:c,accessToken:u,refreshToken:f},s,a)}loadAccount(e,t,r,i,s){if(this.logger.verbose("TokenCache - loading account"),e.account){const c=Rn.createFromAccountInfo(e.account);return this.storage.setAccount(c,r),c}else if(!s||!t&&!i)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Qe(iI);const o=Rn.generateHomeAccountId(t,s.authorityType,this.logger,this.cryptoObj,i),a=i==null?void 0:i.tid,l=zm(this.storage,s,o,Bi,r,i,t,s.hostnameAndPort,a,void 0,void 0,this.logger);return this.storage.setAccount(l,r),l}loadIdToken(e,t,r,i,s){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const o=kf(t,r,e.id_token,this.config.auth.clientId,i);return this.storage.setIdTokenCredential(o,s),o}loadAccessToken(e,t,r,i,s,o,a){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const l=t.scope?dn.fromString(t.scope):new dn(e.scopes),c=o.expiresOn||t.expires_in+new Date().getTime()/1e3,u=o.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,f=Pf(r,i,t.access_token,this.config.auth.clientId,s,l.printScopes(),c,u,Bi);return this.storage.setAccessTokenCredential(f,a),f}loadRefreshToken(e,t,r,i){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const s=dS(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(s,i),s}generateAuthenticationResult(e,t,r,i){var u,f,p;let s="",o=[],a=null,l;t!=null&&t.accessToken&&(s=t.accessToken.secret,o=dn.fromString(t.accessToken.target).asArray(),a=new Date(Number(t.accessToken.expiresOn)*1e3),l=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const c=t.account;return{authority:i?i.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:o,account:c.getAccountInfo(),idToken:((u=t.idToken)==null?void 0:u.secret)||"",idTokenClaims:r||{},accessToken:s,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((f=t.refreshToken)==null?void 0:f.familyId)||"",tokenType:((p=t==null?void 0:t.accessToken)==null?void 0:p.tokenType)||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class YU extends US{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class QU extends Pl{constructor(e,t,r,i,s,o,a,l,c,u){super(e,t,r,i,s,o,l,c,u),this.apiId=a}async acquireToken(e){if(!e.code)throw Qe(sI);const t=await Ve(this.initializeAuthorizationRequest.bind(this),le.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,tt.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const i={...t,code:e.code},s=await Ve(this.getClientConfiguration.bind(this),le.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new YU(s);this.logger.verbose("Auth code client created");const a=new hv(o,this.browserStorage,i,this.logger,this.performanceClient);return await Ve(a.handleCodeResponseFromServer.bind(a),le.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(i){throw i instanceof Zt&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),i}}logout(){return Promise.reject(Qe(Lf))}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function Si(n){const e=n==null?void 0:n.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function gh(n,e){try{lv(n)}catch(t){throw e.end({success:!1},t),t}}class Vf{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new _l(this.logger,this.performanceClient):_d,this.eventHandler=new wU(this.logger),this.browserStorage=this.isBrowserEnvironment?new Y0(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,l3(this.config.auth),this.performanceClient):pU(this.config.auth.clientId,this.logger);const t={cacheLocation:xr.MemoryStorage,temporaryCacheLocation:xr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Y0(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new zU(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const r=new Vf(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(st.INITIALIZE_END);return}const t=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,i=this.performanceClient.startMeasurement(le.InitializeClientApplication,t);if(this.eventHandler.emitEvent(st.INITIALIZE_START),r)try{this.nativeExtensionProvider=await Di.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(s){this.logger.verbose(s)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await Ve(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),le.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(st.INITIALIZE_END),i.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),CI(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return typeof r>"u"?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),i=r&&Di.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,s=i?r==null?void 0:r.correlationId:this.browserStorage.getTemporaryCache(Mt.CORRELATION_ID,!0)||"",o=this.performanceClient.startMeasurement(le.AcquireTokenRedirect,s);this.eventHandler.emitEvent(st.HANDLE_REDIRECT_START,tt.Redirect);let a;if(i&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new Za(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qt.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=Ve(l.handleRedirectPromise.bind(l),le.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,o.event.correlationId)(this.performanceClient,o.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(s);a=Ve(l.handleRedirectPromise.bind(l),le.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,o.event.correlationId)(e,o)}return a.then(l=>(l?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(st.LOGIN_SUCCESS,tt.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_SUCCESS,tt.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),o.end({success:!0,accountType:Si(l.account)})):o.event.errorCode?o.end({success:!1}):o.discard(),this.eventHandler.emitEvent(st.HANDLE_REDIRECT_END,tt.Redirect),l)).catch(l=>{const c=l;throw t.length>0?this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_FAILURE,tt.Redirect,null,c):this.eventHandler.emitEvent(st.LOGIN_FAILURE,tt.Redirect,null,c),this.eventHandler.emitEvent(st.HANDLE_REDIRECT_END,tt.Redirect),o.end({success:!1},c),l})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement(le.AcquireTokenPreRedirect,t);r.add({accountType:Si(e.account),scenarioId:e.scenarioId});const i=e.onRedirectNavigate;if(i)e.onRedirectNavigate=o=>{const a=typeof i=="function"?i(o):void 0;return a!==!1?r.end({success:!0}):r.discard(),a};else{const o=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=a=>{const l=typeof o=="function"?o(a):void 0;return l!==!1?r.end({success:!0}):r.discard(),l}}const s=this.getAllAccounts().length>0;try{q1(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),s?this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_START,tt.Redirect,e):this.eventHandler.emitEvent(st.LOGIN_START,tt.Redirect,e);let o;return this.nativeExtensionProvider&&this.canUseNative(e)?o=new Za(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qt.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch(l=>{if(l instanceof Oi&&La(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(l instanceof Ei)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):o=this.createRedirectClient(t).acquireToken(e),await o}catch(o){throw r.end({success:!1},o),s?this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_FAILURE,tt.Redirect,null,o):this.eventHandler.emitEvent(st.LOGIN_FAILURE,tt.Redirect,null,o),o}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(le.AcquireTokenPopup,t);r.add({scenarioId:e.scenarioId,accountType:Si(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),gh(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(o){return Promise.reject(o)}const i=this.getAllAccounts();i.length>0?this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_START,tt.Popup,e):this.eventHandler.emitEvent(st.LOGIN_START,tt.Popup,e);let s;return this.canUseNative(e)?s=this.acquireTokenNative({...e,correlationId:t},Qt.acquireTokenPopup).then(o=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,accountType:Si(o.account)}),o)).catch(o=>{if(o instanceof Oi&&La(o))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(o instanceof Ei)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),o}):s=this.createPopupClient(t).acquireToken(e),s.then(o=>(i.length<this.getAllAccounts().length?this.eventHandler.emitEvent(st.LOGIN_SUCCESS,tt.Popup,o):this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_SUCCESS,tt.Popup,o),r.end({success:!0,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Si(o.account)}),o)).catch(o=>(i.length>0?this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_FAILURE,tt.Popup,null,o):this.eventHandler.emitEvent(st.LOGIN_FAILURE,tt.Popup,null,o),r.end({success:!1},o),Promise.reject(o)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var s,o;const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(le.SsoSilent,t),(s=this.ssoSilentMeasurement)==null||s.add({scenarioId:e.scenarioId,accountType:Si(e.account)}),gh(this.initialized,this.ssoSilentMeasurement),(o=this.ssoSilentMeasurement)==null||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(st.SSO_SILENT_START,tt.Silent,r);let i;return this.canUseNative(r)?i=this.acquireTokenNative(r,Qt.ssoSilent).catch(a=>{if(a instanceof Oi&&La(a))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw a}):i=this.createSilentIframeClient(r.correlationId).acquireToken(r),i.then(a=>{var l;return this.eventHandler.emitEvent(st.SSO_SILENT_SUCCESS,tt.Silent,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Si(a.account)}),a}).catch(a=>{var l;throw this.eventHandler.emitEvent(st.SSO_SILENT_FAILURE,tt.Silent,null,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},a),a}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(le.AcquireTokenByCode,t);gh(this.initialized,r),this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_BY_CODE_START,tt.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Qe(aI);if(e.code){const i=e.code;let s=this.hybridAuthCodeResponses.get(i);return s?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),s=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(o=>(this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_BY_CODE_SUCCESS,tt.Silent,o),this.hybridAuthCodeResponses.delete(i),r.end({success:!0,isNativeBroker:o.fromNativeBroker,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Si(o.account)}),o)).catch(o=>{throw this.hybridAuthCodeResponses.delete(i),this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_BY_CODE_FAILURE,tt.Silent,null,o),r.end({success:!1},o),o}),this.hybridAuthCodeResponses.set(i,s)),await s}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const i=await this.acquireTokenNative({...e,correlationId:t},Qt.acquireTokenByCode,e.nativeAccountId).catch(s=>{throw s instanceof Oi&&La(s)&&(this.nativeExtensionProvider=void 0),s});return r.end({accountType:Si(i.account),success:!0}),i}else throw Qe(lI);else throw Qe(oI)}catch(i){throw this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_BY_CODE_FAILURE,tt.Silent,null,i),r.end({success:!1},i),i}}async acquireTokenByCodeAsync(e){var i;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(le.AcquireTokenByCodeAsync,e.correlationId),(i=this.acquireTokenByCodeAsyncMeasurement)==null||i.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(s=>{var o;return(o=this.acquireTokenByCodeAsyncMeasurement)==null||o.end({success:!0,fromCache:s.fromCache,isNativeBroker:s.fromNativeBroker}),s}).catch(s=>{var o;throw(o=this.acquireTokenByCodeAsyncMeasurement)==null||o.end({success:!1},s),s}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(le.AcquireTokenFromCache,e.correlationId),t){case Ur.Default:case Ur.AccessToken:case Ur.AccessTokenAndRefreshToken:const r=this.createSilentCacheClient(e.correlationId);return Ve(r.acquireToken.bind(r),le.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ne(hs)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(le.AcquireTokenByRefreshToken,e.correlationId),t){case Ur.Default:case Ur.AccessTokenAndRefreshToken:case Ur.RefreshToken:case Ur.RefreshTokenAndNetwork:const r=this.createSilentRefreshClient(e.correlationId);return Ve(r.acquireToken.bind(r),le.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ne(hs)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(le.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Ve(t.acquireToken.bind(t),le.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return q1(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return lv(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return gU(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return mU(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return vU(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return _U(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return yU(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();EU(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return TU(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=Rn.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Qe(Su);return new Za(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Di.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case On.NONE:case On.CONSENT:case On.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new UU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new VU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new GU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qt.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new bI(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new qU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new QU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qt.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return AI(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){var t;try{(t=e.key)!=null&&t.includes(bn.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(st.ACTIVE_ACCOUNT_CHANGED);const r=e.newValue||e.oldValue;if(!r)return;const i=JSON.parse(r);if(typeof i!="object"||!Rn.isAccountEntity(i))return;const o=gl.toObject(new Rn,i).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(st.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(st.ACCOUNT_REMOVED,void 0,o))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Wi():Te.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||j1})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||j1})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(le.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),gh(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const i=e.account||this.getActiveAccount();if(!i)throw Qe(ZS);r.add({accountType:Si(i)});const s={clientId:this.config.auth.clientId,authority:e.authority||Te.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:i.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},o=JSON.stringify(s),a=this.activeSilentTokenRequests.get(o);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const l=Ve(this.acquireTokenSilentAsync.bind(this),le.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},i).then(c=>(this.activeSilentTokenRequests.delete(o),r.end({success:!0,fromCache:c.fromCache,isNativeBroker:c.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c)).catch(c=>{throw this.activeSilentTokenRequests.delete(o),r.end({success:!1},c),c});return this.activeSilentTokenRequests.set(o,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),{...await a,state:e.state}}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(le.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_START,tt.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const i=await Ve(xU,le.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),s=e.cacheLookupPolicy||Ur.Default;return this.acquireTokenSilentNoIframe(i,s).catch(async a=>{if(XU(a,s))if(this.activeIframeRequest)if(s!==Ur.Skip){const[c,u]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${u}`,i.correlationId);const f=this.performanceClient.startMeasurement(le.AwaitConcurrentIframe,i.correlationId);f.add({awaitIframeCorrelationId:u});const p=await c;if(f.end({success:p}),p)return this.logger.verbose(`Parallel iframe request with correlationId: ${u} succeeded. Retrying cache and/or RT redemption`,i.correlationId),this.acquireTokenSilentNoIframe(i,s);throw this.logger.info(`Iframe request with correlationId: ${u} failed. Interaction is required.`),a}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",i.correlationId),Ve(this.acquireTokenBySilentIframe.bind(this),le.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i);else{let c;return this.activeIframeRequest=[new Promise(u=>{c=u}),i.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",i.correlationId),Ve(this.acquireTokenBySilentIframe.bind(this),le.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i).then(u=>(c(!0),u)).catch(u=>{throw c(!1),u}).finally(()=>{this.activeIframeRequest=void 0})}else throw a}).then(a=>(this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_SUCCESS,tt.Silent,a),e.correlationId&&this.performanceClient.addFields({fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker},e.correlationId),a)).catch(a=>{throw this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_FAILURE,tt.Silent,null,a),a}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,t){return Di.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,Qt.acquireTokenSilent_silentFlow).catch(async r=>{throw r instanceof Oi&&La(r)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,Ne(hs)):r})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),Ve(this.acquireTokenFromCache.bind(this),le.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(r=>{if(t===Ur.AccessToken)throw r;return this.eventHandler.emitEvent(st.ACQUIRE_TOKEN_NETWORK_START,tt.Silent,e),Ve(this.acquireTokenByRefreshToken.bind(this),le.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}function XU(n,e){const t=!(n instanceof Ei&&n.subError!==Mf),r=n.errorCode===$r.INVALID_GRANT_ERROR||n.errorCode===hs,i=t&&r||n.errorCode===Ad||n.errorCode===qm,s=O3.includes(e);return i&&s}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function JU(n,e){const t=new na(n);return await t.initialize(),Vf.createController(t,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class dv{static async createPublicClientApplication(e){const t=await JU(e);return new dv(e,t)}constructor(e,t){this.controller=t||new Vf(new na(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const ZU={auth:{clientId:"69a6554e-8220-4fff-b2d5-895e6031f816",authority:"https://login.microsoftonline.com/consumers",redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}},Fp={scopes:["User.Read","Files.ReadWrite","offline_access"]},ns=new dv(ZU);async function e6(){await ns.initialize()}const Ms=la("auth",()=>{const n=Se(null),e=Se(null),t=Se(null),r=Se(null),i=Se(!0);function s(){console.log("Initializing auth listener and handling MSAL redirect..."),ns.handleRedirectPromise().then(m=>{m?(console.log("MSAL redirect response received:",m.account.username),t.value=m.account,r.value=m.accessToken,console.log("Microsoft redirect login successful:",m.account.username)):console.log("No MSAL redirect response (direct page load)")}).catch(m=>{console.error("Error handling MSAL redirect:",m)}),mN(Da,async m=>{if(console.log("Firebase auth state changed:",m==null?void 0:m.uid),m){n.value=m,await c(m.uid);const v=ns.getAllAccounts();v.length>0&&(t.value=v[0],console.log("Restored Microsoft account from cache:",v[0].username))}else n.value=null,e.value=null;i.value=!1})}async function o(){try{const m=await LN(Da,xF);return n.value=m.user,await c(m.user.uid),m.user}catch(m){throw console.error("Google sign-in error:",m),m}}async function a(){try{const m=ns.getAllAccounts();if(m.length>0){console.log("Microsoft account already exists:",m[0].username),t.value=m[0];return}await ns.loginRedirect(Fp)}catch(m){throw console.error("Microsoft sign-in error:",m),m}}async function l(){if(!t.value)throw new Error("Not signed in with Microsoft");try{const m=await ns.acquireTokenSilent({...Fp,account:t.value});return r.value=m.accessToken,m.accessToken}catch{throw await ns.acquireTokenRedirect(Fp),new Error("Redirecting for authentication...")}}async function c(m){try{const v=await Am(co(Xt,"users",m));v.exists()?e.value=v.data():e.value=null}catch(v){console.error("Error loading user data:",v)}}async function u(m){try{const{collection:v,query:_,where:D,getDocs:b}=await ry(async()=>{const{collection:W,query:A,where:w,getDocs:E}=await Promise.resolve().then(()=>y1);return{collection:W,query:A,where:w,getDocs:E}},void 0),T=v(Xt,"employees"),R=_(T,D("Email","==",m)),B=await b(R);if(!B.empty){const W=B.docs[0].data();return W.isSupervisor===!0||W.Role==="Supervisor"}return!1}catch(v){return console.error("Error checking supervisor status:",v),!1}}async function f(m,v=!1){var E,C,I;if(console.log("registerUser called with:",{employeeData:m,isSupervisor:v,hasUser:!!n.value,hasMsalAccount:!!t.value}),!v&&((E=n.value)!=null&&E.email)&&await u(n.value.email)&&(v=!0,console.log("User is supervisor based on employees collection")),v&&!n.value){console.log("Creating anonymous Firebase user for supervisor...");const x=await wy(Da);n.value=x.user,console.log("Anonymous user created:",x.user.uid)}if(!n.value)throw new Error("No authenticated user");const{collection:_,query:D,where:b,getDocs:T,deleteDoc:R}=await ry(async()=>{const{collection:x,query:P,where:ie,getDocs:Q,deleteDoc:ae}=await Promise.resolve().then(()=>y1);return{collection:x,query:P,where:ie,getDocs:Q,deleteDoc:ae}},void 0),B=_(Xt,"users"),W=D(B,b("employeeId","==",m.Id)),A=await T(W);if(!A.empty)for(const x of A.docs)x.id!==n.value.uid&&(console.log(`Found duplicate user with employeeId ${m.Id}. Removing old user: ${x.id}`),await R(co(Xt,"users",x.id)),console.log(`Deleted duplicate user: ${x.id}`));const w={uid:n.value.uid,email:n.value.email||((C=t.value)==null?void 0:C.username),displayName:n.value.displayName||((I=t.value)==null?void 0:I.name),photoURL:n.value.photoURL,employeeId:m.Id,employeeFirstName:m.FirstName,employeeLastName:m.EmployeeLastName||m.LastName,position:m.Position,role:v?"Supervisor":"Employee",isSupervisor:v,registeredAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return console.log("Saving user info to Firestore:",w),await $C(co(Xt,"users",n.value.uid),w),e.value=w,console.log("User registered successfully"),w}async function p(){if(!n.value){const m=await wy(Da);return n.value=m.user,m.user}return n.value}async function g(){try{await vN(Da),t.value&&(await ns.logoutPopup({account:t.value}),t.value=null,r.value=null),n.value=null,e.value=null}catch(m){throw console.error("Sign out error:",m),m}}return{user:n,userData:e,msalAccount:t,msalAccessToken:r,msalInstance:ns,loading:i,initAuthListener:s,signInWithGoogle:o,signInWithMicrosoft:a,getMicrosoftToken:l,registerUser:f,createAnonymousUser:p,checkEmployeeSupervisorStatus:u,signOut:g}}),t6={key:0,class:"in-app-browser-overlay"},n6={__name:"App",setup(n){const e=Ms(),t=Se(!1),r=()=>{const a=navigator.userAgent||navigator.vendor||window.opera;return a.indexOf("FBAN")>-1||a.indexOf("FBAV")>-1||a.indexOf("Messenger")>-1||a.indexOf("Instagram")>-1},i=()=>{const a=window.location.href,l=navigator.userAgent||navigator.vendor||window.opera;if(/android/i.test(l)){const c=`intent://${a.replace(/https?:\/\//,"")}#Intent;scheme=https;action=android.intent.action.VIEW;end;`;window.location.href=c,setTimeout(()=>{s()},2e3);return}if(/iPad|iPhone|iPod/.test(l)){const c=a.replace(/^https:\/\//,"x-safari-https://").replace(/^http:\/\//,"x-safari-http://");window.location.href=c,setTimeout(()=>{s()},2e3);return}s()},s=()=>{const a=window.location.href;navigator.clipboard.writeText(a).then(()=>{alert("Link !   browser- ,  link-  .")}).catch(()=>{const l=document.createElement("textarea");l.value=a,document.body.appendChild(l),l.select(),document.execCommand("copy"),document.body.removeChild(l),alert("Link !   browser- ,  link-  .")})},o=()=>{t.value=!1,sessionStorage.setItem("in-app-browser-warning-dismissed","true")};return Dr(async()=>{const a=sessionStorage.getItem("in-app-browser-warning-dismissed");r()&&!a&&(t.value=!0),await e6(),e.initAuthListener()}),(a,l)=>{const c=x2("router-view");return ee(),te("div",null,[t.value?(ee(),te("div",t6,[d("div",{class:"in-app-browser-modal"},[l[0]||(l[0]=d("div",{class:"modal-icon"},"",-1)),l[1]||(l[1]=d("h2",null,"Browser-  ",-1)),l[2]||(l[2]=d("p",null," Facebook Messenger browser- .",-1)),l[3]||(l[3]=d("p",null,"     .",-1)),d("button",{onClick:i,class:"open-browser-btn"},"   Browser-  "),l[4]||(l[4]=d("div",{class:"divider"},[d("span",null,"")],-1)),l[5]||(l[5]=d("div",{class:"manual-instructions"},[d("p",null,[d("strong",null," :")]),d("p",null,[wr("    "),d("strong",null,""),wr("   "),d("strong",null,'"Open in Browser"'),wr("  ")])],-1)),d("button",{onClick:o,class:"dismiss-btn"},"  ")])])):Ke("",!0),fn(c)])}}};/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const Ua=typeof document<"u";function OI(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function r6(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&OI(n.default)}const kt=Object.assign;function Lp(n,e){const t={};for(const r in e){const i=e[r];t[r]=Ti(i)?i.map(n):n(i)}return t}const Ic=()=>{},Ti=Array.isArray;function J1(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}const NI=/#/g,i6=/&/g,s6=/\//g,o6=/=/g,a6=/\?/g,DI=/\+/g,l6=/%5B/g,c6=/%5D/g,MI=/%5E/g,u6=/%60/g,FI=/%7B/g,h6=/%7C/g,LI=/%7D/g,d6=/%20/g;function fv(n){return n==null?"":encodeURI(""+n).replace(h6,"|").replace(l6,"[").replace(c6,"]")}function f6(n){return fv(n).replace(FI,"{").replace(LI,"}").replace(MI,"^")}function X0(n){return fv(n).replace(DI,"%2B").replace(d6,"+").replace(NI,"%23").replace(i6,"%26").replace(u6,"`").replace(FI,"{").replace(LI,"}").replace(MI,"^")}function p6(n){return X0(n).replace(o6,"%3D")}function g6(n){return fv(n).replace(NI,"%23").replace(a6,"%3F")}function m6(n){return g6(n).replace(s6,"%2F")}function Yc(n){if(n==null)return null;try{return decodeURIComponent(""+n)}catch{}return""+n}const v6=/\/$/,_6=n=>n.replace(v6,"");function Up(n,e,t="/"){let r,i={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return l=a>=0&&l>a?-1:l,l>=0&&(r=e.slice(0,l),s=e.slice(l,a>0?a:e.length),i=n(s.slice(1))),a>=0&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=w6(r??e,t),{fullPath:r+s+o,path:r,query:i,hash:Yc(o)}}function y6(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Z1(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function E6(n,e,t){const r=e.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&yl(e.matched[r],t.matched[i])&&UI(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function yl(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function UI(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(var t in n)if(!T6(n[t],e[t]))return!1;return!0}function T6(n,e){return Ti(n)?eE(n,e):Ti(e)?eE(e,n):(n==null?void 0:n.valueOf())===(e==null?void 0:e.valueOf())}function eE(n,e){return Ti(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function w6(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const Ks={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let J0=function(n){return n.pop="pop",n.push="push",n}({}),Bp=function(n){return n.back="back",n.forward="forward",n.unknown="",n}({});function A6(n){if(!n)if(Ua){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),_6(n)}const C6=/^[^#]+#/;function S6(n,e){return n.replace(C6,"#")+e}function I6(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Hf=()=>({left:window.scrollX,top:window.scrollY});function x6(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=I6(i,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function tE(n,e){return(history.state?history.state.position-e:-1)+n}const Z0=new Map;function R6(n,e){Z0.set(n,e)}function b6(n){const e=Z0.get(n);return Z0.delete(n),e}function k6(n){return typeof n=="string"||n&&typeof n=="object"}function BI(n){return typeof n=="string"||typeof n=="symbol"}let an=function(n){return n[n.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",n[n.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",n[n.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",n[n.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",n[n.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",n}({});const VI=Symbol("");an.MATCHER_NOT_FOUND+"",an.NAVIGATION_GUARD_REDIRECT+"",an.NAVIGATION_ABORTED+"",an.NAVIGATION_CANCELLED+"",an.NAVIGATION_DUPLICATED+"";function El(n,e){return kt(new Error,{type:n,[VI]:!0},e)}function ts(n,e){return n instanceof Error&&VI in n&&(e==null||!!(n.type&e))}const P6=["params","query","hash"];function O6(n){if(typeof n=="string")return n;if(n.path!=null)return n.path;const e={};for(const t of P6)t in n&&(e[t]=n[t]);return JSON.stringify(e,null,2)}function N6(n){const e={};if(n===""||n==="?")return e;const t=(n[0]==="?"?n.slice(1):n).split("&");for(let r=0;r<t.length;++r){const i=t[r].replace(DI," "),s=i.indexOf("="),o=Yc(s<0?i:i.slice(0,s)),a=s<0?null:Yc(i.slice(s+1));if(o in e){let l=e[o];Ti(l)||(l=e[o]=[l]),l.push(a)}else e[o]=a}return e}function nE(n){let e="";for(let t in n){const r=n[t];if(t=p6(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Ti(r)?r.map(i=>i&&X0(i)):[r&&X0(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function D6(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Ti(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const M6=Symbol(""),rE=Symbol(""),$f=Symbol(""),HI=Symbol(""),eg=Symbol("");function Zl(){let n=[];function e(r){return n.push(r),()=>{const i=n.indexOf(r);i>-1&&n.splice(i,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function Qs(n,e,t,r,i,s=o=>o()){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((a,l)=>{const c=p=>{p===!1?l(El(an.NAVIGATION_ABORTED,{from:t,to:e})):p instanceof Error?l(p):k6(p)?l(El(an.NAVIGATION_GUARD_REDIRECT,{from:e,to:p})):(o&&r.enterCallbacks[i]===o&&typeof p=="function"&&o.push(p),a())},u=s(()=>n.call(r&&r.instances[i],e,t,c));let f=Promise.resolve(u);n.length<3&&(f=f.then(c)),f.catch(p=>l(p))})}function Vp(n,e,t,r,i=s=>s()){const s=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(OI(l)){const c=(l.__vccOpts||l)[e];c&&s.push(Qs(c,t,r,o,a,i))}else{let c=l();s.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=r6(u)?u.default:u;o.mods[a]=u,o.components[a]=f;const p=(f.__vccOpts||f)[e];return p&&Qs(p,t,r,o,a,i)()}))}}return s}function F6(n,e){const t=[],r=[],i=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(n.matched.find(c=>yl(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>yl(c,l))||i.push(l))}return[t,r,i]}/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let L6=()=>location.protocol+"//"+location.host;function $I(n,e){const{pathname:t,search:r,hash:i}=e,s=n.indexOf("#");if(s>-1){let o=i.includes(n.slice(s))?n.slice(s).length:1,a=i.slice(o);return a[0]!=="/"&&(a="/"+a),Z1(a,"")}return Z1(t,n)+r+i}function U6(n,e,t,r){let i=[],s=[],o=null;const a=({state:p})=>{const g=$I(n,location),m=t.value,v=e.value;let _=0;if(p){if(t.value=g,e.value=p,o&&o===m){o=null;return}_=v?p.position-v.position:0}else r(g);i.forEach(D=>{D(t.value,m,{delta:_,type:J0.pop,direction:_?_>0?Bp.forward:Bp.back:Bp.unknown})})};function l(){o=t.value}function c(p){i.push(p);const g=()=>{const m=i.indexOf(p);m>-1&&i.splice(m,1)};return s.push(g),g}function u(){if(document.visibilityState==="hidden"){const{history:p}=window;if(!p.state)return;p.replaceState(kt({},p.state,{scroll:Hf()}),"")}}function f(){for(const p of s)p();s=[],window.removeEventListener("popstate",a),window.removeEventListener("pagehide",u),document.removeEventListener("visibilitychange",u)}return window.addEventListener("popstate",a),window.addEventListener("pagehide",u),document.addEventListener("visibilitychange",u),{pauseListeners:l,listen:c,destroy:f}}function iE(n,e,t,r=!1,i=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:i?Hf():null}}function B6(n){const{history:e,location:t}=window,r={value:$I(n,t)},i={value:e.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const f=n.indexOf("#"),p=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:L6()+n+l;try{e[u?"replaceState":"pushState"](c,"",p),i.value=c}catch(g){console.error(g),t[u?"replace":"assign"](p)}}function o(l,c){s(l,kt({},e.state,iE(i.value.back,l,i.value.forward,!0),c,{position:i.value.position}),!0),r.value=l}function a(l,c){const u=kt({},i.value,e.state,{forward:l,scroll:Hf()});s(u.current,u,!0),s(l,kt({},iE(r.value,l,null),{position:u.position+1},c),!1),r.value=l}return{location:r,state:i,push:a,replace:o}}function V6(n){n=A6(n);const e=B6(n),t=U6(n,e.state,e.location,e.replace);function r(s,o=!0){o||t.pauseListeners(),history.go(s)}const i=kt({location:"",base:n,go:r,createHref:S6.bind(null,n)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}let Uo=function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.Group=2]="Group",n}({});var In=function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.ParamRegExp=2]="ParamRegExp",n[n.ParamRegExpEnd=3]="ParamRegExpEnd",n[n.EscapeNext=4]="EscapeNext",n}(In||{});const H6={type:Uo.Static,value:""},$6=/[a-zA-Z0-9_]/;function K6(n){if(!n)return[[]];if(n==="/")return[[H6]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(g){throw new Error(`ERR (${t})/"${c}": ${g}`)}let t=In.Static,r=t;const i=[];let s;function o(){s&&i.push(s),s=[]}let a=0,l,c="",u="";function f(){c&&(t===In.Static?s.push({type:Uo.Static,value:c}):t===In.Param||t===In.ParamRegExp||t===In.ParamRegExpEnd?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:Uo.Param,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function p(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==In.ParamRegExp){r=t,t=In.EscapeNext;continue}switch(t){case In.Static:l==="/"?(c&&f(),o()):l===":"?(f(),t=In.Param):p();break;case In.EscapeNext:p(),t=r;break;case In.Param:l==="("?t=In.ParamRegExp:$6.test(l)?p():(f(),t=In.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case In.ParamRegExp:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=In.ParamRegExpEnd:u+=l;break;case In.ParamRegExpEnd:f(),t=In.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===In.ParamRegExp&&e(`Unfinished custom RegExp for param "${c}"`),f(),o(),i}const sE="[^/]+?",j6={sensitive:!1,strict:!1,start:!0,end:!0};var vr=function(n){return n[n._multiplier=10]="_multiplier",n[n.Root=90]="Root",n[n.Segment=40]="Segment",n[n.SubSegment=30]="SubSegment",n[n.Static=40]="Static",n[n.Dynamic=20]="Dynamic",n[n.BonusCustomRegExp=10]="BonusCustomRegExp",n[n.BonusWildcard=-50]="BonusWildcard",n[n.BonusRepeatable=-20]="BonusRepeatable",n[n.BonusOptional=-8]="BonusOptional",n[n.BonusStrict=.7000000000000001]="BonusStrict",n[n.BonusCaseSensitive=.25]="BonusCaseSensitive",n}(vr||{});const W6=/[.+*?^${}()[\]/\\]/g;function G6(n,e){const t=kt({},j6,e),r=[];let i=t.start?"^":"";const s=[];for(const c of n){const u=c.length?[]:[vr.Root];t.strict&&!c.length&&(i+="/");for(let f=0;f<c.length;f++){const p=c[f];let g=vr.Segment+(t.sensitive?vr.BonusCaseSensitive:0);if(p.type===Uo.Static)f||(i+="/"),i+=p.value.replace(W6,"\\$&"),g+=vr.Static;else if(p.type===Uo.Param){const{value:m,repeatable:v,optional:_,regexp:D}=p;s.push({name:m,repeatable:v,optional:_});const b=D||sE;if(b!==sE){g+=vr.BonusCustomRegExp;try{`${b}`}catch(R){throw new Error(`Invalid custom RegExp for param "${m}" (${b}): `+R.message)}}let T=v?`((?:${b})(?:/(?:${b}))*)`:`(${b})`;f||(T=_&&c.length<2?`(?:/${T})`:"/"+T),_&&(T+="?"),i+=T,g+=vr.Dynamic,_&&(g+=vr.BonusOptional),v&&(g+=vr.BonusRepeatable),b===".*"&&(g+=vr.BonusWildcard)}u.push(g)}r.push(u)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=vr.BonusStrict}t.strict||(i+="/?"),t.end?i+="$":t.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const o=new RegExp(i,t.sensitive?"":"i");function a(c){const u=c.match(o),f={};if(!u)return null;for(let p=1;p<u.length;p++){const g=u[p]||"",m=s[p-1];f[m.name]=g&&m.repeatable?g.split("/"):g}return f}function l(c){let u="",f=!1;for(const p of n){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const g of p)if(g.type===Uo.Static)u+=g.value;else if(g.type===Uo.Param){const{value:m,repeatable:v,optional:_}=g,D=m in c?c[m]:"";if(Ti(D)&&!v)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const b=Ti(D)?D.join("/"):D;if(!b)if(_)p.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${m}"`);u+=b}}return u||"/"}return{re:o,score:r,keys:s,parse:a,stringify:l}}function q6(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===vr.Static+vr.Segment?-1:1:n.length>e.length?e.length===1&&e[0]===vr.Static+vr.Segment?1:-1:0}function KI(n,e){let t=0;const r=n.score,i=e.score;for(;t<r.length&&t<i.length;){const s=q6(r[t],i[t]);if(s)return s;t++}if(Math.abs(i.length-r.length)===1){if(oE(r))return 1;if(oE(i))return-1}return i.length-r.length}function oE(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const z6={strict:!1,end:!0,sensitive:!1};function Y6(n,e,t){const r=G6(K6(n.path),t),i=kt(r,{record:n,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function Q6(n,e){const t=[],r=new Map;e=J1(z6,e);function i(f){return r.get(f)}function s(f,p,g){const m=!g,v=lE(f);v.aliasOf=g&&g.record;const _=J1(e,f),D=[v];if("alias"in f){const R=typeof f.alias=="string"?[f.alias]:f.alias;for(const B of R)D.push(lE(kt({},v,{components:g?g.record.components:v.components,path:B,aliasOf:g?g.record:v})))}let b,T;for(const R of D){const{path:B}=R;if(p&&B[0]!=="/"){const W=p.record.path,A=W[W.length-1]==="/"?"":"/";R.path=p.record.path+(B&&A+B)}if(b=Y6(R,p,_),g?g.alias.push(b):(T=T||b,T!==b&&T.alias.push(b),m&&f.name&&!cE(b)&&o(f.name)),jI(b)&&l(b),v.children){const W=v.children;for(let A=0;A<W.length;A++)s(W[A],b,g&&g.children[A])}g=g||b}return T?()=>{o(T)}:Ic}function o(f){if(BI(f)){const p=r.get(f);p&&(r.delete(f),t.splice(t.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=t.indexOf(f);p>-1&&(t.splice(p,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const p=Z6(f,t);t.splice(p,0,f),f.record.name&&!cE(f)&&r.set(f.record.name,f)}function c(f,p){let g,m={},v,_;if("name"in f&&f.name){if(g=r.get(f.name),!g)throw El(an.MATCHER_NOT_FOUND,{location:f});_=g.record.name,m=kt(aE(p.params,g.keys.filter(T=>!T.optional).concat(g.parent?g.parent.keys.filter(T=>T.optional):[]).map(T=>T.name)),f.params&&aE(f.params,g.keys.map(T=>T.name))),v=g.stringify(m)}else if(f.path!=null)v=f.path,g=t.find(T=>T.re.test(v)),g&&(m=g.parse(v),_=g.record.name);else{if(g=p.name?r.get(p.name):t.find(T=>T.re.test(p.path)),!g)throw El(an.MATCHER_NOT_FOUND,{location:f,currentLocation:p});_=g.record.name,m=kt({},p.params,f.params),v=g.stringify(m)}const D=[];let b=g;for(;b;)D.unshift(b.record),b=b.parent;return{name:_,path:v,params:m,matched:D,meta:J6(D)}}n.forEach(f=>s(f));function u(){t.length=0,r.clear()}return{addRoute:s,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:i}}function aE(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function lE(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:X6(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function X6(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function cE(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function J6(n){return n.reduce((e,t)=>kt(e,t.meta),{})}function Z6(n,e){let t=0,r=e.length;for(;t!==r;){const s=t+r>>1;KI(n,e[s])<0?r=s:t=s+1}const i=e5(n);return i&&(r=e.lastIndexOf(i,r-1)),r}function e5(n){let e=n;for(;e=e.parent;)if(jI(e)&&KI(n,e)===0)return e}function jI({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function uE(n){const e=di($f),t=di(HI),r=it(()=>{const l=jt(n.to);return e.resolve(l)}),i=it(()=>{const{matched:l}=r.value,{length:c}=l,u=l[c-1],f=t.matched;if(!u||!f.length)return-1;const p=f.findIndex(yl.bind(null,u));if(p>-1)return p;const g=hE(l[c-2]);return c>1&&hE(u)===g&&f[f.length-1].path!==g?f.findIndex(yl.bind(null,l[c-2])):p}),s=it(()=>i.value>-1&&s5(t.params,r.value.params)),o=it(()=>i.value>-1&&i.value===t.matched.length-1&&UI(t.params,r.value.params));function a(l={}){if(i5(l)){const c=e[jt(n.replace)?"replace":"push"](jt(n.to)).catch(Ic);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:it(()=>r.value.href),isActive:s,isExactActive:o,navigate:a}}function t5(n){return n.length===1?n[0]:n}const n5=tw({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:uE,setup(n,{slots:e}){const t=su(uE(n)),{options:r}=di($f),i=it(()=>({[dE(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[dE(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&t5(e.default(t));return n.custom?s:Iw("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},s)}}}),r5=n5;function i5(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function s5(n,e){for(const t in e){const r=e[t],i=n[t];if(typeof r=="string"){if(r!==i)return!1}else if(!Ti(i)||i.length!==r.length||r.some((s,o)=>s.valueOf()!==i[o].valueOf()))return!1}return!0}function hE(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const dE=(n,e,t)=>n??e??t,o5=tw({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=di(eg),i=it(()=>n.route||r.value),s=di(rE,0),o=it(()=>{let c=jt(s);const{matched:u}=i.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),a=it(()=>i.value.matched[o.value]);xh(rE,it(()=>o.value+1)),xh(M6,a),xh(eg,i);const l=Se();return Ho(()=>[l.value,a.value,n.name],([c,u,f],[p,g,m])=>{u&&(u.instances[f]=c,g&&g!==u&&c&&c===p&&(u.leaveGuards.size||(u.leaveGuards=g.leaveGuards),u.updateGuards.size||(u.updateGuards=g.updateGuards))),c&&u&&(!g||!yl(u,g)||!p)&&(u.enterCallbacks[f]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=i.value,u=n.name,f=a.value,p=f&&f.components[u];if(!p)return fE(t.default,{Component:p,route:c});const g=f.props[u],m=g?g===!0?c.params:typeof g=="function"?g(c):g:null,_=Iw(p,kt({},m,e,{onVnodeUnmounted:D=>{D.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return fE(t.default,{Component:_,route:c})||_}}});function fE(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const a5=o5;function l5(n){const e=Q6(n.routes,n),t=n.parseQuery||N6,r=n.stringifyQuery||nE,i=n.history,s=Zl(),o=Zl(),a=Zl(),l=qb(Ks);let c=Ks;Ua&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Lp.bind(null,ne=>""+ne),f=Lp.bind(null,m6),p=Lp.bind(null,Yc);function g(ne,ve){let se,H;return BI(ne)?(se=e.getRecordMatcher(ne),H=ve):H=ne,e.addRoute(H,se)}function m(ne){const ve=e.getRecordMatcher(ne);ve&&e.removeRoute(ve)}function v(){return e.getRoutes().map(ne=>ne.record)}function _(ne){return!!e.getRecordMatcher(ne)}function D(ne,ve){if(ve=kt({},ve||l.value),typeof ne=="string"){const z=Up(t,ne,ve.path),ge=e.resolve({path:z.path},ve),ye=i.createHref(z.fullPath);return kt(z,ge,{params:p(ge.params),hash:Yc(z.hash),redirectedFrom:void 0,href:ye})}let se;if(ne.path!=null)se=kt({},ne,{path:Up(t,ne.path,ve.path).path});else{const z=kt({},ne.params);for(const ge in z)z[ge]==null&&delete z[ge];se=kt({},ne,{params:f(z)}),ve.params=f(ve.params)}const H=e.resolve(se,ve),J=ne.hash||"";H.params=u(p(H.params));const k=y6(r,kt({},ne,{hash:f6(J),path:H.path})),L=i.createHref(k);return kt({fullPath:k,hash:J,query:r===nE?D6(ne.query):ne.query||{}},H,{redirectedFrom:void 0,href:L})}function b(ne){return typeof ne=="string"?Up(t,ne,l.value.path):kt({},ne)}function T(ne,ve){if(c!==ne)return El(an.NAVIGATION_CANCELLED,{from:ve,to:ne})}function R(ne){return A(ne)}function B(ne){return R(kt(b(ne),{replace:!0}))}function W(ne,ve){const se=ne.matched[ne.matched.length-1];if(se&&se.redirect){const{redirect:H}=se;let J=typeof H=="function"?H(ne,ve):H;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=b(J):{path:J},J.params={}),kt({query:ne.query,hash:ne.hash,params:J.path!=null?{}:ne.params},J)}}function A(ne,ve){const se=c=D(ne),H=l.value,J=ne.state,k=ne.force,L=ne.replace===!0,z=W(se,H);if(z)return A(kt(b(z),{state:typeof z=="object"?kt({},J,z.state):J,force:k,replace:L}),ve||se);const ge=se;ge.redirectedFrom=ve;let ye;return!k&&E6(r,H,se)&&(ye=El(an.NAVIGATION_DUPLICATED,{to:ge,from:H}),F(H,H,!0,!1)),(ye?Promise.resolve(ye):C(ge,H)).catch(re=>ts(re)?ts(re,an.NAVIGATION_GUARD_REDIRECT)?re:fe(re):Oe(re,ge,H)).then(re=>{if(re){if(ts(re,an.NAVIGATION_GUARD_REDIRECT))return A(kt({replace:L},b(re.to),{state:typeof re.to=="object"?kt({},J,re.to.state):J,force:k}),ve||ge)}else re=x(ge,H,!0,L,J);return I(ge,H,re),re})}function w(ne,ve){const se=T(ne,ve);return se?Promise.reject(se):Promise.resolve()}function E(ne){const ve=q.values().next().value;return ve&&typeof ve.runWithContext=="function"?ve.runWithContext(ne):ne()}function C(ne,ve){let se;const[H,J,k]=F6(ne,ve);se=Vp(H.reverse(),"beforeRouteLeave",ne,ve);for(const z of H)z.leaveGuards.forEach(ge=>{se.push(Qs(ge,ne,ve))});const L=w.bind(null,ne,ve);return se.push(L),ce(se).then(()=>{se=[];for(const z of s.list())se.push(Qs(z,ne,ve));return se.push(L),ce(se)}).then(()=>{se=Vp(J,"beforeRouteUpdate",ne,ve);for(const z of J)z.updateGuards.forEach(ge=>{se.push(Qs(ge,ne,ve))});return se.push(L),ce(se)}).then(()=>{se=[];for(const z of k)if(z.beforeEnter)if(Ti(z.beforeEnter))for(const ge of z.beforeEnter)se.push(Qs(ge,ne,ve));else se.push(Qs(z.beforeEnter,ne,ve));return se.push(L),ce(se)}).then(()=>(ne.matched.forEach(z=>z.enterCallbacks={}),se=Vp(k,"beforeRouteEnter",ne,ve,E),se.push(L),ce(se))).then(()=>{se=[];for(const z of o.list())se.push(Qs(z,ne,ve));return se.push(L),ce(se)}).catch(z=>ts(z,an.NAVIGATION_CANCELLED)?z:Promise.reject(z))}function I(ne,ve,se){a.list().forEach(H=>E(()=>H(ne,ve,se)))}function x(ne,ve,se,H,J){const k=T(ne,ve);if(k)return k;const L=ve===Ks,z=Ua?history.state:{};se&&(H||L?i.replace(ne.fullPath,kt({scroll:L&&z&&z.scroll},J)):i.push(ne.fullPath,J)),l.value=ne,F(ne,ve,se,L),fe()}let P;function ie(){P||(P=i.listen((ne,ve,se)=>{if(!X.listening)return;const H=D(ne),J=W(H,X.currentRoute.value);if(J){A(kt(J,{replace:!0,force:!0}),H).catch(Ic);return}c=H;const k=l.value;Ua&&R6(tE(k.fullPath,se.delta),Hf()),C(H,k).catch(L=>ts(L,an.NAVIGATION_ABORTED|an.NAVIGATION_CANCELLED)?L:ts(L,an.NAVIGATION_GUARD_REDIRECT)?(A(kt(b(L.to),{force:!0}),H).then(z=>{ts(z,an.NAVIGATION_ABORTED|an.NAVIGATION_DUPLICATED)&&!se.delta&&se.type===J0.pop&&i.go(-1,!1)}).catch(Ic),Promise.reject()):(se.delta&&i.go(-se.delta,!1),Oe(L,H,k))).then(L=>{L=L||x(H,k,!1),L&&(se.delta&&!ts(L,an.NAVIGATION_CANCELLED)?i.go(-se.delta,!1):se.type===J0.pop&&ts(L,an.NAVIGATION_ABORTED|an.NAVIGATION_DUPLICATED)&&i.go(-1,!1)),I(H,k,L)}).catch(Ic)}))}let Q=Zl(),ae=Zl(),Ae;function Oe(ne,ve,se){fe(ne);const H=ae.list();return H.length?H.forEach(J=>J(ne,ve,se)):console.error(ne),Promise.reject(ne)}function Ce(){return Ae&&l.value!==Ks?Promise.resolve():new Promise((ne,ve)=>{Q.add([ne,ve])})}function fe(ne){return Ae||(Ae=!ne,ie(),Q.list().forEach(([ve,se])=>ne?se(ne):ve()),Q.reset()),ne}function F(ne,ve,se,H){const{scrollBehavior:J}=n;if(!Ua||!J)return Promise.resolve();const k=!se&&b6(tE(ne.fullPath,0))||(H||!se)&&history.state&&history.state.scroll||null;return Xd().then(()=>J(ne,ve,k)).then(L=>L&&x6(L)).catch(L=>Oe(L,ne,ve))}const O=ne=>i.go(ne);let Z;const q=new Set,X={currentRoute:l,listening:!0,addRoute:g,removeRoute:m,clearRoutes:e.clearRoutes,hasRoute:_,getRoutes:v,resolve:D,options:n,push:R,replace:B,go:O,back:()=>O(-1),forward:()=>O(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:ae.add,isReady:Ce,install(ne){ne.component("RouterLink",r5),ne.component("RouterView",a5),ne.config.globalProperties.$router=X,Object.defineProperty(ne.config.globalProperties,"$route",{enumerable:!0,get:()=>jt(l)}),Ua&&!Z&&l.value===Ks&&(Z=!0,R(i.location).catch(H=>{}));const ve={};for(const H in Ks)Object.defineProperty(ve,H,{get:()=>l.value[H],enumerable:!0});ne.provide($f,X),ne.provide(HI,$T(ve)),ne.provide(eg,l);const se=ne.unmount;q.add(ne),ne.unmount=function(){q.delete(ne),q.size<1&&(c=Ks,P&&P(),P=null,l.value=Ks,Z=!1,Ae=!1),se()}}};function ce(ne){return ne.reduce((ve,se)=>ve.then(()=>E(se)),Promise.resolve())}return X}function xu(){return di($f)}const Cr=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t},c5={class:"login-container"},u5={class:"login-card"},h5={class:"login-content"},d5={class:"login-section"},f5=["disabled"],p5={key:0,class:"error"},g5={__name:"Login",setup(n){const e=xu(),t=Ms(),r=Se(!1),i=Se("");Dr(async()=>{var a,l;console.log("Login page mounted"),await new Promise(c=>setTimeout(c,1500)),console.log("Checking for Microsoft account...",t.msalAccount),console.log("All MSAL accounts:",(a=t.msalInstance)==null?void 0:a.getAllAccounts());const o=((l=t.msalInstance)==null?void 0:l.getAllAccounts())||[];t.msalAccount||o.length>0?(console.log("Microsoft login detected, redirecting to supervisor registration"),await new Promise(c=>setTimeout(c,100)),e.push("/supervisor-register")):console.log("No Microsoft account found")});async function s(){r.value=!0,i.value="";try{await t.signInWithGoogle(),t.userData?e.push("/dashboard"):e.push("/register")}catch(o){i.value=o.message||"Failed to sign in",console.error("Sign in error:",o)}finally{r.value=!1}}return(o,a)=>(ee(),te("div",c5,[d("div",u5,[a[3]||(a[3]=d("h1",null,"MunkhZaisan",-1)),a[4]||(a[4]=d("h2",null,"Attendance Management System",-1)),d("div",h5,[d("div",d5,[a[1]||(a[1]=d("h3",null,"Sign In",-1)),a[2]||(a[2]=d("p",null,"All employees and supervisors sign in with Google account",-1)),d("button",{onClick:s,class:"google-btn",disabled:r.value},[a[0]||(a[0]=d("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google"},null,-1)),d("span",null,Y(r.value?"Signing in...":"Sign in with Google"),1)],8,f5)]),i.value?(ee(),te("p",p5,Y(i.value),1)):Ke("",!0)])])]))}},m5=Cr(g5,[["__scopeId","data-v-7ffc0635"]]),Ol=la("employees",()=>{const n=Se([]),e=Se(!1);async function t(){e.value=!0;try{const i=await Wn(Pn(Xt,"employees"));return n.value=i.docs.map(s=>{const o=s.data();return{id:s.id,...o,EmployeeLastName:o.LastName||o.EmployeeLastName,Role:o.Role||"Employee",FirstName:o.FirstName}}),n.value}catch(i){throw console.error("Error fetching employees:",i),i}finally{e.value=!1}}async function r(i,s){try{await xf(co(Xt,"employees",i),{Email:s,updatedAt:new Date().toISOString()});const o=n.value.find(a=>a.id===i);o&&(o.Email=s)}catch(o){throw console.error("Error updating employee email:",o),o}}return{employees:n,loading:e,fetchEmployees:t,updateEmployeeEmail:r}}),v5={class:"register-container"},_5={class:"register-card"},y5={class:"subtitle"},E5={class:"form-group"},T5=["value"],w5={key:0,class:"employee-details"},A5={key:0,class:"supervisor-notice"},C5=["disabled"],S5={key:1,class:"error"},I5={__name:"Register",setup(n){const e=xu(),t=Ms(),r=Ol(),i=Se(""),s=Se(null),o=Se(!1),a=Se(""),l=it(()=>r.employees.filter(f=>f.State===" "));Dr(async()=>{if(!t.user){e.push("/login");return}if(t.userData){e.push("/dashboard");return}await r.fetchEmployees()});function c(){s.value=r.employees.find(f=>f.id===i.value)}async function u(){var f;o.value=!0,a.value="";try{const p=((f=s.value)==null?void 0:f.Role)==="Supervisor";await t.registerUser(s.value,p),await r.updateEmployeeEmail(i.value,t.user.email),e.push("/dashboard")}catch(p){a.value=p.message||"Failed to complete registration",console.error("Registration error:",p)}finally{o.value=!1}}return(f,p)=>{var g;return ee(),te("div",v5,[d("div",_5,[p[8]||(p[8]=d("h1",null,"Complete Registration",-1)),d("p",y5,"Welcome, "+Y((g=jt(t).user)==null?void 0:g.displayName)+"!",1),d("form",{onSubmit:ni(u,["prevent"]),class:"register-form"},[d("div",E5,[p[2]||(p[2]=d("label",{for:"employee"},"Select Your Name",-1)),Ie(d("select",{id:"employee","onUpdate:modelValue":p[0]||(p[0]=m=>i.value=m),required:"",onChange:c},[p[1]||(p[1]=d("option",{value:""},"-- Choose your name --",-1)),(ee(!0),te(wt,null,rn(l.value,m=>(ee(),te("option",{key:m.id,value:m.id},Y(m.LastName||m.EmployeeLastName)+" "+Y(m.FirstName||"")+" - "+Y(m.Position||m.Role),9,T5))),128))],544),[[_t,i.value]])]),s.value?(ee(),te("div",w5,[p[7]||(p[7]=d("h3",null,"Employee Information",-1)),d("p",null,[p[3]||(p[3]=d("strong",null,"Name:",-1)),wr(" "+Y(s.value.LastName||s.value.EmployeeLastName)+" "+Y(s.value.FirstName||""),1)]),d("p",null,[p[4]||(p[4]=d("strong",null,"Position:",-1)),wr(" "+Y(s.value.Position),1)]),d("p",null,[p[5]||(p[5]=d("strong",null,"Role:",-1)),wr(" "+Y(s.value.Role||"Employee"),1)]),s.value.Role==="Supervisor"?(ee(),te("p",A5,"  You will be registered as a Supervisor with full access ")):Ke("",!0),d("p",null,[p[6]||(p[6]=d("strong",null,"Current Email:",-1)),wr(" "+Y(s.value.Email||"Not set"),1)])])):Ke("",!0),d("button",{type:"submit",class:"submit-btn",disabled:!i.value||o.value},Y(o.value?"Registering...":"Complete Registration"),9,C5),a.value?(ee(),te("p",S5,Y(a.value),1)):Ke("",!0)],32)])])}}},x5=Cr(I5,[["__scopeId","data-v-7dc466f4"]]),R5={class:"register-container"},b5={class:"register-card"},k5={class:"form-group"},P5={class:"account-info"},O5={class:"form-group"},N5=["disabled"],D5={value:""},M5=["value"],F5=["disabled"],L5={key:0,class:"error"},U5={__name:"SupervisorRegister",setup(n){const e=xu(),t=Ms(),r=Se(!1),i=Se(""),s=Se([]),o=Se(""),a=Se(null),l=it(()=>{console.log("Total employees:",s.value.length);const p=s.value.filter(m=>{const v=m.Status||m.status||m.EmployeeStatus;return console.log("Employee:",m.FirstName,m.LastName||m.EmployeeLastName,"Status:",v),v===""||v==="Active"||v==="active"});console.log("Active employees after filter:",p.length);let g=p.length===0?s.value:p;return g=g.sort((m,v)=>{const _=(m.FirstName||"").toLowerCase(),D=(v.FirstName||"").toLowerCase();return _.localeCompare(D)}),console.log("Sorted employees:",g.length),g});Dr(async()=>{var p;if(r.value=!0,!t.msalAccount){i.value="No Microsoft account found. Please sign in first.",r.value=!1;return}if(!t.user)try{console.log("Creating anonymous Firebase user for reading data..."),await t.createAnonymousUser(),console.log("Anonymous user created successfully:",(p=t.user)==null?void 0:p.uid),await new Promise(g=>setTimeout(g,500))}catch(g){console.error("Error creating anonymous user:",g),i.value="Failed to initialize. Please enable Anonymous Authentication in Firebase Console.",r.value=!1;return}await c(),r.value=!1});async function c(){var p;try{console.log("Loading employees... Current user:",(p=t.user)==null?void 0:p.uid);const g=await Wn(Pn(Xt,"employees"));s.value=g.docs.map(m=>({id:m.id,...m.data()})),console.log("Loaded employees:",s.value.length)}catch(g){console.error("Error loading employees:",g),i.value="Failed to load employee list: "+g.message}}function u(){const p=s.value.find(g=>g.id===o.value);a.value=p,console.log("Selected employee:",p)}async function f(){var p;if(!a.value){i.value="Please select your name";return}r.value=!0,i.value="";try{console.log("Starting supervisor registration..."),console.log("Microsoft account:",(p=t.msalAccount)==null?void 0:p.username);const g={FirstName:a.value.FirstName,EmployeeLastName:a.value.LastName||a.value.EmployeeLastName,Position:a.value.Position};console.log("Employee data:",g),await t.registerUser(g,!0),console.log("Registration successful, redirecting to dashboard..."),e.push("/dashboard")}catch(g){i.value=g.message||"Failed to register",console.error("Registration error:",g)}finally{r.value=!1}}return(p,g)=>{var m;return ee(),te("div",R5,[d("div",b5,[g[3]||(g[3]=d("h1",null,"Supervisor Registration",-1)),g[4]||(g[4]=d("p",{class:"subtitle"},"Complete your profile as a supervisor",-1)),d("form",{onSubmit:ni(f,["prevent"]),class:"register-form"},[d("div",k5,[g[1]||(g[1]=d("label",null,"Microsoft Account",-1)),d("p",P5,Y((m=jt(t).msalAccount)==null?void 0:m.username),1)]),d("div",O5,[g[2]||(g[2]=d("label",{for:"employee"},"Select Your Name",-1)),Ie(d("select",{id:"employee","onUpdate:modelValue":g[0]||(g[0]=v=>o.value=v),required:"",disabled:r.value,onChange:u},[d("option",D5,Y(r.value?"Loading...":"-- Select Your Name --"),1),(ee(!0),te(wt,null,rn(l.value,v=>(ee(),te("option",{key:v.id,value:v.id},Y(v.FirstName)+" "+Y(v.LastName||v.EmployeeLastName),9,M5))),128))],40,N5),[[_t,o.value]])]),d("button",{type:"submit",class:"register-btn",disabled:r.value||!a.value},Y(r.value?"Registering...":"Complete Registration"),9,F5),i.value?(ee(),te("p",L5,Y(i.value),1)):Ke("",!0)],32)])])}}},B5=Cr(U5,[["__scopeId","data-v-57a28946"]]),pv=la("customers",{state:()=>({customers:[],loading:!1,error:null}),actions:{async fetchCustomers(){this.loading=!0,this.error=null;try{const n=await Wn(Pn(Xt,"customers"));this.customers=n.docs.map(e=>({id:e.id,...e.data()}))}catch(n){console.error("Error fetching customers:",n),this.error=n.message}finally{this.loading=!1}}}}),Nl=la("projects",{state:()=>({projects:[],loading:!1,error:null}),actions:{async fetchProjects(){this.loading=!0,this.error=null;try{const n=await Wn(Pn(Xt,"projects"));this.projects=n.docs.map(e=>({docId:e.id,...e.data()}))}catch(n){console.error("Error fetching projects:",n),this.error=n.message}finally{this.loading=!1}}}});function WI(n,e){return function(){return n.apply(e,arguments)}}const{toString:V5}=Object.prototype,{getPrototypeOf:gv}=Object,{iterator:Kf,toStringTag:GI}=Symbol,jf=(n=>e=>{const t=V5.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),wi=n=>(n=n.toLowerCase(),e=>jf(e)===n),Wf=n=>e=>typeof e===n,{isArray:Dl}=Array,Tl=Wf("undefined");function Ru(n){return n!==null&&!Tl(n)&&n.constructor!==null&&!Tl(n.constructor)&&br(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const qI=wi("ArrayBuffer");function H5(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&qI(n.buffer),e}const $5=Wf("string"),br=Wf("function"),zI=Wf("number"),bu=n=>n!==null&&typeof n=="object",K5=n=>n===!0||n===!1,Hh=n=>{if(jf(n)!=="object")return!1;const e=gv(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(GI in n)&&!(Kf in n)},j5=n=>{if(!bu(n)||Ru(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},W5=wi("Date"),G5=wi("File"),q5=wi("Blob"),z5=wi("FileList"),Y5=n=>bu(n)&&br(n.pipe),Q5=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||br(n.append)&&((e=jf(n))==="formdata"||e==="object"&&br(n.toString)&&n.toString()==="[object FormData]"))},X5=wi("URLSearchParams"),[J5,Z5,eB,tB]=["ReadableStream","Request","Response","Headers"].map(wi),nB=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ku(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,i;if(typeof n!="object"&&(n=[n]),Dl(n))for(r=0,i=n.length;r<i;r++)e.call(null,n[r],r,n);else{if(Ru(n))return;const s=t?Object.getOwnPropertyNames(n):Object.keys(n),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,n[a],a,n)}}function YI(n,e){if(Ru(n))return null;e=e.toLowerCase();const t=Object.keys(n);let r=t.length,i;for(;r-- >0;)if(i=t[r],e===i.toLowerCase())return i;return null}const Bo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,QI=n=>!Tl(n)&&n!==Bo;function tg(){const{caseless:n,skipUndefined:e}=QI(this)&&this||{},t={},r=(i,s)=>{const o=n&&YI(t,s)||s;Hh(t[o])&&Hh(i)?t[o]=tg(t[o],i):Hh(i)?t[o]=tg({},i):Dl(i)?t[o]=i.slice():(!e||!Tl(i))&&(t[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&ku(arguments[i],r);return t}const rB=(n,e,t,{allOwnKeys:r}={})=>(ku(e,(i,s)=>{t&&br(i)?n[s]=WI(i,t):n[s]=i},{allOwnKeys:r}),n),iB=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),sB=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},oB=(n,e,t,r)=>{let i,s,o;const a={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),s=i.length;s-- >0;)o=i[s],(!r||r(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&gv(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},aB=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},lB=n=>{if(!n)return null;if(Dl(n))return n;let e=n.length;if(!zI(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},cB=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&gv(Uint8Array)),uB=(n,e)=>{const r=(n&&n[Kf]).call(n);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(n,s[0],s[1])}},hB=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},dB=wi("HTMLFormElement"),fB=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,i){return r.toUpperCase()+i}),pE=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),pB=wi("RegExp"),XI=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};ku(t,(i,s)=>{let o;(o=e(i,s,n))!==!1&&(r[s]=o||i)}),Object.defineProperties(n,r)},gB=n=>{XI(n,(e,t)=>{if(br(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(br(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},mB=(n,e)=>{const t={},r=i=>{i.forEach(s=>{t[s]=!0})};return Dl(n)?r(n):r(String(n).split(e)),t},vB=()=>{},_B=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function yB(n){return!!(n&&br(n.append)&&n[GI]==="FormData"&&n[Kf])}const EB=n=>{const e=new Array(10),t=(r,i)=>{if(bu(r)){if(e.indexOf(r)>=0)return;if(Ru(r))return r;if(!("toJSON"in r)){e[i]=r;const s=Dl(r)?[]:{};return ku(r,(o,a)=>{const l=t(o,i+1);!Tl(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return t(n,0)},TB=wi("AsyncFunction"),wB=n=>n&&(bu(n)||br(n))&&br(n.then)&&br(n.catch),JI=((n,e)=>n?setImmediate:e?((t,r)=>(Bo.addEventListener("message",({source:i,data:s})=>{i===Bo&&s===t&&r.length&&r.shift()()},!1),i=>{r.push(i),Bo.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",br(Bo.postMessage)),AB=typeof queueMicrotask<"u"?queueMicrotask.bind(Bo):typeof process<"u"&&process.nextTick||JI,CB=n=>n!=null&&br(n[Kf]),me={isArray:Dl,isArrayBuffer:qI,isBuffer:Ru,isFormData:Q5,isArrayBufferView:H5,isString:$5,isNumber:zI,isBoolean:K5,isObject:bu,isPlainObject:Hh,isEmptyObject:j5,isReadableStream:J5,isRequest:Z5,isResponse:eB,isHeaders:tB,isUndefined:Tl,isDate:W5,isFile:G5,isBlob:q5,isRegExp:pB,isFunction:br,isStream:Y5,isURLSearchParams:X5,isTypedArray:cB,isFileList:z5,forEach:ku,merge:tg,extend:rB,trim:nB,stripBOM:iB,inherits:sB,toFlatObject:oB,kindOf:jf,kindOfTest:wi,endsWith:aB,toArray:lB,forEachEntry:uB,matchAll:hB,isHTMLForm:dB,hasOwnProperty:pE,hasOwnProp:pE,reduceDescriptors:XI,freezeMethods:gB,toObjectSet:mB,toCamelCase:fB,noop:vB,toFiniteNumber:_B,findKey:YI,global:Bo,isContextDefined:QI,isSpecCompliantForm:yB,toJSONObject:EB,isAsyncFn:TB,isThenable:wB,setImmediate:JI,asap:AB,isIterable:CB};function gt(n,e,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}me.inherits(gt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:me.toJSONObject(this.config),code:this.code,status:this.status}}});const ZI=gt.prototype,ex={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{ex[n]={value:n}});Object.defineProperties(gt,ex);Object.defineProperty(ZI,"isAxiosError",{value:!0});gt.from=(n,e,t,r,i,s)=>{const o=Object.create(ZI);me.toFlatObject(n,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const a=n&&n.message?n.message:"Error",l=e==null&&n?n.code:e;return gt.call(o,a,l,t,r,i),n&&o.cause==null&&Object.defineProperty(o,"cause",{value:n,configurable:!0}),o.name=n&&n.name||"Error",s&&Object.assign(o,s),o};const SB=null;function ng(n){return me.isPlainObject(n)||me.isArray(n)}function tx(n){return me.endsWith(n,"[]")?n.slice(0,-2):n}function gE(n,e,t){return n?n.concat(e).map(function(i,s){return i=tx(i),!t&&s?"["+i+"]":i}).join(t?".":""):e}function IB(n){return me.isArray(n)&&!n.some(ng)}const xB=me.toFlatObject(me,{},null,function(e){return/^is[A-Z]/.test(e)});function Gf(n,e,t){if(!me.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=me.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,_){return!me.isUndefined(_[v])});const r=t.metaTokens,i=t.visitor||u,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&me.isSpecCompliantForm(e);if(!me.isFunction(i))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(me.isDate(m))return m.toISOString();if(me.isBoolean(m))return m.toString();if(!l&&me.isBlob(m))throw new gt("Blob is not supported. Use a Buffer instead.");return me.isArrayBuffer(m)||me.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,v,_){let D=m;if(m&&!_&&typeof m=="object"){if(me.endsWith(v,"{}"))v=r?v:v.slice(0,-2),m=JSON.stringify(m);else if(me.isArray(m)&&IB(m)||(me.isFileList(m)||me.endsWith(v,"[]"))&&(D=me.toArray(m)))return v=tx(v),D.forEach(function(T,R){!(me.isUndefined(T)||T===null)&&e.append(o===!0?gE([v],R,s):o===null?v:v+"[]",c(T))}),!1}return ng(m)?!0:(e.append(gE(_,v,s),c(m)),!1)}const f=[],p=Object.assign(xB,{defaultVisitor:u,convertValue:c,isVisitable:ng});function g(m,v){if(!me.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+v.join("."));f.push(m),me.forEach(m,function(D,b){(!(me.isUndefined(D)||D===null)&&i.call(e,D,me.isString(b)?b.trim():b,v,p))===!0&&g(D,v?v.concat(b):[b])}),f.pop()}}if(!me.isObject(n))throw new TypeError("data must be an object");return g(n),e}function mE(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function mv(n,e){this._pairs=[],n&&Gf(n,this,e)}const nx=mv.prototype;nx.append=function(e,t){this._pairs.push([e,t])};nx.toString=function(e){const t=e?function(r){return e.call(this,r,mE)}:mE;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function RB(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function rx(n,e,t){if(!e)return n;const r=t&&t.encode||RB;me.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let s;if(i?s=i(e,t):s=me.isURLSearchParams(e)?e.toString():new mv(e,t).toString(r),s){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class vE{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){me.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ix={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bB=typeof URLSearchParams<"u"?URLSearchParams:mv,kB=typeof FormData<"u"?FormData:null,PB=typeof Blob<"u"?Blob:null,OB={isBrowser:!0,classes:{URLSearchParams:bB,FormData:kB,Blob:PB},protocols:["http","https","file","blob","url","data"]},vv=typeof window<"u"&&typeof document<"u",rg=typeof navigator=="object"&&navigator||void 0,NB=vv&&(!rg||["ReactNative","NativeScript","NS"].indexOf(rg.product)<0),DB=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",MB=vv&&window.location.href||"http://localhost",FB=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:vv,hasStandardBrowserEnv:NB,hasStandardBrowserWebWorkerEnv:DB,navigator:rg,origin:MB},Symbol.toStringTag,{value:"Module"})),lr={...FB,...OB};function LB(n,e){return Gf(n,new lr.classes.URLSearchParams,{visitor:function(t,r,i,s){return lr.isNode&&me.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function UB(n){return me.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function BB(n){const e={},t=Object.keys(n);let r;const i=t.length;let s;for(r=0;r<i;r++)s=t[r],e[s]=n[s];return e}function sx(n){function e(t,r,i,s){let o=t[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=t.length;return o=!o&&me.isArray(i)?i.length:o,l?(me.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!me.isObject(i[o]))&&(i[o]=[]),e(t,r,i[o],s)&&me.isArray(i[o])&&(i[o]=BB(i[o])),!a)}if(me.isFormData(n)&&me.isFunction(n.entries)){const t={};return me.forEachEntry(n,(r,i)=>{e(UB(r),i,t,0)}),t}return null}function VB(n,e,t){if(me.isString(n))try{return(e||JSON.parse)(n),me.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Pu={transitional:ix,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",i=r.indexOf("application/json")>-1,s=me.isObject(e);if(s&&me.isHTMLForm(e)&&(e=new FormData(e)),me.isFormData(e))return i?JSON.stringify(sx(e)):e;if(me.isArrayBuffer(e)||me.isBuffer(e)||me.isStream(e)||me.isFile(e)||me.isBlob(e)||me.isReadableStream(e))return e;if(me.isArrayBufferView(e))return e.buffer;if(me.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return LB(e,this.formSerializer).toString();if((a=me.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Gf(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),VB(e)):e}],transformResponse:[function(e){const t=this.transitional||Pu.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(me.isResponse(e)||me.isReadableStream(e))return e;if(e&&me.isString(e)&&(r&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?gt.from(a,gt.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:lr.classes.FormData,Blob:lr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};me.forEach(["delete","get","head","post","put","patch"],n=>{Pu.headers[n]={}});const HB=me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$B=n=>{const e={};let t,r,i;return n&&n.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!t||e[t]&&HB[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},_E=Symbol("internals");function ec(n){return n&&String(n).trim().toLowerCase()}function $h(n){return n===!1||n==null?n:me.isArray(n)?n.map($h):String(n)}function KB(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const jB=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Hp(n,e,t,r,i){if(me.isFunction(r))return r.call(this,e,t);if(i&&(e=t),!!me.isString(e)){if(me.isString(r))return e.indexOf(r)!==-1;if(me.isRegExp(r))return r.test(e)}}function WB(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function GB(n,e){const t=me.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}let kr=class{constructor(e){e&&this.set(e)}set(e,t,r){const i=this;function s(a,l,c){const u=ec(l);if(!u)throw new Error("header name must be a non-empty string");const f=me.findKey(i,u);(!f||i[f]===void 0||c===!0||c===void 0&&i[f]!==!1)&&(i[f||l]=$h(a))}const o=(a,l)=>me.forEach(a,(c,u)=>s(c,u,l));if(me.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(me.isString(e)&&(e=e.trim())&&!jB(e))o($B(e),t);else if(me.isObject(e)&&me.isIterable(e)){let a={},l,c;for(const u of e){if(!me.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?me.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,t)}else e!=null&&s(t,e,r);return this}get(e,t){if(e=ec(e),e){const r=me.findKey(this,e);if(r){const i=this[r];if(!t)return i;if(t===!0)return KB(i);if(me.isFunction(t))return t.call(this,i,r);if(me.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ec(e),e){const r=me.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Hp(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let i=!1;function s(o){if(o=ec(o),o){const a=me.findKey(r,o);a&&(!t||Hp(r,r[a],a,t))&&(delete r[a],i=!0)}}return me.isArray(e)?e.forEach(s):s(e),i}clear(e){const t=Object.keys(this);let r=t.length,i=!1;for(;r--;){const s=t[r];(!e||Hp(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const t=this,r={};return me.forEach(this,(i,s)=>{const o=me.findKey(r,s);if(o){t[o]=$h(i),delete t[s];return}const a=e?WB(s):String(s).trim();a!==s&&delete t[s],t[a]=$h(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return me.forEach(this,(r,i)=>{r!=null&&r!==!1&&(t[i]=e&&me.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[_E]=this[_E]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=ec(o);r[a]||(GB(i,o),r[a]=!0)}return me.isArray(e)?e.forEach(s):s(e),this}};kr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);me.reduceDescriptors(kr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});me.freezeMethods(kr);function $p(n,e){const t=this||Pu,r=e||t,i=kr.from(r.headers);let s=r.data;return me.forEach(n,function(a){s=a.call(t,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function ox(n){return!!(n&&n.__CANCEL__)}function Ml(n,e,t){gt.call(this,n??"canceled",gt.ERR_CANCELED,e,t),this.name="CanceledError"}me.inherits(Ml,gt,{__CANCEL__:!0});function ax(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new gt("Request failed with status code "+t.status,[gt.ERR_BAD_REQUEST,gt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function qB(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function zB(n,e){n=n||10;const t=new Array(n),r=new Array(n);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=r[s];o||(o=c),t[i]=l,r[i]=c;let f=s,p=0;for(;f!==i;)p+=t[f++],f=f%n;if(i=(i+1)%n,i===s&&(s=(s+1)%n),c-o<e)return;const g=u&&c-u;return g?Math.round(p*1e3/g):void 0}}function YB(n,e){let t=0,r=1e3/e,i,s;const o=(c,u=Date.now())=>{t=u,i=null,s&&(clearTimeout(s),s=null),n(...c)};return[(...c)=>{const u=Date.now(),f=u-t;f>=r?o(c,u):(i=c,s||(s=setTimeout(()=>{s=null,o(i)},r-f)))},()=>i&&o(i)]}const Id=(n,e,t=3)=>{let r=0;const i=zB(50,250);return YB(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-r,c=i(l),u=o<=a;r=o;const f={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(f)},t)},yE=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},EE=n=>(...e)=>me.asap(()=>n(...e)),QB=lr.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,lr.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(lr.origin),lr.navigator&&/(msie|trident)/i.test(lr.navigator.userAgent)):()=>!0,XB=lr.hasStandardBrowserEnv?{write(n,e,t,r,i,s,o){if(typeof document>"u")return;const a=[`${n}=${encodeURIComponent(e)}`];me.isNumber(t)&&a.push(`expires=${new Date(t).toUTCString()}`),me.isString(r)&&a.push(`path=${r}`),me.isString(i)&&a.push(`domain=${i}`),s===!0&&a.push("secure"),me.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function JB(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function ZB(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function lx(n,e,t){let r=!JB(e);return n&&(r||t==!1)?ZB(n,e):e}const TE=n=>n instanceof kr?{...n}:n;function ra(n,e){e=e||{};const t={};function r(c,u,f,p){return me.isPlainObject(c)&&me.isPlainObject(u)?me.merge.call({caseless:p},c,u):me.isPlainObject(u)?me.merge({},u):me.isArray(u)?u.slice():u}function i(c,u,f,p){if(me.isUndefined(u)){if(!me.isUndefined(c))return r(void 0,c,f,p)}else return r(c,u,f,p)}function s(c,u){if(!me.isUndefined(u))return r(void 0,u)}function o(c,u){if(me.isUndefined(u)){if(!me.isUndefined(c))return r(void 0,c)}else return r(void 0,u)}function a(c,u,f){if(f in e)return r(c,u);if(f in n)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,f)=>i(TE(c),TE(u),f,!0)};return me.forEach(Object.keys({...n,...e}),function(u){const f=l[u]||i,p=f(n[u],e[u],u);me.isUndefined(p)&&f!==a||(t[u]=p)}),t}const cx=n=>{const e=ra({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:a}=e;if(e.headers=o=kr.from(o),e.url=rx(lx(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),me.isFormData(t)){if(lr.hasStandardBrowserEnv||lr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(me.isFunction(t.getHeaders)){const l=t.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([u,f])=>{c.includes(u.toLowerCase())&&o.set(u,f)})}}if(lr.hasStandardBrowserEnv&&(r&&me.isFunction(r)&&(r=r(e)),r||r!==!1&&QB(e.url))){const l=i&&s&&XB.read(s);l&&o.set(i,l)}return e},e8=typeof XMLHttpRequest<"u",t8=e8&&function(n){return new Promise(function(t,r){const i=cx(n);let s=i.data;const o=kr.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=i,u,f,p,g,m;function v(){g&&g(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let _=new XMLHttpRequest;_.open(i.method.toUpperCase(),i.url,!0),_.timeout=i.timeout;function D(){if(!_)return;const T=kr.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),B={data:!a||a==="text"||a==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:T,config:n,request:_};ax(function(A){t(A),v()},function(A){r(A),v()},B),_=null}"onloadend"in _?_.onloadend=D:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(D)},_.onabort=function(){_&&(r(new gt("Request aborted",gt.ECONNABORTED,n,_)),_=null)},_.onerror=function(R){const B=R&&R.message?R.message:"Network Error",W=new gt(B,gt.ERR_NETWORK,n,_);W.event=R||null,r(W),_=null},_.ontimeout=function(){let R=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const B=i.transitional||ix;i.timeoutErrorMessage&&(R=i.timeoutErrorMessage),r(new gt(R,B.clarifyTimeoutError?gt.ETIMEDOUT:gt.ECONNABORTED,n,_)),_=null},s===void 0&&o.setContentType(null),"setRequestHeader"in _&&me.forEach(o.toJSON(),function(R,B){_.setRequestHeader(B,R)}),me.isUndefined(i.withCredentials)||(_.withCredentials=!!i.withCredentials),a&&a!=="json"&&(_.responseType=i.responseType),c&&([p,m]=Id(c,!0),_.addEventListener("progress",p)),l&&_.upload&&([f,g]=Id(l),_.upload.addEventListener("progress",f),_.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(u=T=>{_&&(r(!T||T.type?new Ml(null,n,_):T),_.abort(),_=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const b=qB(i.url);if(b&&lr.protocols.indexOf(b)===-1){r(new gt("Unsupported protocol "+b+":",gt.ERR_BAD_REQUEST,n));return}_.send(s||null)})},n8=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,i;const s=function(c){if(!i){i=!0,a();const u=c instanceof Error?c:this.reason;r.abort(u instanceof gt?u:new Ml(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,s(new gt(`timeout ${e} of ms exceeded`,gt.ETIMEDOUT))},e);const a=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),n=null)};n.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>me.asap(a),l}},r8=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,i;for(;r<t;)i=r+e,yield n.slice(r,i),r=i},i8=async function*(n,e){for await(const t of s8(n))yield*r8(t,e)},s8=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},wE=(n,e,t,r)=>{const i=i8(n,e);let s=0,o,a=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await i.next();if(c){a(),l.close();return}let f=u.byteLength;if(t){let p=s+=f;t(p)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},AE=64*1024,{isFunction:mh}=me,o8=(({Request:n,Response:e})=>({Request:n,Response:e}))(me.global),{ReadableStream:CE,TextEncoder:SE}=me.global,IE=(n,...e)=>{try{return!!n(...e)}catch{return!1}},a8=n=>{n=me.merge.call({skipUndefined:!0},o8,n);const{fetch:e,Request:t,Response:r}=n,i=e?mh(e):typeof fetch=="function",s=mh(t),o=mh(r);if(!i)return!1;const a=i&&mh(CE),l=i&&(typeof SE=="function"?(m=>v=>m.encode(v))(new SE):async m=>new Uint8Array(await new t(m).arrayBuffer())),c=s&&a&&IE(()=>{let m=!1;const v=new t(lr.origin,{body:new CE,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!v}),u=o&&a&&IE(()=>me.isReadableStream(new r("").body)),f={stream:u&&(m=>m.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(v,_)=>{let D=v&&v[m];if(D)return D.call(v);throw new gt(`Response type '${m}' is not supported`,gt.ERR_NOT_SUPPORT,_)})});const p=async m=>{if(m==null)return 0;if(me.isBlob(m))return m.size;if(me.isSpecCompliantForm(m))return(await new t(lr.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(me.isArrayBufferView(m)||me.isArrayBuffer(m))return m.byteLength;if(me.isURLSearchParams(m)&&(m=m+""),me.isString(m))return(await l(m)).byteLength},g=async(m,v)=>{const _=me.toFiniteNumber(m.getContentLength());return _??p(v)};return async m=>{let{url:v,method:_,data:D,signal:b,cancelToken:T,timeout:R,onDownloadProgress:B,onUploadProgress:W,responseType:A,headers:w,withCredentials:E="same-origin",fetchOptions:C}=cx(m),I=e||fetch;A=A?(A+"").toLowerCase():"text";let x=n8([b,T&&T.toAbortSignal()],R),P=null;const ie=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let Q;try{if(W&&c&&_!=="get"&&_!=="head"&&(Q=await g(w,D))!==0){let F=new t(v,{method:"POST",body:D,duplex:"half"}),O;if(me.isFormData(D)&&(O=F.headers.get("content-type"))&&w.setContentType(O),F.body){const[Z,q]=yE(Q,Id(EE(W)));D=wE(F.body,AE,Z,q)}}me.isString(E)||(E=E?"include":"omit");const ae=s&&"credentials"in t.prototype,Ae={...C,signal:x,method:_.toUpperCase(),headers:w.normalize().toJSON(),body:D,duplex:"half",credentials:ae?E:void 0};P=s&&new t(v,Ae);let Oe=await(s?I(P,C):I(v,Ae));const Ce=u&&(A==="stream"||A==="response");if(u&&(B||Ce&&ie)){const F={};["status","statusText","headers"].forEach(X=>{F[X]=Oe[X]});const O=me.toFiniteNumber(Oe.headers.get("content-length")),[Z,q]=B&&yE(O,Id(EE(B),!0))||[];Oe=new r(wE(Oe.body,AE,Z,()=>{q&&q(),ie&&ie()}),F)}A=A||"text";let fe=await f[me.findKey(f,A)||"text"](Oe,m);return!Ce&&ie&&ie(),await new Promise((F,O)=>{ax(F,O,{data:fe,headers:kr.from(Oe.headers),status:Oe.status,statusText:Oe.statusText,config:m,request:P})})}catch(ae){throw ie&&ie(),ae&&ae.name==="TypeError"&&/Load failed|fetch/i.test(ae.message)?Object.assign(new gt("Network Error",gt.ERR_NETWORK,m,P),{cause:ae.cause||ae}):gt.from(ae,ae&&ae.code,m,P)}}},l8=new Map,ux=n=>{let e=n&&n.env||{};const{fetch:t,Request:r,Response:i}=e,s=[r,i,t];let o=s.length,a=o,l,c,u=l8;for(;a--;)l=s[a],c=u.get(l),c===void 0&&u.set(l,c=a?new Map:a8(e)),u=c;return c};ux();const _v={http:SB,xhr:t8,fetch:{get:ux}};me.forEach(_v,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const xE=n=>`- ${n}`,c8=n=>me.isFunction(n)||n===null||n===!1;function u8(n,e){n=me.isArray(n)?n:[n];const{length:t}=n;let r,i;const s={};for(let o=0;o<t;o++){r=n[o];let a;if(i=r,!c8(r)&&(i=_v[(a=String(r)).toLowerCase()],i===void 0))throw new gt(`Unknown adapter '${a}'`);if(i&&(me.isFunction(i)||(i=i.get(e))))break;s[a||"#"+o]=i}if(!i){const o=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=t?o.length>1?`since :
`+o.map(xE).join(`
`):" "+xE(o[0]):"as no adapter specified";throw new gt("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i}const hx={getAdapter:u8,adapters:_v};function Kp(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Ml(null,n)}function RE(n){return Kp(n),n.headers=kr.from(n.headers),n.data=$p.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),hx.getAdapter(n.adapter||Pu.adapter,n)(n).then(function(r){return Kp(n),r.data=$p.call(n,n.transformResponse,r),r.headers=kr.from(r.headers),r},function(r){return ox(r)||(Kp(n),r&&r.response&&(r.response.data=$p.call(n,n.transformResponse,r.response),r.response.headers=kr.from(r.response.headers))),Promise.reject(r)})}const dx="1.13.2",qf={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{qf[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const bE={};qf.transitional=function(e,t,r){function i(s,o){return"[Axios v"+dx+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new gt(i(o," has been removed"+(t?" in "+t:"")),gt.ERR_DEPRECATED);return t&&!bE[o]&&(bE[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};qf.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function h8(n,e,t){if(typeof n!="object")throw new gt("options must be an object",gt.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=n[s],l=a===void 0||o(a,s,n);if(l!==!0)throw new gt("option "+s+" must be "+l,gt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new gt("Unknown option "+s,gt.ERR_BAD_OPTION)}}const Kh={assertOptions:h8,validators:qf},Ii=Kh.validators;let jo=class{constructor(e){this.defaults=e||{},this.interceptors={request:new vE,response:new vE}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ra(this.defaults,t);const{transitional:r,paramsSerializer:i,headers:s}=t;r!==void 0&&Kh.assertOptions(r,{silentJSONParsing:Ii.transitional(Ii.boolean),forcedJSONParsing:Ii.transitional(Ii.boolean),clarifyTimeoutError:Ii.transitional(Ii.boolean)},!1),i!=null&&(me.isFunction(i)?t.paramsSerializer={serialize:i}:Kh.assertOptions(i,{encode:Ii.function,serialize:Ii.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Kh.assertOptions(t,{baseUrl:Ii.spelling("baseURL"),withXsrfToken:Ii.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&me.merge(s.common,s[t.method]);s&&me.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),t.headers=kr.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(t)===!1||(l=l&&v.synchronous,a.unshift(v.fulfilled,v.rejected))});const c=[];this.interceptors.response.forEach(function(v){c.push(v.fulfilled,v.rejected)});let u,f=0,p;if(!l){const m=[RE.bind(this),void 0];for(m.unshift(...a),m.push(...c),p=m.length,u=Promise.resolve(t);f<p;)u=u.then(m[f++],m[f++]);return u}p=a.length;let g=t;for(;f<p;){const m=a[f++],v=a[f++];try{g=m(g)}catch(_){v.call(this,_);break}}try{u=RE.call(this,g)}catch(m){return Promise.reject(m)}for(f=0,p=c.length;f<p;)u=u.then(c[f++],c[f++]);return u}getUri(e){e=ra(this.defaults,e);const t=lx(e.baseURL,e.url,e.allowAbsoluteUrls);return rx(t,e.params,e.paramsSerializer)}};me.forEach(["delete","get","head","options"],function(e){jo.prototype[e]=function(t,r){return this.request(ra(r||{},{method:e,url:t,data:(r||{}).data}))}});me.forEach(["post","put","patch"],function(e){function t(r){return function(s,o,a){return this.request(ra(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}jo.prototype[e]=t(),jo.prototype[e+"Form"]=t(!0)});let d8=class fx{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new Ml(s,o,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new fx(function(i){e=i}),cancel:e}}};function f8(n){return function(t){return n.apply(null,t)}}function p8(n){return me.isObject(n)&&n.isAxiosError===!0}const ig={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(ig).forEach(([n,e])=>{ig[e]=n});function px(n){const e=new jo(n),t=WI(jo.prototype.request,e);return me.extend(t,jo.prototype,e,{allOwnKeys:!0}),me.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return px(ra(n,i))},t}const gn=px(Pu);gn.Axios=jo;gn.CanceledError=Ml;gn.CancelToken=d8;gn.isCancel=ox;gn.VERSION=dx;gn.toFormData=Gf;gn.AxiosError=gt;gn.Cancel=gn.CanceledError;gn.all=function(e){return Promise.all(e)};gn.spread=f8;gn.isAxiosError=p8;gn.mergeConfig=ra;gn.AxiosHeaders=kr;gn.formToJSON=n=>sx(me.isHTMLForm(n)?new FormData(n):n);gn.getAdapter=hx.getAdapter;gn.HttpStatusCode=ig;gn.default=gn;const{Axios:vte,AxiosError:_te,CanceledError:yte,isCancel:Ete,CancelToken:Tte,VERSION:wte,all:Ate,Cancel:Cte,isAxiosError:Ste,spread:Ite,toFormData:xte,AxiosHeaders:Rte,HttpStatusCode:bte,formToJSON:kte,getAdapter:Pte,mergeConfig:Ote}=gn,g8="https://asia-east2-munkh-zaisan.cloudfunctions.net",fr=gn.create({baseURL:g8,headers:{"Content-Type":"application/json"},timeout:12e4});async function m8(n){try{return(await fr.post("/syncEmployeesToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing employees to Excel:",e),e}}async function v8(n){try{return(await fr.post("/syncFromExcelToFirestore",{accessToken:n})).data}catch(e){throw console.error("Error syncing from Excel to Firestore:",e),e}}async function _8(n,e,t=null){try{return(await fr.post("/manageEmployee",{action:n,employeeData:e,employeeId:t})).data}catch(r){throw console.error("Error managing employee:",r),r}}async function y8(n){try{return(await fr.post("/syncCustomersToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing customers to Excel:",e),e}}async function E8(n){try{return(await fr.post("/syncFromExcelToCustomers",{accessToken:n})).data}catch(e){throw console.error("Error syncing from Excel to customers:",e),e}}async function T8(n,e,t=null){try{return(await fr.post("/manageCustomer",{action:n,customerData:e,customerId:t})).data}catch(r){throw console.error("Error managing customer:",r),r}}async function w8(n){try{return(await fr.post("/syncProjectsToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing projects to Excel:",e),e}}async function A8(n){try{return(await fr.post("/syncFromExcelToProjects",{accessToken:n})).data}catch(e){throw console.error("Error syncing from Excel to projects:",e),e}}async function C8(n,e,t=null){try{return(await fr.post("/manageProject",{action:n,projectData:e,projectId:t})).data}catch(r){throw console.error("Error managing project:",r),r}}async function xc(n,e,t=null){try{return(await fr.post("/manageTimeAttendanceRequest",{action:n,requestData:e,requestId:t})).data}catch(r){throw console.error("Error managing time attendance request:",r),r}}async function vh(n,e){try{return(await fr.post("/approveTimeAttendanceRequest",{requestId:n,action:e})).data}catch(t){throw console.error("Error approving time attendance request:",t),t}}async function S8(n){try{return(await fr.post("/syncTimeAttendanceToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing time attendance to Excel:",e),e}}async function I8(){try{return(await fr.get("/updateProjectRealHours")).data}catch(n){throw console.error("Error updating project real hours:",n),n}}async function kE(n,e){try{return(await fr.post("/manageFinancialTransaction",{action:n,transaction:e})).data}catch(t){throw console.error("Error managing financial transaction:",t),t}}async function x8(){try{return(await fr.post("/syncFinancialTransToExcel")).data}catch(n){throw console.error("Error syncing financial transactions to Excel:",n),n}}async function R8(){try{return(await fr.post("/syncFromExcelToFinancialTrans")).data}catch(n){throw console.error("Error syncing from Excel to financial transactions:",n),n}}const b8={class:"management-section"},k8={class:"management-buttons"},P8={key:0,class:"item-list"},O8={class:"list-controls"},N8={class:"item-grid"},D8=["onClick"],M8={class:"item-badge"},F8={class:"employee-name"},L8={class:"employee-info"},U8={class:"employee-info"},B8={class:"modal-content"},V8={key:0,class:"error"},H8={class:"form-row"},$8={class:"form-group"},K8={class:"form-group"},j8={class:"form-row"},W8={class:"form-group"},G8={class:"form-group"},q8={class:"form-row"},z8={class:"form-group"},Y8={class:"form-group"},Q8={class:"form-row"},X8={class:"form-group"},J8={class:"form-group"},Z8={class:"form-row"},eV={class:"form-group"},tV={class:"form-group"},nV={class:"form-row"},rV={class:"form-group"},iV={class:"form-group"},sV={class:"form-row"},oV={class:"form-group"},aV={class:"form-group"},lV={class:"form-row"},cV={class:"form-group"},uV={class:"form-group"},hV={class:"form-row"},dV={class:"form-group"},fV={class:"form-group"},pV={class:"form-actions"},gV=["disabled"],mV={__name:"EmployeeManagement",emits:["saved"],setup(n,{emit:e}){const t=Ol(),r=Se(!1),i=Se(!1),s=Se(null),o=Se(""),a=Se("state"),l=Se(!1),c=Se(""),u=Se({Id:"",LastName:"",FirstName:"",Department:"",Position:"",NumID:"",Phone:"",Mobile:"",DateApplied:"",DateJoined:"","Date-Leave":"",DateBirth:"",Type:"",State:" ",Gender:"",DoorNum:"",Role:"Employee",Email:""}),f=e,p=it(()=>{let b=[...t.employees];if(o.value.trim()){const T=o.value.toLowerCase();b=b.filter(R=>{const B=(R.LastName||"").toLowerCase(),W=(R.FirstName||"").toLowerCase(),A=(R.Position||"").toLowerCase(),w=(R.NumID||"").toLowerCase();return B.includes(T)||W.includes(T)||A.includes(T)||w.includes(T)})}return b.sort((T,R)=>{const B=(T.State||"").toLowerCase(),W=(R.State||"").toLowerCase();if(B!==W)return B<W?-1:1;const A=(T.FirstName||"").toLowerCase(),w=(R.FirstName||"").toLowerCase();return A<w?-1:A>w?1:0}),b});function g(b){if(!b||typeof b!="number")return"";const R=Math.floor(b-25569)*86400,B=new Date(R*1e3),W=B.getUTCFullYear(),A=String(B.getUTCMonth()+1).padStart(2,"0"),w=String(B.getUTCDate()).padStart(2,"0");return`${W}-${A}-${w}`}function m(){const b=t.employees.reduce((T,R)=>{const B=parseInt(R.Id);return!isNaN(B)&&B>T?B:T},0);u.value.Id=b+1,i.value=!0}function v(b){s.value=b;const T=["Employee","Supervisor","nonEmployee","Financial"];let R=b.Role||"Employee";T.includes(R)||(R="Employee"),u.value={Id:b.Id||"",LastName:b.LastName||"",FirstName:b.FirstName||"",Department:b.Department||"",Position:b.Position||"",NumID:b.NumID||"",Phone:b.Phone||"",Mobile:b.Mobile1||b.Mobile||"",DateApplied:g(b.DateApplied),DateJoined:g(b.DateJoined),"Date-Leave":g(b["Date-Leave"]),DateBirth:g(b.DateBirth),Type:b.Type||"",State:b.State||"",Gender:b.Gender||"",DoorNum:b.DoorNum||"",Role:R,Email:b.Email||""}}function _(){i.value=!1,s.value=null,c.value="",u.value={Id:"",LastName:"",FirstName:"",Department:"",Position:"",NumID:"",Phone:"",Mobile:"",DateApplied:"",DateJoined:"","Date-Leave":"",DateBirth:"",Type:"",State:" ",Gender:"",DoorNum:"",Role:"Employee",Email:""}}async function D(){var b;l.value=!0,c.value="";try{const T=s.value?"update":"add",R=((b=s.value)==null?void 0:b.id)||null;await _8(T,u.value,R),await t.fetchEmployees(),f("saved",{success:!0,action:T,type:"employee"}),_()}catch(T){c.value=T.message}finally{l.value=!1}}return(b,T)=>(ee(),te("div",b8,[T[48]||(T[48]=d("h4",null,"Employee Management",-1)),d("div",k8,[d("button",{onClick:m,class:"action-btn add-btn"}," + Add Employee "),d("button",{onClick:T[0]||(T[0]=R=>r.value=!r.value),class:"action-btn"},Y(r.value?"Hide":"Edit")+" Employees ",1)]),r.value?(ee(),te("div",P8,[T[23]||(T[23]=d("h5",null,"Select Employee to Edit:",-1)),d("div",O8,[Ie(d("input",{"onUpdate:modelValue":T[1]||(T[1]=R=>o.value=R),type:"text",placeholder:"Search by name, position, or NumID...",class:"search-input"},null,512),[[Ge,o.value]]),Ie(d("select",{"onUpdate:modelValue":T[2]||(T[2]=R=>a.value=R),class:"sort-select"},[...T[22]||(T[22]=[d("option",{value:"lastName"},"Sort by Last Name",-1),d("option",{value:"firstName"},"Sort by First Name",-1),d("option",{value:"position"},"Sort by Position",-1),d("option",{value:"state"},"Sort by State",-1)])],512),[[_t,a.value]])]),d("div",N8,[(ee(!0),te(wt,null,rn(p.value,R=>(ee(),te("div",{key:R.id,class:"item-card",onClick:B=>v(R)},[d("div",M8,Y(R.NumID),1),d("div",F8,Y(R.FirstName),1),d("div",L8,Y(R.Position),1),d("div",U8," "+Y(R.Phone||R.Mobile||"N/A"),1),d("div",{class:Tt(["state-badge",R.State===" "?"active":"inactive"])},Y(R.State),3)],8,D8))),128))])])):Ke("",!0),i.value||s.value?(ee(),te("div",{key:1,class:"modal-overlay",onClick:ni(_,["self"])},[d("div",B8,[d("h3",null,Y(s.value?"Edit Employee":"Add New Employee"),1),d("form",{onSubmit:ni(D,["prevent"]),class:"item-form"},[c.value?(ee(),te("p",V8,Y(c.value),1)):Ke("",!0),d("div",H8,[d("div",$8,[T[24]||(T[24]=d("label",null,"Id *",-1)),Ie(d("input",{"onUpdate:modelValue":T[3]||(T[3]=R=>u.value.Id=R),type:"number",required:"",readonly:"",style:{"background-color":"#f5f5f5",cursor:"not-allowed"},placeholder:"Auto-generated"},null,512),[[Ge,u.value.Id]])]),d("div",K8,[T[25]||(T[25]=d("label",null,"NumID *",-1)),Ie(d("input",{"onUpdate:modelValue":T[4]||(T[4]=R=>u.value.NumID=R),type:"text",required:"",placeholder:"01261770",maxlength:"10"},null,512),[[Ge,u.value.NumID]])])]),d("div",j8,[d("div",W8,[T[26]||(T[26]=d("label",null," *",-1)),Ie(d("input",{"onUpdate:modelValue":T[5]||(T[5]=R=>u.value.LastName=R),type:"text",required:""},null,512),[[Ge,u.value.LastName]])]),d("div",G8,[T[27]||(T[27]=d("label",null," *",-1)),Ie(d("input",{"onUpdate:modelValue":T[6]||(T[6]=R=>u.value.FirstName=R),type:"text",required:""},null,512),[[Ge,u.value.FirstName]])])]),d("div",q8,[d("div",z8,[T[29]||(T[29]=d("label",null,"Department",-1)),Ie(d("select",{"onUpdate:modelValue":T[7]||(T[7]=R=>u.value.Department=R)},[...T[28]||(T[28]=[d("option",{value:""},"Select",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1)])],512),[[_t,u.value.Department]])]),d("div",Y8,[T[31]||(T[31]=d("label",null,"Position *",-1)),u.value.Department===""?Ie((ee(),te("select",{key:0,"onUpdate:modelValue":T[8]||(T[8]=R=>u.value.Position=R),required:""},[...T[30]||(T[30]=[d("option",{value:""},"Select position",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1)])],512)),[[_t,u.value.Position]]):Ie((ee(),te("input",{key:1,"onUpdate:modelValue":T[9]||(T[9]=R=>u.value.Position=R),type:"text",required:"",placeholder:"Position"},null,512)),[[Ge,u.value.Position]])])]),d("div",Q8,[d("div",X8,[T[32]||(T[32]=d("label",null,"Phone",-1)),Ie(d("input",{"onUpdate:modelValue":T[10]||(T[10]=R=>u.value.Phone=R),type:"tel",placeholder:"94242515",style:{"background-color":"white"}},null,512),[[Ge,u.value.Phone]])]),d("div",J8,[T[33]||(T[33]=d("label",null,"Mobile",-1)),Ie(d("input",{"onUpdate:modelValue":T[11]||(T[11]=R=>u.value.Mobile=R),type:"tel",placeholder:"80097829",style:{"background-color":"white"}},null,512),[[Ge,u.value.Mobile]])])]),d("div",Z8,[d("div",eV,[T[34]||(T[34]=d("label",null,"Email",-1)),Ie(d("input",{"onUpdate:modelValue":T[12]||(T[12]=R=>u.value.Email=R),type:"email",placeholder:"employee@example.com"},null,512),[[Ge,u.value.Email]])]),d("div",tV,[T[36]||(T[36]=d("label",null,"Gender",-1)),Ie(d("select",{"onUpdate:modelValue":T[13]||(T[13]=R=>u.value.Gender=R)},[...T[35]||(T[35]=[d("option",{value:""},"Select",-1),d("option",{value:"Male"},"Male",-1),d("option",{value:"Female"},"Female",-1)])],512),[[_t,u.value.Gender]])])]),d("div",nV,[d("div",rV,[T[37]||(T[37]=d("label",null,"Date Applied",-1)),Ie(d("input",{"onUpdate:modelValue":T[14]||(T[14]=R=>u.value.DateApplied=R),type:"date"},null,512),[[Ge,u.value.DateApplied]])]),d("div",iV,[T[38]||(T[38]=d("label",null,"Date Joined",-1)),Ie(d("input",{"onUpdate:modelValue":T[15]||(T[15]=R=>u.value.DateJoined=R),type:"date"},null,512),[[Ge,u.value.DateJoined]])])]),d("div",sV,[d("div",oV,[T[39]||(T[39]=d("label",null,"Date Birth",-1)),Ie(d("input",{"onUpdate:modelValue":T[16]||(T[16]=R=>u.value.DateBirth=R),type:"date"},null,512),[[Ge,u.value.DateBirth]])]),d("div",aV,[T[40]||(T[40]=d("label",null,"Date Leave",-1)),Ie(d("input",{"onUpdate:modelValue":T[17]||(T[17]=R=>u.value["Date-Leave"]=R),type:"date"},null,512),[[Ge,u.value["Date-Leave"]]])])]),d("div",lV,[d("div",cV,[T[42]||(T[42]=d("label",null,"Type",-1)),Ie(d("select",{"onUpdate:modelValue":T[18]||(T[18]=R=>u.value.Type=R)},[...T[41]||(T[41]=[d("option",{value:""},"Select type",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1)])],512),[[_t,u.value.Type]])]),d("div",uV,[T[44]||(T[44]=d("label",null,"State *",-1)),Ie(d("select",{"onUpdate:modelValue":T[19]||(T[19]=R=>u.value.State=R),required:""},[...T[43]||(T[43]=[d("option",{value:" "}," ",-1),d("option",{value:""},"",-1),d("option",{value:"/"},"/",-1)])],512),[[_t,u.value.State]])])]),d("div",hV,[d("div",dV,[T[45]||(T[45]=d("label",null,"Door Number",-1)),Ie(d("input",{"onUpdate:modelValue":T[20]||(T[20]=R=>u.value.DoorNum=R),type:"text"},null,512),[[Ge,u.value.DoorNum]])]),d("div",fV,[T[47]||(T[47]=d("label",null,"Role *",-1)),Ie(d("select",{"onUpdate:modelValue":T[21]||(T[21]=R=>u.value.Role=R),required:""},[...T[46]||(T[46]=[Cs('<option value="" data-v-b505f998>Select Role</option><option value="Employee" data-v-b505f998>Employee</option><option value="Supervisor" data-v-b505f998>Supervisor</option><option value="nonEmployee" data-v-b505f998>nonEmployee</option><option value="Financial" data-v-b505f998>Financial</option>',5)])],512),[[_t,u.value.Role]])])]),d("div",pV,[d("button",{type:"submit",class:"save-btn",disabled:l.value},Y(l.value?"Saving...":"Save"),9,gV),d("button",{type:"button",onClick:_,class:"cancel-btn"},"Cancel")])],32)])])):Ke("",!0)]))}},vV=Cr(mV,[["__scopeId","data-v-b505f998"]]),_V={class:"management-section"},yV={class:"management-buttons"},EV={key:0,class:"item-list"},TV={class:"list-controls"},wV={class:"item-grid"},AV=["onClick"],CV={class:"item-badge"},SV={class:"customer-name"},IV={class:"customer-info"},xV={class:"customer-info contract"},RV={key:0,class:"customer-info date"},bV={class:"modal-content"},kV={key:0,class:"error"},PV={class:"form-row"},OV={class:"form-group"},NV={class:"form-group"},DV={class:"form-row"},MV={class:"form-group"},FV={class:"form-group"},LV={class:"form-row"},UV={class:"form-group"},BV={class:"form-group"},VV={class:"form-row"},HV={class:"form-group"},$V={class:"form-group"},KV={class:"form-actions"},jV=["disabled"],WV={__name:"CustomerManagement",emits:["saved"],setup(n,{emit:e}){const t=pv(),r=Se(!1),i=Se(!1),s=Se(null),o=Se(""),a=Se("name"),l=Se(!1),c=Se(""),u=Se({ID:"",Name:"",ContractType:"",Initial_StartDate:"",Contract_Num:"",ContractStartDate:"",ContractDueDate:"",Descrption:""}),f=e,p=it(()=>{let T=[...t.customers];if(o.value.trim()){const R=o.value.toLowerCase();T=T.filter(B=>{const W=(B.Name||"").toLowerCase(),A=(B.Contract_Num||"").toLowerCase();return W.includes(R)||A.includes(R)})}return T.sort((R,B)=>{if(a.value==="name"){const W=(R.Name||"").toLowerCase(),A=(B.Name||"").toLowerCase();return W<A?-1:W>A?1:0}else{if(a.value==="contract")return(R.ContractType||"").localeCompare(B.ContractType||"");if(a.value==="date")return(B.ContractStartDate||"").localeCompare(R.ContractStartDate||"")}return 0}),T});function g(T){if(!T)return"";try{return new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return T}}function m(T){if(!T||typeof T!="number")return"";const R=Math.floor(T-25569),B=new Date(R*86400*1e3),W=B.getUTCFullYear(),A=String(B.getUTCMonth()+1).padStart(2,"0"),w=String(B.getUTCDate()).padStart(2,"0");return`${W}-${A}-${w}`}function v(){const T=t.customers.reduce((R,B)=>{const W=parseInt(B.ID);return!isNaN(W)&&W>R?W:R},0);u.value.ID=T+1,i.value=!0}function _(T){s.value=T,u.value={ID:T.ID||"",Name:T.Name||"",ContractType:T.ContractType||"",Initial_StartDate:m(T.Initial_StartDate),Contract_Num:T.Contract_Num||"",ContractStartDate:m(T.ContractStartDate),ContractDueDate:m(T.ContractDueDate),Descrption:T.Descrption||""}}function D(){i.value=!1,s.value=null,c.value="",u.value={ID:"",Name:"",ContractType:"",Initial_StartDate:"",Contract_Num:"",ContractStartDate:"",ContractDueDate:"",Descrption:""}}async function b(){var T;l.value=!0,c.value="";try{const R=s.value?"update":"add",B=((T=s.value)==null?void 0:T.id)||null;await T8(R,u.value,B),await t.fetchCustomers(),f("saved",{success:!0,action:R,type:"customer"}),D()}catch(R){c.value=R.message}finally{l.value=!1}}return(T,R)=>(ee(),te("div",_V,[R[22]||(R[22]=d("h4",null,"Customer Management",-1)),d("div",yV,[d("button",{onClick:v,class:"action-btn add-btn"}," + Add Customer "),d("button",{onClick:R[0]||(R[0]=B=>r.value=!r.value),class:"action-btn"},Y(r.value?"Hide":"Edit")+" Customers ",1)]),r.value?(ee(),te("div",EV,[R[12]||(R[12]=d("h5",null,"Select Customer to Edit:",-1)),d("div",TV,[Ie(d("input",{"onUpdate:modelValue":R[1]||(R[1]=B=>o.value=B),type:"text",placeholder:"Search by name or contract...",class:"search-input"},null,512),[[Ge,o.value]]),Ie(d("select",{"onUpdate:modelValue":R[2]||(R[2]=B=>a.value=B),class:"sort-select"},[...R[11]||(R[11]=[d("option",{value:"name"},"Sort by Name",-1),d("option",{value:"contract"},"Sort by Contract Type",-1),d("option",{value:"date"},"Sort by Start Date",-1)])],512),[[_t,a.value]])]),d("div",wV,[(ee(!0),te(wt,null,rn(p.value,B=>(ee(),te("div",{key:B.id,class:"item-card customer-card-item",onClick:W=>_(B)},[d("div",CV,Y(B.ID),1),d("div",SV,Y(B.Name),1),d("div",IV," "+Y(B.ContractType),1),d("div",xV," "+Y(B.Contract_Num),1),B.ContractStartDate?(ee(),te("div",RV,"  "+Y(g(B.ContractStartDate)),1)):Ke("",!0)],8,AV))),128))])])):Ke("",!0),i.value||s.value?(ee(),te("div",{key:1,class:"modal-overlay",onClick:ni(D,["self"])},[d("div",bV,[d("h3",null,Y(s.value?"Edit Customer":"Add New Customer"),1),d("form",{onSubmit:ni(b,["prevent"]),class:"item-form"},[c.value?(ee(),te("p",kV,Y(c.value),1)):Ke("",!0),d("div",PV,[d("div",OV,[R[13]||(R[13]=d("label",null,"ID *",-1)),Ie(d("input",{"onUpdate:modelValue":R[3]||(R[3]=B=>u.value.ID=B),type:"number",required:"",readonly:"",style:{"background-color":"#f5f5f5"},placeholder:"Auto-generated"},null,512),[[Ge,u.value.ID]])]),d("div",NV,[R[14]||(R[14]=d("label",null,"Name *",-1)),Ie(d("input",{"onUpdate:modelValue":R[4]||(R[4]=B=>u.value.Name=B),type:"text",required:""},null,512),[[Ge,u.value.Name]])])]),d("div",DV,[d("div",MV,[R[16]||(R[16]=d("label",null,"Contract Type",-1)),Ie(d("select",{"onUpdate:modelValue":R[5]||(R[5]=B=>u.value.ContractType=B)},[...R[15]||(R[15]=[Cs('<option value="" data-v-bbe4d2b7>Select type...</option><option value=" " data-v-bbe4d2b7> </option><option value=" " data-v-bbe4d2b7> </option><option value=" " data-v-bbe4d2b7> </option><option value="" data-v-bbe4d2b7></option>',5)])],512),[[_t,u.value.ContractType]])]),d("div",FV,[R[17]||(R[17]=d("label",null,"Contract Number",-1)),Ie(d("input",{"onUpdate:modelValue":R[6]||(R[6]=B=>u.value.Contract_Num=B),type:"text"},null,512),[[Ge,u.value.Contract_Num]])])]),d("div",LV,[d("div",UV,[R[18]||(R[18]=d("label",null,"Initial Start Date",-1)),Ie(d("input",{"onUpdate:modelValue":R[7]||(R[7]=B=>u.value.Initial_StartDate=B),type:"date"},null,512),[[Ge,u.value.Initial_StartDate]])]),d("div",BV,[R[19]||(R[19]=d("label",null,"Contract Start Date",-1)),Ie(d("input",{"onUpdate:modelValue":R[8]||(R[8]=B=>u.value.ContractStartDate=B),type:"date"},null,512),[[Ge,u.value.ContractStartDate]])])]),d("div",VV,[d("div",HV,[R[20]||(R[20]=d("label",null,"Contract Due Date",-1)),Ie(d("input",{"onUpdate:modelValue":R[9]||(R[9]=B=>u.value.ContractDueDate=B),type:"date"},null,512),[[Ge,u.value.ContractDueDate]])]),d("div",$V,[R[21]||(R[21]=d("label",null,"Description",-1)),Ie(d("input",{"onUpdate:modelValue":R[10]||(R[10]=B=>u.value.Descrption=B),type:"text"},null,512),[[Ge,u.value.Descrption]])])]),d("div",KV,[d("button",{type:"submit",class:"save-btn",disabled:l.value},Y(l.value?"Saving...":"Save"),9,jV),d("button",{type:"button",onClick:D,class:"cancel-btn"},"Cancel")])],32)])])):Ke("",!0)]))}},GV=Cr(WV,[["__scopeId","data-v-bbe4d2b7"]]),qV={class:"management-section"},zV={class:"management-buttons"},YV={key:0,class:"item-list"},QV={class:"list-controls"},XV={class:"item-grid"},JV=["onClick"],ZV={class:"card-header"},eH={class:"item-badge"},tH={class:"project-location"},nH={class:"project-customer"},rH={class:"project-info"},iH={class:"project-stats"},sH={class:"stat-item"},oH={class:"stat-value"},aH={class:"stat-item"},lH={class:"stat-value real"},cH={key:0,class:"stat-item"},uH={class:"stat-value engineer"},hH={key:1,class:"stat-item"},dH={class:"stat-value non-engineer"},fH={class:"progress-section"},pH={class:"progress-bar"},gH={class:"progress-text"},mH={key:0,class:"time-performance"},vH={key:1,class:"engineer-bounty"},_H={class:"bounty-value"},yH={key:2,class:"team-bounty"},EH={class:"team-bounty-value"},TH={key:3,class:"non-engineer-bounty"},wH={class:"non-engineer-bounty-value"},AH={class:"profit-value"},CH={class:"modal-content"},SH={key:0,class:"error"},IH={class:"form-row"},xH={class:"form-group"},RH={class:"form-group"},bH=["disabled"],kH=["value"],PH={class:"form-row"},OH={class:"form-group"},NH=["disabled"],DH={class:"form-group"},MH=["disabled"],FH=["readonly"],LH={class:"form-row"},UH={class:"form-group"},BH=["readonly"],VH={class:"form-group"},HH=["disabled"],$H=["value"],KH={class:"form-row"},jH={class:"form-group"},WH=["readonly"],GH={class:"form-group"},qH=["readonly"],zH={class:"form-row"},YH={class:"form-group"},QH=["disabled"],XH={class:"form-group"},JH=["readonly"],ZH={class:"form-group",style:{"grid-column":"1 / -1","margin-top":"15px"}},e9=["readonly"],t9={class:"form-group",style:{"grid-column":"1 / -1"}},n9=["readonly"],r9={class:"form-row"},i9={class:"form-group"},s9=["readonly"],o9={class:"form-group"},a9=["readonly"],l9={class:"form-row"},c9={class:"form-group"},u9=["value"],h9={class:"form-group"},d9=["value"],f9={class:"form-row"},p9={class:"form-group"},g9=["value"],m9={class:"form-group"},v9=["value"],_9={class:"form-row"},y9={class:"form-group"},E9=["value"],T9={class:"form-group"},w9=["value"],A9={class:"form-row"},C9={class:"form-group"},S9=["value"],I9={key:1,class:"form-row"},x9={class:"form-group"},R9=["value"],b9={class:"form-row"},k9={class:"form-group"},P9=["value"],O9={class:"form-group"},N9=["readonly"],D9={class:"form-row"},M9={class:"form-group"},F9=["readonly"],L9={class:"form-row"},U9={class:"form-group"},B9=["readonly"],V9={class:"form-group"},H9=["readonly"],$9={class:"form-row"},K9={class:"form-group"},j9=["value"],W9={class:"form-row"},G9={class:"form-group"},q9=["readonly"],z9={class:"form-group"},Y9=["readonly"],Q9={class:"form-row"},X9={class:"form-group"},J9=["readonly"],Z9={class:"form-group"},e$=["readonly"],t$={class:"form-row"},n$={class:"form-group"},r$=["value"],i$={class:"form-group"},s$=["value"],o$={class:"form-row"},a$={class:"form-group"},l$=["value"],c$={class:"form-group"},u$=["value"],h$={class:"form-actions"},d$=["disabled"],f$={__name:"ProjectManagement",emits:["saved"],setup(n,{expose:e,emit:t}){const r=Nl(),i=pv(),s=Ol();Dr(async()=>{i.customers.length===0&&await i.fetchCustomers(),s.employees.length===0&&await s.fetchEmployees()});const o=Se(!1),a=Se(!1),l=Se(null),c=Se(null),u=Se(!1),f=Se(""),p=Se(""),g=Se("customer"),m=Se(!1),v=Se(""),_=Se({id:"",customer:"",type:"",subtype:"",siteLocation:"",StartDate:"",EndDate:"",ResponsibleEmp:"",Detail:"",Comment:"",referenceIdfromCustomer:"",Status:"Active",WosHour:0,EngineerHand:0,TeamBounty:0,EngineerBounty:0,PlannedHour:0,RealHour:0,EngineerWorkHour:0,NonEngineerWorkHour:0,NonEngineerBounty:0,HourPerformance:0,additionalHour:0,additionalValue:0,AdditionalOwner:"",IncomeHR:0,ExpenceHR:0,IncomeCar:0,ExpenceCar:0,IncomeMaterial:0,ExpenceMaterial:0,ExpenceHSE:0,ProfitHR:0,ProfitCar:0,ProfitMaterial:0,TotalProfit:0}),D=t,b=it(()=>s.employees.filter(fe=>fe.State===" ")),T=it(()=>{let fe=[...r.projects];if(f.value.trim()){const F=f.value.toLowerCase();fe=fe.filter(O=>{const Z=(O.customer||"").toLowerCase(),q=(O.type||"").toLowerCase(),X=(O.siteLocation||"").toLowerCase();return Z.includes(F)||q.includes(F)||X.includes(F)})}return p.value&&(fe=fe.filter(F=>F.Status===p.value)),fe.sort((F,O)=>{if(g.value==="customer"){const Z=(F.customer||"").toLowerCase(),q=(O.customer||"").toLowerCase();return Z<q?-1:Z>q?1:0}else{if(g.value==="status")return(F.Status||"").localeCompare(O.Status||"");if(g.value==="profit")return(O.TotalProfit||0)-(F.TotalProfit||0);if(g.value==="date")return(O.StartDate||"").localeCompare(F.StartDate||"")}return 0}),fe});function R(fe){if(!fe||typeof fe!="number")return"";const F=Math.floor(fe-25569),O=new Date(F*86400*1e3),Z=O.getUTCFullYear(),q=String(O.getUTCMonth()+1).padStart(2,"0"),X=String(O.getUTCDate()).padStart(2,"0");return`${Z}-${q}-${X}`}function B(fe){return!fe&&fe!==0?"":new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}).format(fe)}function W(fe,F){return!F||F===0?0:fe/F*100}function A(fe,F,O){if(!F||F===0||!O)return 0;const q=200-fe/F*100;return O*q/100}function w(fe,F){const O=W(fe,F);return O<100?"perf-good":O===100?"perf-perfect":"perf-bad"}function E(fe){return{:17," ":33,"  ":50,"   ":67," ":83,:100}[fe]||0}function C(fe){return{:"#3b82f6"," ":"#f59e0b","  ":"#8b5cf6","   ":"#ec4899"," ":"#10b981",:"#22c55e"}[fe]||"#6b7280"}function I(){_.value.IncomeHR=(_.value.WosHour||0)*11e4,ie()}function x(){_.value.WosHour=_.value.IncomeHR?_.value.IncomeHR/11e4:0,ie()}function P(){_.value.additionalValue=(_.value.additionalHour||0)*65e3,ie()}function ie(){_.value.TeamBounty=(_.value.WosHour||0)*22500,_.value.PlannedHour=(_.value.WosHour||0)*3,_.value.NonEngineerBounty=(_.value.NonEngineerWorkHour||0)*5e3,_.value.HourPerformance=W(_.value.RealHour,_.value.PlannedHour);const fe=(_.value.WosHour||0)*12500;_.value.EngineerHand=A(_.value.RealHour,_.value.PlannedHour,fe),_.value.EngineerBounty=(_.value.EngineerWorkHour||0)*12500;const F=(_.value.ExpenceHR||0)+(_.value.additionalValue||0);_.value.ProfitHR=(_.value.IncomeHR||0)-F,_.value.ProfitCar=(_.value.IncomeCar||0)-(_.value.ExpenceCar||0),_.value.ProfitMaterial=(_.value.IncomeMaterial||0)-(_.value.ExpenceMaterial||0),_.value.TotalProfit=(_.value.ProfitHR||0)+(_.value.ProfitCar||0)+(_.value.ProfitMaterial||0)-(_.value.ExpenceHSE||0)}function Q(){const fe=r.projects.reduce((F,O)=>{const Z=parseInt(O.id);return!isNaN(Z)&&Z>F?Z:F},0);u.value=!0,_.value.id=fe+1,a.value=!0}function ae(fe){l.value=fe,c.value=fe.docId,console.log("Editing project:",{project:fe,docId:fe.docId,id:fe.id}),u.value=!1,_.value={id:fe.id||"",customer:fe.customer||"",type:fe.type||"",subtype:fe.subtype||"",siteLocation:fe.siteLocation||"",StartDate:R(fe.StartDate),EndDate:R(fe.EndDate),ResponsibleEmp:fe.ResponsibleEmp||"",Detail:fe.Detail||"",Comment:fe.Comment||"",referenceIdfromCustomer:fe.referenceIdfromCustomer||"",Status:fe.Status||"",WosHour:fe.WosHour||0,EngineerHand:fe.EngineerHand||0,TeamBounty:fe.TeamBounty||0,EngineerBounty:fe.EngineerBounty||0,PlannedHour:fe.PlannedHour||0,RealHour:fe.RealHour||0,EngineerWorkHour:fe.EngineerWorkHour||0,NonEngineerWorkHour:fe.NonEngineerWorkHour||0,NonEngineerBounty:fe.NonEngineerBounty||0,HourPerformance:fe.HourPerformance||0,additionalHour:fe.additionalHour||0,additionalValue:fe.additionalValue||0,AdditionalOwner:fe.AdditionalOwner||"",IncomeHR:fe.IncomeHR||0,ExpenceHR:fe.ExpenceHR||0,IncomeCar:fe.IncomeCar||0,ExpenceCar:fe.ExpenceCar||0,IncomeMaterial:fe.IncomeMaterial||0,ExpenceMaterial:fe.ExpenceMaterial||0,ExpenceHSE:fe.ExpenceHSE||0,ProfitHR:fe.ProfitHR||0,ProfitCar:fe.ProfitCar||0,ProfitMaterial:fe.ProfitMaterial||0,TotalProfit:fe.TotalProfit||0}}function Ae(){a.value=!1,l.value=null,c.value=null,u.value=!1,v.value="",_.value={id:"",customer:"",type:"",subtype:"",siteLocation:"",StartDate:"",EndDate:"",ResponsibleEmp:"",Detail:"",Comment:"",referenceIdfromCustomer:"",Status:"Active",WosHour:0,EngineerHand:0,TeamBounty:0,EngineerBounty:0,PlannedHour:0,RealHour:0,EngineerWorkHour:0,NonEngineerWorkHour:0,NonEngineerBounty:0,HourPerformance:0,additionalHour:0,additionalValue:0,AdditionalOwner:"",IncomeHR:0,ExpenceHR:0,IncomeCar:0,ExpenceCar:0,IncomeMaterial:0,ExpenceMaterial:0,ExpenceHSE:0,ProfitHR:0,ProfitCar:0,ProfitMaterial:0,TotalProfit:0}}async function Oe(){m.value=!0,v.value="";try{ie();const fe=l.value?"update":"add",F=c.value||null;console.log("Saving project:",{action:fe,itemId:F,formData:_.value}),await C8(fe,_.value,F),await r.fetchProjects(),D("saved",{success:!0,action:fe,type:"project"}),Ae()}catch(fe){console.error("Error saving project:",fe),v.value=fe.message}finally{m.value=!1}}function Ce(fe){const F=r.projects.find(O=>O.id===fe);F&&ae(F)}return e({openProjectById:Ce}),(fe,F)=>(ee(),te("div",qV,[F[105]||(F[105]=d("h4",null,"Project Management",-1)),d("div",zV,[d("button",{onClick:Q,class:"action-btn add-btn"}," + Add Project "),d("button",{onClick:F[0]||(F[0]=O=>o.value=!o.value),class:"action-btn"},Y(o.value?"Hide Projects":"List Projects"),1)]),o.value?(ee(),te("div",YV,[F[40]||(F[40]=d("h5",null,"Select Project to Edit:",-1)),d("div",QV,[Ie(d("input",{"onUpdate:modelValue":F[1]||(F[1]=O=>f.value=O),type:"text",placeholder:"Search by customer, type, or location...",class:"search-input"},null,512),[[Ge,f.value]]),Ie(d("select",{"onUpdate:modelValue":F[2]||(F[2]=O=>p.value=O),class:"filter-select"},[...F[29]||(F[29]=[Cs('<option value="" data-v-d8824a09>All Status</option><option value="" data-v-d8824a09></option><option value=" " data-v-d8824a09> </option><option value="  " data-v-d8824a09>  </option><option value="   " data-v-d8824a09>   </option><option value=" " data-v-d8824a09> </option><option value="" data-v-d8824a09></option>',7)])],512),[[_t,p.value]]),Ie(d("select",{"onUpdate:modelValue":F[3]||(F[3]=O=>g.value=O),class:"sort-select"},[...F[30]||(F[30]=[d("option",{value:"customer"},"Sort by Customer",-1),d("option",{value:"status"},"Sort by Status",-1),d("option",{value:"profit"},"Sort by Profit",-1),d("option",{value:"date"},"Sort by Date",-1)])],512),[[_t,g.value]])]),d("div",XV,[(ee(!0),te(wt,null,rn(T.value,O=>(ee(),te("div",{key:O.id,class:"item-card project-card-item",onClick:Z=>ae(O)},[d("div",ZV,[d("div",eH,Y(O.id),1),d("span",{class:Tt(["status-badge",O.Status])},Y(O.Status),3)]),d("div",tH," "+Y(O.siteLocation),1),d("div",nH,Y(O.customer),1),d("div",rH,Y(O.type)+" - "+Y(O.subtype),1),d("div",iH,[d("div",sH,[F[31]||(F[31]=d("span",{class:"stat-label"},"Planned:",-1)),d("span",oH,Y(B(O.PlannedHour))+"",1)]),d("div",aH,[F[32]||(F[32]=d("span",{class:"stat-label"},"Real:",-1)),d("span",lH,Y(B(O.RealHour))+"",1)]),O.EngineerWorkHour>0?(ee(),te("div",cH,[F[33]||(F[33]=d("span",{class:"stat-label"},"Engineer:",-1)),d("span",uH,Y(B(O.EngineerWorkHour))+"",1)])):Ke("",!0),O.NonEngineerWorkHour>0?(ee(),te("div",hH,[F[34]||(F[34]=d("span",{class:"stat-label"},"Non-Engineer:",-1)),d("span",dH,Y(B(O.NonEngineerWorkHour))+"",1)])):Ke("",!0)]),d("div",fH,[d("div",pH,[d("div",{class:"progress-fill",style:Nt({width:E(O.Status)+"%",backgroundColor:C(O.Status)})},null,4),d("span",gH,Y(E(O.Status))+"%",1)])]),O.PlannedHour>0?(ee(),te("div",mH,[F[35]||(F[35]=d("span",{class:"perf-label"}," :",-1)),d("span",{class:Tt(["perf-value",w(O.RealHour,O.PlannedHour)])},Y(B(W(O.RealHour,O.PlannedHour)))+"%",3)])):Ke("",!0),O.EngineerHand&&O.EngineerHand>0?(ee(),te("div",vH,[F[36]||(F[36]=d("span",{class:"bounty-label"}," :",-1)),d("span",_H,Y(B(O.EngineerHand))+"",1)])):Ke("",!0),O.TeamBounty&&O.TeamBounty>0?(ee(),te("div",yH,[F[37]||(F[37]=d("span",{class:"team-bounty-label"}," :",-1)),d("span",EH,Y(B(O.TeamBounty))+"",1)])):Ke("",!0),O.NonEngineerBounty&&O.NonEngineerBounty>0?(ee(),te("div",TH,[F[38]||(F[38]=d("span",{class:"non-engineer-bounty-label"},"  :",-1)),d("span",wH,Y(B(O.NonEngineerBounty))+"",1)])):Ke("",!0),d("div",{class:Tt(["profit-display",{"profit-positive":(O.TotalProfit||0)>0,"profit-negative":(O.TotalProfit||0)<0}])},[F[39]||(F[39]=d("span",{class:"profit-label"},"Total Profit:",-1)),d("span",AH,Y(B(O.TotalProfit||0))+"",1)],2)],8,JV))),128))])])):Ke("",!0),(ee(),Sg(f2,{to:"body"},[a.value||l.value?(ee(),te("div",{key:0,class:"modal-overlay",onClick:ni(Ae,["self"])},[d("div",CH,[d("h3",null,Y(l.value&&!u.value?"View Project":l.value?"Edit Project":"Add New Project"),1),d("form",{onSubmit:ni(Oe,["prevent"]),class:"item-form"},[v.value?(ee(),te("p",SH,Y(v.value),1)):Ke("",!0),d("div",IH,[d("div",xH,[F[41]||(F[41]=d("label",null,"ID *",-1)),Ie(d("input",{"onUpdate:modelValue":F[4]||(F[4]=O=>_.value.id=O),type:"number",required:"",readonly:"",style:{"background-color":"#f5f5f5"},placeholder:"Auto"},null,512),[[Ge,_.value.id]])]),d("div",RH,[F[43]||(F[43]=d("label",null,"Customer *",-1)),Ie(d("select",{"onUpdate:modelValue":F[5]||(F[5]=O=>_.value.customer=O),required:"",disabled:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},[F[42]||(F[42]=d("option",{value:""},"Select customer...",-1)),(ee(!0),te(wt,null,rn(jt(i).customers,O=>(ee(),te("option",{key:O.ID,value:O.Name},Y(O.Name),9,kH))),128))],12,bH),[[_t,_.value.customer]])])]),d("div",PH,[d("div",OH,[F[45]||(F[45]=d("label",null,"Type *",-1)),Ie(d("select",{"onUpdate:modelValue":F[6]||(F[6]=O=>_.value.type=O),required:"",disabled:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onChange:F[7]||(F[7]=O=>_.value.subtype="")},[...F[44]||(F[44]=[d("option",{value:""},"Select type...",-1),d("option",{value:" "}," ",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1)])],44,NH),[[_t,_.value.type]])]),d("div",DH,[F[47]||(F[47]=d("label",null,"Subtype",-1)),_.value.type===" "?Ie((ee(),te("select",{key:0,"onUpdate:modelValue":F[8]||(F[8]=O=>_.value.subtype=O),disabled:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},[...F[46]||(F[46]=[d("option",{value:""},"Select subtype...",-1),d("option",{value:" "}," ",-1),d("option",{value:" "}," ",-1),d("option",{value:" "}," ",-1),d("option",{value:"5G "},"5G ",-1),d("option",{value:"  "},"  ",-1),d("option",{value:""},"",-1)])],12,MH)),[[_t,_.value.subtype]]):Ie((ee(),te("input",{key:1,"onUpdate:modelValue":F[9]||(F[9]=O=>_.value.subtype=O),type:"text",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),placeholder:"Enter subtype..."},null,12,FH)),[[Ge,_.value.subtype]])])]),d("div",LH,[d("div",UH,[F[48]||(F[48]=d("label",null,"Site Location",-1)),Ie(d("input",{"onUpdate:modelValue":F[10]||(F[10]=O=>_.value.siteLocation=O),type:"text",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},null,12,BH),[[Ge,_.value.siteLocation]])]),d("div",VH,[F[50]||(F[50]=d("label",null,"Responsible Employee",-1)),Ie(d("select",{"onUpdate:modelValue":F[11]||(F[11]=O=>_.value.ResponsibleEmp=O),disabled:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},[F[49]||(F[49]=d("option",{value:""},"Select employee...",-1)),(ee(!0),te(wt,null,rn(b.value,O=>(ee(),te("option",{key:O.NumID,value:O.FirstName},Y(O.FirstName)+" "+Y(O.LastName),9,$H))),128))],12,HH),[[_t,_.value.ResponsibleEmp]])])]),d("div",KH,[d("div",jH,[F[51]||(F[51]=d("label",null,"Start Date",-1)),Ie(d("input",{"onUpdate:modelValue":F[12]||(F[12]=O=>_.value.StartDate=O),type:"date",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},null,12,WH),[[Ge,_.value.StartDate]])]),d("div",GH,[F[52]||(F[52]=d("label",null,"End Date",-1)),Ie(d("input",{"onUpdate:modelValue":F[13]||(F[13]=O=>_.value.EndDate=O),type:"date",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},null,12,qH),[[Ge,_.value.EndDate]])])]),d("div",zH,[d("div",YH,[F[54]||(F[54]=d("label",null,"Status",-1)),Ie(d("select",{"onUpdate:modelValue":F[14]||(F[14]=O=>_.value.Status=O),disabled:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},[...F[53]||(F[53]=[d("option",{value:""},"",-1),d("option",{value:" "}," ",-1),d("option",{value:"  "},"  ",-1),d("option",{value:"   "},"   ",-1),d("option",{value:" "}," ",-1),d("option",{value:""},"",-1)])],12,QH),[[_t,_.value.Status]])]),d("div",XH,[F[55]||(F[55]=d("label",null,"Reference ID",-1)),Ie(d("input",{"onUpdate:modelValue":F[15]||(F[15]=O=>_.value.referenceIdfromCustomer=O),type:"text",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},null,12,JH),[[Ge,_.value.referenceIdfromCustomer]])])]),d("div",ZH,[F[56]||(F[56]=d("label",null,"Detail",-1)),Ie(d("textarea",{"onUpdate:modelValue":F[16]||(F[16]=O=>_.value.Detail=O),rows:"3",style:Nt([{width:"100%",padding:"8px",border:"1px solid #ddd","border-radius":"4px"},u.value?"":"background-color: #f9fafb;"]),readonly:!u.value},null,12,e9),[[Ge,_.value.Detail]])]),d("div",t9,[F[57]||(F[57]=d("label",null,"Comment",-1)),Ie(d("textarea",{"onUpdate:modelValue":F[17]||(F[17]=O=>_.value.Comment=O),rows:"2",style:Nt([{width:"100%",padding:"8px",border:"1px solid #ddd","border-radius":"4px"},u.value?"":"background-color: #f9fafb;"]),readonly:!u.value},null,12,n9),[[Ge,_.value.Comment]])]),F[99]||(F[99]=d("h5",{style:{"grid-column":"1 / -1","margin-top":"20px",color:"#f59e0b","border-bottom":"2px solid #f59e0b","padding-bottom":"5px"}},"Financial Information",-1)),F[100]||(F[100]=d("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#3b82f6","font-weight":"600","border-bottom":"1px solid #3b82f6","padding-bottom":"3px"}},"HR Information",-1)),d("div",r9,[d("div",i9,[F[58]||(F[58]=d("label",null,"WosHour",-1)),Ie(d("input",{"onUpdate:modelValue":F[18]||(F[18]=O=>_.value.WosHour=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:I},null,44,s9),[[Ge,_.value.WosHour,void 0,{number:!0}]]),F[59]||(F[59]=d("small",{style:{color:"#6b7280"}},"Will calculate Income HR",-1))]),d("div",o9,[F[60]||(F[60]=d("label",null,"OR Income HR (manual)",-1)),Ie(d("input",{"onUpdate:modelValue":F[19]||(F[19]=O=>_.value.IncomeHR=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:x},null,44,a9),[[Ge,_.value.IncomeHR,void 0,{number:!0}]]),F[61]||(F[61]=d("small",{style:{color:"#6b7280"}},"Will calculate WosHour",-1))])]),d("div",l9,[d("div",c9,[F[62]||(F[62]=d("label",null,"  ( )",-1)),d("input",{value:B(_.value.EngineerHand||0),type:"text",readonly:"",style:{"background-color":"#d1fae5","font-weight":"600"}},null,8,u9),F[63]||(F[63]=d("small",{style:{color:"#6b7280"}},"Performance-adjusted bounty",-1))]),d("div",h9,[F[64]||(F[64]=d("label",null," ",-1)),d("input",{value:B(_.value.TeamBounty||0),type:"text",readonly:"",style:{"background-color":"#e9d5ff"}},null,8,d9),F[65]||(F[65]=d("small",{style:{color:"#6b7280"}},"WosHour  22,500 MNT",-1))])]),d("div",f9,[d("div",p9,[F[66]||(F[66]=d("label",null,"Planned Hour (calculated)",-1)),d("input",{value:B(_.value.PlannedHour||0),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,g9),F[67]||(F[67]=d("small",{style:{color:"#6b7280"}},"WosHour  3",-1))]),d("div",m9,[F[68]||(F[68]=d("label",null,"Real Hour",-1)),d("input",{value:B(_.value.RealHour||0),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,v9),F[69]||(F[69]=d("small",{style:{color:"#6b7280"}},"Sum from TimeAttendance",-1))])]),d("div",_9,[d("div",y9,[F[70]||(F[70]=d("label",null,"Engineer Work Hour",-1)),d("input",{value:B(_.value.EngineerWorkHour||0),type:"text",readonly:"",style:{"background-color":"#dbeafe"}},null,8,E9),F[71]||(F[71]=d("small",{style:{color:"#6b7280"}},"Hours by Engineers",-1))]),d("div",T9,[F[72]||(F[72]=d("label",null,"Non-Engineer Work Hour",-1)),d("input",{value:B(_.value.NonEngineerWorkHour||0),type:"text",readonly:"",style:{"background-color":"#e9d5ff"}},null,8,w9),F[73]||(F[73]=d("small",{style:{color:"#6b7280"}},"Hours by Non-Engineers",-1))])]),d("div",A9,[d("div",C9,[F[74]||(F[74]=d("label",null,"  ",-1)),d("input",{value:B(_.value.NonEngineerBounty||0),type:"text",readonly:"",style:{"background-color":"#fde68a"}},null,8,S9),F[75]||(F[75]=d("small",{style:{color:"#6b7280"}},"NonEngineerWorkHour  5,000 MNT",-1))])]),_.value.PlannedHour>0?(ee(),te("div",I9,[d("div",x9,[F[76]||(F[76]=d("label",null," ",-1)),d("input",{value:B(W(_.value.RealHour,_.value.PlannedHour))+"%",type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,R9),F[77]||(F[77]=d("small",{style:{color:"#6b7280"}},"RealHour / PlannedHour  100",-1))])])):Ke("",!0),F[101]||(F[101]=d("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#10b981","font-weight":"600","border-bottom":"1px solid #10b981","padding-bottom":"3px"}},"Income Information",-1)),d("div",b9,[d("div",k9,[F[78]||(F[78]=d("label",null,"Income HR (calculated)",-1)),d("input",{value:B(_.value.IncomeHR),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,P9),F[79]||(F[79]=d("small",{style:{color:"#6b7280"}},"From WosHour or manual entry",-1))]),d("div",O9,[F[80]||(F[80]=d("label",null,"Income Car",-1)),Ie(d("input",{"onUpdate:modelValue":F[20]||(F[20]=O=>_.value.IncomeCar=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:ie},null,44,N9),[[Ge,_.value.IncomeCar,void 0,{number:!0}]])])]),d("div",D9,[d("div",M9,[F[81]||(F[81]=d("label",null,"Income Material",-1)),Ie(d("input",{"onUpdate:modelValue":F[21]||(F[21]=O=>_.value.IncomeMaterial=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:ie},null,44,F9),[[Ge,_.value.IncomeMaterial,void 0,{number:!0}]])])]),F[102]||(F[102]=d("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#f59e0b","font-weight":"600","border-bottom":"1px solid #f59e0b","padding-bottom":"3px"}},"Additional ()",-1)),d("div",L9,[d("div",U9,[F[82]||(F[82]=d("label",null,"Additional Hour (  )",-1)),Ie(d("input",{"onUpdate:modelValue":F[22]||(F[22]=O=>_.value.additionalHour=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:P},null,44,B9),[[Ge,_.value.additionalHour,void 0,{number:!0}]])]),d("div",V9,[F[83]||(F[83]=d("label",null,"Additional Owner",-1)),Ie(d("input",{"onUpdate:modelValue":F[23]||(F[23]=O=>_.value.AdditionalOwner=O),type:"text",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;")},null,12,H9),[[Ge,_.value.AdditionalOwner]])])]),d("div",$9,[d("div",K9,[F[84]||(F[84]=d("label",null,"Additional Value (calculated)",-1)),d("input",{value:B(_.value.additionalValue),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,j9),F[85]||(F[85]=d("small",{style:{color:"#6b7280"}},"additionalHour  65,000",-1))])]),F[103]||(F[103]=d("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#ef4444","font-weight":"600","border-bottom":"1px solid #ef4444","padding-bottom":"3px"}},"Expense Information",-1)),d("div",W9,[d("div",G9,[F[86]||(F[86]=d("label",null,"Expense HR",-1)),Ie(d("input",{"onUpdate:modelValue":F[24]||(F[24]=O=>_.value.ExpenceHR=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:ie},null,44,q9),[[Ge,_.value.ExpenceHR,void 0,{number:!0}]]),F[87]||(F[87]=d("small",{style:{color:"#6b7280"}},"Includes additionalValue",-1))]),d("div",z9,[F[88]||(F[88]=d("label",null,"Expense Car",-1)),Ie(d("input",{"onUpdate:modelValue":F[25]||(F[25]=O=>_.value.ExpenceCar=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:ie},null,44,Y9),[[Ge,_.value.ExpenceCar,void 0,{number:!0}]])])]),d("div",Q9,[d("div",X9,[F[89]||(F[89]=d("label",null,"Expense Material",-1)),Ie(d("input",{"onUpdate:modelValue":F[26]||(F[26]=O=>_.value.ExpenceMaterial=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:ie},null,44,J9),[[Ge,_.value.ExpenceMaterial,void 0,{number:!0}]])]),d("div",Z9,[F[90]||(F[90]=d("label",null,"Expense HSE",-1)),Ie(d("input",{"onUpdate:modelValue":F[27]||(F[27]=O=>_.value.ExpenceHSE=O),type:"number",step:"0.01",readonly:!u.value,style:Nt(u.value?"":"background-color: #f9fafb;"),onInput:ie},null,44,e$),[[Ge,_.value.ExpenceHSE,void 0,{number:!0}]])])]),F[104]||(F[104]=d("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#8b5cf6","font-weight":"600","border-bottom":"1px solid #8b5cf6","padding-bottom":"3px"}},"Profit Summary",-1)),d("div",t$,[d("div",n$,[F[91]||(F[91]=d("label",null,"Profit HR (calculated)",-1)),d("input",{value:B(_.value.ProfitHR),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,r$),F[92]||(F[92]=d("small",{style:{color:"#6b7280"}},"IncomeHR - ExpenseHR",-1))]),d("div",i$,[F[93]||(F[93]=d("label",null,"Profit Car (calculated)",-1)),d("input",{value:B(_.value.ProfitCar),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,s$),F[94]||(F[94]=d("small",{style:{color:"#6b7280"}},"IncomeCar - ExpenseCar",-1))])]),d("div",o$,[d("div",a$,[F[95]||(F[95]=d("label",null,"Profit Material (calculated)",-1)),d("input",{value:B(_.value.ProfitMaterial),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,l$),F[96]||(F[96]=d("small",{style:{color:"#6b7280"}},"IncomeMaterial - ExpenseMaterial",-1))]),d("div",c$,[F[97]||(F[97]=d("label",null,"Total Profit (calculated)",-1)),d("input",{value:B(_.value.TotalProfit),type:"text",readonly:"",style:{"background-color":"#f5f5f5","font-weight":"bold","font-size":"16px",color:"#8b5cf6"}},null,8,u$),F[98]||(F[98]=d("small",{style:{color:"#6b7280"}},"ProfitHR + ProfitCar + ProfitMaterial - ExpenseHSE",-1))])]),d("div",h$,[l.value&&!u.value?(ee(),te("button",{key:0,type:"button",onClick:F[28]||(F[28]=O=>u.value=!0),class:"edit-btn"}," Edit ")):Ke("",!0),u.value?(ee(),te("button",{key:1,type:"submit",class:"save-btn",disabled:m.value},Y(m.value?"Saving...":"Save"),9,d$)):Ke("",!0),d("button",{type:"button",onClick:Ae,class:"cancel-btn"},Y(u.value?"Cancel":"Close"),1)])],32)])])):Ke("",!0)]))]))}},gx=Cr(f$,[["__scopeId","data-v-d8824a09"]]),mx=la("timeAttendanceRequests",{state:()=>({requests:[],loading:!1,error:null}),actions:{async fetchRequests(n=null){this.loading=!0,this.error=null;try{let e=Pn(Xt,"timeAttendanceRequests");n&&(e=ei(e,Vr("status","==",n)));const t=await Wn(e);this.requests=t.docs.map(r=>({docId:r.id,...r.data()}))}catch(e){console.error("Error fetching time attendance requests:",e),this.error=e.message}finally{this.loading=!1}}}}),vx=la("timeAttendance",{state:()=>({records:[],allRecords:[],loading:!1,error:null}),actions:{async fetchRecords(n=!1){this.loading=!0,this.error=null;try{const t=(await Wn(Pn(Xt,"timeAttendance"))).docs.map(r=>({docId:r.id,...r.data()}));this.allRecords=t,n?this.records=t:this.records=t.filter(r=>!r.dataStatus||r.dataStatus==="valid")}catch(e){console.error("Error fetching time attendance records:",e),this.error=e.message}finally{this.loading=!1}}}}),p$={class:"attendance-approval"},g$={class:"approval-header"},m$=["disabled"],v$={class:"tabs"},_$={key:1,class:"edit-mode-section"},y$={key:0,class:"edit-warning"},E$={key:2,class:"filters-section"},T$={class:"filter-group"},w$={class:"filter-group"},A$=["value"],C$={class:"filter-group"},S$=["value"],I$={class:"filter-group"},x$={class:"filter-group"},R$={key:3,class:"total-hours-label"},b$={key:4,class:"loading"},k$={key:5,class:"empty-state"},P$={key:6,class:"empty-state"},O$={key:7,class:"empty-state"},N$={key:8,class:"empty-state"},D$={key:9,class:"requests-table-wrapper"},M$={key:0,class:"bulk-actions"},F$=["disabled"],L$=["disabled"],U$={key:1,class:"info-message"},B$={class:"requests-table"},V$={key:0,class:"checkbox-col"},H$={key:1},$$={key:2},K$={key:0,class:"checkbox-col"},j$=["value"],W$=["onUpdate:modelValue"],G$={key:1},q$=["onUpdate:modelValue"],z$={key:1},Y$=["onUpdate:modelValue"],Q$=["value"],X$={key:1},J$=["onUpdate:modelValue"],Z$={key:1},e7=["onUpdate:modelValue","onChange"],t7={key:1},n7=["onUpdate:modelValue","onChange"],r7={key:1},i7=["onUpdate:modelValue","onChange"],s7=["onUpdate:modelValue"],o7={key:1},a7={key:0,class:"validation-issues"},l7=["onUpdate:modelValue"],c7={key:1},u7={key:2,class:"action-buttons"},h7=["onClick","disabled"],d7=["onClick","disabled"],f7={key:3,class:"action-buttons"},p7=["onClick","disabled"],g7={key:10,class:"sync-section"},m7=["disabled"],v7={key:11,class:"sync-section"},_7=["disabled"],y7=["disabled"],E7={__name:"TimeAttendanceApproval",setup(n){const e=mx(),t=vx(),r=Ms(),i=Nl(),s=Se("pending"),o=Se(!1),a=Se(!1),l=Se(!1),c=Se(""),u=Se(""),f=Se([]),p=Se(!1),g=Se(!1),m=Se({date:"",employee:"",project:"",status:""}),v=Se("date-asc"),_=it(()=>e.requests.filter(H=>H.status==="pending"));it(()=>e.requests.filter(H=>H.status==="approved"));const D=it(()=>e.requests.filter(H=>H.status==="rejected")),b=it(()=>t.records.filter(H=>!H.dataStatus||H.dataStatus==="valid").length),T=it(()=>t.allRecords.filter(H=>(!H.dataStatus||H.dataStatus==="valid")&&H.syncedToExcel===!1)),R=it(()=>T.value.length),B=it(()=>t.allRecords.filter(H=>H.dataStatus==="invalid"||H.dataStatus==="retired")),W=it(()=>B.value.length),A=it(()=>{let H=[];s.value==="pending"?H=_.value:s.value==="approved"?H=t.records:s.value==="notSynced"&&(H=T.value);const J=H.map(k=>k.EmployeeFirstName||k.EmployeeLastName||k.FirstName||k.LastName).filter(Boolean);return[...new Set(J)].sort()}),w=it(()=>{let H=[];s.value==="pending"?H=_.value:s.value==="approved"?H=t.records:s.value==="notSynced"&&(H=T.value);const J=new Set;H.forEach(L=>{L.ProjectID&&J.add(L.ProjectID)});const k=[];return J.forEach(L=>{const z=i.projects.find(ge=>ge.id===L);z?k.push({id:L,name:`${L} - ${z.siteLocation||""}`}):k.push({id:L,name:L})}),k.sort((L,z)=>L.name.localeCompare(z.name))}),E=it(()=>{let H=[];if(s.value==="pending")H=[..._.value];else if(s.value==="approved")H=[...t.records];else if(s.value==="notSynced")H=[...T.value];else return[];return m.value.date&&(H=H.filter(J=>(J.Day||J.Date)===m.value.date)),m.value.employee&&(H=H.filter(J=>(J.EmployeeFirstName||J.EmployeeLastName||J.FirstName||J.LastName)===m.value.employee)),m.value.project&&(H=H.filter(J=>J.ProjectID===m.value.project)),m.value.status&&(H=H.filter(J=>J.Status===m.value.status)),H.sort((J,k)=>{switch(v.value){case"date-asc":return new Date(J.Day||J.Date)-new Date(k.Day||k.Date);case"date-desc":return new Date(k.Day||k.Date)-new Date(J.Day||J.Date);case"employee":return(J.EmployeeFirstName||J.EmployeeLastName||J.FirstName||J.LastName||"").localeCompare(k.EmployeeFirstName||k.EmployeeLastName||k.FirstName||k.LastName||"");case"project":return(J.ProjectID||"").localeCompare(k.ProjectID||"");default:return 0}}),H}),C=it(()=>s.value!=="approved"?0:I.value.reduce((H,J)=>H+(parseFloat(J.WorkingHour)||0),0)),I=it(()=>s.value==="pending"||s.value==="approved"||s.value==="notSynced"?E.value:s.value==="invalid"?B.value:s.value==="rejected"?D.value:[]);Dr(async()=>{await x()}),Ho(s,H=>{H==="approved"?m.value.status="":m.value.status=""});async function x(){o.value=!0;try{await e.fetchRequests(),await t.fetchRecords(!0),await i.fetchProjects(),f.value=[],p.value=!1}catch(H){console.error("Error fetching requests:",H)}finally{o.value=!1}}function P(){p.value?f.value=E.value.map(H=>H.docId):f.value=[]}function ie(){m.value.date="",m.value.employee="",m.value.project="",v.value="date-asc"}function Q(H){if(!H.startTime||!H.endTime)return;const J=ae(H.startTime);let L=ae(H.endTime)-J;L<0&&(L+=24);const z=Math.max(0,Math.round((L-1)*10)/10);H.isOvertimeRequest?(H.WorkingHour=0,H.overtimeHour=z):(H.WorkingHour=Math.min(z,8),H.overtimeHour=0)}function ae(H){const[J,k]=H.split(":").map(Number);return J+k/60}async function Ae(){if(f.value.length!==0&&confirm(`${f.value.length}   ?`)){a.value=!0;try{let H=0;for(const J of f.value){const k=I.value.find(L=>L.docId===J);k&&await xc("update",k,J),await vh(J,"approve"),H++}se(`${H}   `,"success"),await x()}catch(H){se(" : "+H.message,"error")}finally{a.value=!1}}}async function Oe(){if(f.value.length!==0&&confirm(`${f.value.length}   ?`)){a.value=!0;try{let H=0;for(const J of f.value)await vh(J,"reject"),H++;se(`${H}   `,"success"),f.value=[],await x()}catch(H){se(" : "+H.message,"error")}finally{a.value=!1}}}async function Ce(H){if(confirm("   ?")){a.value=!0;try{const J=I.value.find(k=>k.docId===H);J&&await xc("update",J,H),await vh(H,"approve"),se("  ","success"),await x()}catch(J){se(" : "+J.message,"error")}finally{a.value=!1}}}async function fe(H){if(confirm("   ?")){a.value=!0;try{await vh(H,"reject"),se(" ","success"),await x()}catch(J){se(" : "+J.message,"error")}finally{a.value=!1}}}async function F(H){if(confirm("   ?")){a.value=!0;try{if(H.startTime&&H.endTime&&H.Day&&H.Email){const L=t.allRecords.filter(z=>z.docId!==H.docId&&z.Email===H.Email&&z.Day===H.Day&&z.startTime&&z.endTime&&(z.startTime<=H.startTime&&H.startTime<z.endTime||z.startTime<H.endTime&&H.endTime<=z.endTime||H.startTime<=z.startTime&&z.endTime<=H.endTime));if(L.length>0){se("   !       "+L[0].startTime+" - "+L[0].endTime+"  .","error"),a.value=!1;return}}const{docId:J,...k}=H;if(!J){se(": Document ID ","error"),a.value=!1;return}k.syncedToExcel=!1,k.lastEditedAt=new Date().toISOString();try{let L=J;const z=co(Xt,"timeAttendance",J);if(!(await Am(z)).exists())if(console.log("Document not found with docId:",J),console.log("Trying to find by ID field:",H.ID),H.ID){const re=ei(Pn(Xt,"timeAttendance"),Vr("ID","==",H.ID)),Me=await Wn(re);if(!Me.empty)L=Me.docs[0].id,console.log("Found document with different docId:",L);else{se(":   Firestore- .   .","error"),a.value=!1;return}}else{se(":   Firestore-  (ID: "+J+")","error"),a.value=!1;return}const ye=co(Xt,"timeAttendance",L);await xf(ye,k);try{await I8(),await i.fetchProjects(),se("  .   .","success")}catch(re){console.error("Project calculation error:",re),se("     .   .","warning")}await x()}catch(L){console.error("Document update error:",L),console.log("Trying to update docId:",J),console.log("Update data:",k),se(": "+L.message+" (docId: "+J+")","error")}}catch(J){se(" : "+J.message,"error")}finally{a.value=!1}}}async function O(){l.value=!0,c.value="";try{const H=await r.getMicrosoftToken();if(!H)throw new Error("Please login with Microsoft account");await S8(H),se(" Excel-   ","success"),await new Promise(J=>setTimeout(J,1e3)),await x()}catch(H){console.error("Sync error:",H),se("  : "+H.message,"error")}finally{l.value=!1}}async function Z(){l.value=!0,c.value="";try{const H=await r.getMicrosoftToken();if(!H)throw new Error("Please login with Microsoft account");const J=await fetch("https://asia-east2-munkh-zaisan.cloudfunctions.net/fullSyncExcelToFirestore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:H,dryRun:!0})});if(!J.ok){const z=await J.json();throw new Error(z.message||"Sync failed")}const k=await J.json(),L=`
 Dry Run  :
 Excel  (): ${k.firestoreRecordsBefore}
 Excel  (): ${k.excelRecords}
 : ${k.deleted}
  : ${k.created}
${k.errors>0?" : "+k.errors:""}

${k.message}
    `.trim();se(L,"success"),console.log("Full sync dry run results:",k)}catch(H){console.error("Full sync error:",H),se("  : "+H.message,"error")}finally{l.value=!1}}async function q(){if(confirm(" Excel-   Firestore-    ?     Excel-  .")){l.value=!0,c.value="";try{const H=await r.getMicrosoftToken();if(!H)throw new Error("Please login with Microsoft account");const J=await fetch("https://asia-east2-munkh-zaisan.cloudfunctions.net/fullSyncExcelToFirestore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:H,dryRun:!1})});if(!J.ok){const z=await J.json();throw new Error(z.message||"Sync failed")}const k=await J.json(),L=`
   !
 : ${k.deleted}
  : ${k.created}
${k.errors>0?" : "+k.errors:""}
    `.trim();se(L,"success"),console.log("Full sync results:",k),await x()}catch(H){console.error("Full sync error:",H),se("  : "+H.message,"error")}finally{l.value=!1}}}function X(H){return H?new Date(H).toLocaleDateString("mn-MN",{year:"numeric",month:"2-digit",day:"2-digit"}):""}function ce(H){return H===""?"status-attended":H===""?"status-business-trip":H==="/"?"status-off":H===""?"status-missed":H!=null&&H.includes("")?"status-overtime":H!=null&&H.includes("")?"status-off":"status-attended"}function ne(H){return H==="invalid"?"status-invalid":H==="retired"?"status-retired":"status-valid"}function ve(H){return H==="invalid"?" ":H==="retired"?" ":" "}function se(H,J){c.value=H,u.value=J,setTimeout(()=>{c.value=""},5e3)}return(H,J)=>(ee(),te("div",p$,[d("div",g$,[J[13]||(J[13]=d("h3",null,"  ",-1)),d("button",{onClick:x,class:"btn-refresh",disabled:o.value},"   ",8,m$)]),c.value?(ee(),te("div",{key:0,class:Tt(["sync-message",u.value])},Y(c.value),3)):Ke("",!0),d("div",v$,[d("button",{class:Tt(["tab",{active:s.value==="pending"}]),onClick:J[0]||(J[0]=k=>s.value="pending")},"   ("+Y(_.value.length)+") ",3),d("button",{class:Tt(["tab",{active:s.value==="approved"}]),onClick:J[1]||(J[1]=k=>s.value="approved")},"  ("+Y(b.value)+") ",3),d("button",{class:Tt(["tab",{active:s.value==="notSynced"}]),onClick:J[2]||(J[2]=k=>s.value="notSynced")}," Excel -  ("+Y(R.value)+") ",3),d("button",{class:Tt(["tab",{active:s.value==="invalid"}]),onClick:J[3]||(J[3]=k=>s.value="invalid")},"   ("+Y(W.value)+") ",3),d("button",{class:Tt(["tab",{active:s.value==="rejected"}]),onClick:J[4]||(J[4]=k=>s.value="rejected")},"  ("+Y(D.value.length)+") ",3)]),s.value==="approved"?(ee(),te("div",_$,[d("button",{onClick:J[5]||(J[5]=k=>g.value=!g.value),class:Tt(["btn-toggle-edit",{active:g.value}])},Y(g.value?"  ":"  "),3),g.value?(ee(),te("span",y$,"   ")):Ke("",!0)])):Ke("",!0),s.value==="pending"||s.value==="approved"||s.value==="notSynced"?(ee(),te("div",E$,[d("div",T$,[J[14]||(J[14]=d("label",null,":",-1)),Ie(d("input",{type:"date","onUpdate:modelValue":J[6]||(J[6]=k=>m.value.date=k),class:"filter-input"},null,512),[[Ge,m.value.date]])]),d("div",w$,[J[16]||(J[16]=d("label",null,":",-1)),Ie(d("select",{"onUpdate:modelValue":J[7]||(J[7]=k=>m.value.employee=k),class:"filter-input"},[J[15]||(J[15]=d("option",{value:""},"",-1)),(ee(!0),te(wt,null,rn(A.value,k=>(ee(),te("option",{key:k,value:k},Y(k),9,A$))),128))],512),[[_t,m.value.employee]])]),d("div",C$,[J[18]||(J[18]=d("label",null,":",-1)),Ie(d("select",{"onUpdate:modelValue":J[8]||(J[8]=k=>m.value.project=k),class:"filter-input"},[J[17]||(J[17]=d("option",{value:""},"",-1)),(ee(!0),te(wt,null,rn(w.value,k=>(ee(),te("option",{key:k.id,value:k.id},Y(k.name),9,S$))),128))],512),[[_t,m.value.project]])]),d("div",I$,[J[20]||(J[20]=d("label",null,":",-1)),Ie(d("select",{"onUpdate:modelValue":J[9]||(J[9]=k=>m.value.status=k),class:"filter-input"},[...J[19]||(J[19]=[Cs('<option value="" data-v-d6ddc94a></option><option value="" data-v-d6ddc94a></option><option value="" data-v-d6ddc94a></option><option value="/" data-v-d6ddc94a>/</option><option value="" data-v-d6ddc94a></option>',5)])],512),[[_t,m.value.status]])]),d("div",x$,[J[22]||(J[22]=d("label",null,":",-1)),Ie(d("select",{"onUpdate:modelValue":J[10]||(J[10]=k=>v.value=k),class:"filter-input"},[...J[21]||(J[21]=[d("option",{value:"date-asc"}," ()",-1),d("option",{value:"date-desc"}," ()",-1),d("option",{value:"employee"},"",-1),d("option",{value:"project"},"",-1)])],512),[[_t,v.value]])]),d("button",{onClick:ie,class:"btn-clear-filters"},"")])):Ke("",!0),s.value==="approved"&&I.value.length>0?(ee(),te("div",R$,[J[23]||(J[23]=d("strong",null,"  :",-1)),wr(" "+Y(C.value.toFixed(1))+" ",1)])):Ke("",!0),o.value?(ee(),te("div",b$," ...")):I.value.length===0&&s.value==="pending"?(ee(),te("div",k$,"      ")):I.value.length===0&&s.value==="notSynced"?(ee(),te("div",P$,"      ")):I.value.length===0&&s.value==="invalid"?(ee(),te("div",O$,"     ")):I.value.length===0&&s.value==="rejected"?(ee(),te("div",N$,"     ")):(ee(),te("div",D$,[s.value==="pending"?(ee(),te("div",M$,[d("button",{onClick:P,class:"btn-select-all"},Y(p.value?" ":" "),1),d("button",{onClick:Ae,class:"btn-bulk-approve",disabled:f.value.length===0||a.value},"    ("+Y(f.value.length)+") ",9,F$),d("button",{onClick:Oe,class:"btn-bulk-reject",disabled:f.value.length===0||a.value},"    ("+Y(f.value.length)+") ",9,L$)])):Ke("",!0),s.value==="approved"&&g.value?(ee(),te("div",U$,'     .   ""  . ')):Ke("",!0),d("table",B$,[d("thead",null,[d("tr",null,[s.value==="pending"?(ee(),te("th",V$,[Ie(d("input",{type:"checkbox","onUpdate:modelValue":J[11]||(J[11]=k=>p.value=k),onChange:P},null,544),[[Oh,p.value]])])):Ke("",!0),J[24]||(J[24]=d("th",null,"",-1)),J[25]||(J[25]=d("th",null,"",-1)),J[26]||(J[26]=d("th",null,"",-1)),J[27]||(J[27]=d("th",null,"",-1)),J[28]||(J[28]=d("th",null," ID",-1)),J[29]||(J[29]=d("th",null," ",-1)),J[30]||(J[30]=d("th",null,"",-1)),J[31]||(J[31]=d("th",null,"",-1)),J[32]||(J[32]=d("th",null,"",-1)),J[33]||(J[33]=d("th",null,"",-1)),J[34]||(J[34]=d("th",null,"",-1)),s.value==="invalid"||s.value==="notSynced"?(ee(),te("th",H$,"")):Ke("",!0),J[35]||(J[35]=d("th",null,"",-1)),s.value==="pending"?(ee(),te("th",$$,"")):Ke("",!0)])]),d("tbody",null,[(ee(!0),te(wt,null,rn(I.value,k=>(ee(),te("tr",{key:k.docId},[s.value==="pending"?(ee(),te("td",K$,[Ie(d("input",{type:"checkbox",value:k.docId,"onUpdate:modelValue":J[12]||(J[12]=L=>f.value=L)},null,8,j$),[[Oh,f.value]])])):Ke("",!0),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("input",{key:0,type:"date","onUpdate:modelValue":L=>k.Day=L,class:"edit-input"},null,8,W$)),[[Ge,k.Day]]):(ee(),te("span",G$,Y(X(k.Day)),1))]),d("td",null,Y(k.WeekDay),1),d("td",null,Y(k.EmployeeFirstName||k.EmployeeLastName||k.FirstName||k.LastName),1),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("select",{key:0,"onUpdate:modelValue":L=>k.Role=L,class:"edit-input"},[...J[36]||(J[36]=[d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1)])],8,q$)),[[_t,k.Role]]):(ee(),te("span",z$,Y(k.Role),1))]),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("select",{key:0,"onUpdate:modelValue":L=>k.ProjectID=L,class:"edit-input"},[J[37]||(J[37]=d("option",{value:""},"Select project...",-1)),(ee(!0),te(wt,null,rn(jt(i).projects,L=>(ee(),te("option",{key:L.id,value:L.id},Y(L.id)+" - "+Y(L.siteLocation),9,Q$))),128))],8,Y$)),[[_t,k.ProjectID]]):(ee(),te("span",X$,Y(k.ProjectID),1))]),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("input",{key:0,type:"text","onUpdate:modelValue":L=>k.ProjectName=L,class:"edit-input"},null,8,J$)),[[Ge,k.ProjectName]]):(ee(),te("span",Z$,Y(k.ProjectName),1))]),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("input",{key:0,type:"time","onUpdate:modelValue":L=>k.startTime=L,onChange:L=>Q(k),class:"edit-input",step:"60"},null,40,e7)),[[Ge,k.startTime]]):(ee(),te("span",t7,Y(k.startTime),1))]),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("input",{key:0,type:"time","onUpdate:modelValue":L=>k.endTime=L,onChange:L=>Q(k),class:"edit-input",step:"60"},null,40,n7)),[[Ge,k.endTime]]):(ee(),te("span",r7,Y(k.endTime),1))]),d("td",null,Y(k.WorkingHour)+"",1),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("input",{key:0,type:"checkbox","onUpdate:modelValue":L=>k.isOvertimeRequest=L,onChange:L=>Q(k)},null,40,i7)),[[Oh,k.isOvertimeRequest]]):Ke("",!0),wr(" "+Y(k.overtimeHour)+" ",1)]),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("select",{key:0,"onUpdate:modelValue":L=>k.Status=L,class:"edit-input"},[...J[38]||(J[38]=[d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:"/"},"/",-1),d("option",{value:""},"",-1)])],8,s7)),[[_t,k.Status]]):(ee(),te("span",{key:1,class:Tt(["status-badge",ce(k.Status)])},Y(k.Status),3))]),s.value==="invalid"||s.value==="notSynced"?(ee(),te("td",o7,[d("span",{class:Tt(["data-status-badge",ne(k.dataStatus)])},Y(ve(k.dataStatus)),3),k.validationIssues?(ee(),te("small",a7,Y(k.validationIssues),1)):Ke("",!0)])):Ke("",!0),d("td",null,[s.value==="pending"||s.value==="approved"&&g.value?Ie((ee(),te("textarea",{key:0,"onUpdate:modelValue":L=>k.comment=L,class:"edit-textarea",rows:"2"},null,8,l7)),[[Ge,k.comment]]):(ee(),te("span",c7,Y(k.comment),1))]),s.value==="pending"?(ee(),te("td",u7,[d("button",{onClick:L=>Ce(k.docId),class:"btn-approve",disabled:a.value},"  ",8,h7),d("button",{onClick:L=>fe(k.docId),class:"btn-reject",disabled:a.value},"  ",8,d7)])):Ke("",!0),s.value==="approved"&&g.value?(ee(),te("td",f7,[d("button",{onClick:L=>F(k),class:"btn-save",disabled:a.value},"   ",8,p7)])):Ke("",!0)]))),128))])])])),s.value==="notSynced"&&R.value>0?(ee(),te("div",g7,[d("button",{onClick:O,class:"btn-sync",disabled:l.value},Y(l.value?"  ...":" Excel-  "),9,m7)])):Ke("",!0),s.value==="notSynced"?(ee(),te("div",v7,[d("button",{onClick:Z,class:"btn-sync",disabled:l.value,style:{background:"#ff9800"}},Y(l.value?" ...":" Excel-   (Dry Run)"),9,_7),d("button",{onClick:q,class:"btn-sync",disabled:l.value,style:{"margin-left":"10px",background:"#4caf50"}},Y(l.value?"  ...":"   (Step 2)"),9,y7)])):Ke("",!0)]))}},T7=Cr(E7,[["__scopeId","data-v-d6ddc94a"]]),w7={class:"ta-history-container"},A7={class:"projects-summary-section"},C7={class:"project-controls"},S7=["disabled"],I7={key:0,class:"loading"},x7={key:1,class:"projects-grid"},R7=["onClick"],b7={class:"project-header"},k7={class:"project-details"},P7={class:"detail-row"},O7={class:"detail-value"},N7={key:0,class:"detail-row"},D7={class:"detail-value"},M7={key:1,class:"detail-row"},F7={class:"detail-value"},L7={class:"project-stats"},U7={class:"stat-row"},B7={class:"stat-value planned"},V7={class:"stat-row"},H7={class:"stat-value real"},$7={class:"stat-row"},K7={class:"stat-value status"},j7={key:0,class:"stat-row"},W7={class:"stat-value bounty-adjusted"},G7={class:"stat-row"},q7={class:"progress-bar"},z7={class:"progress-text"},Y7={key:1,class:"stat-row"},Q7={class:"progress-bar"},X7={key:2,class:"no-records"},J7={class:"modal-content project-details-modal"},Z7={class:"modal-header"},eK={class:"modal-body"},tK={key:0,class:"loading"},nK={key:1},rK={class:"ta-table"},iK={class:"ta-summary"},sK={key:2,class:"no-records"},oK={class:"month-picker-section"},aK={class:"month-input-group"},lK={key:0,class:"month-stats"},cK={class:"stat-card"},uK={class:"stat-value"},hK={class:"stat-card"},dK={class:"stat-value"},fK={class:"stat-card"},pK={class:"stat-value",style:{"font-weight":"bold",color:"#f59e0b"}},gK={class:"stat-card warning"},mK={class:"stat-value"},vK={class:"tabs-and-filters"},_K={class:"tabs"},yK={class:"record-filters"},EK={key:1,class:"loading"},TK={key:2,class:"table-container"},wK={class:"records-table"},AK={key:3,class:"no-records"},CK={__name:"EmployeeTimeAttendanceHistory",setup(n){const e=Ms(),t=Se(!1),r=Se(v()),i=Se("approved"),s=Se(!1),o=Se(""),a=Se(null),l=Se(!1),c=Se([]),u=Se([]),f=Se([]),p=Se(null),g=Se([]),m=Se("");function v(){const ie=new Date;return`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}`}const _=it(()=>i.value==="approved"?u.value:f.value),D=it(()=>{let ie=_.value;return m.value&&(ie=ie.filter(Q=>Q.Status===m.value)),ie.slice().sort((Q,ae)=>{const Ae=new Date(Q.Day||Q.Date||0);return new Date(ae.Day||ae.Date||0)-Ae})}),b=it(()=>o.value?g.value.filter(ie=>ie.status===o.value):g.value),T=it(()=>c.value.reduce((ie,Q)=>ie+(parseFloat(Q.WorkingHour)||0),0));function R(ie){if(!ie)return"";const Q=new Date(ie);return`${Q.getMonth()+1}/${Q.getDate()}`}function B(ie){switch(ie){case"":return"status-present";case"":return"status-assignment";case"/":return"status-leave";case"":return"status-missed";default:return""}}async function W(){var ie,Q,ae,Ae;t.value=!0;try{const Oe=((ie=e.userData)==null?void 0:ie.LastName)||((Q=e.userData)==null?void 0:Q.employeeLastName),Ce=((ae=e.userData)==null?void 0:ae.FirstName)||((Ae=e.userData)==null?void 0:Ae.employeeFirstName);if(!Oe){console.error("Employee LastName not found");return}if(Ce){const z=ei(Pn(Xt,"employees"),Vr("FirstName","==",Ce)),ge=await Wn(z);if(!ge.empty){const re=ge.docs[0].data().State;if(re!==" "){console.log(`Employee state is "${re}" - access restricted to current employees only`),u.value=[],f.value=[],p.value={approvedDays:0,totalHours:0,notRequestedDays:0},t.value=!1;return}}}const[fe,F]=r.value.split("-"),O=`${fe}-${F}-01`,Z=new Date(parseInt(fe),parseInt(F),0).getDate(),q=`${fe}-${F}-${String(Z).padStart(2,"0")}`,X=ei(Pn(Xt,"timeAttendance"),Vr("EmployeeLastName","==",Oe)),ce=await Wn(X);u.value=ce.docs.map(z=>({docId:z.id,...z.data()})).filter(z=>{const ge=z.Day||z.Date;return ge>=O&&ge<=q});const ne=ei(Pn(Xt,"timeAttendance"),Vr("LastName","==",Oe)),se=(await Wn(ne)).docs.map(z=>({docId:z.id,...z.data()})).filter(z=>{const ge=z.Day||z.Date;return ge>=O&&ge<=q}),H=[...u.value,...se],J=Array.from(new Map(H.map(z=>[z.docId,z])).values());u.value=J;const k=ei(Pn(Xt,"timeAttendanceRequests"),Vr("EmployeeLastName","==",Oe),Vr("status","==","rejected")),L=await Wn(k);f.value=L.docs.map(z=>({docId:z.id,...z.data()})).filter(z=>{const ge=z.Day||z.Date;return ge>=O&&ge<=q}),A(fe,F,Z)}catch(Oe){console.error("Error loading time attendance data:",Oe)}finally{t.value=!1}}function A(ie,Q,ae){const Ae=u.value.length,Oe=u.value.reduce((O,Z)=>O+(Z.WorkingHour||0),0),Ce=u.value.reduce((O,Z)=>{const q=(Z.Status||"").toLowerCase().trim();return q===""||q===""||q===""?O+(Z.WorkingHour||0):O},0);let fe=0;for(let O=1;O<=ae;O++){const q=new Date(parseInt(ie),parseInt(Q)-1,O).getDay();q!==0&&q!==6&&fe++}const F=fe-Ae;p.value={approvedDays:Ae,totalHours:Math.round(Oe*10)/10,workingHours:Math.round(Ce*10)/10,notRequestedDays:Math.max(0,F)}}function w(ie){return{:"#3b82f6"," ":"#f59e0b","  ":"#8b5cf6","   ":"#ec4899"," ":"#10b981",:"#22c55e"}[ie]||"#6b7280"}function E(ie){return ie?ie.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"}function C(ie){return ie<100?"#10b981":ie===100?"#3b82f6":"#ef4444"}async function I(ie){a.value=ie,l.value=!0,c.value=[];try{const Q=ei(Pn(Xt,"timeAttendance"),Vr("ProjectID","==",ie.projectId)),ae=await Wn(Q);c.value=ae.docs.map(Ae=>({docId:Ae.id,...Ae.data()})).sort((Ae,Oe)=>(Oe.Day||"").localeCompare(Ae.Day||""))}catch(Q){console.error("Error loading project TA records:",Q)}finally{l.value=!1}}function x(){a.value=null,c.value=[]}async function P(){var ie,Q;s.value=!0;try{const ae=((ie=e.userData)==null?void 0:ie.FirstName)||((Q=e.userData)==null?void 0:Q.employeeFirstName);if(!ae){console.error("Employee FirstName not found");return}const Ae=ei(Pn(Xt,"employees"),Vr("FirstName","==",ae)),Oe=await Wn(Ae);if(Oe.empty){console.error("Employee not found in employees collection");return}const fe=Oe.docs[0].data().State;if(fe!==" "){console.log(`Employee state is "${fe}" - access restricted to current employees only`),g.value=[];return}const F=await Wn(Pn(Xt,"projects")),O=[],Z={:17," ":33,"  ":50,"   ":67," ":83,:100};F.docs.forEach(X=>{const ce=X.data();if(ce.ResponsibleEmp===ae){const ne=parseFloat(ce["Planned Hour"])||parseFloat(ce.PlannedHour)||0,ve=parseFloat(ce.RealHour)||0,se=parseFloat(ce.WosHour)||0,H=ce.EngineerHand!=null?parseFloat(ce.EngineerHand):se*7500,J=Z[ce.Status]||0;O.push({projectId:ce.id,status:ce.Status||"N/A",siteLocation:ce.siteLocation||ce.SiteLocation||"N/A",referenceId:ce.referenceIdfromCustomer||"",startDate:ce.StartDate||"",plannedHour:Math.round(ne*10)/10,realHour:Math.round(ve*10)/10,engineerHand:ce.EngineerHand||Math.round(H),progress:J,HourPerformance:ce.HourPerformance})}});const q={" ":1,:2,"  ":3,"   ":4," ":5,:6};g.value=O.sort((X,ce)=>{const ne=q[X.status]||999,ve=q[ce.status]||999;return ne!==ve?ne-ve:ce.realHour-X.realHour})}catch(ae){console.error("Error loading project summary:",ae)}finally{s.value=!1}}return Dr(()=>{W(),P()}),(ie,Q)=>(ee(),te("div",w7,[Q[27]||(Q[27]=d("h3",null,"  ",-1)),d("div",A7,[Q[18]||(Q[18]=d("h4",null,"  ",-1)),d("div",C7,[Ie(d("select",{"onUpdate:modelValue":Q[0]||(Q[0]=ae=>o.value=ae),class:"status-filter"},[...Q[5]||(Q[5]=[Cs('<option value="" data-v-dac49874> </option><option value="" data-v-dac49874></option><option value=" " data-v-dac49874> </option><option value="  " data-v-dac49874>  </option><option value="   " data-v-dac49874>   </option><option value=" " data-v-dac49874> </option><option value="" data-v-dac49874></option>',7)])],512),[[_t,o.value]]),d("button",{onClick:P,class:"btn-refresh",disabled:s.value},Y(s.value?" ...":" "),9,S7)]),s.value?(ee(),te("div",I7,"  ...")):b.value.length>0?(ee(),te("div",x7,[(ee(!0),te(wt,null,rn(b.value,ae=>(ee(),te("div",{key:ae.projectId,class:"project-card",onClick:Ae=>I(ae)},[d("div",b7,[d("h5",null,Y(ae.projectId),1),d("span",{class:Tt(["project-status","status-"+ae.status])},Y(ae.status),3)]),d("div",k7,[d("div",P7,[Q[6]||(Q[6]=d("span",{class:"detail-icon"},"",-1)),Q[7]||(Q[7]=d("span",{class:"detail-label"},":",-1)),d("span",O7,Y(ae.siteLocation),1)]),ae.referenceId?(ee(),te("div",N7,[Q[8]||(Q[8]=d("span",{class:"detail-icon"},"",-1)),Q[9]||(Q[9]=d("span",{class:"detail-label"}," :",-1)),d("span",D7,Y(ae.referenceId),1)])):Ke("",!0),ae.startDate?(ee(),te("div",M7,[Q[10]||(Q[10]=d("span",{class:"detail-icon"},"",-1)),Q[11]||(Q[11]=d("span",{class:"detail-label"},":",-1)),d("span",F7,Y(ae.startDate),1)])):Ke("",!0)]),d("div",L7,[d("div",U7,[Q[12]||(Q[12]=d("span",{class:"stat-label"}," :",-1)),d("span",B7,Y(ae.plannedHour)+" /",1)]),d("div",V7,[Q[13]||(Q[13]=d("span",{class:"stat-label"}," :",-1)),d("span",H7,Y(ae.realHour)+" /",1)]),d("div",$7,[Q[14]||(Q[14]=d("span",{class:"stat-label"},":",-1)),d("span",K7,Y(ae.status),1)]),ae.engineerHand>0?(ee(),te("div",j7,[Q[15]||(Q[15]=d("span",{class:"stat-label"}," :",-1)),d("span",W7,Y(E(ae.engineerHand))+" ",1)])):Ke("",!0),d("div",G7,[Q[16]||(Q[16]=d("span",{class:"stat-label"}," :",-1)),d("div",q7,[d("div",{class:"progress-fill",style:Nt({width:ae.progress+"%",backgroundColor:w(ae.status)})},null,4),d("span",z7,Y(ae.progress)+"%",1)])]),ae.HourPerformance!=null?(ee(),te("div",Y7,[Q[17]||(Q[17]=d("span",{class:"stat-label"}," :",-1)),d("div",Q7,[d("div",{class:"progress-fill",style:Nt({width:Math.min(100,ae.HourPerformance)+"%",backgroundColor:C(ae.HourPerformance)})},null,4),d("span",{class:"progress-text",style:Nt({color:C(ae.HourPerformance)})},Y(ae.HourPerformance.toFixed(1))+"%",5)])])):Ke("",!0)])],8,R7))),128))])):(ee(),te("div",X7,"      "))]),a.value?(ee(),te("div",{key:0,class:"modal-overlay",onClick:ni(x,["self"])},[d("div",J7,[d("div",Z7,[d("h3",null,Y(a.value.projectId)+" -   ",1),d("button",{onClick:x,class:"close-btn"},"")]),d("div",eK,[l.value?(ee(),te("div",tK," ...")):c.value.length>0?(ee(),te("div",nK,[d("table",rK,[Q[19]||(Q[19]=d("thead",null,[d("tr",null,[d("th",null,""),d("th",null,""),d("th",null," "),d("th",null,"")])],-1)),d("tbody",null,[(ee(!0),te(wt,null,rn(c.value,ae=>(ee(),te("tr",{key:ae.docId},[d("td",null,Y(ae.Day),1),d("td",null,Y(ae.EmployeeFirstName),1),d("td",null,Y(ae.WorkingHour)+" ",1),d("td",null,Y(ae.comment||"-"),1)]))),128))])]),d("div",iK,[d("strong",null,"  : "+Y(T.value)+" /",1)])])):(ee(),te("div",sK,"       "))])])])):Ke("",!0),d("div",oK,[d("div",aK,[Q[20]||(Q[20]=d("label",null," :",-1)),Ie(d("input",{type:"month","onUpdate:modelValue":Q[1]||(Q[1]=ae=>r.value=ae),onChange:W,class:"month-input"},null,544),[[Ge,r.value]])]),p.value?(ee(),te("div",lK,[d("div",cK,[Q[21]||(Q[21]=d("span",{class:"stat-label"},"  :",-1)),d("span",uK,Y(p.value.approvedDays)+" ",1)]),d("div",hK,[Q[22]||(Q[22]=d("span",{class:"stat-label"},"   :",-1)),d("span",dK,Y(p.value.totalHours)+" ",1)]),d("div",fK,[Q[23]||(Q[23]=d("span",{class:"stat-label"},"/  :",-1)),d("span",pK,Y(p.value.workingHours)+" ",1)]),d("div",gK,[Q[24]||(Q[24]=d("span",{class:"stat-label"}," :",-1)),d("span",mK,Y(p.value.notRequestedDays)+" ",1)])])):Ke("",!0)]),d("div",vK,[d("div",_K,[d("button",{onClick:Q[2]||(Q[2]=ae=>i.value="approved"),class:Tt(["tab-btn",{active:i.value==="approved"}])},"  ("+Y(u.value.length)+") ",3),d("button",{onClick:Q[3]||(Q[3]=ae=>i.value="rejected"),class:Tt(["tab-btn",{active:i.value==="rejected"}])},"  ("+Y(f.value.length)+") ",3)]),d("div",yK,[Ie(d("select",{"onUpdate:modelValue":Q[4]||(Q[4]=ae=>m.value=ae),class:"record-status-filter"},[...Q[25]||(Q[25]=[Cs('<option value="" data-v-dac49874> </option><option value="" data-v-dac49874></option><option value="" data-v-dac49874></option><option value="/" data-v-dac49874>/</option><option value="" data-v-dac49874></option>',5)])],512),[[_t,m.value]])])]),t.value?(ee(),te("div",EK," ...")):D.value.length>0?(ee(),te("div",TK,[d("table",wK,[Q[26]||(Q[26]=d("thead",null,[d("tr",null,[d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null," "),d("th",null," "),d("th",null," "),d("th",null," "),d("th",null,""),d("th",null,"")])],-1)),d("tbody",null,[(ee(!0),te(wt,null,rn(D.value,ae=>(ee(),te("tr",{key:ae.docId},[d("td",null,Y(R(ae.Day)),1),d("td",null,Y(ae.WeekDay),1),d("td",null,[d("span",{class:Tt(["record-status-badge",B(ae.Status)])},Y(ae.Status),3)]),d("td",null,Y(ae.ProjectID),1),d("td",null,Y(ae.ProjectName),1),d("td",null,Y(ae.startTime),1),d("td",null,Y(ae.endTime),1),d("td",null,Y(ae.WorkingHour)+"",1),d("td",null,Y(ae.overtimeHour)+"",1),d("td",null,Y(ae.comment),1),d("td",null,[d("span",{class:Tt(["status-badge",i.value==="approved"?"approved":"rejected"])},Y(i.value==="approved"?"":""),3)])]))),128))])])])):(ee(),te("div",AK,Y(i.value==="approved"?"  ":"  "),1))]))}},SK=Cr(CK,[["__scopeId","data-v-dac49874"]]),IK={class:"dashboard-container"},xK={class:"dashboard-header"},RK={class:"user-info"},bK=["src"],kK={class:"dashboard-content"},PK={class:"welcome-card"},OK={key:0,class:"supervisor-badge"},NK={class:"quick-actions"},DK={key:0},MK={key:1,class:"supervisor-section"},FK={key:0,class:"microsoft-signin"},LK=["disabled"],UK={key:1,class:"sync-section"},BK={class:"microsoft-status"},VK={class:"sync-buttons"},HK=["disabled"],$K=["disabled"],KK=["disabled"],jK={class:"result-icon"},WK={class:"result-message"},GK={key:2,class:"time-attendance-section"},qK={class:"modal-content sync-dialog"},zK={class:"sync-options"},YK=["disabled"],QK=["disabled"],XK={__name:"Dashboard",setup(n){const e=xu(),t=Ms(),r=Ol(),i=pv(),s=Nl(),o=Se(!1),a=Se(null),l=Se(!1),c=Se(!1),u=Se("employee"),f=Se(!1);let p=null;Ho(a,b=>{p&&clearTimeout(p),b&&b.success&&(p=setTimeout(()=>{a.value=null},8e3))}),Dr(async()=>{var T,R,B;const b=localStorage.getItem("msalRedirect");if(b&&(localStorage.removeItem("msalRedirect"),await new Promise(W=>setTimeout(W,500))),(T=t.userData)!=null&&T.isSupervisor&&!t.msalAccount){const W=(R=t.msalInstance)==null?void 0:R.getAllAccounts();W&&W.length>0&&(t.msalAccount=W[0],console.log("Restored Microsoft account on dashboard:",W[0].username),b&&(a.value={success:!0,message:" Microsoft account connected successfully"}))}(B=t.userData)!=null&&B.isSupervisor&&await Promise.all([r.fetchEmployees(),i.fetchCustomers(),s.fetchProjects()])});async function g(){var b;l.value=!0,a.value=null;try{const T=(b=t.msalInstance)==null?void 0:b.getAllAccounts();if(T&&T.length>0){t.msalAccount=T[0],console.log("Restored Microsoft account:",T[0].username),a.value={success:!0,message:" Microsoft account connected"},l.value=!1;return}localStorage.setItem("msalRedirect","true"),await t.signInWithMicrosoft()}catch(T){console.error("Microsoft sign-in error:",T),localStorage.removeItem("msalRedirect"),a.value={success:!1,message:` Failed to sign in: ${T.message}`},l.value=!1}}async function m(){try{await t.signOut(),e.push("/login")}catch(b){console.error("Sign out error:",b)}}function v(b){u.value=b,c.value=!0}async function _(b){var T,R,B,W,A,w;o.value=!0,a.value=null;try{let E;try{E=await t.getMicrosoftToken()}catch{a.value={success:!1,message:" Microsoft authentication expired. Please sign in with Microsoft again."},c.value=!1,o.value=!1;return}let C;if(u.value==="employee")if(b==="toExcel"){C=await m8(E);const I=(C.created||0)+(C.updated||0);a.value={success:!0,message:` Synced ${I} employees to Excel (${C.created||0} created, ${C.updated||0} updated)`}}else{C=await v8(E);const I=(C.created||0)+(C.updated||0);a.value={success:!0,message:` Synced ${I} employees from Excel (${C.created||0} created, ${C.updated||0} updated)`},await r.fetchEmployees()}else if(u.value==="customer")if(b==="toExcel"){C=await y8(E);const I=(C.created||0)+(C.updated||0);a.value={success:!0,message:` Synced ${I} customers to Excel (${C.created||0} created, ${C.updated||0} updated)`}}else{C=await E8(E);const I=(C.created||0)+(C.updated||0);a.value={success:!0,message:` Synced ${I} customers from Excel (${C.created||0} created, ${C.updated||0} updated)`},await i.fetchCustomers()}else if(u.value==="project")if(b==="toExcel"){C=await w8(E);const I=(C.created||0)+(C.updated||0);a.value={success:!0,message:` Synced ${I} projects to Excel (${C.created||0} created, ${C.updated||0} updated)`}}else{C=await A8(E);const I=(C.created||0)+(C.updated||0);a.value={success:!0,message:` Synced ${I} projects from Excel (${C.created||0} created, ${C.updated||0} updated)`},await s.fetchProjects()}c.value=!1}catch(E){console.error("Sync error:",E);let C="Unknown error";E.message==="Network Error"||E.code==="ERR_NETWORK"?C="Network error - Check your internet connection. Firebase functions may be unavailable. Your Microsoft session is still active.":((T=E.response)==null?void 0:T.status)===401||((R=E.response)==null?void 0:R.status)===403?C="Authentication failed - Please sign in with Microsoft again":((B=E.response)==null?void 0:B.status)===404?C="Excel file not found - Check if MainExcel.xlsx exists in OneDrive":((W=E.response)==null?void 0:W.status)===500?C=((A=E.response.data)==null?void 0:A.error)||"Server error - The sync function encountered an error":E.response?C=((w=E.response.data)==null?void 0:w.error)||E.response.statusText||"Server error":E.request?C="No response from server - The sync function may have timed out (>60 seconds)":C=E.message,a.value={success:!1,message:` Sync failed: ${C}`},c.value=!1}finally{o.value=!1}}function D(b){a.value={success:!0,message:` ${b.type.charAt(0).toUpperCase()+b.type.slice(1)} ${b.action==="add"?"added":"updated"} in system. Use Sync to update Excel.`}}return(b,T)=>{var R,B,W,A,w,E,C,I,x,P,ie,Q,ae;return ee(),te("div",IK,[d("header",xK,[T[13]||(T[13]=d("h1",null,"MunkhZaisan Dashboard",-1)),d("div",RK,[(R=jt(t).user)!=null&&R.photoURL?(ee(),te("img",{key:0,src:jt(t).user.photoURL,alt:"Profile"},null,8,bK)):Ke("",!0),d("span",null,Y((B=jt(t).user)==null?void 0:B.displayName),1),d("button",{onClick:m,class:"signout-btn"},"Sign Out")])]),d("main",kK,[d("div",PK,[d("h2",null,"Welcome, "+Y((W=jt(t).userData)==null?void 0:W.employeeFirstName)+"!",1),d("p",null,[T[14]||(T[14]=d("strong",null,"Position:",-1)),wr(" "+Y(((A=jt(t).userData)==null?void 0:A.position)||"N/A"),1)]),d("p",null,[T[15]||(T[15]=d("strong",null,"Role:",-1)),wr(" "+Y(((w=jt(t).userData)==null?void 0:w.role)||"Employee"),1)]),(E=jt(t).userData)!=null&&E.isSupervisor?(ee(),te("p",OK,"  Supervisor Account ")):Ke("",!0),d("div",NK,[d("button",{onClick:T[0]||(T[0]=Ae=>b.$router.push("/time-attendance-request")),class:"btn-action"},"     "),(C=jt(t).userData)!=null&&C.isSupervisor?Ke("",!0):(ee(),te("button",{key:0,onClick:T[1]||(T[1]=Ae=>b.$router.push("/salary-report")),class:"btn-action salary"},"    ")),(I=jt(t).userData)!=null&&I.isSupervisor?(ee(),te("button",{key:1,onClick:T[2]||(T[2]=Ae=>b.$router.push("/supervisor-ta-summary")),class:"btn-action summary"},"    ")):Ke("",!0),(x=jt(t).userData)!=null&&x.isSupervisor?(ee(),te("button",{key:2,onClick:T[3]||(T[3]=Ae=>b.$router.push("/project-summary")),class:"btn-action project"},"    ")):Ke("",!0),(P=jt(t).userData)!=null&&P.isSupervisor?(ee(),te("button",{key:3,onClick:T[4]||(T[4]=Ae=>b.$router.push("/financial-transactions")),class:"btn-action finance"},"    ")):Ke("",!0)])]),(ie=jt(t).userData)!=null&&ie.isSupervisor?Ke("",!0):(ee(),te("div",DK,[fn(SK)])),(Q=jt(t).userData)!=null&&Q.isSupervisor?(ee(),te("div",MK,[T[21]||(T[21]=d("h3",null,"Supervisor Actions",-1)),jt(t).msalAccount?(ee(),te("div",UK,[d("p",BK," Microsoft account: "+Y(jt(t).msalAccount.username),1),T[20]||(T[20]=d("p",null,"Sync data between system and Excel:",-1)),d("div",VK,[d("button",{onClick:T[5]||(T[5]=Ae=>v("employee")),class:"sync-btn employee",disabled:o.value},[T[17]||(T[17]=d("span",{class:"icon"},"",-1)),wr(" "+Y(o.value&&u.value==="employee"?"Syncing...":"Sync Employees"),1)],8,HK),d("button",{onClick:T[6]||(T[6]=Ae=>v("customer")),class:"sync-btn customer",disabled:o.value},[T[18]||(T[18]=d("span",{class:"icon"},"",-1)),wr(" "+Y(o.value&&u.value==="customer"?"Syncing...":"Sync Customers"),1)],8,$K),d("button",{onClick:T[7]||(T[7]=Ae=>v("project")),class:"sync-btn project",disabled:o.value},[T[19]||(T[19]=d("span",{class:"icon"},"",-1)),wr(" "+Y(o.value&&u.value==="project"?"Syncing...":"Sync Projects"),1)],8,KK)]),a.value?(ee(),te("div",{key:0,class:Tt(["sync-result",a.value.success?"success":"error"])},[d("span",jK,Y(a.value.success?"":""),1),d("span",WK,Y(a.value.message),1),d("button",{onClick:T[8]||(T[8]=Ae=>a.value=null),class:"close-result"},"")],2)):Ke("",!0)])):(ee(),te("div",FK,[T[16]||(T[16]=d("p",null,"Connect your Microsoft account to enable Excel sync features",-1)),d("button",{onClick:g,class:"microsoft-btn",disabled:l.value},Y(l.value?"Connecting...":"Connect Microsoft Account"),9,LK)])),fn(vV,{onSaved:D}),fn(GV,{onSaved:D}),fn(gx,{onSaved:D}),(ae=jt(t).userData)!=null&&ae.isSupervisor?(ee(),te("div",GK,[d("button",{onClick:T[9]||(T[9]=Ae=>f.value=!f.value),class:"expand-btn"},Y(f.value?"":"")+"    ",1),f.value?(ee(),Sg(T7,{key:0})):Ke("",!0)])):Ke("",!0)])):Ke("",!0)]),c.value?(ee(),te("div",{key:0,class:"modal-overlay",onClick:T[12]||(T[12]=ni(Ae=>c.value=!1,["self"]))},[d("div",qK,[d("h3",null,"Sync "+Y(u.value.charAt(0).toUpperCase()+u.value.slice(1))+"s",1),d("p",null," Select which direction to sync "+Y(u.value)+" data: ",1),d("div",zK,[d("button",{onClick:T[10]||(T[10]=Ae=>_("toExcel")),class:"sync-option-btn to-excel",disabled:o.value},[...T[22]||(T[22]=[d("span",{class:"arrow"},"",-1),d("span",{class:"label"},"System  Excel",-1),d("small",null,"Update Excel with system data",-1)])],8,YK),d("button",{onClick:T[11]||(T[11]=Ae=>_("toFirestore")),class:"sync-option-btn to-firestore",disabled:o.value},[...T[23]||(T[23]=[d("span",{class:"arrow"},"",-1),d("span",{class:"label"},"System  Excel",-1),d("small",null,"Load data from Excel",-1)])],8,QK)])])])):Ke("",!0)])}}},JK=Cr(XK,[["__scopeId","data-v-6cb59641"]]),ZK={class:"attendance-form-page"},ej={class:"form-header"},tj={key:0,class:"my-requests-section"},nj={class:"requests-header"},rj={class:"filter-controls"},ij={class:"requests-table-wrapper"},sj={class:"my-requests-table"},oj={class:"action-buttons"},aj=["onClick"],lj=["onClick"],cj={class:"form-container"},uj={class:"add-row-section"},hj=["disabled"],dj={class:"table-wrapper"},fj={class:"attendance-table"},pj=["onUpdate:modelValue","onChange"],gj=["onUpdate:modelValue"],mj=["onUpdate:modelValue","onChange"],vj=["onUpdate:modelValue","disabled"],_j=["onUpdate:modelValue","onChange","disabled"],yj=["value"],Ej=["onUpdate:modelValue","disabled"],Tj=["onUpdate:modelValue","onChange","disabled"],wj=["onUpdate:modelValue","onChange","disabled"],Aj=["onUpdate:modelValue"],Cj=["onUpdate:modelValue","onChange"],Sj=["onUpdate:modelValue"],Ij=["onUpdate:modelValue"],xj=["onClick"],Rj={__name:"TimeAttendanceRequestForm",setup(n){xu();const e=Nl(),t=Ol(),r=mx(),i=Se([]),s=Se([]),o=Se(null),a=Se(!1),l=Se(""),c=Se(""),u=Se([]),f=Se(""),p=["","","","","","",""],g=it(()=>f.value?u.value.filter(I=>I.Status===f.value):u.value);function m(I){if(!I)return"";const x=new Date(I);return`${x.getFullYear()}.${String(x.getMonth()+1).padStart(2,"0")}.${String(x.getDate()).padStart(2,"0")}`}function v(I){switch(I){case"":return"status-present";case"":return"status-assignment";case"/":return"status-leave";case"":return"status-missed";default:return""}}Dr(async()=>{await e.fetchProjects(),await t.fetchEmployees(),s.value=e.projects.filter(x=>x.Status===" ").sort((x,P)=>{const ie=parseInt(x.id)||0,Q=parseInt(P.id)||0;return ie-Q});const I=Da.currentUser;I&&(o.value=t.employees.find(x=>x.Email===I.email)),await D(),_()});function _(){var Q,ae,Ae,Oe,Ce,fe,F;const I=Date.now(),x=Math.random().toString(36).substring(2,8),P=`${I}-${x}`,ie=new Date().toISOString().split("T")[0];i.value.push({ID:P,Day:ie,WeekDay:p[new Date().getDay()],EmployeeID:((Q=o.value)==null?void 0:Q.Id)||((ae=o.value)==null?void 0:ae.NumID)||null,FirstName:((Ae=o.value)==null?void 0:Ae.FirstName)||"",LastName:((Oe=o.value)==null?void 0:Oe.LastName)||"",EmployeeFirstName:((Ce=o.value)==null?void 0:Ce.FirstName)||"",EmployeeLastName:((fe=o.value)==null?void 0:fe.LastName)||"",Role:((F=o.value)==null?void 0:F.Position)||"",Status:"",ProjectID:"",ProjectName:"",startTime:"09:00",endTime:"18:00",WorkingHour:8,isOvertimeRequest:!1,overtimeHour:0,comment:"",Week:w(new Date)})}async function D(){await r.fetchRequests(),u.value=r.requests.filter(I=>{var x;return I.status==="pending"&&I.EmployeeLastName===((x=o.value)==null?void 0:x.LastName)})}function b(I){i.value=[{...I,isOvertimeRequest:I.overtimeHour>0,isEditing:!0,editingDocId:I.docId}],window.scrollTo({top:0,behavior:"smooth"}),C('  .    " "  ',"info")}async function T(I){if(confirm("   ?"))try{await xc("delete",{},I),C("  ","success"),await D()}catch(x){C(" : "+x.message,"error")}}function R(I){i.value.splice(I,1)}function B(I){const x=i.value[I],P=s.value.find(ie=>ie.id==x.ProjectID);P&&(x.ProjectName=P.siteLocation||"")}function W(I){const x=i.value[I];if(x.Day){const P=new Date(x.Day);x.WeekDay=p[P.getDay()],x.Week=w(P)}if(x.Status==="/"){x.WorkingHour=8,x.overtimeHour=0,x.isOvertimeRequest=!1,x.startTime="",x.endTime="";return}if(x.startTime&&x.endTime){const P=A(x.startTime);let Q=A(x.endTime)-P;Q<0&&(Q+=24);const ae=Math.max(0,Math.round((Q-1)*10)/10);x.isOvertimeRequest?(x.WorkingHour=0,x.overtimeHour=ae):(x.WorkingHour=Math.min(ae,8),x.overtimeHour=0)}}function A(I){const[x,P]=I.split(":").map(Number);return x+P/60}function w(I){const x=new Date(Date.UTC(I.getFullYear(),I.getMonth(),I.getDate())),P=x.getUTCDay()||7;x.setUTCDate(x.getUTCDate()+4-P);const ie=new Date(Date.UTC(x.getUTCFullYear(),0,1));return Math.ceil(((x-ie)/864e5+1)/7)}async function E(){var P;if(i.value.length===0){C("   ","error");return}if(a.value)return;const I=i.value.map(ie=>`${ie.Day}-${ie.ProjectID}`);if(I.filter((ie,Q)=>I.indexOf(ie)!==Q&&ie!=="-").length>0){C("     ","error");return}for(let ie=0;ie<i.value.length;ie++)for(let Q=ie+1;Q<i.value.length;Q++){const ae=i.value[ie],Ae=i.value[Q];if(ae.Day===Ae.Day&&ae.ProjectID!==Ae.ProjectID){const Oe=A(ae.startTime),Ce=A(ae.endTime),fe=A(Ae.startTime),F=A(Ae.endTime);let O=Ce<Oe?Ce+24:Ce,Z=F<fe?F+24:F,q=Oe,X=fe;if(q<Z&&O>X||X<O&&Z>q){C(`${ae.Day}    :      `,"error");return}}}for(const ie of i.value){if(!ie.Day||!ie.Role||!ie.Status){C("    ","error");return}if(ie.Status!=="/"){if(!ie.ProjectID){C("  ","error");return}if(!ie.startTime||!ie.endTime){C("   ","error");return}}if(!ie.comment||ie.comment.trim()===""){C("     ","error");return}}a.value=!0,l.value="";try{let ie=0,Q=0;await r.fetchRequests();const ae=r.requests.filter(Ce=>Ce.status==="pending"),Ae=vx();await Ae.fetchRecords(!0);const Oe=Ae.allRecords;for(const Ce of i.value){if(Ce.isEditing&&Ce.editingDocId){console.log("Updating request:",Ce.editingDocId),await xc("update",Ce,Ce.editingDocId),ie++;continue}if(ae.find(q=>q.Day===Ce.Day&&q.ProjectID===Ce.ProjectID&&q.EmployeeLastName===Ce.EmployeeLastName)){C(`${Ce.Day}  ${Ce.ProjectID}      `,"error");return}if(Oe.find(q=>q.Day===Ce.Day&&q.ProjectID===Ce.ProjectID&&(q.EmployeeLastName===Ce.EmployeeLastName||q.LastName===Ce.EmployeeLastName))){C(`${Ce.Day}  ${Ce.ProjectID}      `,"error");return}const O=Oe.find(q=>{if(q.Day===Ce.Day&&q.ProjectID===Ce.ProjectID&&(q.EmployeeLastName===Ce.EmployeeLastName||q.LastName===Ce.EmployeeLastName)||q.Day!==Ce.Day||q.EmployeeLastName!==Ce.EmployeeLastName&&q.LastName!==Ce.EmployeeLastName)return!1;const X=A(Ce.startTime),ce=A(Ce.endTime),ne=A(q.startTime),ve=A(q.endTime);let se=ce<X?ce+24:ce,H=ve<ne?ve+24:ve;return X<H&&se>ne});if(O){C(`${Ce.Day}  ${O.startTime}-${O.endTime}       (${O.ProjectID} )`,"error");return}const Z=ae.find(q=>{if(q.Day!==Ce.Day||q.EmployeeLastName!==Ce.EmployeeLastName)return!1;const X=A(Ce.startTime),ce=A(Ce.endTime),ne=A(q.startTime),ve=A(q.endTime);let se=ce<X?ce+24:ce,H=ve<ne?ve+24:ve;return X<H&&se>ne});if(Z){C(`${Ce.Day}    : ${Z.ProjectID}    ${Z.startTime}-${Z.endTime}    `,"error");return}console.log("Submitting request:",Ce);try{const q=await xc("add",Ce);console.log("Response:",q),ie++}catch(q){if(console.error("Backend error:",(P=q.response)==null?void 0:P.data),q.response&&(q.response.status===400||q.response.status===409)){const X=q.response.data.details||q.response.data.message||q.response.data.error;C(X,"error"),a.value=!1;return}throw q}}ie>0&&Q>0||(ie>0?C(`${ie}   `,"success"):Q>0),setTimeout(()=>{i.value=[],_(),D()},2e3)}catch(ie){C(" : "+ie.message,"error")}finally{a.value=!1}}function C(I,x){l.value=I,c.value=x,setTimeout(()=>{l.value=""},5e3)}return(I,x)=>(ee(),te("div",ZK,[d("div",ej,[x[2]||(x[2]=d("h2",null,"  ",-1)),d("button",{onClick:x[0]||(x[0]=P=>I.$router.push("/dashboard")),class:"btn-back"},"")]),u.value.length>0?(ee(),te("div",tj,[d("div",nj,[x[4]||(x[4]=d("h3",null,"  ",-1)),d("div",rj,[Ie(d("select",{"onUpdate:modelValue":x[1]||(x[1]=P=>f.value=P),class:"status-filter"},[...x[3]||(x[3]=[Cs('<option value="" data-v-985e6a6f> </option><option value="" data-v-985e6a6f></option><option value="" data-v-985e6a6f></option><option value="/" data-v-985e6a6f>/</option><option value="" data-v-985e6a6f></option>',5)])],512),[[_t,f.value]])])]),d("div",ij,[d("table",sj,[x[5]||(x[5]=d("thead",null,[d("tr",null,[d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,"")])],-1)),d("tbody",null,[(ee(!0),te(wt,null,rn(g.value,P=>(ee(),te("tr",{key:P.docId},[d("td",null,Y(m(P.Day)),1),d("td",null,Y(P.WeekDay),1),d("td",null,[d("span",{class:Tt(["status-badge",v(P.Status)])},Y(P.Status),3)]),d("td",null,Y(P.ProjectID),1),d("td",null,Y(P.ProjectName),1),d("td",null,Y(P.startTime),1),d("td",null,Y(P.endTime),1),d("td",null,Y(P.WorkingHour)+"",1),d("td",oj,[d("button",{onClick:ie=>b(P),class:"btn-edit"}," ",8,aj),d("button",{onClick:ie=>T(P.docId),class:"btn-delete-req"}," ",8,lj)])]))),128))])])])])):Ke("",!0),d("div",cj,[d("div",uj,[d("button",{onClick:_,class:"btn-add"}," "),d("button",{onClick:E,class:"btn-submit",disabled:i.value.length===0||a.value},Y(a.value?" ...":" "),9,hj)]),l.value?(ee(),te("div",{key:0,class:Tt(["message",c.value])},Y(l.value),3)):Ke("",!0),d("div",dj,[d("table",fj,[x[9]||(x[9]=d("thead",null,[d("tr",null,[d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null,""),d("th",null," "),d("th",null," "),d("th",null," "),d("th",null," "),d("th",null,"  "),d("th")])],-1)),d("tbody",null,[(ee(!0),te(wt,null,rn(i.value,(P,ie)=>(ee(),te("tr",{key:ie},[d("td",null,[Ie(d("input",{type:"date","onUpdate:modelValue":Q=>P.Day=Q,onChange:Q=>W(ie),class:"input-field"},null,40,pj),[[Ge,P.Day]])]),d("td",null,[Ie(d("input",{type:"text","onUpdate:modelValue":Q=>P.WeekDay=Q,readonly:"",class:"input-field"},null,8,gj),[[Ge,P.WeekDay]])]),d("td",null,[Ie(d("select",{"onUpdate:modelValue":Q=>P.Status=Q,onChange:Q=>W(ie),class:"input-field"},[...x[6]||(x[6]=[d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:"/"},"/",-1)])],40,mj),[[_t,P.Status]])]),d("td",null,[Ie(d("select",{"onUpdate:modelValue":Q=>P.Role=Q,class:"input-field",disabled:P.Status==="/"},[...x[7]||(x[7]=[d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1),d("option",{value:""},"",-1)])],8,vj),[[_t,P.Role]])]),d("td",null,[Ie(d("select",{"onUpdate:modelValue":Q=>P.ProjectID=Q,onChange:Q=>B(ie),class:"input-field",disabled:P.Status==="/"},[x[8]||(x[8]=d("option",{value:""},"",-1)),(ee(!0),te(wt,null,rn(s.value,Q=>(ee(),te("option",{key:Q.id,value:Q.id},Y(Q.id)+" - "+Y(Q.siteLocation),9,yj))),128))],40,_j),[[_t,P.ProjectID]])]),d("td",null,[Ie(d("input",{type:"text","onUpdate:modelValue":Q=>P.ProjectName=Q,class:"input-field",placeholder:"",disabled:P.Status==="/"},null,8,Ej),[[Ge,P.ProjectName]])]),d("td",null,[Ie(d("input",{type:"time","onUpdate:modelValue":Q=>P.startTime=Q,onChange:Q=>W(ie),class:"input-field",step:"60",disabled:P.Status==="/"},null,40,Tj),[[Ge,P.startTime]])]),d("td",null,[Ie(d("input",{type:"time","onUpdate:modelValue":Q=>P.endTime=Q,onChange:Q=>W(ie),class:"input-field",step:"60",disabled:P.Status==="/"},null,40,wj),[[Ge,P.endTime]])]),d("td",null,[Ie(d("input",{type:"number","onUpdate:modelValue":Q=>P.WorkingHour=Q,readonly:"",class:"input-field",step:"0.5"},null,8,Aj),[[Ge,P.WorkingHour]])]),d("td",null,[Ie(d("input",{type:"checkbox","onUpdate:modelValue":Q=>P.isOvertimeRequest=Q,onChange:Q=>W(ie),class:"checkbox-field"},null,40,Cj),[[Oh,P.isOvertimeRequest]]),Ie(d("input",{type:"number","onUpdate:modelValue":Q=>P.overtimeHour=Q,readonly:"",class:"input-field overtime-input",step:"0.5"},null,8,Sj),[[Ge,P.overtimeHour]])]),d("td",null,[Ie(d("textarea",{"onUpdate:modelValue":Q=>P.comment=Q,class:"textarea-field",placeholder:"  *",rows:"2",required:""},null,8,Ij),[[Ge,P.comment]])]),d("td",null,[d("button",{onClick:Q=>R(ie),class:"btn-delete"},"x",8,xj)])]))),128))])])])])]))}},bj=Cr(Rj,[["__scopeId","data-v-985e6a6f"]]),kj={class:"salary-report-section"},Pj={class:"period-selector"},Oj={class:"period-buttons"},Nj={class:"month-selector"},Dj={key:0,class:"loading"},Mj={key:1,class:"salary-summary"},Fj={class:"summary-card"},Lj={class:"card-header"},Uj={class:"date-range"},Bj={class:"hours-breakdown"},Vj={class:"hour-item total"},Hj={class:"value"},$j={key:0,class:"hour-item missed"},Kj={class:"value penalty"},jj={key:1,class:"hour-item salary-total"},Wj={class:"value salary"},Gj={key:0,class:"projects-section"},qj={class:"project-list"},zj={class:"project-header"},Yj={class:"project-name"},Qj={class:"project-summary"},Xj={class:"project-total"},Jj={key:0,class:"project-salary"},Zj={class:"role-breakdown"},eW={class:"role-info"},tW={class:"role-icon"},nW={class:"role-name"},rW={class:"role-hours"},iW={class:"hours-detail"},sW={key:0,class:"role-salary"},oW={class:"days-worked"},aW={class:"value"},lW={key:2,class:"no-data"},cW={__name:"EmployeeSalaryReport",setup(n){const e=Ms(),t=Ol(),r=pm(),i=Se(null),s={:5e3,:0,:0};function o(D,b){if(i.value==="")return 0;const T=s[D]||0;return b*T}const a=Se("first-half"),l=Se(""),c=Se(!1),u=Se(null),f=new Date;l.value=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}`;const p=it(()=>{if(!l.value)return 31;const[D,b]=l.value.split("-");return new Date(D,b,0).getDate()}),g=it(()=>a.value==="first-half"?"  ":"  "),m=it(()=>{if(!l.value)return"";const[D,b]=l.value.split("-");return a.value==="first-half"?`${D}-${b}-01 - ${D}-${b}-15`:`${D}-${b}-16 - ${D}-${b}-${p.value}`});function v(D){a.value=D,_()}async function _(){var b;const D=(b=e.userData)==null?void 0:b.employeeId;if(!l.value||!D){console.log("Missing required data:",{month:l.value,employeeId:D});return}c.value=!0;try{await t.fetchEmployees();const T=t.employees.find(Ce=>Ce.Id===D);i.value=(T==null?void 0:T.Type)||null,console.log("Employee type:",i.value);const[R,B]=l.value.split("-");let W,A;a.value==="first-half"?(W=1,A=15):(W=16,A=p.value);const w=`${R}-${B}-${String(W).padStart(2,"0")}`,E=`${R}-${B}-${String(A).padStart(2,"0")}`;console.log("Querying timeAttendance:",{employeeId:D,startDate:w,endDate:E});const C=ei(Pn(r,"timeAttendance"),Vr("EmployeeID","==",D)),I=await Wn(C);console.log("Total records found:",I.size);const x=I.docs.map(Ce=>Ce.data()).filter(Ce=>{const fe=Ce.Day||Ce.Date;return fe>=w&&fe<=E});console.log("Records in date range:",x.length);let P=0,ie=0;const Q=new Map,ae=new Set;x.forEach(Ce=>{const fe=Ce.Status,F=parseFloat(Ce.WorkingHour)||0,O=parseFloat(Ce.overtimeHour)||0;if(fe==="/")return;let Z=F+O;if(fe===""){const ne=F*2;ie+=ne,Z=-ne}P+=Z,Ce.Day&&ae.add(Ce.Day);const q=Ce.ProjectID,X=Ce.ProjectName||q,ce=Ce.Role||"";if(q){Q.has(q)||Q.set(q,{projectId:q,projectName:X,totalHours:0,roles:new Map});const ne=Q.get(q);ne.totalHours+=Z,ne.roles.has(ce)||ne.roles.set(ce,{role:ce,totalHours:0,salary:0});const ve=ne.roles.get(ce);ve.totalHours+=Z,ve.salary+=o(ce,Z)}});const Ae=Array.from(Q.values()).map(Ce=>{const fe=Array.from(Ce.roles.values()).sort((O,Z)=>Z.totalHours-O.totalHours),F=fe.reduce((O,Z)=>O+Z.salary,0);return{...Ce,roles:fe,totalSalary:F}}).sort((Ce,fe)=>fe.totalHours-Ce.totalHours),Oe=Ae.reduce((Ce,fe)=>Ce+fe.totalSalary,0);console.log("Calculated salary data:",{totalHours:P,missedHours:ie,totalSalary:Oe,daysWorked:ae.size,projectCount:Ae.length}),u.value={totalHours:P,missedHours:ie,totalSalary:Oe,daysWorked:ae.size,projectBreakdown:Ae}}catch(T){console.error("Error loading salary data:",T),u.value=null}finally{c.value=!1}}return Dr(()=>{_()}),(D,b)=>(ee(),te("div",kj,[b[10]||(b[10]=d("h3",null,"  ",-1)),b[11]||(b[11]=d("div",{class:"warning-banner"},"           ",-1)),d("div",Pj,[b[4]||(b[4]=d("label",null," :",-1)),d("div",Oj,[d("button",{onClick:b[0]||(b[0]=T=>v("first-half")),class:Tt(["period-btn",{active:a.value==="first-half"}])}," 1-15 (  ) ",2),d("button",{onClick:b[1]||(b[1]=T=>v("second-half")),class:Tt(["period-btn",{active:a.value==="second-half"}])}," 16-"+Y(p.value)+" (  ) ",3)]),d("div",Nj,[b[3]||(b[3]=d("label",null," :",-1)),Ie(d("input",{type:"month","onUpdate:modelValue":b[2]||(b[2]=T=>l.value=T),onChange:_},null,544),[[Ge,l.value]])])]),c.value?(ee(),te("div",Dj,"  ... ")):u.value?(ee(),te("div",Mj,[d("div",Fj,[d("div",Lj,[d("h4",null,Y(g.value),1),d("p",Uj,Y(m.value),1)]),d("div",Bj,[d("div",Vj,[b[5]||(b[5]=d("span",{class:"label"},"  :",-1)),d("span",Hj,Y(u.value.totalHours.toFixed(2))+" ",1)]),u.value.missedHours>0?(ee(),te("div",$j,[b[6]||(b[6]=d("span",{class:"label"}," :",-1)),d("span",Kj,Y(u.value.missedHours.toFixed(2))+" ",1)])):Ke("",!0),u.value.totalSalary>0?(ee(),te("div",jj,[b[7]||(b[7]=d("span",{class:"label"},"  :",-1)),d("span",Wj,Y(u.value.totalSalary.toLocaleString())+" ",1)])):Ke("",!0)]),u.value.projectBreakdown.length>0?(ee(),te("div",Gj,[b[8]||(b[8]=d("h5",null,":",-1)),d("div",qj,[(ee(!0),te(wt,null,rn(u.value.projectBreakdown,T=>(ee(),te("div",{key:T.projectId,class:"project-card"},[d("div",zj,[d("span",Yj,Y(T.projectName),1),d("div",Qj,[d("span",Xj,Y(T.totalHours.toFixed(2))+" ",1),T.totalSalary>0?(ee(),te("span",Jj,Y(T.totalSalary.toLocaleString())+" ",1)):Ke("",!0)])]),d("div",Zj,[(ee(!0),te(wt,null,rn(T.roles,R=>(ee(),te("div",{key:R.role,class:"role-item"},[d("div",eW,[d("span",tW,Y(R.role===""?"":R.role===""?"":""),1),d("span",nW,Y(R.role),1)]),d("div",rW,[d("span",iW,Y(R.totalHours.toFixed(2))+" ",1),R.salary>0?(ee(),te("span",sW,Y(R.salary.toLocaleString())+" ",1)):Ke("",!0)])]))),128))])]))),128))])])):Ke("",!0),d("div",oW,[b[9]||(b[9]=d("span",{class:"label"}," :",-1)),d("span",aW,Y(u.value.daysWorked)+" ",1)])])])):c.value?Ke("",!0):(ee(),te("div",lW,"     "))]))}},uW=Cr(cW,[["__scopeId","data-v-a380e257"]]),hW={class:"salary-report-page"},dW={class:"page-header"},fW={__name:"SalaryReport",setup(n){return(e,t)=>(ee(),te("div",hW,[d("header",dW,[d("button",{onClick:t[0]||(t[0]=r=>e.$router.push("/dashboard")),class:"back-btn"}," "),t[1]||(t[1]=d("h1",null,"  ",-1))]),fn(uW)]))}},pW=Cr(fW,[["__scopeId","data-v-8c2fc283"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var xd={};xd.version="0.18.5";var _x=1252,gW=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],yx=function(n){gW.indexOf(n)!=-1&&(_x=n)};function mW(){yx(1252)}var Qc=function(n){yx(n)};function vW(){Qc(1200),mW()}var _h=function(e){return String.fromCharCode(e)},PE=function(e){return String.fromCharCode(e)},Rd,no="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xc(n){for(var e="",t=0,r=0,i=0,s=0,o=0,a=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),s=t>>2,r=n.charCodeAt(c++),o=(t&3)<<4|r>>4,i=n.charCodeAt(c++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),e+=no.charAt(s)+no.charAt(o)+no.charAt(a)+no.charAt(l);return e}function ks(n){var e="",t=0,r=0,i=0,s=0,o=0,a=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)s=no.indexOf(n.charAt(c++)),o=no.indexOf(n.charAt(c++)),t=s<<2|o>>4,e+=String.fromCharCode(t),a=no.indexOf(n.charAt(c++)),r=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(r)),l=no.indexOf(n.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var bt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Fs=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ia(n){return bt?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function OE(n){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var ci=function(e){return bt?Fs(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function zf(n){if(typeof ArrayBuffer>"u")return ci(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function Ou(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function _W(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Gn=bt?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Fs(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function yW(n){for(var e=[],t=0,r=n.length+250,i=ia(n.length+255),s=0;s<n.length;++s){var o=n.charCodeAt(s);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=n.charCodeAt(++s)&1023;i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|a>>6&15|(o&3)<<4,i[t++]=128|a&63}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|o&63;t>r&&(e.push(i.slice(0,t)),t=0,i=ia(65535),r=65530)}return e.push(i.slice(0,t)),Gn(e)}var Rc=/\u0000/g,yh=/[\u0001-\u0006]/g;function el(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function ui(n,e){var t=""+n;return t.length>=e?t:ln("0",e-t.length)+t}function yv(n,e){var t=""+n;return t.length>=e?t:ln(" ",e-t.length)+t}function bd(n,e){var t=""+n;return t.length>=e?t:t+ln(" ",e-t.length)}function EW(n,e){var t=""+Math.round(n);return t.length>=e?t:ln("0",e-t.length)+t}function TW(n,e){var t=""+n;return t.length>=e?t:ln("0",e-t.length)+t}var NE=Math.pow(2,32);function xa(n,e){if(n>NE||n<-NE)return EW(n,e);var t=Math.round(n);return TW(t,e)}function kd(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var DE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function wW(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var un={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ME={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},AW={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Pd(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,o=1,a=0,l=1,c=0,u=0,f=Math.floor(i);c<e&&(f=Math.floor(i),a=f*o+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=o,o=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=s):(u=c,a=o)),!t)return[0,r*a,u];var p=Math.floor(r*a/u);return[p,r*a-p*u,u]}function Eh(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,o=[],a={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=kW(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var Ex=new Date(1899,11,31,0,0,0),CW=Ex.getTime(),SW=new Date(1900,2,1,0,0,0);function Tx(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=SW&&(t+=24*60*60*1e3),(t-(CW+(n.getTimezoneOffset()-Ex.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ev(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function IW(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xW(n){var e=n<0?12:11,t=Ev(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function RW(n){var e=Ev(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function bW(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=xW(n):e===10?t=n.toFixed(10).substr(0,12):t=RW(n),Ev(IW(t.toUpperCase()))}function sg(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):bW(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return yo(14,Tx(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function kW(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function PW(n,e,t,r){var i="",s=0,o=0,a=t.y,l,c=0;switch(n){case 98:a=t.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return jp[t.m-1][1];case 5:return jp[t.m-1][0];default:return jp[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return DE[t.q][0];default:return DE[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?ui(t.S,e.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(t.S+t.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=ui(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?ui(l,c):"";return u}function ro(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var wx=/%/g;function OW(n,e,t){var r=e.replace(wx,""),i=e.length-r.length;return _s(n,r,t*Math.pow(10,2*i))+ln("%",i)}function NW(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return _s(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function Ax(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ax(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Cx=/# (\?+)( ?)\/( ?)(\d+)/;function DW(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),o=i-s*r,a=r;return t+(s===0?"":""+s)+" "+(o===0?ln(" ",n[1].length+1+n[4].length):yv(o,n[1].length)+n[2]+"/"+n[3]+ui(a,n[4].length))}function MW(n,e,t){return t+(e===0?"":""+e)+ln(" ",n[1].length+2+n[4].length)}var Sx=/^#*0*\.([0#]+)/,Ix=/\).*[0#]/,xx=/\(###\) ###\\?-####/;function yr(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function FE(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function LE(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function FW(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function LW(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Jr(n,e,t){if(n.charCodeAt(0)===40&&!e.match(Ix)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Jr("n",r,t):"("+Jr("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return NW(n,e,t);if(e.indexOf("%")!==-1)return OW(n,e,t);if(e.indexOf("E")!==-1)return Ax(e,t);if(e.charCodeAt(0)===36)return"$"+Jr(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,o,a,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+xa(l,e.length);if(e.match(/^[#?]+$/))return i=xa(t,0),i==="0"&&(i=""),i.length>e.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(Cx))return DW(s,l,c);if(e.match(/^#+0+$/))return c+xa(l,e.length-e.indexOf("0"));if(s=e.match(Sx))return i=FE(t,s[1].length).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])).replace(/\.(\d*)$/,function(m,v){return"."+v+ln("0",yr(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+FE(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ro(xa(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Jr(n,e,-t):ro(""+(Math.floor(t)+FW(t,s[1].length)))+"."+ui(LE(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Jr(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=el(Jr(n,e.replace(/[\\-]/g,""),t)),o=0,el(el(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(e.match(xx))return i=Jr(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Pd(l,Math.pow(10,o)-1,!1),i=""+c,u=_s("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=bd(a[2],o),u.length<s[4].length&&(u=yr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Pd(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?yv(a[1],o)+s[2]+"/"+s[3]+bd(a[2],o):ln(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=xa(t,0),e.length<=i.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=e.indexOf(".")-o,p=e.length-i.length-f;return yr(e.substr(0,f)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=LE(t,s[1].length),t<0?"-"+Jr(n,e,-t):ro(LW(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?ui(0,3-m.length):"")+m})+"."+ui(o,s[1].length);switch(e){case"###,##0.00":return Jr(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var g=ro(xa(l,0));return g!=="0"?c+g:"";case"###,###.00":return Jr(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Jr(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function UW(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return _s(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function BW(n,e,t){var r=e.replace(wx,""),i=e.length-r.length;return _s(n,r,t*Math.pow(10,2*i))+ln("%",i)}function Rx(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Rx(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function xi(n,e,t){if(n.charCodeAt(0)===40&&!e.match(Ix)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?xi("n",r,t):"("+xi("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return UW(n,e,t);if(e.indexOf("%")!==-1)return BW(n,e,t);if(e.indexOf("E")!==-1)return Rx(e,t);if(e.charCodeAt(0)===36)return"$"+xi(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,o,a,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+ui(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(Cx))return MW(s,l,c);if(e.match(/^#+0+$/))return c+ui(l,e.length-e.indexOf("0"));if(s=e.match(Sx))return i=(""+t).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])),i=i.replace(/\.(\d*)$/,function(m,v){return"."+v+ln("0",yr(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ro(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+xi(n,e,-t):ro(""+t)+"."+ln("0",s[1].length);if(s=e.match(/^#,#*,#0/))return xi(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=el(xi(n,e.replace(/[\\-]/g,""),t)),o=0,el(el(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(e.match(xx))return i=xi(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Pd(l,Math.pow(10,o)-1,!1),i=""+c,u=_s("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=bd(a[2],o),u.length<s[4].length&&(u=yr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Pd(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?yv(a[1],o)+s[2]+"/"+s[3]+bd(a[2],o):ln(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=e.indexOf(".")-o,p=e.length-i.length-f;return yr(e.substr(0,f)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+xi(n,e,-t):ro(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?ui(0,3-m.length):"")+m})+"."+ui(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=ro(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return xi(n,e.slice(0,e.lastIndexOf(".")),t)+yr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function _s(n,e,t){return(t|0)===t?xi(n,e,t):Jr(n,e,t)}function VW(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var bx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kx(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":kd(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(bx))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function HW(n,e,t,r){for(var i=[],s="",o=0,a="",l="t",c,u,f,p="H";o<n.length;)switch(a=n.charAt(o)){case"G":if(!kd(n,o))throw new Error("unrecognized character "+a+" in "+n);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=n.charCodeAt(++o))!==34&&o<n.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=n.charAt(++o),m=g==="("||g===")"?g:"t";i[i.length]={t:m,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(c==null&&(c=Eh(e,t,n.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Eh(e,t),c==null))return"";for(s=a;++o<n.length&&n.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=p),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var v={t:a,v:a};if(c==null&&(c=Eh(e,t)),n.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",p="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",o+=5,p="h"):n.substr(o,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",o+=5,p="h"):(v.t="t",++o),c==null&&v.t==="T")return"";i[i.length]=v,l=a;break;case"[":for(s=a;n.charAt(o++)!=="]"&&o<n.length;)s+=n.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(bx)){if(c==null&&(c=Eh(e,t),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",kx(n)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<n.length&&(a=n.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<n.length&&"0#?.,E+-%".indexOf(a=n.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;n.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)s+=n.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+n);i[i.length]={t:"t",v:a},++o;break}var _=0,D=0,b;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=p,l="h",_<1&&(_=1);break;case"s":(b=i[o].v.match(/\.0+$/))&&(D=Math.max(D,b[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[o].v.match(/[Hh]/)&&(_=1),_<2&&i[o].v.match(/[Mm]/)&&(_=2),_<3&&i[o].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",R;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=PW(i[o].t.charCodeAt(0),i[o].v,c,D),i[o].t="t";break;case"n":case"?":for(R=o+1;i[R]!=null&&((a=i[R].t)==="?"||a==="D"||(a===" "||a==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[o].v+=i[R].v,i[R]={v:"",t:";"},++R;T+=i[o].v,o=R-1;break;case"G":i[o].t="t",i[o].v=sg(e,t);break}var B="",W,A;if(T.length>0){T.charCodeAt(0)==40?(W=e<0&&T.charCodeAt(0)===45?-e:e,A=_s("n",T,W)):(W=e<0&&r>1?-e:e,A=_s("n",T,W),W<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),R=A.length-1;var w=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){w=o;break}var E=i.length;if(w===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(R>=i[o].v.length-1?(R-=i[o].v.length,i[o].v=A.substr(R+1,i[o].v.length)):R<0?i[o].v="":(i[o].v=A.substr(0,R+1),R=-1),i[o].t="t",E=o);R>=0&&E<i.length&&(i[E].v=A.substr(0,R+1)+i[E].v)}else if(w!==i.length&&A.indexOf("E")===-1){for(R=A.indexOf(".")-1,o=w;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===w?i[o].v.indexOf(".")-1:i[o].v.length-1,B=i[o].v.substr(u+1);u>=0;--u)R>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(B=A.charAt(R--)+B);i[o].v=B,i[o].t="t",E=o}for(R>=0&&E<i.length&&(i[E].v=A.substr(0,R+1)+i[E].v),R=A.indexOf(".")+1,o=w;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==w)){for(u=i[o].v.indexOf(".")>-1&&o===w?i[o].v.indexOf(".")+1:0,B=i[o].v.substr(0,u);u<i[o].v.length;++u)R<A.length&&(B+=A.charAt(R++));i[o].v=B,i[o].t="t",E=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(W=r>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=_s(i[o].t,i[o].v,W),i[o].t="t");var C="";for(o=0;o!==i.length;++o)i[o]!=null&&(C+=i[o].v);return C}var UE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function BE(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function $W(n,e){var t=VW(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(UE),a=t[1].match(UE);return BE(e,o)?[r,t[0]]:BE(e,a)?[r,t[1]]:[r,t[o!=null&&a!=null?2:1]]}return[r,s]}function yo(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:un)[n],r==null&&(r=t.table&&t.table[ME[n]]||un[ME[n]]),r==null&&(r=AW[n]||"General");break}if(kd(r,0))return sg(e,t);e instanceof Date&&(e=Tx(e,t.date1904));var i=$W(r,e);if(kd(i[1]))return sg(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return HW(i[1],e,t,i[0])}function Px(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(un[t]==null){e<0&&(e=t);continue}if(un[t]==n){e=t;break}}e<0&&(e=391)}return un[e]=n,e}function Yf(n){for(var e=0;e!=392;++e)n[e]!==void 0&&Px(n[e],e)}function Qf(){un=wW()}var Ox=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function KW(n){var e=typeof n=="number"?un[n]:n;return e=e.replace(Ox,"(\\d+)"),new RegExp("^"+e+"$")}function jW(n,e,t){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(Ox)||[]).forEach(function(f,p){var g=parseInt(t[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:r==-1&&i==-1&&s==-1?u:c+"T"+u}var WW=function(){var n={};n.version="1.2.0";function e(){for(var A=0,w=new Array(256),E=0;E!=256;++E)A=E,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,w[E]=A;return typeof Int32Array<"u"?new Int32Array(w):w}var t=e();function r(A){var w=0,E=0,C=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)I[C]=A[C];for(C=0;C!=256;++C)for(E=A[C],w=256+C;w<4096;w+=256)E=I[w]=E>>>8^A[E&255];var x=[];for(C=1;C!=16;++C)x[C-1]=typeof Int32Array<"u"?I.subarray(C*256,C*256+256):I.slice(C*256,C*256+256);return x}var i=r(t),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],f=i[6],p=i[7],g=i[8],m=i[9],v=i[10],_=i[11],D=i[12],b=i[13],T=i[14];function R(A,w){for(var E=w^-1,C=0,I=A.length;C<I;)E=E>>>8^t[(E^A.charCodeAt(C++))&255];return~E}function B(A,w){for(var E=w^-1,C=A.length-15,I=0;I<C;)E=T[A[I++]^E&255]^b[A[I++]^E>>8&255]^D[A[I++]^E>>16&255]^_[A[I++]^E>>>24]^v[A[I++]]^m[A[I++]]^g[A[I++]]^p[A[I++]]^f[A[I++]]^u[A[I++]]^c[A[I++]]^l[A[I++]]^a[A[I++]]^o[A[I++]]^s[A[I++]]^t[A[I++]];for(C+=15;I<C;)E=E>>>8^t[(E^A[I++])&255];return~E}function W(A,w){for(var E=w^-1,C=0,I=A.length,x=0,P=0;C<I;)x=A.charCodeAt(C++),x<128?E=E>>>8^t[(E^x)&255]:x<2048?(E=E>>>8^t[(E^(192|x>>6&31))&255],E=E>>>8^t[(E^(128|x&63))&255]):x>=55296&&x<57344?(x=(x&1023)+64,P=A.charCodeAt(C++)&1023,E=E>>>8^t[(E^(240|x>>8&7))&255],E=E>>>8^t[(E^(128|x>>2&63))&255],E=E>>>8^t[(E^(128|P>>6&15|(x&3)<<4))&255],E=E>>>8^t[(E^(128|P&63))&255]):(E=E>>>8^t[(E^(224|x>>12&15))&255],E=E>>>8^t[(E^(128|x>>6&63))&255],E=E>>>8^t[(E^(128|x&63))&255]);return~E}return n.table=t,n.bstr=R,n.buf=B,n.str=W,n}(),Vt=function(){var e={};e.version="1.2.1";function t(N,K){for(var U=N.split("/"),V=K.split("/"),j=0,G=0,ue=Math.min(U.length,V.length);j<ue;++j){if(G=U[j].length-V[j].length)return G;if(U[j]!=V[j])return U[j]<V[j]?-1:1}return U.length-V.length}function r(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:r(N.slice(0,-1));var K=N.lastIndexOf("/");return K===-1?N:N.slice(0,K+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var K=N.lastIndexOf("/");return K===-1?N:N.slice(K+1)}function s(N,K){typeof K=="string"&&(K=new Date(K));var U=K.getHours();U=U<<6|K.getMinutes(),U=U<<5|K.getSeconds()>>>1,N.write_shift(2,U);var V=K.getFullYear()-1980;V=V<<4|K.getMonth()+1,V=V<<5|K.getDate(),N.write_shift(2,V)}function o(N){var K=N.read_shift(2)&65535,U=N.read_shift(2)&65535,V=new Date,j=U&31;U>>>=5;var G=U&15;U>>>=4,V.setMilliseconds(0),V.setFullYear(U+1980),V.setMonth(G-1),V.setDate(j);var ue=K&31;K>>>=5;var Ee=K&63;return K>>>=6,V.setHours(K),V.setMinutes(Ee),V.setSeconds(ue<<1),V}function a(N){Hr(N,0);for(var K={},U=0;N.l<=N.length-4;){var V=N.read_shift(2),j=N.read_shift(2),G=N.l+j,ue={};switch(V){case 21589:U=N.read_shift(1),U&1&&(ue.mtime=N.read_shift(4)),j>5&&(U&2&&(ue.atime=N.read_shift(4)),U&4&&(ue.ctime=N.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}N.l=G,K[V]=ue}return K}var l;function c(){return l||(l={})}function u(N,K){if(N[0]==80&&N[1]==75)return Hl(N,K);if((N[0]|32)==109&&(N[1]|32)==105)return Vu(N,K);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var U=3,V=512,j=0,G=0,ue=0,Ee=0,he=0,de=[],pe=N.slice(0,512);Hr(pe,0);var Pe=f(pe);switch(U=Pe[0],U){case 3:V=512;break;case 4:V=4096;break;case 0:if(Pe[1]==0)return Hl(N,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}V!==512&&(pe=N.slice(0,V),Hr(pe,28));var He=N.slice(0,V);p(pe,U);var qe=pe.read_shift(4,"i");if(U===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);pe.l+=4,ue=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Ee=pe.read_shift(4,"i"),j=pe.read_shift(4,"i"),he=pe.read_shift(4,"i"),G=pe.read_shift(4,"i");for(var Le=-1,We=0;We<109&&(Le=pe.read_shift(4,"i"),!(Le<0));++We)de[We]=Le;var at=g(N,V);_(he,G,at,V,de);var $t=b(at,ue,de,V);$t[ue].name="!Directory",j>0&&Ee!==P&&($t[Ee].name="!MiniFAT"),$t[de[0]].name="!FAT",$t.fat_addrs=de,$t.ssz=V;var Ot={},tn=[],Qi=[],xo=[];T(ue,$t,at,tn,j,Ot,Qi,Ee),m(Qi,xo,tn),tn.shift();var Bs={FileIndex:Qi,FullPaths:xo};return K&&K.raw&&(Bs.raw={header:He,sectors:at}),Bs}function f(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(ie,"Header Signature: "),N.l+=16;var K=N.read_shift(2,"u");return[N.read_shift(2,"u"),K]}function p(N,K){var U=9;switch(N.l+=2,U=N.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function g(N,K){for(var U=Math.ceil(N.length/K)-1,V=[],j=1;j<U;++j)V[j-1]=N.slice(j*K,(j+1)*K);return V[U-1]=N.slice(U*K),V}function m(N,K,U){for(var V=0,j=0,G=0,ue=0,Ee=0,he=U.length,de=[],pe=[];V<he;++V)de[V]=pe[V]=V,K[V]=U[V];for(;Ee<pe.length;++Ee)V=pe[Ee],j=N[V].L,G=N[V].R,ue=N[V].C,de[V]===V&&(j!==-1&&de[j]!==j&&(de[V]=de[j]),G!==-1&&de[G]!==G&&(de[V]=de[G])),ue!==-1&&(de[ue]=V),j!==-1&&V!=de[V]&&(de[j]=de[V],pe.lastIndexOf(j)<Ee&&pe.push(j)),G!==-1&&V!=de[V]&&(de[G]=de[V],pe.lastIndexOf(G)<Ee&&pe.push(G));for(V=1;V<he;++V)de[V]===V&&(G!==-1&&de[G]!==G?de[V]=de[G]:j!==-1&&de[j]!==j&&(de[V]=de[j]));for(V=1;V<he;++V)if(N[V].type!==0){if(Ee=V,Ee!=de[Ee])do Ee=de[Ee],K[V]=K[Ee]+"/"+K[V];while(Ee!==0&&de[Ee]!==-1&&Ee!=de[Ee]);de[V]=-1}for(K[0]+="/",V=1;V<he;++V)N[V].type!==2&&(K[V]+="/")}function v(N,K,U){for(var V=N.start,j=N.size,G=[],ue=V;U&&j>0&&ue>=0;)G.push(K.slice(ue*x,ue*x+x)),j-=x,ue=Do(U,ue*4);return G.length===0?we(0):Gn(G).slice(0,N.size)}function _(N,K,U,V,j){var G=P;if(N===P){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ue=U[N],Ee=(V>>>2)-1;if(!ue)return;for(var he=0;he<Ee&&(G=Do(ue,he*4))!==P;++he)j.push(G);_(Do(ue,V-4),K-1,U,V,j)}}function D(N,K,U,V,j){var G=[],ue=[];j||(j=[]);var Ee=V-1,he=0,de=0;for(he=K;he>=0;){j[he]=!0,G[G.length]=he,ue.push(N[he]);var pe=U[Math.floor(he*4/V)];if(de=he*4&Ee,V<4+de)throw new Error("FAT boundary crossed: "+he+" 4 "+V);if(!N[pe])break;he=Do(N[pe],de)}return{nodes:G,data:qE([ue])}}function b(N,K,U,V){var j=N.length,G=[],ue=[],Ee=[],he=[],de=V-1,pe=0,Pe=0,He=0,qe=0;for(pe=0;pe<j;++pe)if(Ee=[],He=pe+K,He>=j&&(He-=j),!ue[He]){he=[];var Le=[];for(Pe=He;Pe>=0;){Le[Pe]=!0,ue[Pe]=!0,Ee[Ee.length]=Pe,he.push(N[Pe]);var We=U[Math.floor(Pe*4/V)];if(qe=Pe*4&de,V<4+qe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+V);if(!N[We]||(Pe=Do(N[We],qe),Le[Pe]))break}G[He]={nodes:Ee,data:qE([he])}}return G}function T(N,K,U,V,j,G,ue,Ee){for(var he=0,de=V.length?2:0,pe=K[N].data,Pe=0,He=0,qe;Pe<pe.length;Pe+=128){var Le=pe.slice(Pe,Pe+128);Hr(Le,64),He=Le.read_shift(2),qe=Sv(Le,0,He-de),V.push(qe);var We={name:qe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},at=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);at!==0&&(We.ct=R(Le,Le.l-8));var $t=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);$t!==0&&(We.mt=R(Le,Le.l-8)),We.start=Le.read_shift(4,"i"),We.size=Le.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=P,We.name=""),We.type===5?(he=We.start,j>0&&he!==P&&(K[he].name="!StreamData")):We.size>=4096?(We.storage="fat",K[We.start]===void 0&&(K[We.start]=D(U,We.start,K.fat_addrs,K.ssz)),K[We.start].name=We.name,We.content=K[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:he!==P&&We.start!==P&&K[he]&&(We.content=v(We,K[he].data,(K[Ee]||{}).data))),We.content&&Hr(We.content,0),G[qe]=We,ue.push(We)}}function R(N,K){return new Date((jr(N,K+4)/1e7*Math.pow(2,32)+jr(N,K)/1e7-11644473600)*1e3)}function B(N,K){return c(),u(l.readFileSync(N),K)}function W(N,K){var U=K&&K.type;switch(U||bt&&Buffer.isBuffer(N)&&(U="buffer"),U||"base64"){case"file":return B(N,K);case"base64":return u(ci(ks(N)),K);case"binary":return u(ci(N),K)}return u(N,K)}function A(N,K){var U=K||{},V=U.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=V+"/",N.FileIndex[0]={name:V,type:5}),U.CLSID&&(N.FileIndex[0].clsid=U.CLSID),w(N)}function w(N){var K="Sh33tJ5";if(!Vt.find(N,"/"+K)){var U=we(4);U[0]=55,U[1]=U[3]=50,U[2]=54,N.FileIndex.push({name:K,type:2,content:U,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+K),E(N)}}function E(N,K){A(N);for(var U=!1,V=!1,j=N.FullPaths.length-1;j>=0;--j){var G=N.FileIndex[j];switch(G.type){case 0:V?U=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(G.R*G.L*G.C)&&(U=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!K)){var ue=new Date(1987,1,19),Ee=0,he=Object.create?Object.create(null):{},de=[];for(j=0;j<N.FullPaths.length;++j)he[N.FullPaths[j]]=!0,N.FileIndex[j].type!==0&&de.push([N.FullPaths[j],N.FileIndex[j]]);for(j=0;j<de.length;++j){var pe=r(de[j][0]);V=he[pe],V||(de.push([pe,{name:i(pe).replace("/",""),type:1,clsid:ae,ct:ue,mt:ue,content:null}]),he[pe]=!0)}for(de.sort(function(qe,Le){return t(qe[0],Le[0])}),N.FullPaths=[],N.FileIndex=[],j=0;j<de.length;++j)N.FullPaths[j]=de[j][0],N.FileIndex[j]=de[j][1];for(j=0;j<de.length;++j){var Pe=N.FileIndex[j],He=N.FullPaths[j];if(Pe.name=i(He).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||ae,j===0)Pe.C=de.length>1?1:-1,Pe.size=0,Pe.type=5;else if(He.slice(-1)=="/"){for(Ee=j+1;Ee<de.length&&r(N.FullPaths[Ee])!=He;++Ee);for(Pe.C=Ee>=de.length?-1:Ee,Ee=j+1;Ee<de.length&&r(N.FullPaths[Ee])!=r(He);++Ee);Pe.R=Ee>=de.length?-1:Ee,Pe.type=1}else r(N.FullPaths[j+1]||"")==r(He)&&(Pe.R=j+1),Pe.type=2}}}function C(N,K){var U=K||{};if(U.fileType=="mad")return Bn(N,U);switch(E(N),U.fileType){case"zip":return $l(N,U)}var V=function(qe){for(var Le=0,We=0,at=0;at<qe.FileIndex.length;++at){var $t=qe.FileIndex[at];if($t.content){var Ot=$t.content.length;Ot>0&&(Ot<4096?Le+=Ot+63>>6:We+=Ot+511>>9)}}for(var tn=qe.FullPaths.length+3>>2,Qi=Le+7>>3,xo=Le+127>>7,Bs=Qi+We+tn+xo,Ai=Bs+127>>7,Ea=Ai<=109?0:Math.ceil((Ai-109)/127);Bs+Ai+Ea+127>>7>Ai;)Ea=++Ai<=109?0:Math.ceil((Ai-109)/127);var Mr=[1,Ea,Ai,xo,tn,We,Le,0];return qe.FileIndex[0].size=Le<<6,Mr[7]=(qe.FileIndex[0].start=Mr[0]+Mr[1]+Mr[2]+Mr[3]+Mr[4]+Mr[5])+(Mr[6]+7>>3),Mr}(N),j=we(V[7]<<9),G=0,ue=0;{for(G=0;G<8;++G)j.write_shift(1,Q[G]);for(G=0;G<8;++G)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),G=0;G<3;++G)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,V[2]),j.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:P),j.write_shift(4,V[3]),j.write_shift(-4,V[1]?V[0]-1:P),j.write_shift(4,V[1]),G=0;G<109;++G)j.write_shift(-4,G<V[2]?V[1]+G:-1)}if(V[1])for(ue=0;ue<V[1];++ue){for(;G<236+ue*127;++G)j.write_shift(-4,G<V[2]?V[1]+G:-1);j.write_shift(-4,ue===V[1]-1?P:ue+1)}var Ee=function(qe){for(ue+=qe;G<ue-1;++G)j.write_shift(-4,G+1);qe&&(++G,j.write_shift(-4,P))};for(ue=G=0,ue+=V[1];G<ue;++G)j.write_shift(-4,Ae.DIFSECT);for(ue+=V[2];G<ue;++G)j.write_shift(-4,Ae.FATSECT);Ee(V[3]),Ee(V[4]);for(var he=0,de=0,pe=N.FileIndex[0];he<N.FileIndex.length;++he)pe=N.FileIndex[he],pe.content&&(de=pe.content.length,!(de<4096)&&(pe.start=ue,Ee(de+511>>9)));for(Ee(V[6]+7>>3);j.l&511;)j.write_shift(-4,Ae.ENDOFCHAIN);for(ue=G=0,he=0;he<N.FileIndex.length;++he)pe=N.FileIndex[he],pe.content&&(de=pe.content.length,!(!de||de>=4096)&&(pe.start=ue,Ee(de+63>>6)));for(;j.l&511;)j.write_shift(-4,Ae.ENDOFCHAIN);for(G=0;G<V[4]<<2;++G){var Pe=N.FullPaths[G];if(!Pe||Pe.length===0){for(he=0;he<17;++he)j.write_shift(4,0);for(he=0;he<3;++he)j.write_shift(4,-1);for(he=0;he<12;++he)j.write_shift(4,0);continue}pe=N.FileIndex[G],G===0&&(pe.start=pe.size?pe.start-1:P);var He=G===0&&U.root||pe.name;if(de=2*(He.length+1),j.write_shift(64,He,"utf16le"),j.write_shift(2,de),j.write_shift(1,pe.type),j.write_shift(1,pe.color),j.write_shift(-4,pe.L),j.write_shift(-4,pe.R),j.write_shift(-4,pe.C),pe.clsid)j.write_shift(16,pe.clsid,"hex");else for(he=0;he<4;++he)j.write_shift(4,0);j.write_shift(4,pe.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,pe.start),j.write_shift(4,pe.size),j.write_shift(4,0)}for(G=1;G<N.FileIndex.length;++G)if(pe=N.FileIndex[G],pe.size>=4096)if(j.l=pe.start+1<<9,bt&&Buffer.isBuffer(pe.content))pe.content.copy(j,j.l,0,pe.size),j.l+=pe.size+511&-512;else{for(he=0;he<pe.size;++he)j.write_shift(1,pe.content[he]);for(;he&511;++he)j.write_shift(1,0)}for(G=1;G<N.FileIndex.length;++G)if(pe=N.FileIndex[G],pe.size>0&&pe.size<4096)if(bt&&Buffer.isBuffer(pe.content))pe.content.copy(j,j.l,0,pe.size),j.l+=pe.size+63&-64;else{for(he=0;he<pe.size;++he)j.write_shift(1,pe.content[he]);for(;he&63;++he)j.write_shift(1,0)}if(bt)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function I(N,K){var U=N.FullPaths.map(function(he){return he.toUpperCase()}),V=U.map(function(he){var de=he.split("/");return de[de.length-(he.slice(-1)=="/"?2:1)]}),j=!1;K.charCodeAt(0)===47?(j=!0,K=U[0].slice(0,-1)+K):j=K.indexOf("/")!==-1;var G=K.toUpperCase(),ue=j===!0?U.indexOf(G):V.indexOf(G);if(ue!==-1)return N.FileIndex[ue];var Ee=!G.match(yh);for(G=G.replace(Rc,""),Ee&&(G=G.replace(yh,"!")),ue=0;ue<U.length;++ue)if((Ee?U[ue].replace(yh,"!"):U[ue]).replace(Rc,"")==G||(Ee?V[ue].replace(yh,"!"):V[ue]).replace(Rc,"")==G)return N.FileIndex[ue];return null}var x=64,P=-2,ie="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Oe(N,K,U){c();var V=C(N,U);l.writeFileSync(K,V)}function Ce(N){for(var K=new Array(N.length),U=0;U<N.length;++U)K[U]=String.fromCharCode(N[U]);return K.join("")}function fe(N,K){var U=C(N,K);switch(K&&K.type||"buffer"){case"file":return c(),l.writeFileSync(K.filename,U),U;case"binary":return typeof U=="string"?U:Ce(U);case"base64":return Xc(typeof U=="string"?U:Ce(U));case"buffer":if(bt)return Buffer.isBuffer(U)?U:Fs(U);case"array":return typeof U=="string"?ci(U):U}return U}var F;function O(N){try{var K=N.InflateRaw,U=new K;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)F=N;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function Z(N,K){if(!F)return qi(N,K);var U=F.InflateRaw,V=new U,j=V._processChunk(N.slice(N.l),V._finishFlushFlag);return N.l+=V.bytesRead,j}function q(N){return F?F.deflateRawSync(N):mn(N)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(N){var K=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(K>>16|K>>8|K)&255}for(var se=typeof Uint8Array<"u",H=se?new Uint8Array(256):[],J=0;J<256;++J)H[J]=ve(J);function k(N,K){var U=H[N&255];return K<=8?U>>>8-K:(U=U<<8|H[N>>8&255],K<=16?U>>>16-K:(U=U<<8|H[N>>16&255],U>>>24-K))}function L(N,K){var U=K&7,V=K>>>3;return(N[V]|(U<=6?0:N[V+1]<<8))>>>U&3}function z(N,K){var U=K&7,V=K>>>3;return(N[V]|(U<=5?0:N[V+1]<<8))>>>U&7}function ge(N,K){var U=K&7,V=K>>>3;return(N[V]|(U<=4?0:N[V+1]<<8))>>>U&15}function ye(N,K){var U=K&7,V=K>>>3;return(N[V]|(U<=3?0:N[V+1]<<8))>>>U&31}function re(N,K){var U=K&7,V=K>>>3;return(N[V]|(U<=1?0:N[V+1]<<8))>>>U&127}function Me(N,K,U){var V=K&7,j=K>>>3,G=(1<<U)-1,ue=N[j]>>>V;return U<8-V||(ue|=N[j+1]<<8-V,U<16-V)||(ue|=N[j+2]<<16-V,U<24-V)||(ue|=N[j+3]<<24-V),ue&G}function Fe(N,K,U){var V=K&7,j=K>>>3;return V<=5?N[j]|=(U&7)<<V:(N[j]|=U<<V&255,N[j+1]=(U&7)>>8-V),K+3}function De(N,K,U){var V=K&7,j=K>>>3;return U=(U&1)<<V,N[j]|=U,K+1}function Re(N,K,U){var V=K&7,j=K>>>3;return U<<=V,N[j]|=U&255,U>>>=8,N[j+1]=U,K+8}function Je(N,K,U){var V=K&7,j=K>>>3;return U<<=V,N[j]|=U&255,U>>>=8,N[j+1]=U&255,N[j+2]=U>>>8,K+16}function je(N,K){var U=N.length,V=2*U>K?2*U:K+5,j=0;if(U>=K)return N;if(bt){var G=OE(V);if(N.copy)N.copy(G);else for(;j<N.length;++j)G[j]=N[j];return G}else if(se){var ue=new Uint8Array(V);if(ue.set)ue.set(N);else for(;j<U;++j)ue[j]=N[j];return ue}return N.length=V,N}function Ye(N){for(var K=new Array(N),U=0;U<N;++U)K[U]=0;return K}function nt(N,K,U){var V=1,j=0,G=0,ue=0,Ee=0,he=N.length,de=se?new Uint16Array(32):Ye(32);for(G=0;G<32;++G)de[G]=0;for(G=he;G<U;++G)N[G]=0;he=N.length;var pe=se?new Uint16Array(he):Ye(he);for(G=0;G<he;++G)de[j=N[G]]++,V<j&&(V=j),pe[G]=0;for(de[0]=0,G=1;G<=V;++G)de[G+16]=Ee=Ee+de[G-1]<<1;for(G=0;G<he;++G)Ee=N[G],Ee!=0&&(pe[G]=de[Ee+16]++);var Pe=0;for(G=0;G<he;++G)if(Pe=N[G],Pe!=0)for(Ee=k(pe[G],V)>>V-Pe,ue=(1<<V+4-Pe)-1;ue>=0;--ue)K[Ee|ue<<Pe]=Pe&15|G<<4;return V}var Ze=se?new Uint16Array(512):Ye(512),ot=se?new Uint16Array(32):Ye(32);if(!se){for(var pt=0;pt<512;++pt)Ze[pt]=0;for(pt=0;pt<32;++pt)ot[pt]=0}(function(){for(var N=[],K=0;K<32;K++)N.push(5);nt(N,ot,32);var U=[];for(K=0;K<=143;K++)U.push(8);for(;K<=255;K++)U.push(9);for(;K<=279;K++)U.push(7);for(;K<=287;K++)U.push(8);nt(U,Ze,288)})();var Cn=function(){for(var K=se?new Uint8Array(32768):[],U=0,V=0;U<ne.length-1;++U)for(;V<ne[U+1];++V)K[V]=U;for(;V<32768;++V)K[V]=29;var j=se?new Uint8Array(259):[];for(U=0,V=0;U<ce.length-1;++U)for(;V<ce[U+1];++V)j[V]=U;function G(Ee,he){for(var de=0;de<Ee.length;){var pe=Math.min(65535,Ee.length-de),Pe=de+pe==Ee.length;for(he.write_shift(1,+Pe),he.write_shift(2,pe),he.write_shift(2,~pe&65535);pe-- >0;)he[he.l++]=Ee[de++]}return he.l}function ue(Ee,he){for(var de=0,pe=0,Pe=se?new Uint16Array(32768):[];pe<Ee.length;){var He=Math.min(65535,Ee.length-pe);if(He<10){for(de=Fe(he,de,+(pe+He==Ee.length)),de&7&&(de+=8-(de&7)),he.l=de/8|0,he.write_shift(2,He),he.write_shift(2,~He&65535);He-- >0;)he[he.l++]=Ee[pe++];de=he.l*8;continue}de=Fe(he,de,+(pe+He==Ee.length)+2);for(var qe=0;He-- >0;){var Le=Ee[pe];qe=(qe<<5^Le)&32767;var We=-1,at=0;if((We=Pe[qe])&&(We|=pe&-32768,We>pe&&(We-=32768),We<pe))for(;Ee[We+at]==Ee[pe+at]&&at<250;)++at;if(at>2){Le=j[at],Le<=22?de=Re(he,de,H[Le+1]>>1)-1:(Re(he,de,3),de+=5,Re(he,de,H[Le-23]>>5),de+=3);var $t=Le<8?0:Le-4>>2;$t>0&&(Je(he,de,at-ce[Le]),de+=$t),Le=K[pe-We],de=Re(he,de,H[Le]>>3),de-=3;var Ot=Le<4?0:Le-2>>1;Ot>0&&(Je(he,de,pe-We-ne[Le]),de+=Ot);for(var tn=0;tn<at;++tn)Pe[qe]=pe&32767,qe=(qe<<5^Ee[pe])&32767,++pe;He-=at-1}else Le<=143?Le=Le+48:de=De(he,de,1),de=Re(he,de,H[Le]),Pe[qe]=pe&32767,++pe}de=Re(he,de,0)-1}return he.l=(de+7)/8|0,he.l}return function(he,de){return he.length<8?G(he,de):ue(he,de)}}();function mn(N){var K=we(50+Math.floor(N.length*1.1)),U=Cn(N,K);return K.slice(0,U)}var pr=se?new Uint16Array(32768):Ye(32768),Sn=se?new Uint16Array(32768):Ye(32768),ii=se?new Uint16Array(128):Ye(128),Ls=1,vn=1;function Sr(N,K){var U=ye(N,K)+257;K+=5;var V=ye(N,K)+1;K+=5;var j=ge(N,K)+4;K+=4;for(var G=0,ue=se?new Uint8Array(19):Ye(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,de=se?new Uint8Array(8):Ye(8),pe=se?new Uint8Array(8):Ye(8),Pe=ue.length,He=0;He<j;++He)ue[X[He]]=G=z(N,K),he<G&&(he=G),de[G]++,K+=3;var qe=0;for(de[0]=0,He=1;He<=he;++He)pe[He]=qe=qe+de[He-1]<<1;for(He=0;He<Pe;++He)(qe=ue[He])!=0&&(Ee[He]=pe[qe]++);var Le=0;for(He=0;He<Pe;++He)if(Le=ue[He],Le!=0){qe=H[Ee[He]]>>8-Le;for(var We=(1<<7-Le)-1;We>=0;--We)ii[qe|We<<Le]=Le&7|He<<3}var at=[];for(he=1;at.length<U+V;)switch(qe=ii[re(N,K)],K+=qe&7,qe>>>=3){case 16:for(G=3+L(N,K),K+=2,qe=at[at.length-1];G-- >0;)at.push(qe);break;case 17:for(G=3+z(N,K),K+=3;G-- >0;)at.push(0);break;case 18:for(G=11+re(N,K),K+=7;G-- >0;)at.push(0);break;default:at.push(qe),he<qe&&(he=qe);break}var $t=at.slice(0,U),Ot=at.slice(U);for(He=U;He<286;++He)$t[He]=0;for(He=V;He<30;++He)Ot[He]=0;return Ls=nt($t,pr,286),vn=nt(Ot,Sn,30),K}function _a(N,K){if(N[0]==3&&!(N[1]&3))return[ia(K),2];for(var U=0,V=0,j=OE(K||1<<18),G=0,ue=j.length>>>0,Ee=0,he=0;!(V&1);){if(V=z(N,U),U+=3,V>>>1)V>>1==1?(Ee=9,he=5):(U=Sr(N,U),Ee=Ls,he=vn);else{U&7&&(U+=8-(U&7));var de=N[U>>>3]|N[(U>>>3)+1]<<8;if(U+=32,de>0)for(!K&&ue<G+de&&(j=je(j,G+de),ue=j.length);de-- >0;)j[G++]=N[U>>>3],U+=8;continue}for(;;){!K&&ue<G+32767&&(j=je(j,G+32767),ue=j.length);var pe=Me(N,U,Ee),Pe=V>>>1==1?Ze[pe]:pr[pe];if(U+=Pe&15,Pe>>>=4,!(Pe>>>8&255))j[G++]=Pe;else{if(Pe==256)break;Pe-=257;var He=Pe<8?0:Pe-4>>2;He>5&&(He=0);var qe=G+ce[Pe];He>0&&(qe+=Me(N,U,He),U+=He),pe=Me(N,U,he),Pe=V>>>1==1?ot[pe]:Sn[pe],U+=Pe&15,Pe>>>=4;var Le=Pe<4?0:Pe-2>>1,We=ne[Pe];for(Le>0&&(We+=Me(N,U,Le),U+=Le),!K&&ue<qe&&(j=je(j,qe+100),ue=j.length);G<qe;)j[G]=j[G-We],++G}}}return K?[j,U+7>>>3]:[j.slice(0,G),U+7>>>3]}function qi(N,K){var U=N.slice(N.l||0),V=_a(U,K);return N.l+=V[1],V[0]}function Vl(N,K){if(N)typeof console<"u"&&console.error(K);else throw new Error(K)}function Hl(N,K){var U=N;Hr(U,0);var V=[],j=[],G={FileIndex:V,FullPaths:j};A(G,{root:K.root});for(var ue=U.length-4;(U[ue]!=80||U[ue+1]!=75||U[ue+2]!=5||U[ue+3]!=6)&&ue>=0;)--ue;U.l=ue+4,U.l+=4;var Ee=U.read_shift(2);U.l+=6;var he=U.read_shift(4);for(U.l=he,ue=0;ue<Ee;++ue){U.l+=20;var de=U.read_shift(4),pe=U.read_shift(4),Pe=U.read_shift(2),He=U.read_shift(2),qe=U.read_shift(2);U.l+=8;var Le=U.read_shift(4),We=a(U.slice(U.l+Pe,U.l+Pe+He));U.l+=Pe+He+qe;var at=U.l;U.l=Le+4,Co(U,de,pe,G,We),U.l=at}return G}function Co(N,K,U,V,j){N.l+=2;var G=N.read_shift(2),ue=N.read_shift(2),Ee=o(N);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var he=N.read_shift(4),de=N.read_shift(4),pe=N.read_shift(4),Pe=N.read_shift(2),He=N.read_shift(2),qe="",Le=0;Le<Pe;++Le)qe+=String.fromCharCode(N[N.l++]);if(He){var We=a(N.slice(N.l,N.l+He));(We[21589]||{}).mt&&(Ee=We[21589].mt),((j||{})[21589]||{}).mt&&(Ee=j[21589].mt)}N.l+=He;var at=N.slice(N.l,N.l+de);switch(ue){case 8:at=Z(N,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var $t=!1;G&8&&(he=N.read_shift(4),he==134695760&&(he=N.read_shift(4),$t=!0),de=N.read_shift(4),pe=N.read_shift(4)),de!=K&&Vl($t,"Bad compressed size: "+K+" != "+de),pe!=U&&Vl($t,"Bad uncompressed size: "+U+" != "+pe),Yi(V,qe,at,{unsafe:!0,mt:Ee})}function $l(N,K){var U=K||{},V=[],j=[],G=we(1),ue=U.compression?8:0,Ee=0,he=0,de=0,pe=0,Pe=0,He=N.FullPaths[0],qe=He,Le=N.FileIndex[0],We=[],at=0;for(he=1;he<N.FullPaths.length;++he)if(qe=N.FullPaths[he].slice(He.length),Le=N.FileIndex[he],!(!Le.size||!Le.content||qe=="Sh33tJ5")){var $t=pe,Ot=we(qe.length);for(de=0;de<qe.length;++de)Ot.write_shift(1,qe.charCodeAt(de)&127);Ot=Ot.slice(0,Ot.l),We[Pe]=WW.buf(Le.content,0);var tn=Le.content;ue==8&&(tn=q(tn)),G=we(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,Ee),G.write_shift(2,ue),Le.mt?s(G,Le.mt):G.write_shift(4,0),G.write_shift(-4,We[Pe]),G.write_shift(4,tn.length),G.write_shift(4,Le.content.length),G.write_shift(2,Ot.length),G.write_shift(2,0),pe+=G.length,V.push(G),pe+=Ot.length,V.push(Ot),pe+=tn.length,V.push(tn),G=we(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,Ee),G.write_shift(2,ue),G.write_shift(4,0),G.write_shift(-4,We[Pe]),G.write_shift(4,tn.length),G.write_shift(4,Le.content.length),G.write_shift(2,Ot.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,$t),at+=G.l,j.push(G),at+=Ot.length,j.push(Ot),++Pe}return G=we(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,Pe),G.write_shift(2,Pe),G.write_shift(4,at),G.write_shift(4,pe),G.write_shift(2,0),Gn([Gn(V),Gn(j),G])}var Us={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zi(N,K){if(N.ctype)return N.ctype;var U=N.name||"",V=U.match(/\.([^\.]+)$/);return V&&Us[V[1]]||K&&(V=(U=K).match(/[\.\\]([^\.\\])+$/),V&&Us[V[1]])?Us[V[1]]:"application/octet-stream"}function Uu(N){for(var K=Xc(N),U=[],V=0;V<K.length;V+=76)U.push(K.slice(V,V+76));return U.join(`\r
`)+`\r
`}function ya(N){var K=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var pe=de.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],V=K.split(`\r
`),j=0;j<V.length;++j){var G=V[j];if(G.length==0){U.push("");continue}for(var ue=0;ue<G.length;){var Ee=76,he=G.slice(ue,ue+Ee);he.charAt(Ee-1)=="="?Ee--:he.charAt(Ee-2)=="="?Ee-=2:he.charAt(Ee-3)=="="&&(Ee-=3),he=G.slice(ue,ue+Ee),ue+=Ee,ue<G.length&&(he+="="),U.push(he)}}return U.join(`\r
`)}function Bu(N){for(var K=[],U=0;U<N.length;++U){for(var V=N[U];U<=N.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+N[++U];K.push(V)}for(var j=0;j<K.length;++j)K[j]=K[j].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return ci(K.join(`\r
`))}function So(N,K,U){for(var V="",j="",G="",ue,Ee=0;Ee<10;++Ee){var he=K[Ee];if(!he||he.match(/^\s*$/))break;var de=he.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":V=de[2].trim();break;case"content-type":G=de[2].trim();break;case"content-transfer-encoding":j=de[2].trim();break}}switch(++Ee,j.toLowerCase()){case"base64":ue=ci(ks(K.slice(Ee).join("")));break;case"quoted-printable":ue=Bu(K.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var pe=Yi(N,V.slice(U.length),ue,{unsafe:!0});G&&(pe.ctype=G)}function Vu(N,K){if(Ce(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=K&&K.root||"",V=(bt&&Buffer.isBuffer(N)?N.toString("binary"):Ce(N)).split(`\r
`),j=0,G="";for(j=0;j<V.length;++j)if(G=V[j],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),U||(U=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),G.slice(0,U.length)!=U););var ue=(V[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var Ee="--"+(ue[1]||""),he=[],de=[],pe={FileIndex:he,FullPaths:de};A(pe);var Pe,He=0;for(j=0;j<V.length;++j){var qe=V[j];qe!==Ee&&qe!==Ee+"--"||(He++&&So(pe,V.slice(Pe,j),U),Pe=j)}return pe}function Bn(N,K){var U=K||{},V=U.boundary||"SheetJS";V="------="+V;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],G=N.FullPaths[0],ue=G,Ee=N.FileIndex[0],he=1;he<N.FullPaths.length;++he)if(ue=N.FullPaths[he].slice(G.length),Ee=N.FileIndex[he],!(!Ee.size||!Ee.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var de=Ee.content,pe=bt&&Buffer.isBuffer(de)?de.toString("binary"):Ce(de),Pe=0,He=Math.min(1024,pe.length),qe=0,Le=0;Le<=He;++Le)(qe=pe.charCodeAt(Le))>=32&&qe<128&&++Pe;var We=Pe>=He*4/5;j.push(V),j.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+ue),j.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),j.push("Content-Type: "+zi(Ee,ue)),j.push(""),j.push(We?ya(pe):Uu(pe))}return j.push(V+`--\r
`),j.join(`\r
`)}function Hu(N){var K={};return A(K,N),K}function Yi(N,K,U,V){var j=V&&V.unsafe;j||A(N);var G=!j&&Vt.find(N,K);if(!G){var ue=N.FullPaths[0];K.slice(0,ue.length)==ue?ue=K:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+K).replace("//","/")),G={name:i(K),type:2},N.FileIndex.push(G),N.FullPaths.push(ue),j||Vt.utils.cfb_gc(N)}return G.content=U,G.size=U?U.length:0,V&&(V.CLSID&&(G.clsid=V.CLSID),V.mt&&(G.mt=V.mt),V.ct&&(G.ct=V.ct)),G}function Io(N,K){A(N);var U=Vt.find(N,K);if(U){for(var V=0;V<N.FileIndex.length;++V)if(N.FileIndex[V]==U)return N.FileIndex.splice(V,1),N.FullPaths.splice(V,1),!0}return!1}function np(N,K,U){A(N);var V=Vt.find(N,K);if(V){for(var j=0;j<N.FileIndex.length;++j)if(N.FileIndex[j]==V)return N.FileIndex[j].name=i(U),N.FullPaths[j]=U,!0}return!1}function rp(N){E(N,!0)}return e.find=I,e.read=W,e.parse=u,e.write=fe,e.writeFile=Oe,e.utils={cfb_new:Hu,cfb_add:Yi,cfb_del:Io,cfb_mov:np,cfb_gc:rp,ReadShift:kc,CheckField:Qx,prep_blob:Hr,bconcat:Gn,use_zlib:O,_deflateRaw:mn,_inflateRaw:qi,consts:Ae},e}();function GW(n){return typeof n=="string"?zf(n):Array.isArray(n)?_W(n):n}function Nu(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=zf(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?Zc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([GW(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=n,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(n);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=Ou(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Xn(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function VE(n,e){for(var t=[],r=Xn(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function Tv(n){for(var e=[],t=Xn(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function Xf(n){for(var e=[],t=Xn(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function qW(n){for(var e=[],t=Xn(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var Od=new Date(1899,11,30,0,0,0);function Or(n,e){var t=n.getTime(),r=Od.getTime()+(n.getTimezoneOffset()-Od.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var Nx=new Date,zW=Od.getTime()+(Nx.getTimezoneOffset()-Od.getTimezoneOffset())*6e4,HE=Nx.getTimezoneOffset();function Dx(n){var e=new Date;return e.setTime(n*24*60*60*1e3+zW),e.getTimezoneOffset()!==HE&&e.setTime(e.getTime()+(e.getTimezoneOffset()-HE)*6e4),e}var $E=new Date("2017-02-19T19:06:09.000Z"),Mx=isNaN($E.getFullYear())?new Date("2/19/17"):$E,YW=Mx.getFullYear()==2017;function Ar(n,e){var t=new Date(n);if(YW)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(Mx.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Jf(n,e){if(bt&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Nr(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Nr(n[t]));return e}function ln(n,e){for(var t="";t.length<e;)t+=n;return t}function ys(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var QW=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jc(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var o=n.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&QW.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function mt(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return bt?r=Fs(t):r=yW(t),Vt.utils.cfb_add(n,e,r)}Vt.utils.cfb_add(n,e,t)}else n.file(e,t)}function wv(){return Vt.utils.cfb_new()}var An=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,XW={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Av=Tv(XW),Cv=/[&<>'"]/g,JW=/[\u0000-\u0008\u000b-\u001f]/g;function Lt(n){var e=n+"";return e.replace(Cv,function(t){return Av[t]}).replace(JW,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function KE(n){return Lt(n).replace(/ /g,"_x0020_")}var Fx=/[\u0000-\u001f]/g;function ZW(n){var e=n+"";return e.replace(Cv,function(t){return Av[t]}).replace(/\n/g,"<br/>").replace(Fx,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function eG(n){var e=n+"";return e.replace(Cv,function(t){return Av[t]}).replace(Fx,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function tG(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function nG(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wp(n){for(var e="",t=0,r=0,i=0,s=0,o=0,a=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){o=(r&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=n.charCodeAt(t++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function jE(n){var e=ia(2*n.length),t,r,i=1,s=0,o=0,a;for(r=0;r<n.length;r+=i)i=1,(a=n.charCodeAt(r))<128?t=a:a<224?(t=(a&31)*64+(n.charCodeAt(r+1)&63),i=2):a<240?(t=(a&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(a&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function WE(n){return Fs(n,"binary").toString("utf8")}var Th="foo bar baz",bc=bt&&(WE(Th)==Wp(Th)&&WE||jE(Th)==Wp(Th)&&jE)||Wp,Zc=bt?function(n){return Fs(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},rG=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}}(),Lx=/(^\s|\s$|\n)/;function qn(n,e){return"<"+n+(e.match(Lx)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function eu(n){return Xn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function Ue(n,e,t){return"<"+n+(t!=null?eu(t):"")+(e!=null?(e.match(Lx)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function og(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function iG(n,e){switch(typeof n){case"string":var t=Ue("vt:lpwstr",Lt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ue((n|0)==n?"vt:i4":"vt:r8",Lt(String(n)));case"boolean":return Ue("vt:bool",n?"true":"false")}if(n instanceof Date)return Ue("vt:filetime",og(n));throw new Error("Unable to serialize "+n)}var Dn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function sG(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function oG(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=r?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)n[t+a]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var GE=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},qE=bt?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Fs(e)})):GE(n)}:GE,zE=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(ac(n,i)));return r.join("").replace(Rc,"")},Sv=bt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Rc,""):zE(n,e,t)}:zE,YE=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},Ux=bt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):YE(n,e,t)}:YE,QE=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Ba(n,i)));return r.join("")},Du=bt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):QE(e,t,r)}:QE,Bx=function(n,e){var t=jr(n,e);return t>0?Du(n,e+4,e+4+t-1):""},Vx=Bx,Hx=function(n,e){var t=jr(n,e);return t>0?Du(n,e+4,e+4+t-1):""},$x=Hx,Kx=function(n,e){var t=2*jr(n,e);return t>0?Du(n,e+4,e+4+t-1):""},jx=Kx,Wx=function(e,t){var r=jr(e,t);return r>0?Sv(e,t+4,t+4+r):""},Gx=Wx,qx=function(n,e){var t=jr(n,e);return t>0?Du(n,e+4,e+4+t):""},zx=qx,Yx=function(n,e){return sG(n,e)},Nd=Yx,Iv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};bt&&(Vx=function(e,t){if(!Buffer.isBuffer(e))return Bx(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},$x=function(e,t){if(!Buffer.isBuffer(e))return Hx(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},jx=function(e,t){if(!Buffer.isBuffer(e))return Kx(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Gx=function(e,t){if(!Buffer.isBuffer(e))return Wx(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},zx=function(e,t){if(!Buffer.isBuffer(e))return qx(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Nd=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Yx(e,t)},Iv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ba=function(n,e){return n[e]},ac=function(n,e){return n[e+1]*256+n[e]},aG=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},jr=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Do=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},lG=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function kc(n,e){var t="",r,i,s=[],o,a,l,c;switch(e){case"dbcs":if(c=this.l,bt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(ac(this,c)),c+=2;n*=2;break;case"utf8":t=Du(this,this.l,this.l+n);break;case"utf16le":n*=2,t=Sv(this,this.l,this.l+n);break;case"wstr":return kc.call(this,n,"dbcs");case"lpstr-ansi":t=Vx(this,this.l),n=4+jr(this,this.l);break;case"lpstr-cp":t=$x(this,this.l),n=4+jr(this,this.l);break;case"lpwstr":t=jx(this,this.l),n=4+2*jr(this,this.l);break;case"lpp4":n=4+jr(this,this.l),t=Gx(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+jr(this,this.l),t=zx(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(o=Ba(this,this.l+n++))!==0;)s.push(_h(o));t=s.join("");break;case"_wstr":for(n=0,t="";(o=ac(this,this.l+n))!==0;)s.push(_h(o)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Ba(this,c),this.l=c+1,a=kc.call(this,n-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(_h(ac(this,c))),c+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Ba(this,c),this.l=c+1,a=kc.call(this,n-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(_h(Ba(this,c))),c+=1}t=s.join("");break;default:switch(n){case 1:return r=Ba(this,this.l),this.l++,r;case 2:return r=(e==="i"?aG:ac)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(r=(n>0?Do:lG)(this,this.l),this.l+=4,r):(i=jr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=Nd(this,this.l):i=Nd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=Ux(this,this.l,n);break}}return this.l+=n,t}var cG=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},uG=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},hG=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function dG(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)hG(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,cG(this,e,this.l);break;case 8:if(r=8,t==="f"){oG(this,e,this.l);break}case 16:break;case-4:r=4,uG(this,e,this.l);break}return this.l+=r,this}function Qx(n,e){var t=Ux(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Hr(n,e){n.l=e,n.read_shift=kc,n.chk=Qx,n.write_shift=dG}function Gi(n,e){n.l+=e}function we(n){var e=ia(n);return Hr(e,0),e}function Pr(){var n=[],e=bt?256:2048,t=function(c){var u=we(c);return Hr(u,0),u},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},o=function(){return i(),Gn(n)},a=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:a,end:o,_bufs:n}}function be(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=sJ[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=n.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Iv(t)&&n.push(t)}}function Pc(n,e,t){var r=Nr(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function XE(n,e,t){var r=Nr(n);return r.s=Pc(r.s,e.s,t),r.e=Pc(r.e,e.s,t),r}function Oc(n,e){if(n.cRel&&n.c<0)for(n=Nr(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Nr(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Bt(n);return!n.cRel&&n.cRel!=null&&(t=gG(t)),!n.rRel&&n.rRel!=null&&(t=fG(t)),t}function Gp(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+cr(n.s.c)+":"+(n.e.cRel?"":"$")+cr(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Qn(n.s.r)+":"+(n.e.rRel?"":"$")+Qn(n.e.r):Oc(n.s,e.biff)+":"+Oc(n.e,e.biff)}function xv(n){return parseInt(pG(n),10)-1}function Qn(n){return""+(n+1)}function fG(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function pG(n){return n.replace(/\$(\d+)$/,"$1")}function Rv(n){for(var e=mG(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function cr(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function gG(n){return n.replace(/^([A-Z])/,"$$$1")}function mG(n){return n.replace(/^\$([A-Z])/,"$1")}function vG(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mn(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Bt(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Qr(n){var e=n.indexOf(":");return e==-1?{s:Mn(n),e:Mn(n)}:{s:Mn(n.slice(0,e)),e:Mn(n.slice(e+1))}}function wn(n,e){return typeof e>"u"||typeof e=="number"?wn(n.s,n.e):(typeof n!="string"&&(n=Bt(n)),typeof e!="string"&&(e=Bt(e)),n==e?n:n+":"+e)}function en(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function JE(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=yo(n.z,t?Or(e):e)}catch{}try{return n.w=yo((n.XF||{}).numFmtId||(t?14:0),t?Or(e):e)}catch{return""+e}}function Ps(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?Mu[n.v]||n.v:e==null?JE(n,n.v):JE(n,e))}function fa(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function Xx(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?Mn(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=en(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[f].length;++p)if(!(typeof e[f][p]>"u")){var g={v:e[f][p]},m=o+f,v=a+p;if(c.s.r>m&&(c.s.r=m),c.s.c>v&&(c.s.c=v),c.e.r<m&&(c.e.r=m),c.e.c<v&&(c.e.c=v),e[f][p]&&typeof e[f][p]=="object"&&!Array.isArray(e[f][p])&&!(e[f][p]instanceof Date))g=e[f][p];else if(Array.isArray(g.v)&&(g.f=e[f][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else if(r.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=r.dateNF||un[14],r.cellDates?(g.t="d",g.w=yo(g.z,Or(g.v))):(g.t="n",g.v=Or(g.v),g.w=yo(g.z,g.v))):g.t="s";if(i)s[m]||(s[m]=[]),s[m][v]&&s[m][v].z&&(g.z=s[m][v].z),s[m][v]=g;else{var _=Bt({c:v,r:m});s[_]&&s[_].z&&(g.z=s[_].z),s[_]=g}}}return c.s.c<1e7&&(s["!ref"]=wn(c)),s}function Ll(n,e){return Xx(null,n,e)}function _G(n){return n.read_shift(4,"i")}function vi(n,e){return e||(e=we(4)),e.write_shift(4,n),e}function ur(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function Fn(n,e){var t=!1;return e==null&&(t=!0,e=we(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function yG(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function EG(n,e){return e||(e=we(4)),e.write_shift(2,0),e.write_shift(2,0),e}function bv(n,e){var t=n.l,r=n.read_shift(1),i=ur(n),s=[],o={t:i,h:i};if(r&1){for(var a=n.read_shift(4),l=0;l!=a;++l)s.push(yG(n));o.r=s}else o.r=[{ich:0,ifnt:0}];return n.l=t+e,o}function TG(n,e){var t=!1;return e==null&&(t=!0,e=we(15+4*n.t.length)),e.write_shift(1,0),Fn(n.t,e),t?e.slice(0,e.l):e}var wG=bv;function AG(n,e){var t=!1;return e==null&&(t=!0,e=we(23+4*n.t.length)),e.write_shift(1,1),Fn(n.t,e),e.write_shift(4,1),EG({},e),t?e.slice(0,e.l):e}function ri(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function pa(n,e){return e==null&&(e=we(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function ga(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function ma(n,e){return e==null&&(e=we(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var CG=ur,Jx=Fn;function kv(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function Dd(n,e){var t=!1;return e==null&&(t=!0,e=we(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var SG=ur,ag=kv,Pv=Dd;function Zx(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?Nd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Do(e,0)>>2;return t?i/100:i}function eR(n,e){e==null&&(e=we(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function tR(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function IG(n,e){return e||(e=we(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var va=tR,Ul=IG;function Bl(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function sa(n,e){return(e||we(8)).write_shift(8,n,"f")}function xG(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),o=n.read_shift(1),a=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=FG[i];c&&(e.rgb=cT(c));break;case 2:e.rgb=cT([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Md(n,e){if(e||(e=we(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function RG(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function bG(n,e){e||(e=we(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var nR=2,Br=3,wh=11,Fd=19,Ah=64,kG=65,PG=71,OG=4108,NG=4126,Kn=80,ZE={1:{n:"CodePage",t:nR},2:{n:"Category",t:Kn},3:{n:"PresentationFormat",t:Kn},4:{n:"ByteCount",t:Br},5:{n:"LineCount",t:Br},6:{n:"ParagraphCount",t:Br},7:{n:"SlideCount",t:Br},8:{n:"NoteCount",t:Br},9:{n:"HiddenCount",t:Br},10:{n:"MultimediaClipCount",t:Br},11:{n:"ScaleCrop",t:wh},12:{n:"HeadingPairs",t:OG},13:{n:"TitlesOfParts",t:NG},14:{n:"Manager",t:Kn},15:{n:"Company",t:Kn},16:{n:"LinksUpToDate",t:wh},17:{n:"CharacterCount",t:Br},19:{n:"SharedDoc",t:wh},22:{n:"HyperlinksChanged",t:wh},23:{n:"AppVersion",t:Br,p:"version"},24:{n:"DigSig",t:kG},26:{n:"ContentType",t:Kn},27:{n:"ContentStatus",t:Kn},28:{n:"Language",t:Kn},29:{n:"Version",t:Kn},255:{},2147483648:{n:"Locale",t:Fd},2147483651:{n:"Behavior",t:Fd},1919054434:{}},eT={1:{n:"CodePage",t:nR},2:{n:"Title",t:Kn},3:{n:"Subject",t:Kn},4:{n:"Author",t:Kn},5:{n:"Keywords",t:Kn},6:{n:"Comments",t:Kn},7:{n:"Template",t:Kn},8:{n:"LastAuthor",t:Kn},9:{n:"RevNumber",t:Kn},10:{n:"EditTime",t:Ah},11:{n:"LastPrinted",t:Ah},12:{n:"CreatedDate",t:Ah},13:{n:"ModifiedDate",t:Ah},14:{n:"PageCount",t:Br},15:{n:"WordCount",t:Br},16:{n:"CharCount",t:Br},17:{n:"Thumbnail",t:PG},18:{n:"Application",t:Kn},19:{n:"DocSecurity",t:Br},255:{},2147483648:{n:"Locale",t:Fd},2147483651:{n:"Behavior",t:Fd},1919054434:{}};function DG(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var MG=DG([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),FG=Nr(MG),Mu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},LG={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ch={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function rR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iR(n,e){var t=qW(LG),r=[],i;r[r.length]=An,r[r.length]=Ue("Types",null,{xmlns:Dn.CT,"xmlns:xsd":Dn.xsd,"xmlns:xsi":Dn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ue("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=Ue("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ch[l][e.bookType]||Ch[l].xlsx}))},o=function(l){(n[l]||[]).forEach(function(c){r[r.length]=Ue("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Ch[l][e.bookType]||Ch[l].xlsx})})},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=Ue("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var xt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sR(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function tl(n){var e=[An,Ue("Relationships",null,{xmlns:Dn.RELS})];return Xn(n["!id"]).forEach(function(t){e[e.length]=Ue("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ft(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[xt.HLINK,xt.XPATH,xt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function UG(n){var e=[An];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function tT(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function BG(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function VG(n){var e=[An];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(tT(n[t][0],n[t][1])),e.push(BG("",n[t][0]));return e.push(tT("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function oR(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xd.version+"</meta:generator></office:meta></office:document-meta>"}var Wo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function qp(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Lt(e),r[r.length]=t?Ue(n,e,t):qn(n,e))}function aR(n,e){var t=e||{},r=[An,Ue("cp:coreProperties",null,{"xmlns:cp":Dn.CORE_PROPS,"xmlns:dc":Dn.dc,"xmlns:dcterms":Dn.dcterms,"xmlns:dcmitype":Dn.dcmitype,"xmlns:xsi":Dn.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&qp("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:og(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&qp("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:og(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Wo.length;++s){var o=Wo[s],a=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:n?n[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&qp(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var nl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],lR=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function cR(n){var e=[],t=Ue;return n||(n={}),n.Application="SheetJS",e[e.length]=An,e[e.length]=Ue("Properties",null,{xmlns:Dn.EXT_PROPS,"xmlns:vt":Dn.vt}),nl.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Lt(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Lt(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function uR(n){var e=[An,Ue("Properties",null,{xmlns:Dn.CUST_PROPS,"xmlns:vt":Dn.vt})];if(!n)return e.join("");var t=1;return Xn(n).forEach(function(i){++t,e[e.length]=Ue("property",iG(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Lt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var nT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function HG(n,e){var t=[];return Xn(nT).map(function(r){for(var i=0;i<Wo.length;++i)if(Wo[i][1]==r)return Wo[i];for(i=0;i<nl.length;++i)if(nl[i][1]==r)return nl[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(qn(nT[r[1]]||r[1],i))}}),Ue("DocumentProperties",t.join(""),{xmlns:Kr.o})}function $G(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Xn(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var o=0;o<Wo.length;++o)if(s==Wo[o][1])return;for(o=0;o<nl.length;++o)if(s==nl[o][1])return;for(o=0;o<t.length;++o)if(s==t[o])return;var a=n[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(Ue(KE(s),a,{"dt:dt":l}))}}),e&&Xn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Ue(KE(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+Kr.o+'">'+i.join("")+"</"+r+">"}function KG(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=we(8);return o.write_shift(4,r),o.write_shift(4,i),o}function rT(n,e){var t=we(4),r=we(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=we(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=KG(e);break;case 31:case 80:for(r=we(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Gn([t,r])}var hR=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function jG(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function iT(n,e,t){var r=we(8),i=[],s=[],o=8,a=0,l=we(8),c=we(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!e){c=we(8),c.write_shift(4,0),i.unshift(c);var u=[we(4)];for(u[0].write_shift(4,n.length),a=0;a<n.length;++a){var f=n[a][0];for(l=we(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Gn(u),s.unshift(l),o+=8+l.length}for(a=0;a<n.length;++a)if(!(e&&!e[n[a][0]])&&!(hR.indexOf(n[a][0])>-1||lR.indexOf(n[a][0])>-1)&&n[a][1]!=null){var p=n[a][1],g=0;if(e){g=+e[n[a][0]];var m=t[g];if(m.p=="version"&&typeof p=="string"){var v=p.split(".");p=(+v[0]<<16)+(+v[1]||0)}l=rT(m.t,p)}else{var _=jG(p);_==-1&&(_=31,p=String(p)),l=rT(_,p)}s.push(l),c=we(8),c.write_shift(4,e?g:2+a),i.push(c),o+=8+l.length}var D=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,D),D+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),Gn([r].concat(i).concat(s))}function sT(n,e,t,r,i,s){var o=we(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Vt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=iT(n,t,r);if(a.push(l),i){var c=iT(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Gn(a)}function WG(n,e){e||(e=we(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function GG(n,e){return n.read_shift(e)===1}function Er(n,e){return e||(e=we(2)),e.write_shift(2,+!!n),e}function dR(n){return n.read_shift(2,"u")}function Zr(n,e){return e||(e=we(2)),e.write_shift(2,n),e}function fR(n,e,t){return t||(t=we(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function pR(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=r?n.read_shift(r,i):"";return o}function qG(n){var e=n.t||"",t=we(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=we(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return Gn(i)}function zG(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function YG(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):zG(n,r,t)}function QG(n,e,t){if(t.biff>5)return YG(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function gR(n,e,t){return t||(t=we(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function oT(n,e){e||(e=we(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function XG(n){var e=we(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)e.write_shift(4,o[t]);if(s==28)r=r.slice(1),oT(r,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));var a=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(a.length+1)),t=0;t<a.length;++t)e.write_shift(2,a.charCodeAt(t));e.write_shift(2,0),s&8&&oT(i>-1?r.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function oa(n,e,t,r){return r||(r=we(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function JG(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),o=n.read_shift(r,"i");return[i,s,o]}function ZG(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function mR(n,e){return e||(e=we(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function Ov(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=we(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function eq(n,e){var t=!e||e.biff==8,r=we(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function tq(n,e){var t=!e||e.biff>=8?2:1,r=we(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function nq(n,e){var t=we(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=qG(n[i]);var s=Gn([t].concat(r));return s.parts=[t.length].concat(r.map(function(o){return o.length})),s}function rq(){var n=we(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function iq(n){var e=we(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function sq(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=we(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function oq(n,e,t,r){var i=we(10);return oa(n,e,r,i),i.write_shift(4,t),i}function aq(n,e,t,r,i){var s=!i||i.biff==8,o=we(8+ +s+(1+s)*t.length);return oa(n,e,r,o),o.write_shift(2,t.length),s&&o.write_shift(1,1),o.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),o}function lq(n,e,t,r){var i=t&&t.biff==5;r||(r=we(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function cq(n,e){var t=e.biff==8||!e.biff?4:2,r=we(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function aT(n,e,t,r){var i=t&&t.biff==5;r||(r=we(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function uq(n){var e=we(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function hq(n,e,t,r,i,s){var o=we(8);return oa(n,e,r,o),fR(t,s,o),o}function dq(n,e,t,r){var i=we(14);return oa(n,e,r,i),sa(t,i),i}function fq(n,e,t){if(t.biff<8)return pq(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(JG(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function pq(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=pR(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function gq(n){var e=we(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)mR(n[t],e);return e}function mq(n){var e=we(24),t=Mn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Gn([e,XG(n[1])])}function vq(n){var e=n[1].Tooltip,t=we(10+2*(e.length+1));t.write_shift(2,2048);var r=Mn(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function _q(n){return n||(n=we(4)),n.write_shift(2,1),n.write_shift(2,1),n}function yq(n,e,t){if(!t.cellStyles)return Gi(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),o=n.read_shift(r),a=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function Eq(n,e){var t=we(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function Tq(n){for(var e=we(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function wq(n,e,t){var r=we(15);return Lu(r,n,e),r.write_shift(8,t,"f"),r}function Aq(n,e,t){var r=we(9);return Lu(r,n,e),r.write_shift(2,t),r}var Cq=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Tv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(a,l){var c=[],u=ia(1);switch(l.type){case"base64":u=ci(ks(a));break;case"binary":u=ci(a);break;case"buffer":case"array":u=a;break}Hr(u,0);var f=u.read_shift(1),p=!!(f&136),g=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,_=521;f==2&&(v=u.read_shift(2)),u.l+=3,f!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(_=u.read_shift(2));var D=u.read_shift(2),b=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=n[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var T=[],R={},B=Math.min(u.length,f==2?521:_-10-(g?264:0)),W=m?32:11;u.l<B&&u[u.l]!=13;)switch(R={},R.name=Rd.utils.decode(b,u.slice(u.l,u.l+W)).replace(/[\u0000\r\n].*$/g,""),u.l+=W,R.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(R.offset=u.read_shift(4)),R.len=u.read_shift(1),f==2&&(R.offset=u.read_shift(2)),R.dec=u.read_shift(1),R.name.length&&T.push(R),f!=2&&(u.l+=m?13:14),R.type){case"B":(!g||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var A=0,w=0;for(c[0]=[],w=0;w!=T.length;++w)c[0][w]=T[w].name;for(;v-- >0;){if(u[u.l]===42){u.l+=D;continue}for(++u.l,c[++A]=[],w=0,w=0;w!=T.length;++w){var E=u.slice(u.l,u.l+T[w].len);u.l+=T[w].len,Hr(E,0);var C=Rd.utils.decode(b,E);switch(T[w].type){case"C":C.trim().length&&(c[A][w]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[A][w]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[A][w]=C;break;case"F":c[A][w]=parseFloat(C.trim());break;case"+":case"I":c[A][w]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[A][w]=!0;break;case"N":case"F":c[A][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[A][w]="##MEMO##"+(m?parseInt(C.trim(),10):E.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[A][w]=+C||0);break;case"@":c[A][w]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":c[A][w]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":c[A][w]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[A][w]=-E.read_shift(-8,"f");break;case"B":if(g&&T[w].len==8){c[A][w]=E.read_shift(8,"f");break}case"G":case"P":E.l+=T[w].len;break;case"0":if(T[w].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[w].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=T,c}function r(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ll(t(a,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(a,l){try{return fa(r(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&Qc(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Pr(),f=Hd(a,{header:1,raw:!0,cellDates:!0}),p=f[0],g=f.slice(1),m=a["!cols"]||[],v=0,_=0,D=0,b=1;for(v=0;v<p.length;++v){if(((m[v]||{}).DBF||{}).name){p[v]=m[v].DBF.name,++D;continue}if(p[v]!=null){if(++D,typeof p[v]=="number"&&(p[v]=p[v].toString(10)),typeof p[v]!="string")throw new Error("DBF Invalid column name "+p[v]+" |"+typeof p[v]+"|");if(p.indexOf(p[v])!==v){for(_=0;_<1024;++_)if(p.indexOf(p[v]+"_"+_)==-1){p[v]+="_"+_;break}}}}var T=en(a["!ref"]),R=[],B=[],W=[];for(v=0;v<=T.e.c-T.s.c;++v){var A="",w="",E=0,C=[];for(_=0;_<g.length;++_)g[_][v]!=null&&C.push(g[_][v]);if(C.length==0||p[v]==null){R[v]="?";continue}for(_=0;_<C.length;++_){switch(typeof C[_]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=C[_]instanceof Date?"D":"C";break;default:w="C"}E=Math.max(E,String(C[_]).length),A=A&&A!=w?"C":w}E>250&&(E=250),w=((m[v]||{}).DBF||{}).type,w=="C"&&m[v].DBF.len>E&&(E=m[v].DBF.len),A=="B"&&w=="N"&&(A="N",W[v]=m[v].DBF.dec,E=m[v].DBF.len),B[v]=A=="C"||w=="N"?E:s[A]||0,b+=B[v],R[v]=A}var I=u.next(32);for(I.write_shift(4,318902576),I.write_shift(4,g.length),I.write_shift(2,296+32*D),I.write_shift(2,b),v=0;v<4;++v)I.write_shift(4,0);for(I.write_shift(4,0|(+e[_x]||3)<<8),v=0,_=0;v<p.length;++v)if(p[v]!=null){var x=u.next(32),P=(p[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);x.write_shift(1,P,"sbcs"),x.write_shift(1,R[v]=="?"?"C":R[v],"sbcs"),x.write_shift(4,_),x.write_shift(1,B[v]||s[R[v]]||0),x.write_shift(1,W[v]||0),x.write_shift(1,2),x.write_shift(4,0),x.write_shift(1,0),x.write_shift(4,0),x.write_shift(4,0),_+=B[v]||s[R[v]]||0}var ie=u.next(264);for(ie.write_shift(4,13),v=0;v<65;++v)ie.write_shift(4,0);for(v=0;v<g.length;++v){var Q=u.next(b);for(Q.write_shift(1,0),_=0;_<p.length;++_)if(p[_]!=null)switch(R[_]){case"L":Q.write_shift(1,g[v][_]==null?63:g[v][_]?84:70);break;case"B":Q.write_shift(8,g[v][_]||0,"f");break;case"N":var ae="0";for(typeof g[v][_]=="number"&&(ae=g[v][_].toFixed(W[_]||0)),D=0;D<B[_]-ae.length;++D)Q.write_shift(1,32);Q.write_shift(1,ae,"sbcs");break;case"D":g[v][_]?(Q.write_shift(4,("0000"+g[v][_].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(g[v][_].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+g[v][_].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(g[v][_]!=null?g[v][_]:"").slice(0,B[_]);for(Q.write_shift(1,Ae,"sbcs"),D=0;D<B[_]-Ae.length;++D)Q.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),Sq=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Xn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(p,g){var m=n[g];return typeof m=="number"?PE(m):m},r=function(p,g,m){var v=g.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return v==59?p:PE(v)};n["|"]=254;function i(p,g){switch(g.type){case"base64":return s(ks(p),g);case"binary":return s(p,g);case"buffer":return s(bt&&Buffer.isBuffer(p)?p.toString("binary"):Ou(p),g);case"array":return s(Jf(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var m=p.split(/[\n\r]+/),v=-1,_=-1,D=0,b=0,T=[],R=[],B=null,W={},A=[],w=[],E=[],C=0,I;for(+g.codepage>=0&&Qc(+g.codepage);D!==m.length;++D){C=0;var x=m[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),P=x.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),ie=P[0],Q;if(x.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&R.push(x.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,Ae=!1,Oe=!1,Ce=!1,fe=-1,F=-1;for(b=1;b<P.length;++b)switch(P[b].charAt(0)){case"A":break;case"X":_=parseInt(P[b].slice(1))-1,Ae=!0;break;case"Y":for(v=parseInt(P[b].slice(1))-1,Ae||(_=0),I=T.length;I<=v;++I)T[I]=[];break;case"K":Q=P[b].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(ys(Q))?isNaN(Jc(Q).getDate())||(Q=Ar(Q)):(Q=ys(Q),B!==null&&kx(B)&&(Q=Dx(Q))),ae=!0;break;case"E":Ce=!0;var O=Az(P[b].slice(1),{r:v,c:_});T[v][_]=[T[v][_],O];break;case"S":Oe=!0,T[v][_]=[T[v][_],"S5S"];break;case"G":break;case"R":fe=parseInt(P[b].slice(1))-1;break;case"C":F=parseInt(P[b].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+x)}if(ae&&(T[v][_]&&T[v][_].length==2?T[v][_][0]=Q:T[v][_]=Q,B=null),Oe){if(Ce)throw new Error("SYLK shared formula cannot have own formula");var Z=fe>-1&&T[fe][F];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");T[v][_][1]=Cz(Z[1],{r:v-fe,c:_-F})}break;case"F":var q=0;for(b=1;b<P.length;++b)switch(P[b].charAt(0)){case"X":_=parseInt(P[b].slice(1))-1,++q;break;case"Y":for(v=parseInt(P[b].slice(1))-1,I=T.length;I<=v;++I)T[I]=[];break;case"M":C=parseInt(P[b].slice(1))/20;break;case"F":break;case"G":break;case"P":B=R[parseInt(P[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=P[b].slice(1).split(" "),I=parseInt(E[0],10);I<=parseInt(E[1],10);++I)C=parseInt(E[2],10),w[I-1]=C===0?{hidden:!0}:{wch:C},Nv(w[I-1]);break;case"C":_=parseInt(P[b].slice(1))-1,w[_]||(w[_]={});break;case"R":v=parseInt(P[b].slice(1))-1,A[v]||(A[v]={}),C>0?(A[v].hpt=C,A[v].hpx=TR(C)):C===0&&(A[v].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+x)}q<1&&(B=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+x)}}return A.length>0&&(W["!rows"]=A),w.length>0&&(W["!cols"]=w),g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),[T,W]}function o(p,g){var m=i(p,g),v=m[0],_=m[1],D=Ll(v,g);return Xn(_).forEach(function(b){D[b]=_[b]}),D}function a(p,g){return fa(o(p,g),g)}function l(p,g,m,v){var _="C;Y"+(m+1)+";X"+(v+1)+";K";switch(p.t){case"n":_+=p.v||0,p.f&&!p.F&&(_+=";E"+Mv(p.f,{r:m,c:v}));break;case"b":_+=p.v?"TRUE":"FALSE";break;case"e":_+=p.w||p.v;break;case"d":_+='"'+(p.w||p.v)+'"';break;case"s":_+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(p,g){g.forEach(function(m,v){var _="F;W"+(v+1)+" "+(v+1)+" ";m.hidden?_+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Ld(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Ud(m.wpx)),typeof m.wch=="number"&&(_+=Math.round(m.wch))),_.charAt(_.length-1)!=" "&&p.push(_)})}function u(p,g){g.forEach(function(m,v){var _="F;";m.hidden?_+="M0;":m.hpt?_+="M"+20*m.hpt+";":m.hpx&&(_+="M"+20*Bd(m.hpx)+";"),_.length>2&&p.push(_+"R"+(v+1))})}function f(p,g){var m=["ID;PWXL;N;E"],v=[],_=en(p["!ref"]),D,b=Array.isArray(p),T=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&c(m,p["!cols"]),p["!rows"]&&u(m,p["!rows"]),m.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var R=_.s.r;R<=_.e.r;++R)for(var B=_.s.c;B<=_.e.c;++B){var W=Bt({r:R,c:B});D=b?(p[R]||[])[B]:p[W],!(!D||D.v==null&&(!D.f||D.F))&&v.push(l(D,p,R,B))}return m.join(T)+T+v.join(T)+T+"E"+T}return{to_workbook:a,to_sheet:o,from_sheet:f}}(),Iq=function(){function n(s,o){switch(o.type){case"base64":return e(ks(s),o);case"binary":return e(s,o);case"buffer":return e(bt&&Buffer.isBuffer(s)?s.toString("binary"):Ou(s),o);case"array":return e(Jf(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==a.length;++u){if(a[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var p=a[u].trim().split(","),g=p[0],m=p[1];++u;for(var v=a[u]||"";(v.match(/["]/g)||[]).length&1&&u<a.length-1;)v+=`
`+a[++u];switch(v=v.trim(),+g){case-1:if(v==="BOT"){f[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[l][c]=!0:v==="FALSE"?f[l][c]=!1:isNaN(ys(m))?isNaN(Jc(m).getDate())?f[l][c]=m:f[l][c]=Ar(m):f[l][c]=ys(m),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function t(s,o){return Ll(n(s,o),o)}function r(s,o){return fa(t(s,o),o)}var i=function(){var s=function(l,c,u,f,p){l.push(c),l.push(u+","+f),l.push('"'+p.replace(/"/g,'""')+'"')},o=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=en(l["!ref"]),f,p=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){o(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var v=Bt({r:g,c:m});if(f=p?(l[g]||[])[m]:l[v],!f){o(c,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?o(c,1,0,"="+f.f):o(c,1,0,""):o(c,0,_,"V");break;case"b":o(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=yo(f.z||un[14],Or(Ar(f.v)))),o(c,0,f.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var D=`\r
`,b=c.join(D);return b}}();return{to_workbook:r,to_sheet:t,from_sheet:i}}(),vR=function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,p){for(var g=f.split(`
`),m=-1,v=-1,_=0,D=[];_!==g.length;++_){var b=g[_].trim().split(":");if(b[0]==="cell"){var T=Mn(b[1]);if(D.length<=T.r)for(m=D.length;m<=T.r;++m)D[m]||(D[m]=[]);switch(m=T.r,v=T.c,b[2]){case"t":D[m][v]=n(b[3]);break;case"v":D[m][v]=+b[3];break;case"vtf":var R=b[b.length-1];case"vtc":switch(b[3]){case"nl":D[m][v]=!!+b[4];break;default:D[m][v]=+b[4];break}b[2]=="vtf"&&(D[m][v]=[D[m][v],R])}}}return p&&p.sheetRows&&(D=D.slice(0,p.sheetRows)),D}function r(f,p){return Ll(t(f,p),p)}function i(f,p){return fa(r(f,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var p=[],g=[],m,v="",_=Qr(f["!ref"]),D=Array.isArray(f),b=_.s.r;b<=_.e.r;++b)for(var T=_.s.c;T<=_.e.c;++T)if(v=Bt({r:b,c:T}),m=D?(f[b]||[])[T]:f[v],!(!m||m.v==null||m.t==="z")){switch(g=["cell",v,"t"],m.t){case"s":case"str":g.push(e(m.v));break;case"n":m.f?(g[2]="vtf",g[3]="n",g[4]=m.v,g[5]=e(m.f)):(g[2]="v",g[3]=m.v);break;case"b":g[2]="vt"+(m.f?"f":"c"),g[3]="nl",g[4]=m.v?"1":"0",g[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var R=Or(Ar(m.v));g[2]="vtc",g[3]="nd",g[4]=""+R,g[5]=m.w||yo(m.z||un[14],R);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(f){return[s,o,a,o,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}}(),xq=function(){function n(u,f,p,g,m){m.raw?f[p][g]=u:u===""||(u==="TRUE"?f[p][g]=!0:u==="FALSE"?f[p][g]=!1:isNaN(ys(u))?isNaN(Jc(u).getDate())?f[p][g]=u:f[p][g]=Ar(u):f[p][g]=ys(u))}function e(u,f){var p=f||{},g=[];if(!u||u.length===0)return g;for(var m=u.split(/[\r\n]/),v=m.length-1;v>=0&&m[v].length===0;)--v;for(var _=10,D=0,b=0;b<=v;++b)D=m[b].indexOf(" "),D==-1?D=m[b].length:D++,_=Math.max(_,D);for(b=0;b<=v;++b){g[b]=[];var T=0;for(n(m[b].slice(0,_).trim(),g,b,T,p),T=1;T<=(m[b].length-_)/10+1;++T)n(m[b].slice(_+(T-1)*10,_+T*10).trim(),g,b,T,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var f={},p=!1,g=0,m=0;g<u.length;++g)(m=u.charCodeAt(g))==34?p=!p:!p&&m in t&&(f[m]=(f[m]||0)+1);m=[];for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&m.push([f[g],g]);if(!m.length){f=r;for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&m.push([f[g],g])}return m.sort(function(v,_){return v[0]-_[0]||r[v[1]]-r[_[1]]}),t[m.pop()[1]]||44}function s(u,f){var p=f||{},g="",m=p.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(g=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(g=u.charAt(4),u=u.slice(6)):g=i(u.slice(0,1024)):p&&p.FS?g=p.FS:g=i(u.slice(0,1024));var _=0,D=0,b=0,T=0,R=0,B=g.charCodeAt(0),W=!1,A=0,w=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var E=p.dateNF!=null?KW(p.dateNF):null;function C(){var I=u.slice(T,R),x={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)x.t="z";else if(p.raw)x.t="s",x.v=I;else if(I.trim().length===0)x.t="s",x.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(x.t="s",x.v=I.slice(2,-1).replace(/""/g,'"')):Sz(I)?(x.t="n",x.f=I.slice(1)):(x.t="s",x.v=I);else if(I=="TRUE")x.t="b",x.v=!0;else if(I=="FALSE")x.t="b",x.v=!1;else if(!isNaN(b=ys(I)))x.t="n",p.cellText!==!1&&(x.w=I),x.v=b;else if(!isNaN(Jc(I).getDate())||E&&I.match(E)){x.z=p.dateNF||un[14];var P=0;E&&I.match(E)&&(I=jW(I,p.dateNF,I.match(E)||[]),P=1),p.cellDates?(x.t="d",x.v=Ar(I,P)):(x.t="n",x.v=Or(Ar(I,P))),p.cellText!==!1&&(x.w=yo(x.z,x.v instanceof Date?Or(x.v):x.v)),p.cellNF||delete x.z}else x.t="s",x.v=I;if(x.t=="z"||(p.dense?(m[_]||(m[_]=[]),m[_][D]=x):m[Bt({c:D,r:_})]=x),T=R+1,w=u.charCodeAt(T),v.e.c<D&&(v.e.c=D),v.e.r<_&&(v.e.r=_),A==B)++D;else if(D=0,++_,p.sheetRows&&p.sheetRows<=_)return!0}e:for(;R<u.length;++R)switch(A=u.charCodeAt(R)){case 34:w===34&&(W=!W);break;case B:case 10:case 13:if(!W&&C())break e;break}return R-T>0&&C(),m["!ref"]=wn(v),m}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Ll(e(u,f),f)}function a(u,f){var p="",g=f.type=="string"?[0,0,0,0]:BJ(u,f);switch(f.type){case"base64":p=ks(u);break;case"binary":p=u;break;case"buffer":f.codepage==65001?p=u.toString("utf8"):f.codepage&&typeof Rd<"u"||(p=bt&&Buffer.isBuffer(u)?u.toString("binary"):Ou(u));break;case"array":p=Jf(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+f.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=bc(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=bc(p):f.type=="binary"&&typeof Rd<"u",p.slice(0,19)=="socialcalc:version:"?vR.to_sheet(f.type=="string"?p:bc(p),f):o(p,f)}function l(u,f){return fa(a(u,f),f)}function c(u){for(var f=[],p=en(u["!ref"]),g,m=Array.isArray(u),v=p.s.r;v<=p.e.r;++v){for(var _=[],D=p.s.c;D<=p.e.c;++D){var b=Bt({r:v,c:D});if(g=m?(u[v]||[])[D]:u[b],!g||g.v==null){_.push("          ");continue}for(var T=(g.w||(Ps(g),g.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(D===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}(),lT=function(){function n(O,Z,q){if(O){Hr(O,O.l||0);for(var X=q.Enum||fe;O.l<O.length;){var ce=O.read_shift(2),ne=X[ce]||X[65535],ve=O.read_shift(2),se=O.l+ve,H=ne.f&&ne.f(O,ve,q);if(O.l=se,Z(H,ne,ce))return}}}function e(O,Z){switch(Z.type){case"base64":return t(ci(ks(O)),Z);case"binary":return t(ci(O),Z);case"buffer":case"array":return t(O,Z)}throw"Unsupported type "+Z.type}function t(O,Z){if(!O)return O;var q=Z||{},X=q.dense?[]:{},ce="Sheet1",ne="",ve=0,se={},H=[],J=[],k={s:{r:0,c:0},e:{r:0,c:0}},L=q.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)q.Enum=fe,n(O,function(re,Me,Fe){switch(Fe){case 0:q.vers=re,re>=4096&&(q.qpro=!0);break;case 6:k=re;break;case 204:re&&(ne=re);break;case 222:ne=re;break;case 15:case 51:q.qpro||(re[1].v=re[1].v.slice(1));case 13:case 14:case 16:Fe==14&&(re[2]&112)==112&&(re[2]&15)>1&&(re[2]&15)<15&&(re[1].z=q.dateNF||un[14],q.cellDates&&(re[1].t="d",re[1].v=Dx(re[1].v))),q.qpro&&re[3]>ve&&(X["!ref"]=wn(k),se[ce]=X,H.push(ce),X=q.dense?[]:{},k={s:{r:0,c:0},e:{r:0,c:0}},ve=re[3],ce=ne||"Sheet"+(ve+1),ne="");var De=q.dense?(X[re[0].r]||[])[re[0].c]:X[Bt(re[0])];if(De){De.t=re[1].t,De.v=re[1].v,re[1].z!=null&&(De.z=re[1].z),re[1].f!=null&&(De.f=re[1].f);break}q.dense?(X[re[0].r]||(X[re[0].r]=[]),X[re[0].r][re[0].c]=re[1]):X[Bt(re[0])]=re[1];break}},q);else if(O[2]==26||O[2]==14)q.Enum=F,O[2]==14&&(q.qpro=!0,O.l=0),n(O,function(re,Me,Fe){switch(Fe){case 204:ce=re;break;case 22:re[1].v=re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(re[3]>ve&&(X["!ref"]=wn(k),se[ce]=X,H.push(ce),X=q.dense?[]:{},k={s:{r:0,c:0},e:{r:0,c:0}},ve=re[3],ce="Sheet"+(ve+1)),L>0&&re[0].r>=L)break;q.dense?(X[re[0].r]||(X[re[0].r]=[]),X[re[0].r][re[0].c]=re[1]):X[Bt(re[0])]=re[1],k.e.c<re[0].c&&(k.e.c=re[0].c),k.e.r<re[0].r&&(k.e.r=re[0].r);break;case 27:re[14e3]&&(J[re[14e3][0]]=re[14e3][1]);break;case 1537:J[re[0]]=re[1],re[0]==ve&&(ce=re[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(X["!ref"]=wn(k),se[ne||ce]=X,H.push(ne||ce),!J.length)return{SheetNames:H,Sheets:se};for(var z={},ge=[],ye=0;ye<J.length;++ye)se[H[ye]]?(ge.push(J[ye]||H[ye]),z[J[ye]]=se[J[ye]]||se[H[ye]]):(ge.push(J[ye]),z[J[ye]]={"!ref":"A1"});return{SheetNames:ge,Sheets:z}}function r(O,Z){var q=Z||{};if(+q.codepage>=0&&Qc(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Pr(),ce=en(O["!ref"]),ne=Array.isArray(O),ve=[];Be(X,0,s(1030)),Be(X,6,l(ce));for(var se=Math.min(ce.e.r,8191),H=ce.s.r;H<=se;++H)for(var J=Qn(H),k=ce.s.c;k<=ce.e.c;++k){H===ce.s.r&&(ve[k]=cr(k));var L=ve[k]+J,z=ne?(O[H]||[])[k]:O[L];if(!(!z||z.t=="z"))if(z.t=="n")(z.v|0)==z.v&&z.v>=-32768&&z.v<=32767?Be(X,13,g(H,k,z.v)):Be(X,14,v(H,k,z.v));else{var ge=Ps(z);Be(X,15,f(H,k,ge.slice(0,239)))}}return Be(X,1),X.end()}function i(O,Z){var q=Z||{};if(+q.codepage>=0&&Qc(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Pr();Be(X,0,o(O));for(var ce=0,ne=0;ce<O.SheetNames.length;++ce)(O.Sheets[O.SheetNames[ce]]||{})["!ref"]&&Be(X,27,Ce(O.SheetNames[ce],ne++));var ve=0;for(ce=0;ce<O.SheetNames.length;++ce){var se=O.Sheets[O.SheetNames[ce]];if(!(!se||!se["!ref"])){for(var H=en(se["!ref"]),J=Array.isArray(se),k=[],L=Math.min(H.e.r,8191),z=H.s.r;z<=L;++z)for(var ge=Qn(z),ye=H.s.c;ye<=H.e.c;++ye){z===H.s.r&&(k[ye]=cr(ye));var re=k[ye]+ge,Me=J?(se[z]||[])[ye]:se[re];if(!(!Me||Me.t=="z"))if(Me.t=="n")Be(X,23,C(z,ye,ve,Me.v));else{var Fe=Ps(Me);Be(X,22,A(z,ye,ve,Fe.slice(0,239)))}}++ve}}return Be(X,1),X.end()}function s(O){var Z=we(2);return Z.write_shift(2,O),Z}function o(O){var Z=we(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var q=0,X=0,ce=0,ne=0;ne<O.SheetNames.length;++ne){var ve=O.SheetNames[ne],se=O.Sheets[ve];if(!(!se||!se["!ref"])){++ce;var H=Qr(se["!ref"]);q<H.e.r&&(q=H.e.r),X<H.e.c&&(X=H.e.c)}}return q>8191&&(q=8191),Z.write_shift(2,q),Z.write_shift(1,ce),Z.write_shift(1,X),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function a(O,Z,q){var X={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&q.qpro?(X.s.c=O.read_shift(1),O.l++,X.s.r=O.read_shift(2),X.e.c=O.read_shift(1),O.l++,X.e.r=O.read_shift(2),X):(X.s.c=O.read_shift(2),X.s.r=O.read_shift(2),Z==12&&q.qpro&&(O.l+=2),X.e.c=O.read_shift(2),X.e.r=O.read_shift(2),Z==12&&q.qpro&&(O.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(O){var Z=we(8);return Z.write_shift(2,O.s.c),Z.write_shift(2,O.s.r),Z.write_shift(2,O.e.c),Z.write_shift(2,O.e.r),Z}function c(O,Z,q){var X=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(X[0].c=O.read_shift(1),X[3]=O.read_shift(1),X[0].r=O.read_shift(2),O.l+=2):(X[2]=O.read_shift(1),X[0].c=O.read_shift(2),X[0].r=O.read_shift(2)),X}function u(O,Z,q){var X=O.l+Z,ce=c(O,Z,q);if(ce[1].t="s",q.vers==20768){O.l++;var ne=O.read_shift(1);return ce[1].v=O.read_shift(ne,"utf8"),ce}return q.qpro&&O.l++,ce[1].v=O.read_shift(X-O.l,"cstr"),ce}function f(O,Z,q){var X=we(7+q.length);X.write_shift(1,255),X.write_shift(2,Z),X.write_shift(2,O),X.write_shift(1,39);for(var ce=0;ce<X.length;++ce){var ne=q.charCodeAt(ce);X.write_shift(1,ne>=128?95:ne)}return X.write_shift(1,0),X}function p(O,Z,q){var X=c(O,Z,q);return X[1].v=O.read_shift(2,"i"),X}function g(O,Z,q){var X=we(7);return X.write_shift(1,255),X.write_shift(2,Z),X.write_shift(2,O),X.write_shift(2,q,"i"),X}function m(O,Z,q){var X=c(O,Z,q);return X[1].v=O.read_shift(8,"f"),X}function v(O,Z,q){var X=we(13);return X.write_shift(1,255),X.write_shift(2,Z),X.write_shift(2,O),X.write_shift(8,q,"f"),X}function _(O,Z,q){var X=O.l+Z,ce=c(O,Z,q);if(ce[1].v=O.read_shift(8,"f"),q.qpro)O.l=X;else{var ne=O.read_shift(2);R(O.slice(O.l,O.l+ne),ce),O.l+=ne}return ce}function D(O,Z,q){var X=Z&32768;return Z&=-32769,Z=(X?O:0)+(Z>=8192?Z-16384:Z),(X?"":"$")+(q?cr(Z):Qn(Z))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(O,Z){Hr(O,0);for(var q=[],X=0,ce="",ne="",ve="",se="";O.l<O.length;){var H=O[O.l++];switch(H){case 0:q.push(O.read_shift(8,"f"));break;case 1:ne=D(Z[0].c,O.read_shift(2),!0),ce=D(Z[0].r,O.read_shift(2),!1),q.push(ne+ce);break;case 2:{var J=D(Z[0].c,O.read_shift(2),!0),k=D(Z[0].r,O.read_shift(2),!1);ne=D(Z[0].c,O.read_shift(2),!0),ce=D(Z[0].r,O.read_shift(2),!1),q.push(J+k+":"+ne+ce)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(O.read_shift(2));break;case 6:{for(var L="";H=O[O.l++];)L+=String.fromCharCode(H);q.push('"'+L.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:se=q.pop(),ve=q.pop(),q.push(["AND","OR"][H-20]+"("+ve+","+se+")");break;default:if(H<32&&T[H])se=q.pop(),ve=q.pop(),q.push(ve+T[H]+se);else if(b[H]){if(X=b[H][1],X==69&&(X=O[O.l++]),X>q.length){console.error("WK1 bad formula parse 0x"+H.toString(16)+":|"+q.join("|")+"|");return}var z=q.slice(-X);q.length-=X,q.push(b[H][0]+"("+z.join(",")+")")}else return H<=7?console.error("WK1 invalid opcode "+H.toString(16)):H<=24?console.error("WK1 unsupported op "+H.toString(16)):H<=30?console.error("WK1 invalid opcode "+H.toString(16)):H<=115?console.error("WK1 unsupported function opcode "+H.toString(16)):console.error("WK1 unrecognized opcode "+H.toString(16))}}q.length==1?Z[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function B(O){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=O.read_shift(2),Z[3]=O[O.l++],Z[0].c=O[O.l++],Z}function W(O,Z){var q=B(O);return q[1].t="s",q[1].v=O.read_shift(Z-4,"cstr"),q}function A(O,Z,q,X){var ce=we(6+X.length);ce.write_shift(2,O),ce.write_shift(1,q),ce.write_shift(1,Z),ce.write_shift(1,39);for(var ne=0;ne<X.length;++ne){var ve=X.charCodeAt(ne);ce.write_shift(1,ve>=128?95:ve)}return ce.write_shift(1,0),ce}function w(O,Z){var q=B(O);q[1].v=O.read_shift(2);var X=q[1].v>>1;if(q[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return q[1].v=X,q}function E(O,Z){var q=B(O),X=O.read_shift(4),ce=O.read_shift(4),ne=O.read_shift(2);if(ne==65535)return X===0&&ce===3221225472?(q[1].t="e",q[1].v=15):X===0&&ce===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ve=ne&32768;return ne=(ne&32767)-16446,q[1].v=(1-ve*2)*(ce*Math.pow(2,ne+32)+X*Math.pow(2,ne)),q}function C(O,Z,q,X){var ce=we(14);if(ce.write_shift(2,O),ce.write_shift(1,q),ce.write_shift(1,Z),X==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var ne=0,ve=0,se=0,H=0;return X<0&&(ne=1,X=-X),ve=Math.log2(X)|0,X/=Math.pow(2,ve-31),H=X>>>0,H&2147483648||(X/=2,++ve,H=X>>>0),X-=H,H|=2147483648,H>>>=0,X*=Math.pow(2,32),se=X>>>0,ce.write_shift(4,se),ce.write_shift(4,H),ve+=16383+(ne?32768:0),ce.write_shift(2,ve),ce}function I(O,Z){var q=E(O);return O.l+=Z-14,q}function x(O,Z){var q=B(O),X=O.read_shift(4);return q[1].v=X>>6,q}function P(O,Z){var q=B(O),X=O.read_shift(8,"f");return q[1].v=X,q}function ie(O,Z){var q=P(O);return O.l+=Z-10,q}function Q(O,Z){return O[O.l+Z-1]==0?O.read_shift(Z,"cstr"):""}function ae(O,Z){var q=O[O.l++];q>Z-1&&(q=Z-1);for(var X="";X.length<q;)X+=String.fromCharCode(O[O.l++]);return X}function Ae(O,Z,q){if(!(!q.qpro||Z<21)){var X=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var ce=O.read_shift(Z-21,"cstr");return[X,ce]}}function Oe(O,Z){for(var q={},X=O.l+Z;O.l<X;){var ce=O.read_shift(2);if(ce==14e3){for(q[ce]=[0,""],q[ce][0]=O.read_shift(2);O[O.l];)q[ce][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return q}function Ce(O,Z){var q=we(5+O.length);q.write_shift(2,14e3),q.write_shift(2,Z);for(var X=0;X<O.length;++X){var ce=O.charCodeAt(X);q[q.l++]=ce>127?95:ce}return q[q.l++]=0,q}var fe={0:{n:"BOF",f:dR},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},F={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:x},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}}(),Rq=/^\s|\s$|[\t\n\r]/;function _R(n,e){if(!e.bookSST)return"";var t=[An];t[t.length]=Ue("sst",null,{xmlns:Fl[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Rq)&&(s+=' xml:space="preserve"'),s+=">"+Lt(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function bq(n){return[n.read_shift(4),n.read_shift(4)]}function kq(n,e){return e||(e=we(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var Pq=TG;function Oq(n){var e=Pr();be(e,159,kq(n));for(var t=0;t<n.length;++t)be(e,19,Pq(n[t]));return be(e,160),e.end()}function Nq(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function yR(n){var e=0,t,r=Nq(n),i=r.length+1,s,o,a,l,c;for(t=ia(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)o=t[s],a=e&16384?1:0,l=e<<1&32767,c=a|l,e=c^o;return e^52811}var Dq=function(){function n(i,s){switch(s.type){case"base64":return e(ks(i),s);case"binary":return e(i,s);case"buffer":return e(bt&&Buffer.isBuffer(i)?i.toString("binary"):Ou(i),s);case"array":return e(Jf(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(a)&&(a[f]=[]);for(var p=/\\\w+\b/g,g=0,m,v=-1;m=p.exec(u);){switch(m[0]){case"\\cell":var _=u.slice(g,p.lastIndex-m[0].length);if(_[0]==" "&&(_=_.slice(1)),++v,_.length){var D={v:_,t:"s"};Array.isArray(a)?a[f][v]=D:a[Bt({r:f,c:v})]=D}break}g=p.lastIndex}v>c.e.c&&(c.e.c=v)}),a["!ref"]=wn(c),a}function t(i,s){return fa(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=en(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Bt({r:c,c:u});a=l?(i[c]||[])[u]:i[f],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(Ps(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}}();function cT(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var Mq=6,Es=Mq;function Ld(n){return Math.floor((n+Math.round(128/Es)/256)*Es)}function Ud(n){return Math.floor((n-5)/Es*100+.5)/100}function lg(n){return Math.round((n*Es+5)/Es*256)/256}function Nv(n){n.width?(n.wpx=Ld(n.width),n.wch=Ud(n.wpx),n.MDW=Es):n.wpx?(n.wch=Ud(n.wpx),n.width=lg(n.wch),n.MDW=Es):typeof n.wch=="number"&&(n.width=lg(n.wch),n.wpx=Ld(n.width),n.MDW=Es),n.customWidth&&delete n.customWidth}var Fq=96,ER=Fq;function Bd(n){return n*96/ER}function TR(n){return n*ER/96}function Lq(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=Ue("numFmt",null,{numFmtId:r,formatCode:Lt(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Uq(n){var e=[];return e[e.length]=Ue("cellXfs",null),n.forEach(function(t){e[e.length]=Ue("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function wR(n,e){var t=[An,Ue("styleSheet",null,{xmlns:Fl[0],"xmlns:vt":Dn.vt})],r;return n.SSF&&(r=Lq(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=Uq(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Bq(n,e){var t=n.read_shift(2),r=ur(n);return[t,r]}function Vq(n,e,t){t||(t=we(6+4*e.length)),t.write_shift(2,n),Fn(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function Hq(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=RG(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=n.read_shift(1);o!=0&&(r.underline=o);var a=n.read_shift(1);a>0&&(r.family=a);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=xG(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ur(n),r}function $q(n,e){e||(e=we(25+4*32)),e.write_shift(2,n.sz*20),bG(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Md(n.color,e);var r=0;return r=2,e.write_shift(1,r),Fn(n.name,e),e.length>e.l?e.slice(0,e.l):e}var Kq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zp,jq=Gi;function uT(n,e){e||(e=we(4*3+8*7+16*1)),zp||(zp=Tv(Kq));var t=zp[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(Md({auto:1},e),Md({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Wq(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function AR(n,e,t){t||(t=we(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function tc(n,e){return e||(e=we(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Gq=Gi;function qq(n,e){return e||(e=we(51)),e.write_shift(1,0),tc(null,e),tc(null,e),tc(null,e),tc(null,e),tc(null,e),e.length>e.l?e.slice(0,e.l):e}function zq(n,e){return e||(e=we(12+4*10)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Dd(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Yq(n,e,t){var r=we(2052);return r.write_shift(4,n),Dd(e,r),Dd(t,r),r.length>r.l?r.slice(0,r.l):r}function Qq(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(be(n,615,vi(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&be(n,44,Vq(i,e[i]))}),be(n,616))}}function Xq(n){var e=1;be(n,611,vi(e)),be(n,43,$q({sz:12,color:{theme:1},name:"Calibri",family:2})),be(n,612)}function Jq(n){var e=2;be(n,603,vi(e)),be(n,45,uT({patternType:"none"})),be(n,45,uT({patternType:"gray125"})),be(n,604)}function Zq(n){var e=1;be(n,613,vi(e)),be(n,46,qq()),be(n,614)}function ez(n){var e=1;be(n,626,vi(e)),be(n,47,AR({numFmtId:0},65535)),be(n,627)}function tz(n,e){be(n,617,vi(e.length)),e.forEach(function(t){be(n,47,AR(t,0))}),be(n,618)}function nz(n){var e=1;be(n,619,vi(e)),be(n,48,zq({xfId:0,name:"Normal"})),be(n,620)}function rz(n){var e=0;be(n,505,vi(e)),be(n,506)}function iz(n){var e=0;be(n,508,Yq(e,"TableStyleMedium9","PivotStyleMedium4")),be(n,509)}function sz(n,e){var t=Pr();return be(t,278),Qq(t,n.SSF),Xq(t),Jq(t),Zq(t),ez(t),tz(t,e.cellXfs),nz(t),rz(t),iz(t),be(t,279),t.end()}function CR(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[An];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function oz(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:ur(n)}}function az(n){var e=we(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),Fn(n.name,e),e.slice(0,e.l)}function lz(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function cz(n){var e=we(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function uz(n,e){var t=we(8+2*e.length);return t.write_shift(4,n),Fn(e,t),t.slice(0,t.l)}function hz(n){return n.l+=4,n.read_shift(4)!=0}function dz(n,e){var t=we(8);return t.write_shift(4,n),t.write_shift(4,1),t}function fz(){var n=Pr();return be(n,332),be(n,334,vi(1)),be(n,335,az({name:"XLDAPR",version:12e4,flags:3496657072})),be(n,336),be(n,339,uz(1,"XLDAPR")),be(n,52),be(n,35,vi(514)),be(n,4096,vi(0)),be(n,4097,Zr(1)),be(n,36),be(n,53),be(n,340),be(n,337,dz(1)),be(n,51,cz([[1,0]])),be(n,338),be(n,333),n.end()}function SR(){var n=[An];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function pz(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Bt(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var ja=1024;function IR(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[Ue("xml",null,{"xmlns:v":Kr.v,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:mv":Kr.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];ja<n*1e3;)ja+=1e3;return e.forEach(function(s){var o=Mn(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ue("v:fill",l,a),u={on:"t",obscured:"t"};++ja,i=i.concat(["<v:shape"+eu({id:"_x0000_s"+ja,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ue("v:shadow",null,u),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),qn("x:AutoFill","False"),qn("x:Row",String(o.r)),qn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function xR(n){var e=[An,Ue("comments",null,{xmlns:Fl[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Lt(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Lt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(qn("t",Lt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(qn("t",Lt(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function gz(n,e,t){var r=[An,Ue("ThreadedComments",null,{xmlns:Dn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),r.push(Ue("threadedComment",qn("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function mz(n){var e=[An,Ue("personList",null,{xmlns:Dn.TCMNT,"xmlns:x":Fl[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(Ue("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function vz(n){var e={};e.iauthor=n.read_shift(4);var t=va(n);return e.rfx=t.s,e.ref=Bt(t.s),n.l+=16,e}function _z(n,e){return e==null&&(e=we(36)),e.write_shift(4,n[1].iauthor),Ul(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var yz=ur;function Ez(n){return Fn(n.slice(0,54))}function Tz(n){var e=Pr(),t=[];return be(e,628),be(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),be(e,632,Ez(i.a)))})}),be(e,631),be(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Mn(r[0]),e:Mn(r[0])};be(e,635,_z([s,i])),i.t&&i.t.length>0&&be(e,637,AG(i)),be(e,636),delete i.iauthor})}),be(e,634),be(e,629),e.end()}function wz(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Vt.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var RR=["xlsb","xlsm","xlam","biff8","xla"],Az=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+cr(u)+(l?"":"$")+Qn(c)}return function(i,s){return e=s,i.replace(n,t)}}(),Dv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Mv=function(){return function(e,t){return e.replace(Dv,function(r,i,s,o,a,l){var c=Rv(o)-(s?0:t.c),u=xv(l)-(a?0:t.r),f=u==0?"":a?u+1:"["+u+"]",p=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+p})}}();function Cz(n,e){return n.replace(Dv,function(t,r,i,s,o,a){return r+(i=="$"?i+s:cr(Rv(s)+e.c))+(o=="$"?o+a:Qn(xv(a)+e.r))})}function Sz(n){return n.length!=1}function _n(n){n.l+=1}function Eo(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function bR(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return kR(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),o=Eo(n),a=Eo(n);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function kR(n){var e=Eo(n),t=Eo(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Iz(n,e,t){if(t.biff<8)return kR(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=Eo(n),o=Eo(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function PR(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return xz(n);var r=n.read_shift(t&&t.biff==12?4:2),i=Eo(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function xz(n){var e=Eo(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Rz(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function bz(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return kz(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function kz(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function Pz(n,e,t){var r=(n[n.l++]&96)>>5,i=bR(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function Oz(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var o=bR(n,s,t);return[r,i,o]}function Nz(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function Dz(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function Mz(n,e,t){var r=(n[n.l++]&96)>>5,i=Iz(n,e-1,t);return[r,i]}function Fz(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function hT(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function Lz(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function Uz(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Bz(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Vz(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function Hz(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function OR(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function $z(n){return n.read_shift(2),OR(n)}function Kz(n){return n.read_shift(2),OR(n)}function jz(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=PR(n,0,t);return[r,i]}function Wz(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=bz(n,0,t);return[r,i]}function Gz(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=PR(n,0,t);return[r,i,s]}function qz(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[qY[i],MR[i],r]}function zz(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:Yz(n);return[i,(s[0]===0?MR:GY)[s[1]]]}function Yz(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function Qz(n,e,t){n.l+=t&&t.biff==2?3:4}function Xz(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Jz(n){return n.l++,Mu[n.read_shift(1)]}function Zz(n){return n.l++,n.read_shift(2)}function eY(n){return n.l++,n.read_shift(1)!==0}function tY(n){return n.l++,Bl(n)}function nY(n,e,t){return n.l++,pR(n,e-1,t)}function rY(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=GG(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=Mu[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Bl(n);break;case 2:t[1]=QG(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function iY(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?va:ZG)(n));return i}function sY(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=rY(n,t.biff);return o}function oY(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function aY(n,e,t){if(t.biff==5)return lY(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function lY(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function cY(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function uY(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function hY(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function dY(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var fY=Gi,pY=Gi,gY=Gi;function Fu(n,e,t){return n.l+=2,[Rz(n)]}function Fv(n){return n.l+=6,[]}var mY=Fu,vY=Fv,_Y=Fv,yY=Fu;function NR(n){return n.l+=2,[dR(n),n.read_shift(2)&1]}var EY=Fu,TY=NR,wY=Fv,AY=Fu,CY=Fu,SY=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function IY(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),o=SY[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:r,c:i,C:s}}function xY(n){return n.l+=2,[n.read_shift(4)]}function RY(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function bY(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function kY(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function PY(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function OY(n){return n.l+=4,[0,0]}var dT={1:{n:"PtgExp",f:Xz},2:{n:"PtgTbl",f:gY},3:{n:"PtgAdd",f:_n},4:{n:"PtgSub",f:_n},5:{n:"PtgMul",f:_n},6:{n:"PtgDiv",f:_n},7:{n:"PtgPower",f:_n},8:{n:"PtgConcat",f:_n},9:{n:"PtgLt",f:_n},10:{n:"PtgLe",f:_n},11:{n:"PtgEq",f:_n},12:{n:"PtgGe",f:_n},13:{n:"PtgGt",f:_n},14:{n:"PtgNe",f:_n},15:{n:"PtgIsect",f:_n},16:{n:"PtgUnion",f:_n},17:{n:"PtgRange",f:_n},18:{n:"PtgUplus",f:_n},19:{n:"PtgUminus",f:_n},20:{n:"PtgPercent",f:_n},21:{n:"PtgParen",f:_n},22:{n:"PtgMissArg",f:_n},23:{n:"PtgStr",f:nY},26:{n:"PtgSheet",f:RY},27:{n:"PtgEndSheet",f:bY},28:{n:"PtgErr",f:Jz},29:{n:"PtgBool",f:eY},30:{n:"PtgInt",f:Zz},31:{n:"PtgNum",f:tY},32:{n:"PtgArray",f:Fz},33:{n:"PtgFunc",f:qz},34:{n:"PtgFuncVar",f:zz},35:{n:"PtgName",f:oY},36:{n:"PtgRef",f:jz},37:{n:"PtgArea",f:Pz},38:{n:"PtgMemArea",f:cY},39:{n:"PtgMemErr",f:fY},40:{n:"PtgMemNoMem",f:pY},41:{n:"PtgMemFunc",f:uY},42:{n:"PtgRefErr",f:hY},43:{n:"PtgAreaErr",f:Nz},44:{n:"PtgRefN",f:Wz},45:{n:"PtgAreaN",f:Mz},46:{n:"PtgMemAreaN",f:kY},47:{n:"PtgMemNoMemN",f:PY},57:{n:"PtgNameX",f:aY},58:{n:"PtgRef3d",f:Gz},59:{n:"PtgArea3d",f:Oz},60:{n:"PtgRefErr3d",f:dY},61:{n:"PtgAreaErr3d",f:Dz},255:{}},NY={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},DY={1:{n:"PtgElfLel",f:NR},2:{n:"PtgElfRw",f:AY},3:{n:"PtgElfCol",f:mY},6:{n:"PtgElfRwV",f:CY},7:{n:"PtgElfColV",f:yY},10:{n:"PtgElfRadical",f:EY},11:{n:"PtgElfRadicalS",f:wY},13:{n:"PtgElfColS",f:vY},15:{n:"PtgElfColSV",f:_Y},16:{n:"PtgElfRadicalLel",f:TY},25:{n:"PtgList",f:IY},29:{n:"PtgSxName",f:xY},255:{}},MY={0:{n:"PtgAttrNoop",f:OY},1:{n:"PtgAttrSemi",f:Hz},2:{n:"PtgAttrIf",f:Bz},4:{n:"PtgAttrChoose",f:Lz},8:{n:"PtgAttrGoto",f:Uz},16:{n:"PtgAttrSum",f:Qz},32:{n:"PtgAttrBaxcel",f:hT},33:{n:"PtgAttrBaxcel",f:hT},64:{n:"PtgAttrSpace",f:$z},65:{n:"PtgAttrSpaceSemi",f:Kz},128:{n:"PtgAttrIfError",f:Vz},255:{}};function FY(n,e,t,r){if(r.biff<8)return Gi(n,e);for(var i=n.l+e,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=sY(n,0,r),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=iY(n,t[o][1],r),s.push(t[o][2]);break;case"PtgExp":r&&r.biff==12&&(t[o][1][1]=n.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=i-n.l,e!==0&&s.push(Gi(n,e)),s}function LY(n,e,t){for(var r=n.l+e,i,s,o=[];r!=n.l;)e=r-n.l,s=n[n.l],i=dT[s]||dT[NY[s]],(s===24||s===25)&&(i=(s===24?DY:MY)[n[n.l+1]]),!i||!i.f?Gi(n,e):o.push([i.n,i.f(n,e,t)]);return o}function UY(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var BY={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function VY(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function DR(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function fT(n,e,t){var r=DR(n,e,t);return r=="#REF"?r:VY(r,t)}function wl(n,e,t,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,f=0,p=0,g,m="";if(!n[0]||!n[0][0])return"";for(var v=-1,_="",D=0,b=n[0].length;D<b;++D){var T=n[0][D];switch(T[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),v>=0){switch(n[0][v][1][0]){case 0:_=ln(" ",n[0][v][1][1]);break;case 1:_=ln("\r",n[0][v][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][v][1][0])}c=c+_,v=-1}a.push(c+BY[T[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Pc(T[1][1],o,i),a.push(Oc(u,s));break;case"PtgRefN":u=t?Pc(T[1][1],t,i):T[1][1],a.push(Oc(u,s));break;case"PtgRef3d":f=T[1][1],u=Pc(T[1][2],o,i),m=fT(r,f,i),a.push(m+"!"+Oc(u,s));break;case"PtgFunc":case"PtgFuncVar":var R=T[1][0],B=T[1][1];R||(R=0),R&=127;var W=R==0?[]:a.slice(-R);a.length-=R,B==="User"&&(B=W.shift()),a.push(B+"("+W.join(",")+")");break;case"PtgBool":a.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(T[1]);break;case"PtgNum":a.push(String(T[1]));break;case"PtgStr":a.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(T[1]);break;case"PtgAreaN":g=XE(T[1][1],t?{s:t}:o,i),a.push(Gp(g,i));break;case"PtgArea":g=XE(T[1][1],o,i),a.push(Gp(g,i));break;case"PtgArea3d":f=T[1][1],g=T[1][2],m=fT(r,f,i),a.push(m+"!"+Gp(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=T[1][2];var A=(r.names||[])[p-1]||(r[0]||[])[p],w=A?A.Name:"SH33TJSNAME"+String(p);w&&w.slice(0,6)=="_xlfn."&&!i.xlfn&&(w=w.slice(6)),a.push(w);break;case"PtgNameX":var E=T[1][1];p=T[1][2];var C;if(i.biff<=5)E<0&&(E=-E),r[E]&&(C=r[E][p]);else{var I="";if(((r[E]||[])[0]||[])[0]==14849||(((r[E]||[])[0]||[])[0]==1025?r[E][p]&&r[E][p].itab>0&&(I=r.SheetNames[r[E][p].itab-1]+"!"):I=r.SheetNames[p-1]+"!"),r[E]&&r[E][p])I+=r[E][p].Name;else if(r[0]&&r[0][p])I+=r[0][p].Name;else{var x=(DR(r,E,i)||"").split(";;");x[p-1]?I=x[p-1]:I+="SH33TJSERRX"}a.push(I);break}C||(C={Name:"SH33TJSERRY"}),a.push(C.Name);break;case"PtgParen":var P="(",ie=")";if(v>=0){switch(_="",n[0][v][1][0]){case 2:P=ln(" ",n[0][v][1][1])+P;break;case 3:P=ln("\r",n[0][v][1][1])+P;break;case 4:ie=ln(" ",n[0][v][1][1])+ie;break;case 5:ie=ln("\r",n[0][v][1][1])+ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][v][1][0])}v=-1}a.push(P+a.pop()+ie);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:T[1][1],r:T[1][0]};var Q={c:t.c,r:t.r};if(r.sharedf[Bt(u)]){var ae=r.sharedf[Bt(u)];a.push(wl(ae,o,Q,r,i))}else{var Ae=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(wl(c[1],o,Q,r,i)),Ae=!0;break}Ae||a.push(T[1])}break;case"PtgArray":a.push("{"+UY(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var Oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&Oe.indexOf(n[0][D][0])==-1){T=n[0][v];var Ce=!0;switch(T[1][0]){case 4:Ce=!1;case 0:_=ln(" ",T[1][1]);break;case 5:Ce=!1;case 1:_=ln("\r",T[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}a.push((Ce?_:"")+a.pop()+(Ce?"":_)),v=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function HY(n){if(n==null){var e=we(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return sa(n);return sa(0)}function $Y(n,e,t,r,i){var s=oa(e,t,i),o=HY(n.v),a=we(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=we(n.bf.length),u=0;u<n.bf.length;++u)c[u]=n.bf[u];var f=Gn([s,o,a,c]);return f}function Zf(n,e,t){var r=n.read_shift(4),i=LY(n,r,t),s=n.read_shift(4),o=s>0?FY(n,s,i,t):null;return[i,o]}var KY=Zf,ep=Zf,jY=Zf,WY=Zf,GY={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},MR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qY={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function zY(n){var e="of:="+n.replace(Dv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function YY(n){return n.replace(/\./,"!")}var Nc=typeof Map<"u";function Lv(n,e,t){var r=0,i=n.length;if(t){if(Nc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Nc?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(Nc?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function tp(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(Es=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=Ud(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=lg(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function FR(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Ao(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){Px(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function QY(n,e,t){if(n&&n["!ref"]){var r=en(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function XY(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+wn(n[t])+'"/>';return e+"</mergeCells>"}function JY(n,e,t,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,o.codeName=Zc(Lt(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),a=(a||"")+Ue("outlinePr",null,c)}!s&&!a||(i[i.length]=Ue("sheetPr",a,o))}var ZY=["objects","scenarios","selectLockedCells","selectUnlockedCells"],eQ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function tQ(n){var e={sheet:1};return ZY.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),eQ.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=yR(n.password).toString(16).toUpperCase()),Ue("sheetProtection",null,e)}function nQ(n){return FR(n),Ue("pageMargins",null,n)}function rQ(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=Ue("col",null,tp(i,r)));return t[t.length]="</cols>",t.join("")}function iQ(n,e,t,r){var i=typeof n.ref=="string"?n.ref:wn(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=Qr(i);o.s.r==o.e.r&&(o.e.r=Qr(e["!ref"]).e.r,i=wn(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),Ue("autoFilter",null,{ref:i})}function sQ(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,i),{})}function oQ(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,o=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=Mu[n.v];break;case"d":r&&r.cellDates?i=Ar(n.v,-1).toISOString():(n=Nr(n),n.t="n",i=""+(n.v=Or(Ar(n.v)))),typeof n.z>"u"&&(n.z=un[14]);break;default:i=n.v;break}var a=qn("v",Lt(i)),l={r:e},c=Ao(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=qn("v",""+Lv(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=o),typeof n.f=="string"&&n.f){var u=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;a=Ue("f",Lt(n.f),u)+(n.v!=null?a:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),Ue("c",a,l)}function aQ(n,e,t,r){var i=[],s=[],o=en(n["!ref"]),a="",l,c="",u=[],f=0,p=0,g=n["!rows"],m=Array.isArray(n),v={r:c},_,D=-1;for(p=o.s.c;p<=o.e.c;++p)u[p]=cr(p);for(f=o.s.r;f<=o.e.r;++f){for(s=[],c=Qn(f),p=o.s.c;p<=o.e.c;++p){l=u[p]+c;var b=m?(n[f]||[])[p]:n[l];b!==void 0&&(a=oQ(b,l,n,e))!=null&&s.push(a)}(s.length>0||g&&g[f])&&(v={r:c},g&&g[f]&&(_=g[f],_.hidden&&(v.hidden=1),D=-1,_.hpx?D=Bd(_.hpx):_.hpt&&(D=_.hpt),D>-1&&(v.ht=D,v.customHeight=1),_.level&&(v.outlineLevel=_.level)),i[i.length]=Ue("row",s.join(""),v))}if(g)for(;f<g.length;++f)g&&g[f]&&(v={r:f+1},_=g[f],_.hidden&&(v.hidden=1),D=-1,_.hpx?D=Bd(_.hpx):_.hpt&&(D=_.hpt),D>-1&&(v.ht=D,v.customHeight=1),_.level&&(v.outlineLevel=_.level),i[i.length]=Ue("row","",v));return i.join("")}function LR(n,e,t,r){var i=[An,Ue("worksheet",null,{xmlns:Fl[0],"xmlns:r":Dn.r})],s=t.SheetNames[n],o=0,a="",l=t.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=en(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=wn(u)}r||(r={}),l["!comments"]=[];var f=[];JY(l,t,n,e,i),i[i.length]=Ue("dimension",null,{ref:c}),i[i.length]=sQ(l,e,n,t),e.sheetFormat&&(i[i.length]=Ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=rQ(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=aQ(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=tQ(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=iQ(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=XY(l["!merges"]));var p=-1,g,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(g={ref:v[0]},v[1].Target.charAt(0)!="#"&&(m=Ft(r,-1,Lt(v[1].Target).replace(/#.*$/,""),xt.HLINK),g["r:id"]="rId"+m),(p=v[1].Target.indexOf("#"))>-1&&(g.location=Lt(v[1].Target.slice(p+1))),v[1].Tooltip&&(g.tooltip=Lt(v[1].Tooltip)),i[i.length]=Ue("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=nQ(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=qn("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(m=Ft(r,-1,"../drawings/drawing"+(n+1)+".xml",xt.DRAW),i[i.length]=Ue("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=f),l["!comments"].length>0&&(m=Ft(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",xt.VML),i[i.length]=Ue("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function lQ(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function cQ(n,e,t){var r=we(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=Bd(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:n,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var f=-1,p=-1,g=u<<10;g<u+1<<10;++g){c.c=g;var m=Array.isArray(t)?(t[c.r]||[])[c.c]:t[Bt(c)];m&&(f<0&&(f=g),p=g)}f<0||(++a,r.write_shift(4,f),r.write_shift(4,p))}var v=r.l;return r.l=l,r.write_shift(4,a),r.l=v,r.length>r.l?r.slice(0,r.l):r}function uQ(n,e,t,r){var i=cQ(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&be(n,0,i)}var hQ=va,dQ=Ul;function fQ(){}function pQ(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=CG(n),t}function gQ(n,e,t){t==null&&(t=we(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return Md({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Jx(n,t),t.slice(0,t.l)}function mQ(n){var e=ri(n);return[e]}function vQ(n,e,t){return t==null&&(t=we(8)),pa(e,t)}function _Q(n){var e=ga(n);return[e]}function yQ(n,e,t){return t==null&&(t=we(4)),ma(e,t)}function EQ(n){var e=ri(n),t=n.read_shift(1);return[e,t,"b"]}function TQ(n,e,t){return t==null&&(t=we(9)),pa(e,t),t.write_shift(1,n.v?1:0),t}function wQ(n){var e=ga(n),t=n.read_shift(1);return[e,t,"b"]}function AQ(n,e,t){return t==null&&(t=we(5)),ma(e,t),t.write_shift(1,n.v?1:0),t}function CQ(n){var e=ri(n),t=n.read_shift(1);return[e,t,"e"]}function SQ(n,e,t){return t==null&&(t=we(9)),pa(e,t),t.write_shift(1,n.v),t}function IQ(n){var e=ga(n),t=n.read_shift(1);return[e,t,"e"]}function xQ(n,e,t){return t==null&&(t=we(8)),ma(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function RQ(n){var e=ri(n),t=n.read_shift(4);return[e,t,"s"]}function bQ(n,e,t){return t==null&&(t=we(12)),pa(e,t),t.write_shift(4,e.v),t}function kQ(n){var e=ga(n),t=n.read_shift(4);return[e,t,"s"]}function PQ(n,e,t){return t==null&&(t=we(8)),ma(e,t),t.write_shift(4,e.v),t}function OQ(n){var e=ri(n),t=Bl(n);return[e,t,"n"]}function NQ(n,e,t){return t==null&&(t=we(16)),pa(e,t),sa(n.v,t),t}function DQ(n){var e=ga(n),t=Bl(n);return[e,t,"n"]}function MQ(n,e,t){return t==null&&(t=we(12)),ma(e,t),sa(n.v,t),t}function FQ(n){var e=ri(n),t=Zx(n);return[e,t,"n"]}function LQ(n,e,t){return t==null&&(t=we(12)),pa(e,t),eR(n.v,t),t}function UQ(n){var e=ga(n),t=Zx(n);return[e,t,"n"]}function BQ(n,e,t){return t==null&&(t=we(8)),ma(e,t),eR(n.v,t),t}function VQ(n){var e=ri(n),t=bv(n);return[e,t,"is"]}function HQ(n){var e=ri(n),t=ur(n);return[e,t,"str"]}function $Q(n,e,t){return t==null&&(t=we(12+4*n.v.length)),pa(e,t),Fn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function KQ(n){var e=ga(n),t=ur(n);return[e,t,"str"]}function jQ(n,e,t){return t==null&&(t=we(8+4*n.v.length)),ma(e,t),Fn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function WQ(n,e,t){var r=n.l+e,i=ri(n);i.r=t["!row"];var s=n.read_shift(1),o=[i,s,"b"];if(t.cellFormula){n.l+=2;var a=ep(n,r-n.l,t);o[3]=wl(a,null,i,t.supbooks,t)}else n.l=r;return o}function GQ(n,e,t){var r=n.l+e,i=ri(n);i.r=t["!row"];var s=n.read_shift(1),o=[i,s,"e"];if(t.cellFormula){n.l+=2;var a=ep(n,r-n.l,t);o[3]=wl(a,null,i,t.supbooks,t)}else n.l=r;return o}function qQ(n,e,t){var r=n.l+e,i=ri(n);i.r=t["!row"];var s=Bl(n),o=[i,s,"n"];if(t.cellFormula){n.l+=2;var a=ep(n,r-n.l,t);o[3]=wl(a,null,i,t.supbooks,t)}else n.l=r;return o}function zQ(n,e,t){var r=n.l+e,i=ri(n);i.r=t["!row"];var s=ur(n),o=[i,s,"str"];if(t.cellFormula){n.l+=2;var a=ep(n,r-n.l,t);o[3]=wl(a,null,i,t.supbooks,t)}else n.l=r;return o}var YQ=va,QQ=Ul;function XQ(n,e){return e==null&&(e=we(4)),e.write_shift(4,n),e}function JQ(n,e){var t=n.l+e,r=va(n),i=kv(n),s=ur(n),o=ur(n),a=ur(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function ZQ(n,e){var t=we(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Ul({s:Mn(n[0]),e:Mn(n[0])},t),Pv("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return Fn(i||"",t),Fn(n[1].Tooltip||"",t),Fn("",t),t.slice(0,t.l)}function eX(){}function tX(n,e,t){var r=n.l+e,i=tR(n),s=n.read_shift(1),o=[i];if(o[2]=s,t.cellFormula){var a=KY(n,r-n.l,t);o[1]=a}else n.l=r;return o}function nX(n,e,t){var r=n.l+e,i=va(n),s=[i];if(t.cellFormula){var o=WY(n,r-n.l,t);s[1]=o,n.l=r}else n.l=r;return s}function rX(n,e,t){t==null&&(t=we(18));var r=tp(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var UR=["left","right","top","bottom","header","footer"];function iX(n){var e={};return UR.forEach(function(t){e[t]=Bl(n)}),e}function sX(n,e){return e==null&&(e=we(6*8)),FR(n),UR.forEach(function(t){sa(n[t],e)}),e}function oX(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function aX(n,e,t){t==null&&(t=we(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function lX(n){var e=we(24);return e.write_shift(4,4),e.write_shift(4,1),Ul(n,e),e}function cX(n,e){return e==null&&(e=we(16*4+2)),e.write_shift(2,n.password?yR(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function uX(){}function hX(){}function dX(n,e,t,r,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=Nr(e),e.z=e.z||un[14],e.v=Or(Ar(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r:t,c:r};switch(l.s=Ao(i.cellXfs,e,i),e.l&&s["!links"].push([Bt(l),e.l]),e.c&&s["!comments"].push([Bt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=Lv(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?be(n,18,PQ(e,l)):be(n,7,bQ(e,l))):(l.t="str",o?be(n,17,jQ(e,l)):be(n,6,$Q(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?be(n,13,BQ(e,l)):be(n,2,LQ(e,l)):o?be(n,16,MQ(e,l)):be(n,5,NQ(e,l)),!0;case"b":return l.t="b",o?be(n,15,AQ(e,l)):be(n,4,TQ(e,l)),!0;case"e":return l.t="e",o?be(n,14,xQ(e,l)):be(n,3,SQ(e,l)),!0}return o?be(n,12,yQ(e,l)):be(n,1,vQ(e,l)),!0}function fX(n,e,t,r){var i=en(e["!ref"]||"A1"),s,o="",a=[];be(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=Qn(u),uQ(n,e,i,u);var f=!1;if(u<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){u===i.s.r&&(a[p]=cr(p)),s=a[p]+o;var g=l?(e[u]||[])[p]:e[s];if(!g){f=!1;continue}f=dX(n,g,u,p,r,e,f)}}be(n,146)}function pX(n,e){!e||!e["!merges"]||(be(n,177,XQ(e["!merges"].length)),e["!merges"].forEach(function(t){be(n,176,QQ(t))}),be(n,178))}function gX(n,e){!e||!e["!cols"]||(be(n,390),e["!cols"].forEach(function(t,r){t&&be(n,60,rX(r,t))}),be(n,391))}function mX(n,e){!e||!e["!ref"]||(be(n,648),be(n,649,lX(en(e["!ref"]))),be(n,650))}function vX(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Ft(t,-1,r[1].Target.replace(/#.*$/,""),xt.HLINK);be(n,494,ZQ(r,i))}}),delete e["!links"]}function _X(n,e,t,r){if(e["!comments"].length>0){var i=Ft(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",xt.VML);be(n,551,Pv("rId"+i)),e["!legacy"]=i}}function yX(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:wn(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,a=Qr(s);a.s.r==a.e.r&&(a.e.r=Qr(e["!ref"]).e.r,s=wn(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),be(n,161,Ul(en(s))),be(n,162)}}function EX(n,e,t){be(n,133),be(n,137,aX(e,t)),be(n,138),be(n,134)}function TX(n,e){e["!protect"]&&be(n,535,cX(e["!protect"]))}function wX(n,e,t,r){var i=Pr(),s=t.SheetNames[n],o=t.Sheets[s]||{},a=s;try{t&&t.Workbook&&(a=t.Workbook.Sheets[n].CodeName||a)}catch{}var l=en(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],be(i,129),(t.vbaraw||o["!outline"])&&be(i,147,gQ(a,o["!outline"])),be(i,148,dQ(l)),EX(i,o,t.Workbook),gX(i,o),fX(i,o,n,e),TX(i,o),yX(i,o,t,n),pX(i,o),vX(i,o,r),o["!margins"]&&be(i,476,sX(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&mX(i,o),_X(i,o,n,r),be(i,130),i.end()}function AX(n,e){n.l+=10;var t=ur(n);return{name:t}}var CX=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function SX(n){return!n.Workbook||!n.Workbook.WBProps?"false":nG(n.Workbook.WBProps.date1904)?"true":"false"}var IX="][*?/\\".split("");function BR(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return IX.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function xX(n,e,t){n.forEach(function(r,i){BR(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var o=e&&e[i]&&e[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function RX(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];xX(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)QY(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function VR(n){var e=[An];e[e.length]=Ue("workbook",null,{xmlns:Fl[0],"xmlns:r":Dn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(CX.forEach(function(a){n.Workbook.WBProps[a[0]]!=null&&n.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=n.Workbook.WBProps[a[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=Ue("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var o={name:Lt(n.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ue("sheet",null,o)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=Ue("definedName",Lt(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function bX(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=ag(n),t.name=ur(n),t}function kX(n,e){return e||(e=we(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),Pv(n.strRelID,e),Fn(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function PX(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?ur(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function OX(n,e){e||(e=we(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),Jx(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function NX(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=SG(n),o=jY(n,0,t),a=kv(n);n.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function DX(n,e){be(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};be(n,156,kX(i))}be(n,144)}function MX(n,e){e||(e=we(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Fn("SheetJS",e),Fn(xd.version,e),Fn(xd.version,e),Fn("7262",e),e.length>e.l?e.slice(0,e.l):e}function FX(n,e){e||(e=we(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function LX(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(be(n,135),be(n,158,FX(i)),be(n,136))}}function UX(n,e){var t=Pr();return be(t,131),be(t,128,MX()),be(t,153,OX(n.Workbook&&n.Workbook.WBProps||null)),LX(t,n),DX(t,n),be(t,132),t.end()}function BX(n,e,t){return(e.slice(-4)===".bin"?UX:VR)(n)}function VX(n,e,t,r,i){return(e.slice(-4)===".bin"?wX:LR)(n,t,r,i)}function HX(n,e,t){return(e.slice(-4)===".bin"?sz:wR)(n,t)}function $X(n,e,t){return(e.slice(-4)===".bin"?Oq:_R)(n,t)}function KX(n,e,t){return(e.slice(-4)===".bin"?Tz:xR)(n)}function jX(n){return(n.slice(-4)===".bin"?fz:SR)()}function WX(n,e){var t=[];return n.Props&&t.push(HG(n.Props,e)),n.Custprops&&t.push($G(n.Props,n.Custprops)),t.join("")}function GX(){return""}function qX(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(Ue("NumberFormat",null,{"ss:Format":Lt(un[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};t.push(Ue("Style",s.join(""),o))}),Ue("Styles",t.join(""))}function HR(n){return Ue("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Mv(n.Ref,{r:0,c:0})})}function zX(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(HR(i)))}return Ue("Names",t.join(""))}function YX(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==t&&(a.Name.match(/^_xlfn\./)||s.push(HR(a)))}return s.join("")}function QX(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(Ue("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(Ue("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(Ue("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(Ue("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(qn("ProtectContents","True")),n["!protect"].objects&&i.push(qn("ProtectObjects","True")),n["!protect"].scenarios&&i.push(qn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(qn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){n["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Ue("WorksheetOptions",i.join(""),{xmlns:Kr.x})}function XX(n){return n.map(function(e){var t=tG(e.t||""),r=Ue("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",r,{"ss:Author":e.a})}).join("")}function JX(n,e,t,r,i,s,o){if(!n||n.v==null&&n.f==null)return"";var a={};if(n.f&&(a["ss:Formula"]="="+Lt(Mv(n.f,o))),n.F&&n.F.slice(0,e.length)==e){var l=Mn(n.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(n.l&&n.l.Target&&(a["ss:HRef"]=Lt(n.l.Target),n.l.Tooltip&&(a["x:HRefScreenTip"]=Lt(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",p="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",p=String(n.v);break;case"b":f="Boolean",p=n.v?"1":"0";break;case"e":f="Error",p=Mu[n.v];break;case"d":f="DateTime",p=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||un[14]);break;case"s":f="String",p=eG(n.v||"");break}var g=Ao(r.cellXfs,n,r);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var m=n.v!=null?p:"",v=n.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(n.c||[]).length>0&&(v+=XX(n.c)),Ue("Cell",v,a)}function ZX(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=TR(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function eJ(n,e,t,r){if(!n["!ref"])return"";var i=en(n["!ref"]),s=n["!merges"]||[],o=0,a=[];n["!cols"]&&n["!cols"].forEach(function(_,D){Nv(_);var b=!!_.width,T=tp(D,_),R={"ss:Index":D+1};b&&(R["ss:Width"]=Ld(T.width)),_.hidden&&(R["ss:Hidden"]="1"),a.push(Ue("Column",null,R))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var u=[ZX(c,(n["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var p=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>c)&&!(s[o].e.c<f)&&!(s[o].e.r<c)){(s[o].s.c!=f||s[o].s.r!=c)&&(p=!0);break}if(!p){var g={r:c,c:f},m=Bt(g),v=l?(n[c]||[])[f]:n[m];u.push(JX(v,m,n,e,t,r,g))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function tJ(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],o=s?YX(s,e,n,t):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?eJ(s,e,n,t):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(QX(s,e,n,t)),r.join("")}function nJ(n,e){e||(e={}),n.SSF||(n.SSF=Nr(un)),n.SSF&&(Qf(),Yf(n.SSF),e.revssf=Xf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Ao(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(WX(n,e)),t.push(GX()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(Ue("Worksheet",tJ(r,e,n),{"ss:Name":Lt(n.SheetNames[r])}));return t[2]=qX(n,e),t[3]=zX(n),An+Ue("Workbook",t.join(""),{xmlns:Kr.ss,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:ss":Kr.ss,"xmlns:dt":Kr.dt,"xmlns:html":Kr.html})}var Yp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function rJ(n,e){var t=[],r=[],i=[],s=0,o,a=VE(ZE,"n"),l=VE(eT,"n");if(n.Props)for(o=Xn(n.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?t:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],n.Props[o[s]]]);if(n.Custprops)for(o=Xn(n.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?t:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],n.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)hR.indexOf(i[s][0])>-1||lR.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&Vt.utils.cfb_add(e,"/SummaryInformation",sT(r,Yp.SI,l,eT)),(t.length||c.length)&&Vt.utils.cfb_add(e,"/DocumentSummaryInformation",sT(t,Yp.DSI,a,ZE,c.length?c:null,Yp.UDI))}function iJ(n,e){var t=e||{},r=Vt.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Vt.utils.cfb_add(r,i,$R(n,t)),t.biff==8&&(n.Props||n.Custprops)&&rJ(n,r),t.biff==8&&n.vbaraw&&wz(r,Vt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var sJ={0:{f:lQ},1:{f:mQ},2:{f:FQ},3:{f:CQ},4:{f:EQ},5:{f:OQ},6:{f:HQ},7:{f:RQ},8:{f:zQ},9:{f:qQ},10:{f:WQ},11:{f:GQ},12:{f:_Q},13:{f:UQ},14:{f:IQ},15:{f:wQ},16:{f:DQ},17:{f:KQ},18:{f:kQ},19:{f:bv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:NX},40:{},42:{},43:{f:Hq},44:{f:Bq},45:{f:jq},46:{f:Gq},47:{f:Wq},48:{},49:{f:_G},50:{},51:{f:lz},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yq},62:{f:VQ},63:{f:pz},64:{f:uX},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:oX},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pQ},148:{f:hQ,p:16},151:{f:eX},152:{},153:{f:PX},154:{},155:{},156:{f:bX},157:{},158:{},159:{T:1,f:bq},160:{T:-1},161:{T:1,f:va},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:YQ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:oz},336:{T:-1},337:{f:hz,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ag},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fq},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:tX},427:{f:nX},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:iX},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fQ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JQ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ag},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yz},633:{T:1},634:{T:-1},635:{T:1,f:vz},636:{T:-1},637:{f:wG},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:AX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hX},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Be(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,o=n.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Iv(t)&&n.push(t)}}function oJ(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return Be(n,e,t,i);var s=e;if(!isNaN(s)){for(var o=t.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=n.next(4);for(u.write_shift(2,s),u.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(u=n.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function Lu(n,e,t){return n||(n=we(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function aJ(n,e,t,r){var i=we(9);return Lu(i,n,e),fR(t,r||"b",i),i}function lJ(n,e,t){var r=we(8+2*t.length);return Lu(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function cJ(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Or(Ar(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Be(n,2,Aq(t,r,i)):Be(n,3,wq(t,r,i));return;case"b":case"e":Be(n,5,aJ(t,r,e.v,e.t));return;case"s":case"str":Be(n,4,lJ(t,r,(e.v||"").slice(0,255)));return}Be(n,1,Lu(null,t,r))}function uJ(n,e,t,r){var i=Array.isArray(e),s=en(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=wn(s)}for(var c=s.s.r;c<=s.e.r;++c){a=Qn(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=cr(u)),o=l[u]+a;var f=i?(e[c]||[])[u]:e[o];f&&cJ(n,f,c,u)}}}function hJ(n,e){for(var t=e||{},r=Pr(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Be(r,t.biff==4?1033:t.biff==3?521:9,Ov(n,16,t)),uJ(r,n.Sheets[n.SheetNames[i]],i,t),Be(r,10),r.end()}function dJ(n,e,t){Be(n,49,sq({sz:12,name:"Arial"},t))}function fJ(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Be(n,1054,lq(i,e[i],t))})}function pJ(n,e){var t=we(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Be(n,2151,t),t=we(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),mR(en(e["!ref"]||"A1"),t),t.write_shift(4,4),Be(n,2152,t)}function gJ(n,e){for(var t=0;t<16;++t)Be(n,224,aT({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){Be(n,224,aT(r,0,e))})}function mJ(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];Be(n,440,mq(r)),r[1].Tooltip&&Be(n,2048,vq(r))}delete e["!links"]}function vJ(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&Be(n,125,Eq(tp(i,r),i))})}}function _J(n,e,t,r,i){var s=16+Ao(i.cellXfs,e,i);if(e.v==null&&!e.bf){Be(n,513,oa(t,r,s));return}if(e.bf)Be(n,6,$Y(e,t,r,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Or(Ar(e.v)):e.v;Be(n,515,dq(t,r,o,s));break;case"b":case"e":Be(n,517,hq(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=Lv(i.Strings,e.v,i.revStrings);Be(n,253,oq(t,r,a,s))}else Be(n,516,aq(t,r,(e.v||"").slice(0,255),s,i));break;default:Be(n,513,oa(t,r,s))}}function yJ(n,e,t){var r=Pr(),i=t.SheetNames[n],s=t.Sheets[i]||{},o=(t||{}).Workbook||{},a=(o.Sheets||[])[n]||{},l=Array.isArray(s),c=e.biff==8,u,f="",p=[],g=en(s["!ref"]||"A1"),m=c?65536:16384;if(g.e.c>255||g.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,m-1)}Be(r,2057,Ov(t,16,e)),Be(r,13,Zr(1)),Be(r,12,Zr(100)),Be(r,15,Er(!0)),Be(r,17,Er(!1)),Be(r,16,sa(.001)),Be(r,95,Er(!0)),Be(r,42,Er(!1)),Be(r,43,Er(!1)),Be(r,130,Zr(1)),Be(r,128,uq()),Be(r,131,Er(!1)),Be(r,132,Er(!1)),c&&vJ(r,s["!cols"]),Be(r,512,cq(g,e)),c&&(s["!links"]=[]);for(var v=g.s.r;v<=g.e.r;++v){f=Qn(v);for(var _=g.s.c;_<=g.e.c;++_){v===g.s.r&&(p[_]=cr(_)),u=p[_]+f;var D=l?(s[v]||[])[_]:s[u];D&&(_J(r,D,v,_,e),c&&D.l&&s["!links"].push([u,D.l]))}}var b=a.CodeName||a.name||i;return c&&Be(r,574,iq((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&Be(r,229,gq(s["!merges"])),c&&mJ(r,s),Be(r,442,gR(b)),c&&pJ(r,s),Be(r,10),r.end()}function EJ(n,e,t){var r=Pr(),i=(n||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=t.biff==8,l=t.biff==5;if(Be(r,2057,Ov(n,5,t)),t.bookType=="xla"&&Be(r,135),Be(r,225,a?Zr(1200):null),Be(r,193,WG(2)),l&&Be(r,191),l&&Be(r,192),Be(r,226),Be(r,92,eq("SheetJS",t)),Be(r,66,Zr(a?1200:1252)),a&&Be(r,353,Zr(0)),a&&Be(r,448),Be(r,317,Tq(n.SheetNames.length)),a&&n.vbaraw&&Be(r,211),a&&n.vbaraw){var c=o.CodeName||"ThisWorkbook";Be(r,442,gR(c))}Be(r,156,Zr(17)),Be(r,25,Er(!1)),Be(r,18,Er(!1)),Be(r,19,Zr(0)),a&&Be(r,431,Er(!1)),a&&Be(r,444,Zr(0)),Be(r,61,rq()),Be(r,64,Er(!1)),Be(r,141,Zr(0)),Be(r,34,Er(SX(n)=="true")),Be(r,14,Er(!0)),a&&Be(r,439,Er(!1)),Be(r,218,Zr(0)),dJ(r,n,t),fJ(r,n.SSF,t),gJ(r,t),a&&Be(r,352,Er(!1));var u=r.end(),f=Pr();a&&Be(f,140,_q()),a&&t.Strings&&oJ(f,252,nq(t.Strings)),Be(f,10);var p=f.end(),g=Pr(),m=0,v=0;for(v=0;v<n.SheetNames.length;++v)m+=(a?12:11)+(a?2:1)*n.SheetNames[v].length;var _=u.length+m+p.length;for(v=0;v<n.SheetNames.length;++v){var D=s[v]||{};Be(g,133,tq({pos:_,hs:D.Hidden||0,dt:0,name:n.SheetNames[v]},t)),_+=e[v].length}var b=g.end();if(m!=b.length)throw new Error("BS8 "+m+" != "+b.length);var T=[];return u.length&&T.push(u),b.length&&T.push(b),p.length&&T.push(p),Gn(T)}function TJ(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Nr(un)),n&&n.SSF&&(Qf(),Yf(n.SSF),t.revssf=Xf(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Uv(t),t.cellXfs=[],Ao(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=yJ(i,t,n);return r.unshift(EJ(n,r,t)),Gn(r)}function $R(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=Qr(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return TJ(n,e);case 4:case 3:case 2:return hJ(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function wJ(n,e,t,r){for(var i=n["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>o)&&!(i[c].e.r<t||i[c].e.c<o)){if(i[c].s.r<t||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=Bt({r:t,c:o}),f=r.dense?(n[t]||[])[o]:n[u],p=f&&f.v!=null&&(f.h||ZW(f.w||(Ps(f),f.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),r.editable?p='<span contenteditable="true">'+p+"</span>":f&&(g["data-t"]=f&&f.t||"z",f.v!=null&&(g["data-v"]=f.v),f.z!=null&&(g["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),g.id=(r.id||"sjs")+"-"+u,s.push(Ue("td",p,g))}}var m="<tr>";return m+s.join("")+"</tr>"}var AJ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',CJ="</body></html>";function SJ(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function KR(n,e){var t=e||{},r=t.header!=null?t.header:AJ,i=t.footer!=null?t.footer:CJ,s=[r],o=Qr(n["!ref"]);t.dense=Array.isArray(n),s.push(SJ(n,o,t));for(var a=o.s.r;a<=o.e.r;++a)s.push(wJ(n,o,a,t));return s.push("</table>"+i),s.join("")}function jR(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?Mn(r.origin):r.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var u=Qr(n["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],p=0,g=n["!rows"]||(n["!rows"]=[]),m=0,v=0,_=0,D=0,b=0,T=0;for(n["!cols"]||(n["!cols"]=[]);m<a.length&&v<l;++m){var R=a[m];if(pT(R)){if(r.display)continue;g[v]={hidden:!0}}var B=R.children;for(_=D=0;_<B.length;++_){var W=B[_];if(!(r.display&&pT(W))){var A=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):rG(W.innerHTML),w=W.getAttribute("data-z")||W.getAttribute("z");for(p=0;p<f.length;++p){var E=f[p];E.s.c==D+s&&E.s.r<v+i&&v+i<=E.e.r&&(D=E.e.c+1-s,p=-1)}T=+W.getAttribute("colspan")||1,((b=+W.getAttribute("rowspan")||1)>1||T>1)&&f.push({s:{r:v+i,c:D+s},e:{r:v+i+(b||1)-1,c:D+s+(T||1)-1}});var C={t:"s",v:A},I=W.getAttribute("data-t")||W.getAttribute("t")||"";A!=null&&(A.length==0?C.t=I||"z":r.raw||A.trim().length==0||I=="s"||(A==="TRUE"?C={t:"b",v:!0}:A==="FALSE"?C={t:"b",v:!1}:isNaN(ys(A))?isNaN(Jc(A).getDate())||(C={t:"d",v:Ar(A)},r.cellDates||(C={t:"n",v:Or(C.v)}),C.z=r.dateNF||un[14]):C={t:"n",v:ys(A)})),C.z===void 0&&w!=null&&(C.z=w);var x="",P=W.getElementsByTagName("A");if(P&&P.length)for(var ie=0;ie<P.length&&!(P[ie].hasAttribute("href")&&(x=P[ie].getAttribute("href"),x.charAt(0)!="#"));++ie);x&&x.charAt(0)!="#"&&(C.l={Target:x}),r.dense?(n[v+i]||(n[v+i]=[]),n[v+i][D+s]=C):n[Bt({c:D+s,r:v+i})]=C,c.e.c<D+s&&(c.e.c=D+s),D+=T}}++v}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,v-1+i),n["!ref"]=wn(c),v>=l&&(n["!fullref"]=wn((c.e.r=a.length-m+v-1+i,c))),n}function WR(n,e){var t=e||{},r=t.dense?[]:{};return jR(r,n,e)}function IJ(n,e){return fa(WR(n,e),e)}function pT(n){var e="",t=xJ(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function xJ(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var RJ=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+eu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return An+e}}(),gT=function(){var n=function(s){return Lt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Lt(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,f=Qr(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,m=Array.isArray(s);if(s["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var v="",_=s["!rows"]||[];for(c=0;c<f.s.r;++c)v=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;c<=f.e.r;++c){for(v=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+v+`>
`),u=0;u<f.s.c;++u)l.push(e);for(;u<=f.e.c;++u){var D=!1,b={},T="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>u)&&!(p[g].s.r>c)&&!(p[g].e.c<u)&&!(p[g].e.r<c)){(p[g].s.c!=u||p[g].s.r!=c)&&(D=!0),b["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,b["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(D){l.push(t);continue}var R=Bt({r:c,c:u}),B=m?(s[c]||[])[u]:s[R];if(B&&B.f&&(b["table:formula"]=Lt(zY(B.f)),B.F&&B.F.slice(0,R.length)==R)){var W=Qr(B.F);b["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,b["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!B){l.push(e);continue}switch(B.t){case"b":T=B.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=B.v?"true":"false";break;case"n":T=B.w||String(B.v||0),b["office:value-type"]="float",b["office:value"]=B.v||0;break;case"s":case"str":T=B.v==null?"":B.v,b["office:value-type"]="string";break;case"d":T=B.w||Ar(B.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Ar(B.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var A=n(T);if(B.l&&B.l.Target){var w=B.l.Target;w=w.charAt(0)=="#"?"#"+YY(w.slice(1)):w,w.charAt(0)!="#"&&!w.match(/^\w+:/)&&(w="../"+w),A=Ue("text:a",A,{"xlink:href":w.replace(/&/g,"&amp;")})}l.push("          "+Ue("table:table-cell",Ue("text:p",A,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Nv(f),f.ods=a;var p=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[An],c=eu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=eu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(oR().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)l.push(r(o.Sheets[o.SheetNames[f]],o,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function GR(n,e){if(e.bookType=="fods")return gT(n,e);var t=wv(),r="",i=[],s=[];return r="mimetype",mt(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",mt(t,r,gT(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",mt(t,r,RJ(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",mt(t,r,An+oR()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",mt(t,r,VG(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",mt(t,r,UG(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Vd(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function bJ(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):ci(Zc(n))}function kJ(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function To(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function PJ(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function tu(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Dt(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function rl(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function xn(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=tu(n,t),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);a=n.slice(l,t[0])}break;case 5:o=4,a=n.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,a=n.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=tu(n,t),a=n.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:a,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function $n(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Dt(r*8+i.type)),i.type==2&&e.push(Dt(i.data.length)),e.push(i.data))})}),To(e)}function oi(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=tu(n,r),s=xn(n.slice(r[0],r[0]+i));r[0]+=i;var o={id:rl(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=xn(a.data),c=rl(l[3][0].data);o.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(o.merge=rl(s[3][0].data)>>>0>0),t.push(o)}return t}function Ra(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Dt(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Dt(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Dt(o.data.length)}],r[2].push({data:$n(o.meta),type:2})});var s=$n(r);e.push(Dt(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),To(e)}function OJ(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=tu(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var o=e[t[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[t[0]],a>1&&(o|=e[t[0]+1]<<8),a>2&&(o|=e[t[0]+2]<<16),a>3&&(o|=e[t[0]+3]<<24),o>>>=0,o++,t[0]+=a}i.push(e.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[To(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=To(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function ai(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(OJ(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return To(e)}function ba(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Dt(r),o=s.length;e.push(s),r<=60?(o++,e.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,t+=r}return To(e)}function Qp(n,e){var t=new Uint8Array(32),r=Vd(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,PJ(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function Xp(n,e){var t=new Uint8Array(32),r=Vd(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function js(n){var e=xn(n);return tu(e[1][0].data)}function NJ(n,e,t){var r,i,s,o;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=n[8])==null?void 0:s[0])==null?void 0:o.data)&&rl(n[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=Vd(n[7][0].data),u=0,f=[],p=Vd(n[4][0].data),g=0,m=[],v=0;v<e.length;++v){if(e[v]==null){c.setUint16(v*2,65535,!0),p.setUint16(v*2,65535);continue}c.setUint16(v*2,u,!0),p.setUint16(v*2,g,!0);var _,D;switch(typeof e[v]){case"string":_=Qp({t:"s",v:e[v]},t),D=Xp({t:"s",v:e[v]},t);break;case"number":_=Qp({t:"n",v:e[v]},t),D=Xp({t:"n",v:e[v]},t);break;case"boolean":_=Qp({t:"b",v:e[v]},t),D=Xp({t:"b",v:e[v]},t);break;default:throw new Error("Unsupported value "+e[v])}f.push(_),u+=_.length,m.push(D),g+=D.length,++l}for(n[2][0].data=Dt(l);v<n[7][0].data.length/2;++v)c.setUint16(v*2,65535,!0),p.setUint16(v*2,65535,!0);return n[6][0].data=To(f),n[3][0].data=To(m),l}function DJ(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Qr(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(wn(r)));var s=Hd(t,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(Z){return Z.forEach(function(q){typeof q=="string"&&o.push(q)})});var a={},l=[],c=Vt.read(e.numbers,{type:"base64"});c.FileIndex.map(function(Z,q){return[Z,c.FullPaths[q]]}).forEach(function(Z){var q=Z[0],X=Z[1];if(q.type==2&&q.name.match(/\.iwa/)){var ce=q.content,ne=ai(ce),ve=oi(ne);ve.forEach(function(se){l.push(se.id),a[se.id]={deps:[],location:X,type:rl(se.messages[0].meta[1][0].data)}})}}),l.sort(function(Z,q){return Z-q});var u=l.filter(function(Z){return Z>1}).map(function(Z){return[Z,Dt(Z)]});c.FileIndex.map(function(Z,q){return[Z,c.FullPaths[q]]}).forEach(function(Z){var q=Z[0];if(Z[1],!!q.name.match(/\.iwa/)){var X=oi(ai(q.content));X.forEach(function(ce){ce.messages.forEach(function(ne){u.forEach(function(ve){ce.messages.some(function(se){return rl(se.meta[1][0].data)!=11006&&kJ(se.data,ve[1])})&&a[ve[0]].deps.push(ce.id)})})})}});for(var f=Vt.find(c,a[1].location),p=oi(ai(f.content)),g,m=0;m<p.length;++m){var v=p[m];v.id==1&&(g=v)}var _=js(xn(g.messages[0].data)[1][0].data);for(f=Vt.find(c,a[_].location),p=oi(ai(f.content)),m=0;m<p.length;++m)v=p[m],v.id==_&&(g=v);for(_=js(xn(g.messages[0].data)[2][0].data),f=Vt.find(c,a[_].location),p=oi(ai(f.content)),m=0;m<p.length;++m)v=p[m],v.id==_&&(g=v);for(_=js(xn(g.messages[0].data)[2][0].data),f=Vt.find(c,a[_].location),p=oi(ai(f.content)),m=0;m<p.length;++m)v=p[m],v.id==_&&(g=v);var D=xn(g.messages[0].data);{D[6][0].data=Dt(r.e.r+1),D[7][0].data=Dt(r.e.c+1);var b=js(D[46][0].data),T=Vt.find(c,a[b].location),R=oi(ai(T.content));{for(var B=0;B<R.length&&R[B].id!=b;++B);if(R[B].id!=b)throw"Bad ColumnRowUIDMapArchive";var W=xn(R[B].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var A=0;A<=r.e.c;++A){var w=[];w[1]=w[2]=[{type:0,data:Dt(A+420690)}],W[1].push({type:2,data:$n(w)}),W[2].push({type:0,data:Dt(A)}),W[3].push({type:0,data:Dt(A)})}W[4]=[],W[5]=[],W[6]=[];for(var E=0;E<=r.e.r;++E)w=[],w[1]=w[2]=[{type:0,data:Dt(E+726270)}],W[4].push({type:2,data:$n(w)}),W[5].push({type:0,data:Dt(E)}),W[6].push({type:0,data:Dt(E)});R[B].messages[0].data=$n(W)}T.content=ba(Ra(R)),T.size=T.content.length,delete D[46];var C=xn(D[4][0].data);{C[7][0].data=Dt(r.e.r+1);var I=xn(C[1][0].data),x=js(I[2][0].data);T=Vt.find(c,a[x].location),R=oi(ai(T.content));{if(R[0].id!=x)throw"Bad HeaderStorageBucket";var P=xn(R[0].messages[0].data);for(E=0;E<s.length;++E){var ie=xn(P[2][0].data);ie[1][0].data=Dt(E),ie[4][0].data=Dt(s[E].length),P[2][E]={type:P[2][0].type,data:$n(ie)}}R[0].messages[0].data=$n(P)}T.content=ba(Ra(R)),T.size=T.content.length;var Q=js(C[2][0].data);T=Vt.find(c,a[Q].location),R=oi(ai(T.content));{if(R[0].id!=Q)throw"Bad HeaderStorageBucket";for(P=xn(R[0].messages[0].data),A=0;A<=r.e.c;++A)ie=xn(P[2][0].data),ie[1][0].data=Dt(A),ie[4][0].data=Dt(r.e.r+1),P[2][A]={type:P[2][0].type,data:$n(ie)};R[0].messages[0].data=$n(P)}T.content=ba(Ra(R)),T.size=T.content.length;var ae=js(C[4][0].data);(function(){for(var Z=Vt.find(c,a[ae].location),q=oi(ai(Z.content)),X,ce=0;ce<q.length;++ce){var ne=q[ce];ne.id==ae&&(X=ne)}var ve=xn(X.messages[0].data);{ve[3]=[];var se=[];o.forEach(function(k,L){se[1]=[{type:0,data:Dt(L)}],se[2]=[{type:0,data:Dt(1)}],se[3]=[{type:2,data:bJ(k)}],ve[3].push({type:2,data:$n(se)})})}X.messages[0].data=$n(ve);var H=Ra(q),J=ba(H);Z.content=J,Z.size=Z.content.length})();var Ae=xn(C[3][0].data);{var Oe=Ae[1][0];delete Ae[2];var Ce=xn(Oe.data);{var fe=js(Ce[2][0].data);(function(){for(var Z=Vt.find(c,a[fe].location),q=oi(ai(Z.content)),X,ce=0;ce<q.length;++ce){var ne=q[ce];ne.id==fe&&(X=ne)}var ve=xn(X.messages[0].data);{delete ve[6],delete Ae[7];var se=new Uint8Array(ve[5][0].data);ve[5]=[];for(var H=0,J=0;J<=r.e.r;++J){var k=xn(se);H+=NJ(k,s[J],o),k[1][0].data=Dt(J),ve[5].push({data:$n(k),type:2})}ve[1]=[{type:0,data:Dt(r.e.c+1)}],ve[2]=[{type:0,data:Dt(r.e.r+1)}],ve[3]=[{type:0,data:Dt(H)}],ve[4]=[{type:0,data:Dt(r.e.r+1)}]}X.messages[0].data=$n(ve);var L=Ra(q),z=ba(L);Z.content=z,Z.size=Z.content.length})()}Oe.data=$n(Ce)}C[3][0].data=$n(Ae)}D[4][0].data=$n(C)}g.messages[0].data=$n(D);var F=Ra(p),O=ba(F);return f.content=O,f.size=f.content.length,c}function MJ(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Uv(n){MJ([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function FJ(n,e){return e.bookType=="ods"?GR(n,e):e.bookType=="numbers"?DJ(n,e):e.bookType=="xlsb"?LJ(n,e):UJ(n,e)}function LJ(n,e){ja=1024,n&&!n.SSF&&(n.SSF=Nr(un)),n&&n.SSF&&(Qf(),Yf(n.SSF),e.revssf=Xf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Nc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=RR.indexOf(e.bookType)>-1,i=rR();Uv(e=e||{});var s=wv(),o="",a=0;if(e.cellXfs=[],Ao(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",mt(s,o,aR(n.Props,e)),i.coreprops.push(o),Ft(e.rels,2,o,xt.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,mt(s,o,cR(n.Props)),i.extprops.push(o),Ft(e.rels,3,o,xt.EXT_PROPS),n.Custprops!==n.Props&&Xn(n.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(s,o,uR(n.Custprops)),i.custprops.push(o),Ft(e.rels,4,o,xt.CUST_PROPS)),a=1;a<=n.SheetNames.length;++a){var u={"!id":{}},f=n.Sheets[n.SheetNames[a-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+a+"."+t,mt(s,o,VX(a-1,o,e,n,u)),i.sheets.push(o),Ft(e.wbrels,-1,"worksheets/sheet"+a+"."+t,xt.WS[0])}if(f){var g=f["!comments"],m=!1,v="";g&&g.length>0&&(v="xl/comments"+a+"."+t,mt(s,v,KX(g,v)),i.comments.push(v),Ft(u,-1,"../comments"+a+"."+t,xt.CMNT),m=!0),f["!legacy"]&&m&&mt(s,"xl/drawings/vmlDrawing"+a+".vml",IR(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&mt(s,sR(o),tl(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,mt(s,o,$X(e.Strings,o,e)),i.strs.push(o),Ft(e.wbrels,-1,"sharedStrings."+t,xt.SST)),o="xl/workbook."+t,mt(s,o,BX(n,o)),i.workbooks.push(o),Ft(e.rels,1,o,xt.WB),o="xl/theme/theme1.xml",mt(s,o,CR(n.Themes,e)),i.themes.push(o),Ft(e.wbrels,-1,"theme/theme1.xml",xt.THEME),o="xl/styles."+t,mt(s,o,HX(n,o,e)),i.styles.push(o),Ft(e.wbrels,-1,"styles."+t,xt.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",mt(s,o,n.vbaraw),i.vba.push(o),Ft(e.wbrels,-1,"vbaProject.bin",xt.VBA)),o="xl/metadata."+t,mt(s,o,jX(o)),i.metadata.push(o),Ft(e.wbrels,-1,"metadata."+t,xt.XLMETA),mt(s,"[Content_Types].xml",iR(i,e)),mt(s,"_rels/.rels",tl(e.rels)),mt(s,"xl/_rels/workbook."+t+".rels",tl(e.wbrels)),delete e.revssf,delete e.ssf,s}function UJ(n,e){ja=1024,n&&!n.SSF&&(n.SSF=Nr(un)),n&&n.SSF&&(Qf(),Yf(n.SSF),e.revssf=Xf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Nc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=RR.indexOf(e.bookType)>-1,i=rR();Uv(e=e||{});var s=wv(),o="",a=0;if(e.cellXfs=[],Ao(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",mt(s,o,aR(n.Props,e)),i.coreprops.push(o),Ft(e.rels,2,o,xt.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,mt(s,o,cR(n.Props)),i.extprops.push(o),Ft(e.rels,3,o,xt.EXT_PROPS),n.Custprops!==n.Props&&Xn(n.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(s,o,uR(n.Custprops)),i.custprops.push(o),Ft(e.rels,4,o,xt.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=n.SheetNames.length;++a){var f={"!id":{}},p=n.Sheets[n.SheetNames[a-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+a+"."+t,mt(s,o,LR(a-1,e,n,f)),i.sheets.push(o),Ft(e.wbrels,-1,"worksheets/sheet"+a+"."+t,xt.WS[0])}if(p){var m=p["!comments"],v=!1,_="";if(m&&m.length>0){var D=!1;m.forEach(function(b){b[1].forEach(function(T){T.T==!0&&(D=!0)})}),D&&(_="xl/threadedComments/threadedComment"+a+"."+t,mt(s,_,gz(m,u,e)),i.threadedcomments.push(_),Ft(f,-1,"../threadedComments/threadedComment"+a+"."+t,xt.TCMNT)),_="xl/comments"+a+"."+t,mt(s,_,xR(m)),i.comments.push(_),Ft(f,-1,"../comments"+a+"."+t,xt.CMNT),v=!0}p["!legacy"]&&v&&mt(s,"xl/drawings/vmlDrawing"+a+".vml",IR(a,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&mt(s,sR(o),tl(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,mt(s,o,_R(e.Strings,e)),i.strs.push(o),Ft(e.wbrels,-1,"sharedStrings."+t,xt.SST)),o="xl/workbook."+t,mt(s,o,VR(n)),i.workbooks.push(o),Ft(e.rels,1,o,xt.WB),o="xl/theme/theme1.xml",mt(s,o,CR(n.Themes,e)),i.themes.push(o),Ft(e.wbrels,-1,"theme/theme1.xml",xt.THEME),o="xl/styles."+t,mt(s,o,wR(n,e)),i.styles.push(o),Ft(e.wbrels,-1,"styles."+t,xt.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",mt(s,o,n.vbaraw),i.vba.push(o),Ft(e.wbrels,-1,"vbaProject.bin",xt.VBA)),o="xl/metadata."+t,mt(s,o,SR()),i.metadata.push(o),Ft(e.wbrels,-1,"metadata."+t,xt.XLMETA),u.length>1&&(o="xl/persons/person.xml",mt(s,o,mz(u)),i.people.push(o),Ft(e.wbrels,-1,"persons/person.xml",xt.PEOPLE)),mt(s,"[Content_Types].xml",iR(i,e)),mt(s,"_rels/.rels",tl(e.rels)),mt(s,"xl/_rels/workbook."+t+".rels",tl(e.wbrels)),delete e.revssf,delete e.ssf,s}function BJ(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=ks(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function qR(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Nu(e.file,Vt.write(n,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Vt.write(n,e)}function VJ(n,e){var t=Nr(e||{}),r=FJ(n,t);return HJ(r,t)}function HJ(n,e){var t={},r=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?Vt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(zf(i))}return e.password&&typeof encrypt_agile<"u"?qR(encrypt_agile(i,e.password),e):e.type==="file"?Nu(e.file,i):e.type=="string"?bc(i):i}function $J(n,e){var t=e||{},r=iJ(n,t);return qR(r,t)}function Ri(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return Xc(Zc(r));case"binary":return Zc(r);case"string":return n;case"file":return Nu(e.file,r,"utf8");case"buffer":return bt?Fs(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ri(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function KJ(n,e){switch(e.type){case"base64":return Xc(n);case"binary":return n;case"string":return n;case"file":return Nu(e.file,n,"binary");case"buffer":return bt?Fs(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Sh(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?Xc(t):e.type=="string"?bc(t):t;case"file":return Nu(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function Bv(n,e){vW(),RX(n);var t=Nr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=Bv(n,t);return t.type="array",zf(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ri(nJ(n,t),t);case"slk":case"sylk":return Ri(Sq.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Ri(KR(n.Sheets[n.SheetNames[i]],t),t);case"txt":return KJ(zR(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Ri(Vv(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Ri(Iq.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return Sh(Cq.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Ri(xq.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Ri(Dq.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Ri(vR.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Ri(GR(n,t),t);case"wk1":return Sh(lT.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return Sh(lT.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Sh($R(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),$J(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return VJ(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function jJ(n,e,t,r,i,s,o,a){var l=Qn(t),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),f=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:t,enumerable:!1})}catch{p.__rowNum__=t}else p.__rowNum__=t;if(!o||n[t])for(var g=e.s.c;g<=e.e.c;++g){var m=o?n[t][g]:n[r[g]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[g]!=null&&(p[s[g]]=c);continue}var v=m.v;switch(m.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[g]!=null){if(v==null)if(m.t=="e"&&v===null)p[s[g]]=null;else if(c!==void 0)p[s[g]]=c;else if(u&&v===null)p[s[g]]=null;else continue;else p[s[g]]=u&&(m.t!=="n"||m.t==="n"&&a.rawNumbers!==!1)?v:Ps(m,v,a);v!=null&&(f=!1)}}return{row:p,isempty:f}}function Hd(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof u){case"string":l=en(u);break;case"number":l=en(n["!ref"]),l.s.r=u;break;default:l=u}r>0&&(i=0);var f=Qn(l.s.r),p=[],g=[],m=0,v=0,_=Array.isArray(n),D=l.s.r,b=0,T={};_&&!n[D]&&(n[D]=[]);var R=c.skipHidden&&n["!cols"]||[],B=c.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(R[b]||{}).hidden)switch(p[b]=cr(b),t=_?n[D][b]:n[p[b]+f],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=p[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),a=o=Ps(t,null,c),v=T[o]||0,!v)T[o]=1;else{do a=o+"_"+v++;while(T[a]);T[o]=v,T[a]=1}s[b]=a}for(D=l.s.r+i;D<=l.e.r;++D)if(!(B[D]||{}).hidden){var W=jJ(n,l,D,p,r,s,_,c);(W.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(g[m++]=W.row)}return g.length=m,g}var mT=/"/g;function WJ(n,e,t,r,i,s,o,a){for(var l=!0,c=[],u="",f=Qn(t),p=e.s.c;p<=e.e.c;++p)if(r[p]){var g=a.dense?(n[t]||[])[p]:n[r[p]+f];if(g==null)u="";else if(g.v!=null){l=!1,u=""+(a.rawNumbers&&g.t=="n"?g.v:Ps(g,null,a));for(var m=0,v=0;m!==u.length;++m)if((v=u.charCodeAt(m))===i||v===s||v===34||a.forceQuotes){u='"'+u.replace(mT,'""')+'"';break}u=="ID"&&(u='"ID"')}else g.f!=null&&!g.F?(l=!1,u="="+g.f,u.indexOf(",")>=0&&(u='"'+u.replace(mT,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function Vv(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=en(n["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];r.dense=Array.isArray(n);for(var p=r.skipHidden&&n["!cols"]||[],g=r.skipHidden&&n["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(p[m]||{}).hidden||(f[m]=cr(m));for(var v=0,_=i.s.r;_<=i.e.r;++_)(g[_]||{}).hidden||(u=WJ(n,i,_,f,o,l,s,r),u!=null&&(r.strip&&(u=u.replace(c,"")),(u||r.blankrows!==!1)&&t.push((v++?a:"")+u)));return delete r.dense,t.join("")}function zR(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Vv(n,e);return t}function GJ(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=en(n["!ref"]),s="",o=[],a,l=[],c=Array.isArray(n);for(a=i.s.c;a<=i.e.c;++a)o[a]=cr(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Qn(u),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,t=c?(n[u]||[])[a]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function YR(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?Mn(r.origin):r.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var f=en(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+e.length-1+i)}else o==-1&&(o=0,u.e.r=e.length-1+i);var p=r.header||[],g=0;e.forEach(function(v,_){Xn(v).forEach(function(D){(g=p.indexOf(D))==-1&&(p[g=p.length]=D);var b=v[D],T="z",R="",B=Bt({c:a+g,r:o+_+i});c=nu(s,B),b&&typeof b=="object"&&!(b instanceof Date)?s[B]=b:(typeof b=="number"?T="n":typeof b=="boolean"?T="b":typeof b=="string"?T="s":b instanceof Date?(T="d",r.cellDates||(T="n",b=Or(b)),R=r.dateNF||un[14]):b===null&&r.nullError&&(T="e",b=0),c?(c.t=T,c.v=b,delete c.w,delete c.R,R&&(c.z=R)):s[B]=c={t:T,v:b},R&&(c.z=R))})}),u.e.c=Math.max(u.e.c,a+p.length-1);var m=Qn(o);if(i)for(g=0;g<p.length;++g)s[cr(g+a)+m]={t:"s",v:p[g]};return s["!ref"]=wn(u),s}function qJ(n,e){return YR(null,n,e)}function nu(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=Mn(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?nu(n,Bt(e)):nu(n,Bt({r:e,c:t||0}))}function zJ(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function YJ(){return{SheetNames:[],Sheets:{}}}function QJ(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=o+i)!=-1;++i);}if(BR(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function XJ(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=zJ(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function JJ(n,e){return n.z=e,n}function QR(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function ZJ(n,e,t){return QR(n,"#"+e,t)}function eZ(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function tZ(n,e,t,r){for(var i=typeof e!="string"?e:en(e),s=typeof e=="string"?e:wn(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=nu(n,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var XR={encode_col:cr,encode_row:Qn,encode_cell:Bt,encode_range:wn,decode_col:Rv,decode_row:xv,split_cell:vG,decode_cell:Mn,decode_range:Qr,format_cell:Ps,sheet_add_aoa:Xx,sheet_add_json:YR,sheet_add_dom:jR,aoa_to_sheet:Ll,json_to_sheet:qJ,table_to_sheet:WR,table_to_book:IJ,sheet_to_csv:Vv,sheet_to_txt:zR,sheet_to_json:Hd,sheet_to_html:KR,sheet_to_formulae:GJ,sheet_to_row_object_array:Hd,sheet_get_cell:nu,book_new:YJ,book_append_sheet:QJ,book_set_sheet_visibility:XJ,cell_set_number_format:JJ,cell_set_hyperlink:QR,cell_set_internal_link:ZJ,cell_add_comment:eZ,sheet_set_array_formula:tZ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const nZ={class:"ta-summary-container"},rZ={class:"filters-section"},iZ={class:"filter-group"},sZ={class:"filter-group"},oZ=["disabled"],aZ={key:0,class:"stats-section"},lZ={class:"stat-card reference"},cZ={class:"stat-content"},uZ={class:"stat-value"},hZ={class:"stat-detail"},dZ={class:"stat-card"},fZ={class:"stat-content"},pZ={class:"stat-value"},gZ={class:"stat-card"},mZ={class:"stat-content"},vZ={class:"stat-value"},_Z={class:"stat-card"},yZ={class:"stat-content"},EZ={class:"stat-value"},TZ={class:"stat-card"},wZ={class:"stat-content"},AZ={class:"stat-value"},CZ={key:1,class:"loading"},SZ={key:2,class:"table-container"},IZ={class:"table-header"},xZ={class:"summary-table"},RZ={class:"employee-cell"},bZ={class:"employee-name"},kZ={class:"employee-id"},PZ={class:"hours-cell worked"},OZ={class:"hours-cell rest"},NZ={class:"hours-cell missed"},DZ={class:"hours-cell total"},MZ={class:"days-cell"},FZ={class:"day-badges"},LZ={key:0,class:"day-badge worked"},UZ={key:1,class:"day-separator"},BZ={key:2,class:"day-badge rest"},VZ={key:3,class:"day-separator"},HZ={key:4,class:"day-badge missed"},$Z={class:"total-row"},KZ={class:"hours-cell worked"},jZ={class:"hours-cell rest"},WZ={class:"hours-cell missed"},GZ={class:"hours-cell total"},qZ={key:3,class:"no-data"},zZ={__name:"SupervisorTASummary",setup(n){const e=Se(!1),t=Se([]),r=new Date,i=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,s=Se(i),o=Se("full"),a=Se("employeeName"),l=Se(!0),c=["2024-01-01","2024-02-12","2024-02-13","2024-02-14","2024-03-08","2024-06-01","2024-07-11","2024-07-12","2024-07-13","2024-11-26","2025-01-01","2025-01-29","2025-01-30","2025-01-31","2025-03-08","2025-06-01","2025-07-11","2025-07-12","2025-07-13","2025-11-26","2026-01-01","2026-02-17","2026-02-18","2026-02-19","2026-03-08","2026-06-01","2026-07-11","2026-07-12","2026-07-13","2026-11-26","2027-01-01","2027-02-06","2027-02-07","2027-02-08","2027-03-08","2027-06-01","2027-07-11","2027-07-12","2027-07-13","2027-11-26"],u=it(()=>{const[B,W]=s.value.split("-");let A,w;o.value==="full"?(A=1,w=new Date(parseInt(B),parseInt(W),0).getDate()):[A,w]=o.value.split("-").map(Number);let E=0;for(let C=A;C<=w;C++){const I=`${B}-${W}-${String(C).padStart(2,"0")}`,P=new Date(I).getDay();P===0||P===6||c.includes(I)||E++}return E}),f=it(()=>u.value*8),p=it(()=>{const B=[...t.value];return B.sort((W,A)=>{const w=W[a.value],E=A[a.value];return typeof w=="number"&&typeof E=="number"?l.value?w-E:E-w:l.value?String(w).localeCompare(String(E),"mn"):String(E).localeCompare(String(w),"mn")}),B}),g=it(()=>t.value.reduce((B,W)=>B+W.workedHours,0)),m=it(()=>t.value.reduce((B,W)=>B+W.restHours,0)),v=it(()=>t.value.reduce((B,W)=>B+W.missedHours,0)),_=it(()=>t.value.reduce((B,W)=>B+W.totalHours,0));async function D(){e.value=!0;try{const[B,W]=s.value.split("-");let A,w;o.value==="full"?(A=1,w=new Date(parseInt(B),parseInt(W),0).getDate()):[A,w]=o.value.split("-").map(Number);const E=`${B}-${W}-${String(A).padStart(2,"0")}`,C=`${B}-${W}-${String(w).padStart(2,"0")}`;console.log("Loading summary for range:",E,"to",C);const I=ei(Pn(Xt,"timeAttendance"),Vr("Day",">=",E),Vr("Day","<=",C)),P=(await Wn(I)).docs.map(Q=>Q.data());console.log(`Loaded ${P.length} records`);const ie=new Map;P.forEach(Q=>{const ae=Q.EmployeeFirstName||"Unknown",Ae=Q.EmployeeID||"";ie.has(ae)||ie.set(ae,{employeeName:ae,employeeId:Ae,workedHours:0,restHours:0,missedHours:0,totalHours:0,workedDays:0,restDays:0,missedDays:0});const Oe=ie.get(ae),Ce=parseFloat(Q.WorkingHour)||0,fe=Q.Status||"";fe===""||fe===""||fe===""?(Oe.workedHours+=Ce,Ce>0&&Oe.workedDays++):fe==="/"||fe.includes("")||fe.includes("")?(Oe.restHours+=Ce,Ce>0&&Oe.restDays++):fe===""&&(Oe.missedHours+=Ce,Ce>0&&Oe.missedDays++),Oe.totalHours+=Ce}),t.value=Array.from(ie.values()),console.log(`Processed ${t.value.length} employees`)}catch(B){console.error("Error loading summary:",B)}finally{e.value=!1}}function b(B){a.value===B?l.value=!l.value:(a.value=B,l.value=!1)}function T(){const[B,W]=s.value.split("-");if(o.value==="full")return`${B}/${W}`;const[A,w]=o.value.split("-");return`${B}/${W}/${A} - ${B}/${W}/${w}`}function R(){const B={SheetNames:["Summary"],Sheets:{}},A=[["","ID"," ","/",""," "," "," "," "],...p.value.map(x=>[x.employeeName,x.employeeId,x.workedHours.toFixed(2),x.restHours.toFixed(2),x.missedHours.toFixed(2),x.totalHours.toFixed(2),x.workedDays,x.restDays,x.missedDays]),["","",g.value.toFixed(2),m.value.toFixed(2),v.value.toFixed(2),_.value.toFixed(2),"","",""]],w=XR.aoa_to_sheet(A);w["!cols"]=[{wch:20},{wch:10},{wch:15},{wch:18},{wch:12},{wch:12},{wch:15},{wch:15},{wch:15}],B.Sheets.Summary=w;const E=Bv(B,{bookType:"xlsx",type:"array"}),C=new Blob([E],{type:"application/octet-stream"}),I=document.createElement("a");I.href=URL.createObjectURL(C),I.download=`TA_Summary_${T().replace(/\//g,"-")}.xlsx`,I.click()}return Dr(()=>{D()}),(B,W)=>(ee(),te("div",nZ,[W[23]||(W[23]=d("h3",null,"   ()",-1)),d("div",rZ,[d("div",iZ,[W[7]||(W[7]=d("label",null," :",-1)),Ie(d("input",{type:"month","onUpdate:modelValue":W[0]||(W[0]=A=>s.value=A),onChange:D},null,544),[[Ge,s.value]])]),d("div",sZ,[W[9]||(W[9]=d("label",null,":",-1)),Ie(d("select",{"onUpdate:modelValue":W[1]||(W[1]=A=>o.value=A),onChange:D},[...W[8]||(W[8]=[d("option",{value:"full"}," ",-1),d("option",{value:"1-15"},"1-15",-1),d("option",{value:"16-31"},"16-31",-1)])],544),[[_t,o.value]])]),d("button",{onClick:D,class:"btn-refresh",disabled:e.value},Y(e.value?" ...":" "),9,oZ)]),!e.value&&t.value.length>0?(ee(),te("div",aZ,[d("div",lZ,[W[11]||(W[11]=d("div",{class:"stat-icon"},"",-1)),d("div",cZ,[W[10]||(W[10]=d("div",{class:"stat-label"},"  ()",-1)),d("div",uZ,Y(u.value)+" ",1),d("div",hZ,Y(f.value.toFixed(0))+" ",1)])]),d("div",dZ,[W[13]||(W[13]=d("div",{class:"stat-icon"},"",-1)),d("div",fZ,[W[12]||(W[12]=d("div",{class:"stat-label"}," ",-1)),d("div",pZ,Y(t.value.length),1)])]),d("div",gZ,[W[15]||(W[15]=d("div",{class:"stat-icon"},"",-1)),d("div",mZ,[W[14]||(W[14]=d("div",{class:"stat-label"},"  ",-1)),d("div",vZ,Y(g.value.toFixed(2))+"",1)])]),d("div",_Z,[W[17]||(W[17]=d("div",{class:"stat-icon"},"",-1)),d("div",yZ,[W[16]||(W[16]=d("div",{class:"stat-label"},"/",-1)),d("div",EZ,Y(m.value.toFixed(2))+"",1)])]),d("div",TZ,[W[19]||(W[19]=d("div",{class:"stat-icon"},"",-1)),d("div",wZ,[W[18]||(W[18]=d("div",{class:"stat-label"}," ",-1)),d("div",AZ,Y(v.value.toFixed(2))+"",1)])])])):Ke("",!0),e.value?(ee(),te("div",CZ,"   ... ")):t.value.length>0?(ee(),te("div",SZ,[d("div",IZ,[d("span",null,Y(T()),1),d("button",{onClick:R,class:"btn-export"}," Excel ")]),d("table",xZ,[d("thead",null,[d("tr",null,[d("th",{onClick:W[2]||(W[2]=A=>b("employeeName")),class:"sortable"},"  "+Y(a.value==="employeeName"?l.value?"":"":""),1),d("th",{onClick:W[3]||(W[3]=A=>b("workedHours")),class:"sortable hours-col"},"   "+Y(a.value==="workedHours"?l.value?"":"":""),1),d("th",{onClick:W[4]||(W[4]=A=>b("restHours")),class:"sortable hours-col"}," / "+Y(a.value==="restHours"?l.value?"":"":""),1),d("th",{onClick:W[5]||(W[5]=A=>b("missedHours")),class:"sortable hours-col"},"  "+Y(a.value==="missedHours"?l.value?"":"":""),1),d("th",{onClick:W[6]||(W[6]=A=>b("totalHours")),class:"sortable hours-col"},"   "+Y(a.value==="totalHours"?l.value?"":"":""),1),W[20]||(W[20]=d("th",{class:"days-col"}," ",-1))])]),d("tbody",null,[(ee(!0),te(wt,null,rn(p.value,A=>(ee(),te("tr",{key:A.employeeName},[d("td",RZ,[d("div",bZ,Y(A.employeeName),1),d("div",kZ,"ID: "+Y(A.employeeId),1)]),d("td",PZ,Y(A.workedHours.toFixed(2))+"",1),d("td",OZ,Y(A.restHours.toFixed(2))+"",1),d("td",NZ,Y(A.missedHours.toFixed(2))+"",1),d("td",DZ,Y(A.totalHours.toFixed(2))+"",1),d("td",MZ,[d("div",FZ,[A.workedDays>0?(ee(),te("span",LZ,Y(A.workedDays)+" ",1)):Ke("",!0),A.workedDays>0&&(A.restDays>0||A.missedDays>0)?(ee(),te("span",UZ," / ")):Ke("",!0),A.restDays>0?(ee(),te("span",BZ,Y(A.restDays)+" ",1)):Ke("",!0),A.restDays>0&&A.missedDays>0?(ee(),te("span",VZ," / ")):Ke("",!0),A.missedDays>0?(ee(),te("span",HZ,Y(A.missedDays)+" ",1)):Ke("",!0)])])]))),128))]),d("tfoot",null,[d("tr",$Z,[W[21]||(W[21]=d("td",null,[d("strong",null,":")],-1)),d("td",KZ,[d("strong",null,Y(g.value.toFixed(2))+"",1)]),d("td",jZ,[d("strong",null,Y(m.value.toFixed(2))+"",1)]),d("td",WZ,[d("strong",null,Y(v.value.toFixed(2))+"",1)]),d("td",GZ,[d("strong",null,Y(_.value.toFixed(2))+"",1)]),W[22]||(W[22]=d("td",null,null,-1))])])])])):e.value?Ke("",!0):(ee(),te("div",qZ,"     "))]))}},YZ=Cr(zZ,[["__scopeId","data-v-6a6b9887"]]),QZ={class:"project-summary-container"},XZ={class:"filter-buttons-section"},JZ={class:"filter-count"},ZZ={class:"filter-count"},eee={class:"filter-count"},tee={class:"filter-count"},nee={class:"filter-count"},ree={class:"filter-count"},iee={class:"filter-count"},see={class:"filters-section"},oee={class:"filter-group"},aee=["disabled"],lee={key:0,class:"loading"},cee={key:1,class:"table-container"},uee={class:"table-header"},hee={class:"summary-table"},dee={class:"project-id-cell"},fee={key:1},pee={key:1},gee={key:1},mee={class:"number-cell"},vee={key:1},_ee={class:"number-cell"},yee={key:1},Eee={class:"number-cell"},Tee={key:1},wee={key:1},Aee={class:"actions-cell"},Cee=["onClick","disabled"],See=["onClick"],Iee=["onClick"],xee={key:2,class:"no-data"},Ree={style:{display:"none"}},bee={__name:"ProjectSummary",setup(n){const e=Nl(),t=Se(!1),r=Se([]),i=Se(""),s=Se(""),o=Se(null),a=Se(null),l=Se(!1),c=Se({customer:"",siteLocation:"",ResponsibleEmp:"",HourPerformance:0,EngineerBounty:0,EngineerHand:0,referenceIdfromCustomer:""}),u=Se("id"),f=Se(!1),p=it(()=>{let A=[...r.value];if(i.value&&(A=A.filter(w=>(w.Status||"").trim()===i.value)),s.value.trim()){const w=s.value.toLowerCase();A=A.filter(E=>{var C,I,x;return((C=E.id)==null?void 0:C.toString().toLowerCase().includes(w))||((I=E.name)==null?void 0:I.toLowerCase().includes(w))||((x=E.customer)==null?void 0:x.toLowerCase().includes(w))})}return A}),g=it(()=>{const A=[...p.value];return A.sort((w,E)=>{const C=w[u.value]||"",I=E[u.value]||"";return typeof C=="number"&&typeof I=="number"?f.value?C-I:I-C:f.value?String(C).localeCompare(String(I),"mn"):String(I).localeCompare(String(C),"mn")}),A});function m(A){return r.value.filter(w=>(w.Status||"").trim()===A).length}function v(A){i.value=A}async function _(){t.value=!0;try{await e.fetchProjects(),r.value=e.projects,console.log(`Loaded ${r.value.length} projects`);const A=[...new Set(r.value.map(w=>w.Status))];console.log("Unique statuses in database:",A)}catch(A){console.error("Error loading projects:",A)}finally{t.value=!1}}function D(A){u.value===A?f.value=!f.value:(u.value=A,f.value=!0)}function b(A){a.value=A.id,c.value={customer:A.customer||"",siteLocation:A.siteLocation||"",ResponsibleEmp:A.ResponsibleEmp||"",HourPerformance:A.HourPerformance||0,EngineerBounty:A.EngineerBounty||0,EngineerHand:A.EngineerHand||0,referenceIdfromCustomer:A.referenceIdfromCustomer||""}}function T(A){o.value&&o.value.openProjectById&&o.value.openProjectById(A.id)}function R(){a.value=null,c.value={customer:"",siteLocation:"",ResponsibleEmp:"",HourPerformance:0,EngineerBounty:0,EngineerHand:0,referenceIdfromCustomer:""}}async function B(A){l.value=!0;try{const w=co(Xt,"projects",A.docId);await xf(w,{customer:c.value.customer,siteLocation:c.value.siteLocation,ResponsibleEmp:c.value.ResponsibleEmp,HourPerformance:Number(c.value.HourPerformance),EngineerBounty:Number(c.value.EngineerBounty),EngineerHand:Number(c.value.EngineerHand),referenceIdfromCustomer:c.value.referenceIdfromCustomer,updatedAt:new Date().toISOString()});const E=r.value.findIndex(C=>C.id===A.id);E!==-1&&Object.assign(r.value[E],c.value),console.log("Project updated successfully"),R()}catch(w){console.error("Error updating project:",w),alert(" : "+w.message)}finally{l.value=!1}}function W(){const A={SheetNames:["Projects"],Sheets:{}},E=[["ID","","",""," %"," "," "," "],...g.value.map(Q=>[Q.id,Q.customer||"-",Q.siteLocation||"-",Q.ResponsibleEmp||"-",Q.HourPerformance?Q.HourPerformance.toFixed(2):"-",Q.EngineerBounty||"-",Q.EngineerHand||"-",Q.referenceIdfromCustomer||"-"])],C=XR.aoa_to_sheet(E);C["!cols"]=[{wch:8},{wch:30},{wch:25},{wch:20},{wch:15},{wch:20},{wch:15},{wch:20}],A.Sheets.Projects=C;const I=Bv(A,{bookType:"xlsx",type:"array"}),x=new Blob([I],{type:"application/octet-stream"}),P=document.createElement("a");P.href=URL.createObjectURL(x);const ie=new Date().toISOString().split("T")[0];P.download=`Projects_${ie}.xlsx`,P.click()}return Dr(async()=>{await _()}),(A,w)=>(ee(),te("div",QZ,[w[32]||(w[32]=d("h3",null,"  ",-1)),d("div",XZ,[d("button",{onClick:w[0]||(w[0]=E=>v("")),class:Tt(["filter-btn","filter-all",{active:i.value===""}])},[w[23]||(w[23]=d("span",{class:"filter-label"},"",-1)),d("span",JZ,Y(r.value.length),1)],2),d("button",{onClick:w[1]||(w[1]=E=>v(" ")),class:Tt(["filter-btn","filter-working",{active:i.value===" "}])},[w[24]||(w[24]=d("span",{class:"filter-label"}," ",-1)),d("span",ZZ,Y(m(" ")),1)],2),d("button",{onClick:w[2]||(w[2]=E=>v("")),class:Tt(["filter-btn","filter-planned",{active:i.value===""}])},[w[25]||(w[25]=d("span",{class:"filter-label"},"",-1)),d("span",eee,Y(m("")),1)],2),d("button",{onClick:w[3]||(w[3]=E=>v("  ")),class:Tt(["filter-btn","filter-handover",{active:i.value==="  "}])},[w[26]||(w[26]=d("span",{class:"filter-label"},"  ",-1)),d("span",tee,Y(m("  ")),1)],2),d("button",{onClick:w[4]||(w[4]=E=>v("   ")),class:Tt(["filter-btn","filter-invoice",{active:i.value==="   "}])},[w[27]||(w[27]=d("span",{class:"filter-label"},"   ",-1)),d("span",nee,Y(m("   ")),1)],2),d("button",{onClick:w[5]||(w[5]=E=>v(" ")),class:Tt(["filter-btn","filter-award",{active:i.value===" "}])},[w[28]||(w[28]=d("span",{class:"filter-label"}," ",-1)),d("span",ree,Y(m(" ")),1)],2),d("button",{onClick:w[6]||(w[6]=E=>v("")),class:Tt(["filter-btn","filter-finished",{active:i.value===""}])},[w[29]||(w[29]=d("span",{class:"filter-label"},"",-1)),d("span",iee,Y(m("")),1)],2)]),d("div",see,[d("div",oee,[w[30]||(w[30]=d("label",null,":",-1)),Ie(d("input",{type:"text","onUpdate:modelValue":w[7]||(w[7]=E=>s.value=E),placeholder:"   ..."},null,512),[[Ge,s.value]])]),d("button",{onClick:_,class:"btn-refresh",disabled:t.value},Y(t.value?" ...":" "),9,aee)]),t.value?(ee(),te("div",lee,"   ... ")):p.value.length>0?(ee(),te("div",cee,[d("div",uee,[d("span",null,"  ("+Y(p.value.length)+")",1),d("button",{onClick:W,class:"btn-export"}," Excel ")]),d("table",hee,[d("thead",null,[d("tr",null,[d("th",{onClick:w[8]||(w[8]=E=>D("id")),class:"sortable"}," ID "+Y(u.value==="id"?f.value?"":"":""),1),d("th",{onClick:w[9]||(w[9]=E=>D("customer")),class:"sortable"},"  "+Y(u.value==="customer"?f.value?"":"":""),1),d("th",{onClick:w[10]||(w[10]=E=>D("siteLocation")),class:"sortable"},"  "+Y(u.value==="siteLocation"?f.value?"":"":""),1),d("th",{onClick:w[11]||(w[11]=E=>D("ResponsibleEmp")),class:"sortable"},"  "+Y(u.value==="ResponsibleEmp"?f.value?"":"":""),1),d("th",{onClick:w[12]||(w[12]=E=>D("HourPerformance")),class:"sortable"},"  % "+Y(u.value==="HourPerformance"?f.value?"":"":""),1),d("th",{onClick:w[13]||(w[13]=E=>D("EngineerBounty")),class:"sortable"},"   "+Y(u.value==="EngineerBounty"?f.value?"":"":""),1),d("th",{onClick:w[14]||(w[14]=E=>D("EngineerHand")),class:"sortable"},"   "+Y(u.value==="EngineerHand"?f.value?"":"":""),1),d("th",{onClick:w[15]||(w[15]=E=>D("referenceIdfromCustomer")),class:"sortable"},"   "+Y(u.value==="referenceIdfromCustomer"?f.value?"":"":""),1),w[31]||(w[31]=d("th",{class:"actions-col"},"",-1))])]),d("tbody",null,[(ee(!0),te(wt,null,rn(g.value,E=>(ee(),te("tr",{key:E.id},[d("td",dee,Y(E.id),1),d("td",null,[a.value===E.id?Ie((ee(),te("input",{key:0,"onUpdate:modelValue":w[16]||(w[16]=C=>c.value.customer=C),type:"text",class:"edit-input"},null,512)),[[Ge,c.value.customer]]):(ee(),te("span",fee,Y(E.customer||"-"),1))]),d("td",null,[a.value===E.id?Ie((ee(),te("input",{key:0,"onUpdate:modelValue":w[17]||(w[17]=C=>c.value.siteLocation=C),type:"text",class:"edit-input"},null,512)),[[Ge,c.value.siteLocation]]):(ee(),te("span",pee,Y(E.siteLocation||"-"),1))]),d("td",null,[a.value===E.id?Ie((ee(),te("input",{key:0,"onUpdate:modelValue":w[18]||(w[18]=C=>c.value.ResponsibleEmp=C),type:"text",class:"edit-input"},null,512)),[[Ge,c.value.ResponsibleEmp]]):(ee(),te("span",gee,Y(E.ResponsibleEmp||"-"),1))]),d("td",mee,[a.value===E.id?Ie((ee(),te("input",{key:0,"onUpdate:modelValue":w[19]||(w[19]=C=>c.value.HourPerformance=C),type:"number",step:"0.01",class:"edit-input"},null,512)),[[Ge,c.value.HourPerformance,void 0,{number:!0}]]):(ee(),te("span",vee,Y(E.HourPerformance?E.HourPerformance.toFixed(2)+"%":"-"),1))]),d("td",_ee,[a.value===E.id?Ie((ee(),te("input",{key:0,"onUpdate:modelValue":w[20]||(w[20]=C=>c.value.EngineerBounty=C),type:"number",class:"edit-input"},null,512)),[[Ge,c.value.EngineerBounty,void 0,{number:!0}]]):(ee(),te("span",yee,Y(E.EngineerBounty?E.EngineerBounty.toLocaleString():"-"),1))]),d("td",Eee,[a.value===E.id?Ie((ee(),te("input",{key:0,"onUpdate:modelValue":w[21]||(w[21]=C=>c.value.EngineerHand=C),type:"number",class:"edit-input"},null,512)),[[Ge,c.value.EngineerHand,void 0,{number:!0}]]):(ee(),te("span",Tee,Y(E.EngineerHand?E.EngineerHand.toLocaleString():"-"),1))]),d("td",null,[a.value===E.id?Ie((ee(),te("input",{key:0,"onUpdate:modelValue":w[22]||(w[22]=C=>c.value.referenceIdfromCustomer=C),type:"text",class:"edit-input"},null,512)),[[Ge,c.value.referenceIdfromCustomer]]):(ee(),te("span",wee,Y(E.referenceIdfromCustomer||"-"),1))]),d("td",Aee,[a.value===E.id?(ee(),te(wt,{key:0},[d("button",{onClick:C=>B(E),class:"btn-save",disabled:l.value},"",8,Cee),d("button",{onClick:R,class:"btn-cancel"},"")],64)):(ee(),te(wt,{key:1},[d("button",{onClick:C=>T(E),class:"btn-view",title:" "},"",8,See),d("button",{onClick:C=>b(E),class:"btn-edit",title:""},"",8,Iee)],64))])]))),128))])])])):t.value?Ke("",!0):(ee(),te("div",xee,"     ")),d("div",Ree,[fn(gx,{ref_key:"projectManagementRef",ref:o},null,512)])]))}},kee=Cr(bee,[["__scopeId","data-v-4c6cda3d"]]),Pee=la("financialTransactions",{state:()=>({transactions:[],loading:!1,error:null}),getters:{getTransactionById:n=>e=>n.transactions.find(t=>t.id===e),getTransactionsByProject:n=>e=>n.transactions.filter(t=>t.projectID===e),getTransactionsByType:n=>e=>n.transactions.filter(t=>t.type===e),totalAmountByProject:n=>e=>n.transactions.filter(t=>t.projectID===e).reduce((t,r)=>t+(parseFloat(r.amount)||0),0),totalAmountByType:n=>e=>n.transactions.filter(t=>t.type===e).reduce((t,r)=>t+(parseFloat(r.amount)||0),0)},actions:{async fetchTransactions(){this.loading=!0,this.error=null;try{const n=ei(Pn(Xt,"financialTransactions"),BC("date","desc"));KC(n,e=>{this.transactions=e.docs.map(t=>({id:t.id,...t.data()})),this.loading=!1},e=>{console.error("Error fetching financial transactions:",e),this.error=e.message,this.loading=!1})}catch(n){console.error("Error setting up transactions listener:",n),this.error=n.message,this.loading=!1}}}}),Oee={class:"management-section"},Nee={class:"management-buttons"},Dee=["disabled"],Mee=["disabled"],Fee={key:0,class:"item-list"},Lee={class:"list-controls"},Uee={class:"item-grid"},Bee=["onClick"],Vee={class:"card-header"},Hee={class:"item-badge"},$ee={class:"card-content"},Kee={class:"info-row"},jee={class:"info-row"},Wee={class:"info-row"},Gee={class:"amount"},qee={class:"info-row"},zee={class:"modal-content large-modal"},Yee={class:"modal-header"},Qee={class:"form-row"},Xee={class:"form-group"},Jee={class:"form-group"},Zee=["value"],ete={class:"form-row"},tte={class:"form-group"},nte={class:"form-group"},rte={class:"form-row"},ite={class:"form-group"},ste={class:"form-group"},ote={class:"form-actions"},ate={type:"submit",class:"btn-submit"},lte={__name:"FinancialTransactionManagement",setup(n){const e=Pee(),t=Nl(),r=Se(!1),i=Se(!1),s=Se(!1),o=Se(""),a=Se(""),l=Se("date"),c=Se(""),u=Se(""),f=Se(!1),p=Se({id:"",date:"",projectID:"",projectLocation:"",requestedby:"",amount:0,type:""}),g=it(()=>t.projects.filter(C=>C.Status===" ").sort((C,I)=>{const x=parseInt(C.id)||0,P=parseInt(I.id)||0;return x-P})),m=it(()=>{let C=[...e.transactions];if(o.value){const I=o.value.toLowerCase();C=C.filter(x=>{var P,ie,Q,ae;return((P=x.projectID)==null?void 0:P.toLowerCase().includes(I))||((ie=x.projectLocation)==null?void 0:ie.toLowerCase().includes(I))||((Q=x.requestedby)==null?void 0:Q.toLowerCase().includes(I))||((ae=x.type)==null?void 0:ae.toLowerCase().includes(I))})}return a.value&&(C=C.filter(I=>I.type===a.value)),C.sort((I,x)=>{switch(l.value){case"date":return new Date(x.date)-new Date(I.date);case"amount":return(x.amount||0)-(I.amount||0);case"project":return(I.projectID||"").localeCompare(x.projectID||"");default:return 0}}),C});function v(C){if(!C)return"";const I=new Date(C);return`${I.getFullYear()}.${String(I.getMonth()+1).padStart(2,"0")}.${String(I.getDate()).padStart(2,"0")}`}function _(C){return!C&&C!==0?"0":Number(C).toLocaleString("en-US")}function D(){const C=t.projects.find(I=>I.id===p.value.projectID);C&&(p.value.projectLocation=C.siteLocation||"")}function b(){s.value=!1,p.value={id:"",date:new Date().toISOString().split("T")[0],projectID:"",projectLocation:"",requestedby:"",amount:0,type:""},i.value=!0}function T(C){s.value=!0,p.value={...C},i.value=!0}function R(){i.value=!1,p.value={id:"",date:"",projectID:"",projectLocation:"",requestedby:"",amount:0,type:""}}async function B(){try{const C=s.value?"update":"create",I=await kE(C,p.value);I.success?(E(I.message,"success"),R()):E(I.error||"Operation failed","error")}catch(C){console.error("Error submitting transaction:",C),E(C.message||"Failed to save transaction","error")}}async function W(){if(confirm("Are you sure you want to delete this transaction?"))try{const C=await kE("delete",p.value);C.success?(E(C.message,"success"),R()):E(C.error||"Delete failed","error")}catch(C){console.error("Error deleting transaction:",C),E(C.message||"Failed to delete transaction","error")}}async function A(){f.value=!0;try{const C=await x8();C.success?E(C.message,"success"):E(C.error||"Sync to Excel failed","error")}catch(C){console.error("Error syncing to Excel:",C),E(C.message||"Failed to sync to Excel","error")}finally{f.value=!1}}async function w(){f.value=!0;try{const C=await R8();C.success?E(C.message,"success"):E(C.error||"Sync from Excel failed","error")}catch(C){console.error("Error syncing from Excel:",C),E(C.message||"Failed to sync from Excel","error")}finally{f.value=!1}}function E(C,I){c.value=C,u.value=I,setTimeout(()=>{c.value=""},5e3)}return Dr(async()=>{await e.fetchTransactions(),await t.fetchProjects()}),(C,I)=>(ee(),te("div",Oee,[I[25]||(I[25]=d("h4",null,"Financial Transaction Management",-1)),d("div",Nee,[d("button",{onClick:b,class:"action-btn add-btn"}," + Add Transaction "),d("button",{onClick:I[0]||(I[0]=x=>r.value=!r.value),class:"action-btn"},Y(r.value?"Hide Transactions":"List Transactions"),1),d("button",{onClick:A,class:"action-btn sync-btn",disabled:f.value},Y(f.value?"Syncing...":"Sync to Excel"),9,Dee),d("button",{onClick:w,class:"action-btn sync-btn",disabled:f.value},Y(f.value?"Syncing...":"Sync from Excel"),9,Mee)]),r.value?(ee(),te("div",Fee,[I[16]||(I[16]=d("h5",null,"Select Transaction to Edit:",-1)),d("div",Lee,[Ie(d("input",{"onUpdate:modelValue":I[1]||(I[1]=x=>o.value=x),type:"text",placeholder:"Search by project, type, or requester...",class:"search-input"},null,512),[[Ge,o.value]]),Ie(d("select",{"onUpdate:modelValue":I[2]||(I[2]=x=>a.value=x),class:"filter-select"},[...I[10]||(I[10]=[Cs('<option value="" data-v-c86aa97f>All Types</option><option value="Expense" data-v-c86aa97f>Expense</option><option value="Income" data-v-c86aa97f>Income</option><option value="Payment" data-v-c86aa97f>Payment</option><option value="Refund" data-v-c86aa97f>Refund</option>',5)])],512),[[_t,a.value]]),Ie(d("select",{"onUpdate:modelValue":I[3]||(I[3]=x=>l.value=x),class:"sort-select"},[...I[11]||(I[11]=[d("option",{value:"date"},"Sort by Date",-1),d("option",{value:"amount"},"Sort by Amount",-1),d("option",{value:"project"},"Sort by Project",-1)])],512),[[_t,l.value]])]),d("div",Uee,[(ee(!0),te(wt,null,rn(m.value,x=>(ee(),te("div",{key:x.id,class:"item-card transaction-card-item",onClick:P=>T(x)},[d("div",Vee,[d("div",Hee,Y(x.id),1),d("span",{class:Tt(["type-badge",x.type])},Y(x.type),3)]),d("div",$ee,[d("div",Kee,[I[12]||(I[12]=d("strong",null,"Date:",-1)),d("span",null,Y(v(x.date)),1)]),d("div",jee,[I[13]||(I[13]=d("strong",null,"Project:",-1)),d("span",null,Y(x.projectID)+" - "+Y(x.projectLocation),1)]),d("div",Wee,[I[14]||(I[14]=d("strong",null,"Amount:",-1)),d("span",Gee,Y(_(x.amount))+"",1)]),d("div",qee,[I[15]||(I[15]=d("strong",null,"Requested by:",-1)),d("span",null,Y(x.requestedby),1)])])],8,Bee))),128))])])):Ke("",!0),i.value?(ee(),te("div",{key:1,class:"modal-overlay",onClick:ni(R,["self"])},[d("div",zee,[d("div",Yee,[d("h4",null,Y(s.value?"Edit Transaction":"Add New Transaction"),1),d("button",{class:"close-btn",onClick:R},"")]),d("form",{onSubmit:ni(B,["prevent"]),class:"item-form"},[d("div",Qee,[d("div",Xee,[I[17]||(I[17]=d("label",null,"Date *",-1)),Ie(d("input",{"onUpdate:modelValue":I[4]||(I[4]=x=>p.value.date=x),type:"date",required:"",class:"form-input"},null,512),[[Ge,p.value.date]])]),d("div",Jee,[I[19]||(I[19]=d("label",null,"Project *",-1)),Ie(d("select",{"onUpdate:modelValue":I[5]||(I[5]=x=>p.value.projectID=x),required:"",class:"form-input",onChange:D},[I[18]||(I[18]=d("option",{value:""},"Select Project",-1)),(ee(!0),te(wt,null,rn(g.value,x=>(ee(),te("option",{key:x.id,value:x.id},Y(x.id)+" - "+Y(x.siteLocation),9,Zee))),128))],544),[[_t,p.value.projectID]])])]),d("div",ete,[d("div",tte,[I[20]||(I[20]=d("label",null,"Project Location",-1)),Ie(d("input",{"onUpdate:modelValue":I[6]||(I[6]=x=>p.value.projectLocation=x),type:"text",readonly:"",class:"form-input",placeholder:"Auto-filled from project"},null,512),[[Ge,p.value.projectLocation]])]),d("div",nte,[I[21]||(I[21]=d("label",null,"Requested By",-1)),Ie(d("input",{"onUpdate:modelValue":I[7]||(I[7]=x=>p.value.requestedby=x),type:"text",class:"form-input",placeholder:"Employee name or department"},null,512),[[Ge,p.value.requestedby]])])]),d("div",rte,[d("div",ite,[I[22]||(I[22]=d("label",null,"Amount *",-1)),Ie(d("input",{"onUpdate:modelValue":I[8]||(I[8]=x=>p.value.amount=x),type:"number",step:"0.01",required:"",class:"form-input",placeholder:"0.00"},null,512),[[Ge,p.value.amount,void 0,{number:!0}]])]),d("div",ste,[I[24]||(I[24]=d("label",null,"Type *",-1)),Ie(d("select",{"onUpdate:modelValue":I[9]||(I[9]=x=>p.value.type=x),required:"",class:"form-input"},[...I[23]||(I[23]=[Cs('<option value="" data-v-c86aa97f>Select Type</option><option value="Expense" data-v-c86aa97f>Expense ()</option><option value="Income" data-v-c86aa97f>Income ()</option><option value="Payment" data-v-c86aa97f>Payment ()</option><option value="Refund" data-v-c86aa97f>Refund ()</option>',5)])],512),[[_t,p.value.type]])])]),d("div",ote,[d("button",ate,Y(s.value?"Update Transaction":"Add Transaction"),1),d("button",{type:"button",onClick:R,class:"btn-cancel"},"Cancel"),s.value?(ee(),te("button",{key:0,type:"button",onClick:W,class:"btn-delete"}," Delete ")):Ke("",!0)])],32)])])):Ke("",!0),c.value?(ee(),te("div",{key:2,class:Tt(["message",u.value])},Y(c.value),3)):Ke("",!0)]))}},cte=Cr(lte,[["__scopeId","data-v-c86aa97f"]]),ute=[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:m5},{path:"/register",name:"Register",component:x5,meta:{requiresAuth:!0}},{path:"/supervisor-register",name:"SupervisorRegister",component:B5,meta:{requiresMicrosoft:!0}},{path:"/dashboard",name:"Dashboard",component:JK,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/time-attendance-request",name:"TimeAttendanceRequest",component:bj,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/salary-report",name:"SalaryReport",component:pW,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/supervisor-ta-summary",name:"SupervisorTASummary",component:YZ,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/project-summary",name:"ProjectSummary",component:kee,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/financial-transactions",name:"FinancialTransactions",component:cte,meta:{requiresAuth:!0,requiresRegistration:!0}}],JR=l5({history:V6(),routes:ute});JR.beforeEach(async(n,e,t)=>{const r=Ms();for(;r.loading;)await new Promise(i=>setTimeout(i,100));if(n.path==="/supervisor-register"){r.msalAccount?t():t("/login");return}n.meta.requiresAuth&&!r.user?t("/login"):n.meta.requiresRegistration&&!r.userData?t("/register"):n.path==="/login"&&r.user?r.userData?t("/dashboard"):t("/register"):t()});const Hv=Vk(n6);Hv.use(Kk());Hv.use(JR);Hv.mount("#app");

(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function T0(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const zt={},Za=[],Fs=()=>{},FT=()=>!1,Yh=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),w0=n=>n.startsWith("onUpdate:"),gr=Object.assign,C0=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},XR=Object.prototype.hasOwnProperty,Mt=(n,e)=>XR.call(n,e),ot=Array.isArray,el=n=>du(n)==="[object Map]",Nl=n=>du(n)==="[object Set]",Ny=n=>du(n)==="[object Date]",vt=n=>typeof n=="function",_n=n=>typeof n=="string",Ws=n=>typeof n=="symbol",Xt=n=>n!==null&&typeof n=="object",LT=n=>(Xt(n)||vt(n))&&vt(n.then)&&vt(n.catch),UT=Object.prototype.toString,du=n=>UT.call(n),JR=n=>du(n).slice(8,-1),BT=n=>du(n)==="[object Object]",Qh=n=>_n(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,vc=T0(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xh=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},ZR=/-\w/g,rs=Xh(n=>n.replace(ZR,e=>e.slice(1).toUpperCase())),e2=/\B([A-Z])/g,Io=Xh(n=>n.replace(e2,"-$1").toLowerCase()),Jh=Xh(n=>n.charAt(0).toUpperCase()+n.slice(1)),_p=Xh(n=>n?`on${Jh(n)}`:""),ao=(n,e)=>!Object.is(n,e),Nd=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},VT=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},Zh=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let Oy;const ef=()=>Oy||(Oy=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function wt(n){if(ot(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=_n(r)?s2(r):wt(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(_n(n)||Xt(n))return n}const t2=/;(?![^(]*\))/g,n2=/:([^]+)/,r2=/\/\*[^]*?\*\//g;function s2(n){const e={};return n.replace(r2,"").split(t2).forEach(t=>{if(t){const r=t.split(n2);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function mt(n){let e="";if(_n(n))e=n;else if(ot(n))for(let t=0;t<n.length;t++){const r=mt(n[t]);r&&(e+=r+" ")}else if(Xt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const i2="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",o2=T0(i2);function $T(n){return!!n||n===""}function a2(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=Xo(n[r],e[r]);return t}function Xo(n,e){if(n===e)return!0;let t=Ny(n),r=Ny(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=Ws(n),r=Ws(e),t||r)return n===e;if(t=ot(n),r=ot(e),t||r)return t&&r?a2(n,e):!1;if(t=Xt(n),r=Xt(e),t||r){if(!t||!r)return!1;const s=Object.keys(n).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Xo(n[o],e[o]))return!1}}return String(n)===String(e)}function A0(n,e){return n.findIndex(t=>Xo(t,e))}const HT=n=>!!(n&&n.__v_isRef===!0),P=n=>_n(n)?n:n==null?"":ot(n)||Xt(n)&&(n.toString===UT||!vt(n.toString))?HT(n)?P(n.value):JSON.stringify(n,jT,2):String(n),jT=(n,e)=>HT(e)?jT(n,e.value):el(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[Ep(r,i)+" =>"]=s,t),{})}:Nl(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Ep(t))}:Ws(e)?Ep(e):Xt(e)&&!ot(e)&&!BT(e)?String(e):e,Ep=(n,e="")=>{var t;return Ws(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let or;class WT{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=or,!e&&or&&(this.index=(or.scopes||(or.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=or;try{return or=this,e()}finally{or=t}}}on(){++this._on===1&&(this.prevScope=or,or=this)}off(){this._on>0&&--this._on===0&&(or=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function KT(n){return new WT(n)}function qT(){return or}function l2(n,e=!1){or&&or.cleanups.push(n)}let Jt;const Tp=new WeakSet;class GT{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,or&&or.active&&or.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Tp.has(this)&&(Tp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||YT(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Dy(this),QT(this);const e=Jt,t=hs;Jt=this,hs=!0;try{return this.fn()}finally{XT(this),Jt=e,hs=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)x0(e);this.deps=this.depsTail=void 0,Dy(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Tp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){am(this)&&this.run()}get dirty(){return am(this)}}let zT=0,yc,_c;function YT(n,e=!1){if(n.flags|=8,e){n.next=_c,_c=n;return}n.next=yc,yc=n}function I0(){zT++}function S0(){if(--zT>0)return;if(_c){let e=_c;for(_c=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;yc;){let e=yc;for(yc=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function QT(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function XT(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),x0(r),c2(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function am(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(JT(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function JT(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Hc)||(n.globalVersion=Hc,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!am(n))))return;n.flags|=2;const e=n.dep,t=Jt,r=hs;Jt=n,hs=!0;try{QT(n);const s=n.fn(n._value);(e.version===0||ao(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{Jt=t,hs=r,XT(n),n.flags&=-3}}function x0(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)x0(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function c2(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let hs=!0;const ZT=[];function bi(){ZT.push(hs),hs=!1}function Ri(){const n=ZT.pop();hs=n===void 0?!0:n}function Dy(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Jt;Jt=void 0;try{e()}finally{Jt=t}}}let Hc=0;class u2{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class b0{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Jt||!hs||Jt===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Jt)t=this.activeLink=new u2(Jt,this),Jt.deps?(t.prevDep=Jt.depsTail,Jt.depsTail.nextDep=t,Jt.depsTail=t):Jt.deps=Jt.depsTail=t,ew(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Jt.depsTail,t.nextDep=void 0,Jt.depsTail.nextDep=t,Jt.depsTail=t,Jt.deps===t&&(Jt.deps=r)}return t}trigger(e){this.version++,Hc++,this.notify(e)}notify(e){I0();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{S0()}}}function ew(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)ew(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Yd=new WeakMap,Ko=Symbol(""),lm=Symbol(""),jc=Symbol("");function cr(n,e,t){if(hs&&Jt){let r=Yd.get(n);r||Yd.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new b0),s.map=r,s.key=t),s.track()}}function di(n,e,t,r,s,i){const o=Yd.get(n);if(!o){Hc++;return}const a=l=>{l&&l.trigger()};if(I0(),e==="clear")o.forEach(a);else{const l=ot(n),u=l&&Qh(t);if(l&&t==="length"){const d=Number(r);o.forEach((f,p)=>{(p==="length"||p===jc||!Ws(p)&&p>=d)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(jc)),e){case"add":l?u&&a(o.get("length")):(a(o.get(Ko)),el(n)&&a(o.get(lm)));break;case"delete":l||(a(o.get(Ko)),el(n)&&a(o.get(lm)));break;case"set":el(n)&&a(o.get(Ko));break}}S0()}function d2(n,e){const t=Yd.get(n);return t&&t.get(e)}function Pa(n){const e=kt(n);return e===n?e:(cr(e,"iterate",jc),Xr(n)?e:e.map(_s))}function tf(n){return cr(n=kt(n),"iterate",jc),n}function Xi(n,e){return ki(n)?Ei(n)?pl(_s(e)):pl(e):_s(e)}const h2={__proto__:null,[Symbol.iterator](){return wp(this,Symbol.iterator,n=>Xi(this,n))},concat(...n){return Pa(this).concat(...n.map(e=>ot(e)?Pa(e):e))},entries(){return wp(this,"entries",n=>(n[1]=Xi(this,n[1]),n))},every(n,e){return ii(this,"every",n,e,void 0,arguments)},filter(n,e){return ii(this,"filter",n,e,t=>t.map(r=>Xi(this,r)),arguments)},find(n,e){return ii(this,"find",n,e,t=>Xi(this,t),arguments)},findIndex(n,e){return ii(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return ii(this,"findLast",n,e,t=>Xi(this,t),arguments)},findLastIndex(n,e){return ii(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return ii(this,"forEach",n,e,void 0,arguments)},includes(...n){return Cp(this,"includes",n)},indexOf(...n){return Cp(this,"indexOf",n)},join(n){return Pa(this).join(n)},lastIndexOf(...n){return Cp(this,"lastIndexOf",n)},map(n,e){return ii(this,"map",n,e,void 0,arguments)},pop(){return rc(this,"pop")},push(...n){return rc(this,"push",n)},reduce(n,...e){return My(this,"reduce",n,e)},reduceRight(n,...e){return My(this,"reduceRight",n,e)},shift(){return rc(this,"shift")},some(n,e){return ii(this,"some",n,e,void 0,arguments)},splice(...n){return rc(this,"splice",n)},toReversed(){return Pa(this).toReversed()},toSorted(n){return Pa(this).toSorted(n)},toSpliced(...n){return Pa(this).toSpliced(...n)},unshift(...n){return rc(this,"unshift",n)},values(){return wp(this,"values",n=>Xi(this,n))}};function wp(n,e,t){const r=tf(n),s=r[e]();return r!==n&&!Xr(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=t(i.value)),i}),s}const f2=Array.prototype;function ii(n,e,t,r,s,i){const o=tf(n),a=o!==n&&!Xr(n),l=o[e];if(l!==f2[e]){const f=l.apply(n,i);return a?_s(f):f}let u=t;o!==n&&(a?u=function(f,p){return t.call(this,Xi(n,f),p,n)}:t.length>2&&(u=function(f,p){return t.call(this,f,p,n)}));const d=l.call(o,u,r);return a&&s?s(d):d}function My(n,e,t,r){const s=tf(n);let i=t;return s!==n&&(Xr(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,Xi(n,a),l,n)}),s[e](i,...r)}function Cp(n,e,t){const r=kt(n);cr(r,"iterate",jc);const s=r[e](...t);return(s===-1||s===!1)&&nf(t[0])?(t[0]=kt(t[0]),r[e](...t)):s}function rc(n,e,t=[]){bi(),I0();const r=kt(n)[e].apply(n,t);return S0(),Ri(),r}const p2=T0("__proto__,__v_isRef,__isVue"),tw=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ws));function m2(n){Ws(n)||(n=String(n));const e=kt(this);return cr(e,"has",n),e.hasOwnProperty(n)}class nw{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?I2:ow:i?iw:sw).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=ot(e);if(!s){let l;if(o&&(l=h2[t]))return l;if(t==="hasOwnProperty")return m2}const a=Reflect.get(e,t,pn(e)?e:r);if((Ws(t)?tw.has(t):p2(t))||(s||cr(e,"get",t),i))return a;if(pn(a)){const l=o&&Qh(t)?a:a.value;return s&&Xt(l)?um(l):l}return Xt(a)?s?um(a):hu(a):a}}class rw extends nw{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];const o=ot(e)&&Qh(t);if(!this._isShallow){const u=ki(i);if(!Xr(r)&&!ki(r)&&(i=kt(i),r=kt(r)),!o&&pn(i)&&!pn(r))return u||(i.value=r),!0}const a=o?Number(t)<e.length:Mt(e,t),l=Reflect.set(e,t,r,pn(e)?e:s);return e===kt(s)&&(a?ao(r,i)&&di(e,"set",t,r):di(e,"add",t,r)),l}deleteProperty(e,t){const r=Mt(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&di(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!Ws(t)||!tw.has(t))&&cr(e,"has",t),r}ownKeys(e){return cr(e,"iterate",ot(e)?"length":Ko),Reflect.ownKeys(e)}}class g2 extends nw{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const v2=new rw,y2=new g2,_2=new rw(!0);const cm=n=>n,od=n=>Reflect.getPrototypeOf(n);function E2(n,e,t){return function(...r){const s=this.__v_raw,i=kt(s),o=el(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,u=s[n](...r),d=t?cm:e?pl:_s;return!e&&cr(i,"iterate",l?lm:Ko),{next(){const{value:f,done:p}=u.next();return p?{value:f,done:p}:{value:a?[d(f[0]),d(f[1])]:d(f),done:p}},[Symbol.iterator](){return this}}}}function ad(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function T2(n,e){const t={get(s){const i=this.__v_raw,o=kt(i),a=kt(s);n||(ao(s,a)&&cr(o,"get",s),cr(o,"get",a));const{has:l}=od(o),u=e?cm:n?pl:_s;if(l.call(o,s))return u(i.get(s));if(l.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&cr(kt(s),"iterate",Ko),s.size},has(s){const i=this.__v_raw,o=kt(i),a=kt(s);return n||(ao(s,a)&&cr(o,"has",s),cr(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=kt(a),u=e?cm:n?pl:_s;return!n&&cr(l,"iterate",Ko),a.forEach((d,f)=>s.call(i,u(d),u(f),o))}};return gr(t,n?{add:ad("add"),set:ad("set"),delete:ad("delete"),clear:ad("clear")}:{add(s){!e&&!Xr(s)&&!ki(s)&&(s=kt(s));const i=kt(this);return od(i).has.call(i,s)||(i.add(s),di(i,"add",s,s)),this},set(s,i){!e&&!Xr(i)&&!ki(i)&&(i=kt(i));const o=kt(this),{has:a,get:l}=od(o);let u=a.call(o,s);u||(s=kt(s),u=a.call(o,s));const d=l.call(o,s);return o.set(s,i),u?ao(i,d)&&di(o,"set",s,i):di(o,"add",s,i),this},delete(s){const i=kt(this),{has:o,get:a}=od(i);let l=o.call(i,s);l||(s=kt(s),l=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return l&&di(i,"delete",s,void 0),u},clear(){const s=kt(this),i=s.size!==0,o=s.clear();return i&&di(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=E2(s,n,e)}),t}function R0(n,e){const t=T2(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(Mt(t,s)&&s in r?t:r,s,i)}const w2={get:R0(!1,!1)},C2={get:R0(!1,!0)},A2={get:R0(!0,!1)};const sw=new WeakMap,iw=new WeakMap,ow=new WeakMap,I2=new WeakMap;function S2(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function x2(n){return n.__v_skip||!Object.isExtensible(n)?0:S2(JR(n))}function hu(n){return ki(n)?n:k0(n,!1,v2,w2,sw)}function aw(n){return k0(n,!1,_2,C2,iw)}function um(n){return k0(n,!0,y2,A2,ow)}function k0(n,e,t,r,s){if(!Xt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=x2(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function Ei(n){return ki(n)?Ei(n.__v_raw):!!(n&&n.__v_isReactive)}function ki(n){return!!(n&&n.__v_isReadonly)}function Xr(n){return!!(n&&n.__v_isShallow)}function nf(n){return n?!!n.__v_raw:!1}function kt(n){const e=n&&n.__v_raw;return e?kt(e):n}function P0(n){return!Mt(n,"__v_skip")&&Object.isExtensible(n)&&VT(n,"__v_skip",!0),n}const _s=n=>Xt(n)?hu(n):n,pl=n=>Xt(n)?um(n):n;function pn(n){return n?n.__v_isRef===!0:!1}function ae(n){return lw(n,!1)}function b2(n){return lw(n,!0)}function lw(n,e){return pn(n)?n:new R2(n,e)}class R2{constructor(e,t){this.dep=new b0,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:kt(e),this._value=t?e:_s(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||Xr(e)||ki(e);e=r?e:kt(e),ao(e,t)&&(this._rawValue=e,this._value=r?e:_s(e),this.dep.trigger())}}function Ut(n){return pn(n)?n.value:n}const k2={get:(n,e,t)=>e==="__v_raw"?n:Ut(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return pn(s)&&!pn(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function cw(n){return Ei(n)?n:new Proxy(n,k2)}function P2(n){const e=ot(n)?new Array(n.length):{};for(const t in n)e[t]=O2(n,t);return e}class N2{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0,this._raw=kt(e);let s=!0,i=e;if(!ot(e)||!Qh(String(t)))do s=!nf(i)||Xr(i);while(s&&(i=i.__v_raw));this._shallow=s}get value(){let e=this._object[this._key];return this._shallow&&(e=Ut(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&pn(this._raw[this._key])){const t=this._object[this._key];if(pn(t)){t.value=e;return}}this._object[this._key]=e}get dep(){return d2(this._raw,this._key)}}function O2(n,e,t){return new N2(n,e,t)}class D2{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new b0(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Hc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Jt!==this)return YT(this,!0),!0}get value(){const e=this.dep.track();return JT(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function M2(n,e,t=!1){let r,s;return vt(n)?r=n:(r=n.get,s=n.set),new D2(r,s,t)}const ld={},Qd=new WeakMap;let Lo;function F2(n,e=!1,t=Lo){if(t){let r=Qd.get(t);r||Qd.set(t,r=[]),r.push(n)}}function L2(n,e,t=zt){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,u=C=>s?C:Xr(C)||s===!1||s===0?hi(C,1):hi(C);let d,f,p,m,g=!1,v=!1;if(pn(n)?(f=()=>n.value,g=Xr(n)):Ei(n)?(f=()=>u(n),g=!0):ot(n)?(v=!0,g=n.some(C=>Ei(C)||Xr(C)),f=()=>n.map(C=>{if(pn(C))return C.value;if(Ei(C))return u(C);if(vt(C))return l?l(C,2):C()})):vt(n)?e?f=l?()=>l(n,2):n:f=()=>{if(p){bi();try{p()}finally{Ri()}}const C=Lo;Lo=d;try{return l?l(n,3,[m]):n(m)}finally{Lo=C}}:f=Fs,e&&s){const C=f,j=s===!0?1/0:s;f=()=>hi(C(),j)}const y=qT(),L=()=>{d.stop(),y&&y.active&&C0(y.effects,d)};if(i&&e){const C=e;e=(...j)=>{C(...j),L()}}let D=v?new Array(n.length).fill(ld):ld;const A=C=>{if(!(!(d.flags&1)||!d.dirty&&!C))if(e){const j=d.run();if(s||g||(v?j.some((z,w)=>ao(z,D[w])):ao(j,D))){p&&p();const z=Lo;Lo=d;try{const w=[j,D===ld?void 0:v&&D[0]===ld?[]:D,m];D=j,l?l(e,3,w):e(...w)}finally{Lo=z}}}else d.run()};return a&&a(A),d=new GT(f),d.scheduler=o?()=>o(A,!1):A,m=C=>F2(C,!1,d),p=d.onStop=()=>{const C=Qd.get(d);if(C){if(l)l(C,4);else for(const j of C)j();Qd.delete(d)}},e?r?A(!0):D=d.run():o?o(A.bind(null,!0),!0):d.run(),L.pause=d.pause.bind(d),L.resume=d.resume.bind(d),L.stop=L,L}function hi(n,e=1/0,t){if(e<=0||!Xt(n)||n.__v_skip||(t=t||new Map,(t.get(n)||0)>=e))return n;if(t.set(n,e),e--,pn(n))hi(n.value,e,t);else if(ot(n))for(let r=0;r<n.length;r++)hi(n[r],e,t);else if(Nl(n)||el(n))n.forEach(r=>{hi(r,e,t)});else if(BT(n)){for(const r in n)hi(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&hi(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fu(n,e,t,r){try{return r?n(...r):n()}catch(s){rf(s,e,t)}}function Ks(n,e,t,r){if(vt(n)){const s=fu(n,e,t,r);return s&&LT(s)&&s.catch(i=>{rf(i,e,t)}),s}if(ot(n)){const s=[];for(let i=0;i<n.length;i++)s.push(Ks(n[i],e,t,r));return s}}function rf(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||zt;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](n,l,u)===!1)return}a=a.parent}if(i){bi(),fu(i,null,10,[n,l,u]),Ri();return}}U2(n,t,s,r,o)}function U2(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const Sr=[];let ks=-1;const tl=[];let Ji=null,La=0;const uw=Promise.resolve();let Xd=null;function sf(n){const e=Xd||uw;return n?e.then(this?n.bind(this):n):e}function B2(n){let e=ks+1,t=Sr.length;for(;e<t;){const r=e+t>>>1,s=Sr[r],i=Wc(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function N0(n){if(!(n.flags&1)){const e=Wc(n),t=Sr[Sr.length-1];!t||!(n.flags&2)&&e>=Wc(t)?Sr.push(n):Sr.splice(B2(e),0,n),n.flags|=1,dw()}}function dw(){Xd||(Xd=uw.then(fw))}function V2(n){ot(n)?tl.push(...n):Ji&&n.id===-1?Ji.splice(La+1,0,n):n.flags&1||(tl.push(n),n.flags|=1),dw()}function Fy(n,e,t=ks+1){for(;t<Sr.length;t++){const r=Sr[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Sr.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function hw(n){if(tl.length){const e=[...new Set(tl)].sort((t,r)=>Wc(t)-Wc(r));if(tl.length=0,Ji){Ji.push(...e);return}for(Ji=e,La=0;La<Ji.length;La++){const t=Ji[La];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Ji=null,La=0}}const Wc=n=>n.id==null?n.flags&2?-1:1/0:n.id;function fw(n){try{for(ks=0;ks<Sr.length;ks++){const e=Sr[ks];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),fu(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ks<Sr.length;ks++){const e=Sr[ks];e&&(e.flags&=-2)}ks=-1,Sr.length=0,hw(),Xd=null,(Sr.length||tl.length)&&fw()}}let Gr=null,pw=null;function Jd(n){const e=Gr;return Gr=n,pw=n&&n.type.__scopeId||null,e}function $2(n,e=Gr,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&th(-1);const i=Jd(e);let o;try{o=n(...s)}finally{Jd(i),r._d&&th(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function ce(n,e){if(Gr===null)return n;const t=cf(Gr),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=zt]=e[s];i&&(vt(i)&&(i={mounted:i,updated:i}),i.deep&&hi(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Mo(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(bi(),Ks(l,t,8,[n.el,a,n,e]),Ri())}}function Od(n,e){if(hr){let t=hr.provides;const r=hr.parent&&hr.parent.provides;r===t&&(t=hr.provides=Object.create(r)),t[n]=e}}function fs(n,e,t=!1){const r=Hw();if(r||qo){let s=qo?qo._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&vt(e)?e.call(r&&r.proxy):e}}function H2(){return!!(Hw()||qo)}const j2=Symbol.for("v-scx"),W2=()=>fs(j2);function Ti(n,e,t){return mw(n,e,t)}function mw(n,e,t=zt){const{immediate:r,deep:s,flush:i,once:o}=t,a=gr({},t),l=e&&r||!e&&i!=="post";let u;if(qc){if(i==="sync"){const m=W2();u=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=Fs,m.resume=Fs,m.pause=Fs,m}}const d=hr;a.call=(m,g,v)=>Ks(m,d,g,v);let f=!1;i==="post"?a.scheduler=m=>{Er(m,d&&d.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(m,g)=>{g?m():N0(m)}),a.augmentJob=m=>{e&&(m.flags|=4),f&&(m.flags|=2,d&&(m.id=d.uid,m.i=d))};const p=L2(n,e,a);return qc&&(u?u.push(p):l&&p()),p}function K2(n,e,t){const r=this.proxy,s=_n(n)?n.includes(".")?gw(r,n):()=>r[n]:n.bind(r,r);let i;vt(e)?i=e:(i=e.handler,t=e);const o=pu(this),a=mw(s,i.bind(r),t);return o(),a}function gw(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const vw=Symbol("_vte"),q2=n=>n.__isTeleport,Ec=n=>n&&(n.disabled||n.disabled===""),Ly=n=>n&&(n.defer||n.defer===""),Uy=n=>typeof SVGElement<"u"&&n instanceof SVGElement,By=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,dm=(n,e)=>{const t=n&&n.to;return _n(t)?e?e(t):null:t},yw={name:"Teleport",__isTeleport:!0,process(n,e,t,r,s,i,o,a,l,u){const{mc:d,pc:f,pbc:p,o:{insert:m,querySelector:g,createText:v,createComment:y}}=u,L=Ec(e.props);let{shapeFlag:D,children:A,dynamicChildren:C}=e;if(n==null){const j=e.el=v(""),z=e.anchor=v("");m(j,t,r),m(z,t,r);const w=(x,b)=>{D&16&&d(A,x,b,s,i,o,a,l)},R=()=>{const x=e.target=dm(e.props,g),b=_w(x,e,v,m);x&&(o!=="svg"&&Uy(x)?o="svg":o!=="mathml"&&By(x)&&(o="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(x),L||(w(x,b),Dd(e,!1)))};L&&(w(t,z),Dd(e,!0)),Ly(e.props)?(e.el.__isMounted=!1,Er(()=>{R(),delete e.el.__isMounted},i)):R()}else{if(Ly(e.props)&&n.el.__isMounted===!1){Er(()=>{yw.process(n,e,t,r,s,i,o,a,l,u)},i);return}e.el=n.el,e.targetStart=n.targetStart;const j=e.anchor=n.anchor,z=e.target=n.target,w=e.targetAnchor=n.targetAnchor,R=Ec(n.props),x=R?t:z,b=R?j:w;if(o==="svg"||Uy(z)?o="svg":(o==="mathml"||By(z))&&(o="mathml"),C?(p(n.dynamicChildren,C,x,s,i,o,a),F0(n,e,!0)):l||f(n,e,x,b,s,i,o,a,!1),L)R?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):cd(e,t,j,u,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const N=e.target=dm(e.props,g);N&&cd(e,N,null,u,0)}else R&&cd(e,z,w,u,1);Dd(e,L)}},remove(n,e,t,{um:r,o:{remove:s}},i){const{shapeFlag:o,children:a,anchor:l,targetStart:u,targetAnchor:d,target:f,props:p}=n;if(f&&(s(u),s(d)),i&&s(l),o&16){const m=i||!Ec(p);for(let g=0;g<a.length;g++){const v=a[g];r(v,e,t,m,!!v.dynamicChildren)}}},move:cd,hydrate:G2};function cd(n,e,t,{o:{insert:r},m:s},i=2){i===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:u,props:d}=n,f=i===2;if(f&&r(o,e,t),(!f||Ec(d))&&l&16)for(let p=0;p<u.length;p++)s(u[p],e,t,2);f&&r(a,e,t)}function G2(n,e,t,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:u,createText:d}},f){function p(v,y,L,D){y.anchor=f(o(v),y,a(v),t,r,s,i),y.targetStart=L,y.targetAnchor=D}const m=e.target=dm(e.props,l),g=Ec(e.props);if(m){const v=m._lpa||m.firstChild;if(e.shapeFlag&16)if(g)p(n,e,v,v&&o(v));else{e.anchor=o(n);let y=v;for(;y;){if(y&&y.nodeType===8){if(y.data==="teleport start anchor")e.targetStart=y;else if(y.data==="teleport anchor"){e.targetAnchor=y,m._lpa=e.targetAnchor&&o(e.targetAnchor);break}}y=o(y)}e.targetAnchor||_w(m,e,d,u),f(v&&o(v),e,m,t,r,s,i)}Dd(e,g)}else g&&e.shapeFlag&16&&p(n,e,n,o(n));return e.anchor&&o(e.anchor)}const z2=yw;function Dd(n,e){const t=n.ctx;if(t&&t.ut){let r,s;for(e?(r=n.el,s=n.anchor):(r=n.targetStart,s=n.targetAnchor);r&&r!==s;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}function _w(n,e,t,r){const s=e.targetStart=t(""),i=e.targetAnchor=t("");return s[vw]=i,n&&(r(s,n),r(i,n)),i}const Y2=Symbol("_leaveCb");function O0(n,e){n.shapeFlag&6&&n.component?(n.transition=e,O0(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function Ew(n,e){return vt(n)?gr({name:n.name},e,{setup:n}):n}function Tw(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const Zd=new WeakMap;function Tc(n,e,t,r,s=!1){if(ot(n)){n.forEach((g,v)=>Tc(g,e&&(ot(e)?e[v]:e),t,r,s));return}if(wc(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Tc(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?cf(r.component):r.el,o=s?null:i,{i:a,r:l}=n,u=e&&e.r,d=a.refs===zt?a.refs={}:a.refs,f=a.setupState,p=kt(f),m=f===zt?FT:g=>Mt(p,g);if(u!=null&&u!==l){if(Vy(e),_n(u))d[u]=null,m(u)&&(f[u]=null);else if(pn(u)){u.value=null;const g=e;g.k&&(d[g.k]=null)}}if(vt(l))fu(l,a,12,[o,d]);else{const g=_n(l),v=pn(l);if(g||v){const y=()=>{if(n.f){const L=g?m(l)?f[l]:d[l]:l.value;if(s)ot(L)&&C0(L,i);else if(ot(L))L.includes(i)||L.push(i);else if(g)d[l]=[i],m(l)&&(f[l]=d[l]);else{const D=[i];l.value=D,n.k&&(d[n.k]=D)}}else g?(d[l]=o,m(l)&&(f[l]=o)):v&&(l.value=o,n.k&&(d[n.k]=o))};if(o){const L=()=>{y(),Zd.delete(n)};L.id=-1,Zd.set(n,L),Er(L,t)}else Vy(n),y()}}}function Vy(n){const e=Zd.get(n);e&&(e.flags|=8,Zd.delete(n))}ef().requestIdleCallback;ef().cancelIdleCallback;const wc=n=>!!n.type.__asyncLoader,ww=n=>n.type.__isKeepAlive;function Q2(n,e){Cw(n,"a",e)}function X2(n,e){Cw(n,"da",e)}function Cw(n,e,t=hr){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(of(e,r,t),t){let s=t.parent;for(;s&&s.parent;)ww(s.parent.vnode)&&J2(r,e,t,s),s=s.parent}}function J2(n,e,t,r){const s=of(e,n,r,!0);Aw(()=>{C0(r[e],s)},t)}function of(n,e,t=hr,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{bi();const a=pu(t),l=Ks(e,t,n,o);return a(),Ri(),l});return r?s.unshift(i):s.push(i),i}}const Ui=n=>(e,t=hr)=>{(!qc||n==="sp")&&of(n,(...r)=>e(...r),t)},Z2=Ui("bm"),kn=Ui("m"),ek=Ui("bu"),tk=Ui("u"),nk=Ui("bum"),Aw=Ui("um"),rk=Ui("sp"),sk=Ui("rtg"),ik=Ui("rtc");function ok(n,e=hr){of("ec",n,e)}const ak="components";function lk(n,e){return uk(ak,n,!0,e)||n}const ck=Symbol.for("v-ndc");function uk(n,e,t=!0,r=!1){const s=Gr||hr;if(s){const i=s.type;{const a=zk(i,!1);if(a&&(a===e||a===rs(e)||a===Jh(rs(e))))return i}const o=$y(s[n]||i[n],e)||$y(s.appContext[n],e);return!o&&r?i:o}}function $y(n,e){return n&&(n[e]||n[rs(e)]||n[Jh(rs(e))])}function ft(n,e,t,r){let s;const i=t,o=ot(n);if(o||_n(n)){const a=o&&Ei(n);let l=!1,u=!1;a&&(l=!Xr(n),u=ki(n),n=tf(n)),s=new Array(n.length);for(let d=0,f=n.length;d<f;d++)s[d]=e(l?u?pl(_s(n[d])):_s(n[d]):n[d],d,void 0,i)}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i)}else if(Xt(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const d=a[l];s[l]=e(n[d],d,l,i)}}else s=[];return s}const hm=n=>n?jw(n)?cf(n):hm(n.parent):null,Cc=gr(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>hm(n.parent),$root:n=>hm(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>Sw(n),$forceUpdate:n=>n.f||(n.f=()=>{N0(n.update)}),$nextTick:n=>n.n||(n.n=sf.bind(n.proxy)),$watch:n=>K2.bind(n)}),Ap=(n,e)=>n!==zt&&!n.__isScriptSetup&&Mt(n,e),dk={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Ap(r,e))return o[e]=1,r[e];if(s!==zt&&Mt(s,e))return o[e]=2,s[e];if(Mt(i,e))return o[e]=3,i[e];if(t!==zt&&Mt(t,e))return o[e]=4,t[e];fm&&(o[e]=0)}}const u=Cc[e];let d,f;if(u)return e==="$attrs"&&cr(n.attrs,"get",""),u(n);if((d=a.__cssModules)&&(d=d[e]))return d;if(t!==zt&&Mt(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,Mt(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return Ap(s,e)?(s[e]=t,!0):r!==zt&&Mt(r,e)?(r[e]=t,!0):Mt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,props:i,type:o}},a){let l;return!!(t[a]||n!==zt&&a[0]!=="$"&&Mt(n,a)||Ap(e,a)||Mt(i,a)||Mt(r,a)||Mt(Cc,a)||Mt(s.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Mt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function Hy(n){return ot(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let fm=!0;function hk(n){const e=Sw(n),t=n.proxy,r=n.ctx;fm=!1,e.beforeCreate&&jy(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:u,created:d,beforeMount:f,mounted:p,beforeUpdate:m,updated:g,activated:v,deactivated:y,beforeDestroy:L,beforeUnmount:D,destroyed:A,unmounted:C,render:j,renderTracked:z,renderTriggered:w,errorCaptured:R,serverPrefetch:x,expose:b,inheritAttrs:N,components:M,directives:F,filters:oe}=e;if(u&&fk(u,r,null),o)for(const ge in o){const xe=o[ge];vt(xe)&&(r[ge]=xe.bind(t))}if(s){const ge=s.call(t,t);Xt(ge)&&(n.data=hu(ge))}if(fm=!0,i)for(const ge in i){const xe=i[ge],Ee=vt(xe)?xe.bind(t,t):vt(xe.get)?xe.get.bind(t,t):Fs,Pe=!vt(xe)&&vt(xe.set)?xe.set.bind(t):Fs,he=Be({get:Ee,set:Pe});Object.defineProperty(r,ge,{enumerable:!0,configurable:!0,get:()=>he.value,set:E=>he.value=E})}if(a)for(const ge in a)Iw(a[ge],r,t,ge);if(l){const ge=vt(l)?l.call(t):l;Reflect.ownKeys(ge).forEach(xe=>{Od(xe,ge[xe])})}d&&jy(d,n,"c");function ne(ge,xe){ot(xe)?xe.forEach(Ee=>ge(Ee.bind(t))):xe&&ge(xe.bind(t))}if(ne(Z2,f),ne(kn,p),ne(ek,m),ne(tk,g),ne(Q2,v),ne(X2,y),ne(ok,R),ne(ik,z),ne(sk,w),ne(nk,D),ne(Aw,C),ne(rk,x),ot(b))if(b.length){const ge=n.exposed||(n.exposed={});b.forEach(xe=>{Object.defineProperty(ge,xe,{get:()=>t[xe],set:Ee=>t[xe]=Ee,enumerable:!0})})}else n.exposed||(n.exposed={});j&&n.render===Fs&&(n.render=j),N!=null&&(n.inheritAttrs=N),M&&(n.components=M),F&&(n.directives=F),x&&Tw(n)}function fk(n,e,t=Fs){ot(n)&&(n=pm(n));for(const r in n){const s=n[r];let i;Xt(s)?"default"in s?i=fs(s.from||r,s.default,!0):i=fs(s.from||r):i=fs(s),pn(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function jy(n,e,t){Ks(ot(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function Iw(n,e,t,r){let s=r.includes(".")?gw(t,r):()=>t[r];if(_n(n)){const i=e[n];vt(i)&&Ti(s,i)}else if(vt(n))Ti(s,n.bind(t));else if(Xt(n))if(ot(n))n.forEach(i=>Iw(i,e,t,r));else{const i=vt(n.handler)?n.handler.bind(t):e[n.handler];vt(i)&&Ti(s,i,n)}}function Sw(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(u=>eh(l,u,o,!0)),eh(l,e,o)),Xt(e)&&i.set(e,l),l}function eh(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&eh(n,i,t,!0),s&&s.forEach(o=>eh(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=pk[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const pk={data:Wy,props:Ky,emits:Ky,methods:cc,computed:cc,beforeCreate:_r,created:_r,beforeMount:_r,mounted:_r,beforeUpdate:_r,updated:_r,beforeDestroy:_r,beforeUnmount:_r,destroyed:_r,unmounted:_r,activated:_r,deactivated:_r,errorCaptured:_r,serverPrefetch:_r,components:cc,directives:cc,watch:gk,provide:Wy,inject:mk};function Wy(n,e){return e?n?function(){return gr(vt(n)?n.call(this,this):n,vt(e)?e.call(this,this):e)}:e:n}function mk(n,e){return cc(pm(n),pm(e))}function pm(n){if(ot(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function _r(n,e){return n?[...new Set([].concat(n,e))]:e}function cc(n,e){return n?gr(Object.create(null),n,e):e}function Ky(n,e){return n?ot(n)&&ot(e)?[...new Set([...n,...e])]:gr(Object.create(null),Hy(n),Hy(e??{})):e}function gk(n,e){if(!n)return e;if(!e)return n;const t=gr(Object.create(null),n);for(const r in e)t[r]=_r(n[r],e[r]);return t}function xw(){return{app:null,config:{isNativeTag:FT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let vk=0;function yk(n,e){return function(r,s=null){vt(r)||(r=gr({},r)),s!=null&&!Xt(s)&&(s=null);const i=xw(),o=new WeakSet,a=[];let l=!1;const u=i.app={_uid:vk++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Qk,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&vt(d.install)?(o.add(d),d.install(u,...f)):vt(d)&&(o.add(d),d(u,...f))),u},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),u},component(d,f){return f?(i.components[d]=f,u):i.components[d]},directive(d,f){return f?(i.directives[d]=f,u):i.directives[d]},mount(d,f,p){if(!l){const m=u._ceVNode||fn(r,s);return m.appContext=i,p===!0?p="svg":p===!1&&(p=void 0),n(m,d,p),l=!0,u._container=d,d.__vue_app__=u,cf(m.component)}},onUnmount(d){a.push(d)},unmount(){l&&(Ks(a,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(d,f){return i.provides[d]=f,u},runWithContext(d){const f=qo;qo=u;try{return d()}finally{qo=f}}};return u}}let qo=null;const _k=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${rs(e)}Modifiers`]||n[`${Io(e)}Modifiers`];function Ek(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||zt;let s=t;const i=e.startsWith("update:"),o=i&&_k(r,e.slice(7));o&&(o.trim&&(s=t.map(d=>_n(d)?d.trim():d)),o.number&&(s=t.map(Zh)));let a,l=r[a=_p(e)]||r[a=_p(rs(e))];!l&&i&&(l=r[a=_p(Io(e))]),l&&Ks(l,n,6,s);const u=r[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Ks(u,n,6,s)}}const Tk=new WeakMap;function bw(n,e,t=!1){const r=t?Tk:e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!vt(n)){const l=u=>{const d=bw(u,e,!0);d&&(a=!0,gr(o,d))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(Xt(n)&&r.set(n,null),null):(ot(i)?i.forEach(l=>o[l]=null):gr(o,i),Xt(n)&&r.set(n,o),o)}function af(n,e){return!n||!Yh(e)?!1:(e=e.slice(2).replace(/Once$/,""),Mt(n,e[0].toLowerCase()+e.slice(1))||Mt(n,Io(e))||Mt(n,e))}function qy(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:u,renderCache:d,props:f,data:p,setupState:m,ctx:g,inheritAttrs:v}=n,y=Jd(n);let L,D;try{if(t.shapeFlag&4){const C=s||r,j=C;L=Ps(u.call(j,C,d,f,m,p,g)),D=a}else{const C=e;L=Ps(C.length>1?C(f,{attrs:a,slots:o,emit:l}):C(f,null)),D=e.props?a:wk(a)}}catch(C){Ac.length=0,rf(C,n,1),L=fn(fo)}let A=L;if(D&&v!==!1){const C=Object.keys(D),{shapeFlag:j}=A;C.length&&j&7&&(i&&C.some(w0)&&(D=Ck(D,i)),A=ml(A,D,!1,!0))}return t.dirs&&(A=ml(A,null,!1,!0),A.dirs=A.dirs?A.dirs.concat(t.dirs):t.dirs),t.transition&&O0(A,t.transition),L=A,Jd(y),L}const wk=n=>{let e;for(const t in n)(t==="class"||t==="style"||Yh(t))&&((e||(e={}))[t]=n[t]);return e},Ck=(n,e)=>{const t={};for(const r in n)(!w0(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function Ak(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?Gy(r,o,u):!!o;if(l&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const p=d[f];if(o[p]!==r[p]&&!af(u,p))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Gy(r,o,u):!0:!!o;return!1}function Gy(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!af(t,i))return!0}return!1}function Ik({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const Rw={},kw=()=>Object.create(Rw),Pw=n=>Object.getPrototypeOf(n)===Rw;function Sk(n,e,t,r=!1){const s={},i=kw();n.propsDefaults=Object.create(null),Nw(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:aw(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function xk(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=kt(s),[l]=n.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let f=0;f<d.length;f++){let p=d[f];if(af(n.emitsOptions,p))continue;const m=e[p];if(l)if(Mt(i,p))m!==i[p]&&(i[p]=m,u=!0);else{const g=rs(p);s[g]=mm(l,a,g,m,n,!1)}else m!==i[p]&&(i[p]=m,u=!0)}}}else{Nw(n,e,s,i)&&(u=!0);let d;for(const f in a)(!e||!Mt(e,f)&&((d=Io(f))===f||!Mt(e,d)))&&(l?t&&(t[f]!==void 0||t[d]!==void 0)&&(s[f]=mm(l,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!Mt(e,f))&&(delete i[f],u=!0)}u&&di(n.attrs,"set","")}function Nw(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(vc(l))continue;const u=e[l];let d;s&&Mt(s,d=rs(l))?!i||!i.includes(d)?t[d]=u:(a||(a={}))[d]=u:af(n.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,o=!0)}if(i){const l=kt(t),u=a||zt;for(let d=0;d<i.length;d++){const f=i[d];t[f]=mm(s,l,f,u[f],n,!Mt(u,f))}}return o}function mm(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=Mt(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&vt(l)){const{propsDefaults:u}=s;if(t in u)r=u[t];else{const d=pu(s);r=u[t]=l.call(null,e),d()}}else r=l;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Io(t))&&(r=!0))}return r}const bk=new WeakMap;function Ow(n,e,t=!1){const r=t?bk:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!vt(n)){const d=f=>{l=!0;const[p,m]=Ow(f,e,!0);gr(o,p),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!i&&!l)return Xt(n)&&r.set(n,Za),Za;if(ot(i))for(let d=0;d<i.length;d++){const f=rs(i[d]);zy(f)&&(o[f]=zt)}else if(i)for(const d in i){const f=rs(d);if(zy(f)){const p=i[d],m=o[f]=ot(p)||vt(p)?{type:p}:gr({},p),g=m.type;let v=!1,y=!0;if(ot(g))for(let L=0;L<g.length;++L){const D=g[L],A=vt(D)&&D.name;if(A==="Boolean"){v=!0;break}else A==="String"&&(y=!1)}else v=vt(g)&&g.name==="Boolean";m[0]=v,m[1]=y,(v||Mt(m,"default"))&&a.push(f)}}const u=[o,a];return Xt(n)&&r.set(n,u),u}function zy(n){return n[0]!=="$"&&!vc(n)}const D0=n=>n==="_"||n==="_ctx"||n==="$stable",M0=n=>ot(n)?n.map(Ps):[Ps(n)],Rk=(n,e,t)=>{if(e._n)return e;const r=$2((...s)=>M0(e(...s)),t);return r._c=!1,r},Dw=(n,e,t)=>{const r=n._ctx;for(const s in n){if(D0(s))continue;const i=n[s];if(vt(i))e[s]=Rk(s,i,r);else if(i!=null){const o=M0(i);e[s]=()=>o}}},Mw=(n,e)=>{const t=M0(e);n.slots.default=()=>t},Fw=(n,e,t)=>{for(const r in e)(t||!D0(r))&&(n[r]=e[r])},kk=(n,e,t)=>{const r=n.slots=kw();if(n.vnode.shapeFlag&32){const s=e._;s?(Fw(r,e,t),t&&VT(r,"_",s,!0)):Dw(e,r)}else e&&Mw(n,e)},Pk=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=zt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:Fw(s,e,t):(i=!e.$stable,Dw(e,s)),o=e}else e&&(Mw(n,e),o={default:1});if(i)for(const a in s)!D0(a)&&o[a]==null&&delete s[a]},Er=Fk;function Nk(n){return Ok(n)}function Ok(n,e){const t=ef();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:u,setElementText:d,parentNode:f,nextSibling:p,setScopeId:m=Fs,insertStaticContent:g}=n,v=(I,S,B,ie=null,ue=null,re=null,Re=void 0,Oe=null,Me=!!S.dynamicChildren)=>{if(I===S)return;I&&!sc(I,S)&&(ie=se(I),E(I,ue,re,!0),I=null),S.patchFlag===-2&&(Me=!1,S.dynamicChildren=null);const{type:Se,ref:et,shapeFlag:qe}=S;switch(Se){case lf:y(I,S,B,ie);break;case fo:L(I,S,B,ie);break;case Md:I==null&&D(S,B,ie,Re);break;case Xe:M(I,S,B,ie,ue,re,Re,Oe,Me);break;default:qe&1?j(I,S,B,ie,ue,re,Re,Oe,Me):qe&6?F(I,S,B,ie,ue,re,Re,Oe,Me):(qe&64||qe&128)&&Se.process(I,S,B,ie,ue,re,Re,Oe,Me,O)}et!=null&&ue?Tc(et,I&&I.ref,re,S||I,!S):et==null&&I&&I.ref!=null&&Tc(I.ref,null,re,I,!0)},y=(I,S,B,ie)=>{if(I==null)r(S.el=a(S.children),B,ie);else{const ue=S.el=I.el;S.children!==I.children&&u(ue,S.children)}},L=(I,S,B,ie)=>{I==null?r(S.el=l(S.children||""),B,ie):S.el=I.el},D=(I,S,B,ie)=>{[I.el,I.anchor]=g(I.children,S,B,ie,I.el,I.anchor)},A=({el:I,anchor:S},B,ie)=>{let ue;for(;I&&I!==S;)ue=p(I),r(I,B,ie),I=ue;r(S,B,ie)},C=({el:I,anchor:S})=>{let B;for(;I&&I!==S;)B=p(I),s(I),I=B;s(S)},j=(I,S,B,ie,ue,re,Re,Oe,Me)=>{if(S.type==="svg"?Re="svg":S.type==="math"&&(Re="mathml"),I==null)z(S,B,ie,ue,re,Re,Oe,Me);else{const Se=I.el&&I.el._isVueCE?I.el:null;try{Se&&Se._beginPatch(),x(I,S,ue,re,Re,Oe,Me)}finally{Se&&Se._endPatch()}}},z=(I,S,B,ie,ue,re,Re,Oe)=>{let Me,Se;const{props:et,shapeFlag:qe,transition:Qe,dirs:it}=I;if(Me=I.el=o(I.type,re,et&&et.is,et),qe&8?d(Me,I.children):qe&16&&R(I.children,Me,null,ie,ue,Ip(I,re),Re,Oe),it&&Mo(I,null,ie,"created"),w(Me,I,I.scopeId,Re,ie),et){for(const lt in et)lt!=="value"&&!vc(lt)&&i(Me,lt,null,et[lt],re,ie);"value"in et&&i(Me,"value",null,et.value,re),(Se=et.onVnodeBeforeMount)&&Is(Se,ie,I)}it&&Mo(I,null,ie,"beforeMount");const tt=Dk(ue,Qe);tt&&Qe.beforeEnter(Me),r(Me,S,B),((Se=et&&et.onVnodeMounted)||tt||it)&&Er(()=>{Se&&Is(Se,ie,I),tt&&Qe.enter(Me),it&&Mo(I,null,ie,"mounted")},ue)},w=(I,S,B,ie,ue)=>{if(B&&m(I,B),ie)for(let re=0;re<ie.length;re++)m(I,ie[re]);if(ue){let re=ue.subTree;if(S===re||Bw(re.type)&&(re.ssContent===S||re.ssFallback===S)){const Re=ue.vnode;w(I,Re,Re.scopeId,Re.slotScopeIds,ue.parent)}}},R=(I,S,B,ie,ue,re,Re,Oe,Me=0)=>{for(let Se=Me;Se<I.length;Se++){const et=I[Se]=Oe?Zi(I[Se]):Ps(I[Se]);v(null,et,S,B,ie,ue,re,Re,Oe)}},x=(I,S,B,ie,ue,re,Re)=>{const Oe=S.el=I.el;let{patchFlag:Me,dynamicChildren:Se,dirs:et}=S;Me|=I.patchFlag&16;const qe=I.props||zt,Qe=S.props||zt;let it;if(B&&Fo(B,!1),(it=Qe.onVnodeBeforeUpdate)&&Is(it,B,S,I),et&&Mo(S,I,B,"beforeUpdate"),B&&Fo(B,!0),(qe.innerHTML&&Qe.innerHTML==null||qe.textContent&&Qe.textContent==null)&&d(Oe,""),Se?b(I.dynamicChildren,Se,Oe,B,ie,Ip(S,ue),re):Re||xe(I,S,Oe,null,B,ie,Ip(S,ue),re,!1),Me>0){if(Me&16)N(Oe,qe,Qe,B,ue);else if(Me&2&&qe.class!==Qe.class&&i(Oe,"class",null,Qe.class,ue),Me&4&&i(Oe,"style",qe.style,Qe.style,ue),Me&8){const tt=S.dynamicProps;for(let lt=0;lt<tt.length;lt++){const yt=tt[lt],Nn=qe[yt],Cn=Qe[yt];(Cn!==Nn||yt==="value")&&i(Oe,yt,Nn,Cn,ue,B)}}Me&1&&I.children!==S.children&&d(Oe,S.children)}else!Re&&Se==null&&N(Oe,qe,Qe,B,ue);((it=Qe.onVnodeUpdated)||et)&&Er(()=>{it&&Is(it,B,S,I),et&&Mo(S,I,B,"updated")},ie)},b=(I,S,B,ie,ue,re,Re)=>{for(let Oe=0;Oe<S.length;Oe++){const Me=I[Oe],Se=S[Oe],et=Me.el&&(Me.type===Xe||!sc(Me,Se)||Me.shapeFlag&198)?f(Me.el):B;v(Me,Se,et,null,ie,ue,re,Re,!0)}},N=(I,S,B,ie,ue)=>{if(S!==B){if(S!==zt)for(const re in S)!vc(re)&&!(re in B)&&i(I,re,S[re],null,ue,ie);for(const re in B){if(vc(re))continue;const Re=B[re],Oe=S[re];Re!==Oe&&re!=="value"&&i(I,re,Oe,Re,ue,ie)}"value"in B&&i(I,"value",S.value,B.value,ue)}},M=(I,S,B,ie,ue,re,Re,Oe,Me)=>{const Se=S.el=I?I.el:a(""),et=S.anchor=I?I.anchor:a("");let{patchFlag:qe,dynamicChildren:Qe,slotScopeIds:it}=S;it&&(Oe=Oe?Oe.concat(it):it),I==null?(r(Se,B,ie),r(et,B,ie),R(S.children||[],B,et,ue,re,Re,Oe,Me)):qe>0&&qe&64&&Qe&&I.dynamicChildren&&I.dynamicChildren.length===Qe.length?(b(I.dynamicChildren,Qe,B,ue,re,Re,Oe),(S.key!=null||ue&&S===ue.subTree)&&F0(I,S,!0)):xe(I,S,B,et,ue,re,Re,Oe,Me)},F=(I,S,B,ie,ue,re,Re,Oe,Me)=>{S.slotScopeIds=Oe,I==null?S.shapeFlag&512?ue.ctx.activate(S,B,ie,Re,Me):oe(S,B,ie,ue,re,Re,Me):Q(I,S,Me)},oe=(I,S,B,ie,ue,re,Re)=>{const Oe=I.component=jk(I,ie,ue);if(ww(I)&&(Oe.ctx.renderer=O),Wk(Oe,!1,Re),Oe.asyncDep){if(ue&&ue.registerDep(Oe,ne,Re),!I.el){const Me=Oe.subTree=fn(fo);L(null,Me,S,B),I.placeholder=Me.el}}else ne(Oe,I,S,B,ue,re,Re)},Q=(I,S,B)=>{const ie=S.component=I.component;if(Ak(I,S,B))if(ie.asyncDep&&!ie.asyncResolved){ge(ie,S,B);return}else ie.next=S,ie.update();else S.el=I.el,ie.vnode=S},ne=(I,S,B,ie,ue,re,Re)=>{const Oe=()=>{if(I.isMounted){let{next:qe,bu:Qe,u:it,parent:tt,vnode:lt}=I;{const On=Lw(I);if(On){qe&&(qe.el=lt.el,ge(I,qe,Re)),On.asyncDep.then(()=>{I.isUnmounted||Oe()});return}}let yt=qe,Nn;Fo(I,!1),qe?(qe.el=lt.el,ge(I,qe,Re)):qe=lt,Qe&&Nd(Qe),(Nn=qe.props&&qe.props.onVnodeBeforeUpdate)&&Is(Nn,tt,qe,lt),Fo(I,!0);const Cn=qy(I),yr=I.subTree;I.subTree=Cn,v(yr,Cn,f(yr.el),se(yr),I,ue,re),qe.el=Cn.el,yt===null&&Ik(I,Cn.el),it&&Er(it,ue),(Nn=qe.props&&qe.props.onVnodeUpdated)&&Er(()=>Is(Nn,tt,qe,lt),ue)}else{let qe;const{el:Qe,props:it}=S,{bm:tt,m:lt,parent:yt,root:Nn,type:Cn}=I,yr=wc(S);Fo(I,!1),tt&&Nd(tt),!yr&&(qe=it&&it.onVnodeBeforeMount)&&Is(qe,yt,S),Fo(I,!0);{Nn.ce&&Nn.ce._def.shadowRoot!==!1&&Nn.ce._injectChildStyle(Cn);const On=I.subTree=qy(I);v(null,On,B,ie,I,ue,re),S.el=On.el}if(lt&&Er(lt,ue),!yr&&(qe=it&&it.onVnodeMounted)){const On=S;Er(()=>Is(qe,yt,On),ue)}(S.shapeFlag&256||yt&&wc(yt.vnode)&&yt.vnode.shapeFlag&256)&&I.a&&Er(I.a,ue),I.isMounted=!0,S=B=ie=null}};I.scope.on();const Me=I.effect=new GT(Oe);I.scope.off();const Se=I.update=Me.run.bind(Me),et=I.job=Me.runIfDirty.bind(Me);et.i=I,et.id=I.uid,Me.scheduler=()=>N0(et),Fo(I,!0),Se()},ge=(I,S,B)=>{S.component=I;const ie=I.vnode.props;I.vnode=S,I.next=null,xk(I,S.props,ie,B),Pk(I,S.children,B),bi(),Fy(I),Ri()},xe=(I,S,B,ie,ue,re,Re,Oe,Me=!1)=>{const Se=I&&I.children,et=I?I.shapeFlag:0,qe=S.children,{patchFlag:Qe,shapeFlag:it}=S;if(Qe>0){if(Qe&128){Pe(Se,qe,B,ie,ue,re,Re,Oe,Me);return}else if(Qe&256){Ee(Se,qe,B,ie,ue,re,Re,Oe,Me);return}}it&8?(et&16&&le(Se,ue,re),qe!==Se&&d(B,qe)):et&16?it&16?Pe(Se,qe,B,ie,ue,re,Re,Oe,Me):le(Se,ue,re,!0):(et&8&&d(B,""),it&16&&R(qe,B,ie,ue,re,Re,Oe,Me))},Ee=(I,S,B,ie,ue,re,Re,Oe,Me)=>{I=I||Za,S=S||Za;const Se=I.length,et=S.length,qe=Math.min(Se,et);let Qe;for(Qe=0;Qe<qe;Qe++){const it=S[Qe]=Me?Zi(S[Qe]):Ps(S[Qe]);v(I[Qe],it,B,null,ue,re,Re,Oe,Me)}Se>et?le(I,ue,re,!0,!1,qe):R(S,B,ie,ue,re,Re,Oe,Me,qe)},Pe=(I,S,B,ie,ue,re,Re,Oe,Me)=>{let Se=0;const et=S.length;let qe=I.length-1,Qe=et-1;for(;Se<=qe&&Se<=Qe;){const it=I[Se],tt=S[Se]=Me?Zi(S[Se]):Ps(S[Se]);if(sc(it,tt))v(it,tt,B,null,ue,re,Re,Oe,Me);else break;Se++}for(;Se<=qe&&Se<=Qe;){const it=I[qe],tt=S[Qe]=Me?Zi(S[Qe]):Ps(S[Qe]);if(sc(it,tt))v(it,tt,B,null,ue,re,Re,Oe,Me);else break;qe--,Qe--}if(Se>qe){if(Se<=Qe){const it=Qe+1,tt=it<et?S[it].el:ie;for(;Se<=Qe;)v(null,S[Se]=Me?Zi(S[Se]):Ps(S[Se]),B,tt,ue,re,Re,Oe,Me),Se++}}else if(Se>Qe)for(;Se<=qe;)E(I[Se],ue,re,!0),Se++;else{const it=Se,tt=Se,lt=new Map;for(Se=tt;Se<=Qe;Se++){const An=S[Se]=Me?Zi(S[Se]):Ps(S[Se]);An.key!=null&&lt.set(An.key,Se)}let yt,Nn=0;const Cn=Qe-tt+1;let yr=!1,On=0;const is=new Array(Cn);for(Se=0;Se<Cn;Se++)is[Se]=0;for(Se=it;Se<=qe;Se++){const An=I[Se];if(Nn>=Cn){E(An,ue,re,!0);continue}let Rr;if(An.key!=null)Rr=lt.get(An.key);else for(yt=tt;yt<=Qe;yt++)if(is[yt-tt]===0&&sc(An,S[yt])){Rr=yt;break}Rr===void 0?E(An,ue,re,!0):(is[Rr-tt]=Se+1,Rr>=On?On=Rr:yr=!0,v(An,S[Rr],B,null,ue,re,Re,Oe,Me),Nn++)}const $i=yr?Mk(is):Za;for(yt=$i.length-1,Se=Cn-1;Se>=0;Se--){const An=tt+Se,Rr=S[An],Ia=S[An+1],Zs=An+1<et?Ia.el||Uw(Ia):ie;is[Se]===0?v(null,Rr,B,Zs,ue,re,Re,Oe,Me):yr&&(yt<0||Se!==$i[yt]?he(Rr,B,Zs,2):yt--)}}},he=(I,S,B,ie,ue=null)=>{const{el:re,type:Re,transition:Oe,children:Me,shapeFlag:Se}=I;if(Se&6){he(I.component.subTree,S,B,ie);return}if(Se&128){I.suspense.move(S,B,ie);return}if(Se&64){Re.move(I,S,B,O);return}if(Re===Xe){r(re,S,B);for(let qe=0;qe<Me.length;qe++)he(Me[qe],S,B,ie);r(I.anchor,S,B);return}if(Re===Md){A(I,S,B);return}if(ie!==2&&Se&1&&Oe)if(ie===0)Oe.beforeEnter(re),r(re,S,B),Er(()=>Oe.enter(re),ue);else{const{leave:qe,delayLeave:Qe,afterLeave:it}=Oe,tt=()=>{I.ctx.isUnmounted?s(re):r(re,S,B)},lt=()=>{re._isLeaving&&re[Y2](!0),qe(re,()=>{tt(),it&&it()})};Qe?Qe(re,tt,lt):lt()}else r(re,S,B)},E=(I,S,B,ie=!1,ue=!1)=>{const{type:re,props:Re,ref:Oe,children:Me,dynamicChildren:Se,shapeFlag:et,patchFlag:qe,dirs:Qe,cacheIndex:it}=I;if(qe===-2&&(ue=!1),Oe!=null&&(bi(),Tc(Oe,null,B,I,!0),Ri()),it!=null&&(S.renderCache[it]=void 0),et&256){S.ctx.deactivate(I);return}const tt=et&1&&Qe,lt=!wc(I);let yt;if(lt&&(yt=Re&&Re.onVnodeBeforeUnmount)&&Is(yt,S,I),et&6)ee(I.component,B,ie);else{if(et&128){I.suspense.unmount(B,ie);return}tt&&Mo(I,null,S,"beforeUnmount"),et&64?I.type.remove(I,S,B,O,ie):Se&&!Se.hasOnce&&(re!==Xe||qe>0&&qe&64)?le(Se,S,B,!1,!0):(re===Xe&&qe&384||!ue&&et&16)&&le(Me,S,B),ie&&T(I)}(lt&&(yt=Re&&Re.onVnodeUnmounted)||tt)&&Er(()=>{yt&&Is(yt,S,I),tt&&Mo(I,null,S,"unmounted")},B)},T=I=>{const{type:S,el:B,anchor:ie,transition:ue}=I;if(S===Xe){U(B,ie);return}if(S===Md){C(I);return}const re=()=>{s(B),ue&&!ue.persisted&&ue.afterLeave&&ue.afterLeave()};if(I.shapeFlag&1&&ue&&!ue.persisted){const{leave:Re,delayLeave:Oe}=ue,Me=()=>Re(B,re);Oe?Oe(I.el,re,Me):Me()}else re()},U=(I,S)=>{let B;for(;I!==S;)B=p(I),s(I),I=B;s(S)},ee=(I,S,B)=>{const{bum:ie,scope:ue,job:re,subTree:Re,um:Oe,m:Me,a:Se}=I;Yy(Me),Yy(Se),ie&&Nd(ie),ue.stop(),re&&(re.flags|=8,E(Re,I,S,B)),Oe&&Er(Oe,S),Er(()=>{I.isUnmounted=!0},S)},le=(I,S,B,ie=!1,ue=!1,re=0)=>{for(let Re=re;Re<I.length;Re++)E(I[Re],S,B,ie,ue)},se=I=>{if(I.shapeFlag&6)return se(I.component.subTree);if(I.shapeFlag&128)return I.suspense.next();const S=p(I.anchor||I.el),B=S&&S[vw];return B?p(B):S};let ve=!1;const te=(I,S,B)=>{let ie;I==null?S._vnode&&(E(S._vnode,null,null,!0),ie=S._vnode.component):v(S._vnode||null,I,S,null,null,null,B),S._vnode=I,ve||(ve=!0,Fy(ie),hw(),ve=!1)},O={p:v,um:E,m:he,r:T,mt:oe,mc:R,pc:xe,pbc:b,n:se,o:n};return{render:te,hydrate:void 0,createApp:yk(te)}}function Ip({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Fo({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function Dk(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function F0(n,e,t=!1){const r=n.children,s=e.children;if(ot(r)&&ot(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Zi(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&F0(o,a)),a.type===lf&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=i+(n.type===Xe?1:0)),a.type===fo&&!a.el&&(a.el=o.el)}}function Mk(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const u=n[r];if(u!==0){if(s=t[t.length-1],n[s]<u){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<u?i=a+1:o=a;u<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function Lw(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Lw(e)}function Yy(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}function Uw(n){if(n.placeholder)return n.placeholder;const e=n.component;return e?Uw(e.subTree):null}const Bw=n=>n.__isSuspense;function Fk(n,e){e&&e.pendingBranch?ot(n)?e.effects.push(...n):e.effects.push(n):V2(n)}const Xe=Symbol.for("v-fgt"),lf=Symbol.for("v-txt"),fo=Symbol.for("v-cmt"),Md=Symbol.for("v-stc"),Ac=[];let zr=null;function K(n=!1){Ac.push(zr=n?null:[])}function Lk(){Ac.pop(),zr=Ac[Ac.length-1]||null}let Kc=1;function th(n,e=!1){Kc+=n,n<0&&zr&&e&&(zr.hasOnce=!0)}function Vw(n){return n.dynamicChildren=Kc>0?zr||Za:null,Lk(),Kc>0&&zr&&zr.push(n),n}function q(n,e,t,r,s,i){return Vw(c(n,e,t,r,s,i,!0))}function nh(n,e,t,r,s){return Vw(fn(n,e,t,r,s,!0))}function rh(n){return n?n.__v_isVNode===!0:!1}function sc(n,e){return n.type===e.type&&n.key===e.key}const $w=({key:n})=>n??null,Fd=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?_n(n)||pn(n)||vt(n)?{i:Gr,r:n,k:e,f:!!t}:n:null);function c(n,e=null,t=null,r=0,s=null,i=n===Xe?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&$w(e),ref:e&&Fd(e),scopeId:pw,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Gr};return a?(L0(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=_n(t)?8:16),Kc>0&&!o&&zr&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&zr.push(l),l}const fn=Uk;function Uk(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===ck)&&(n=fo),rh(n)){const a=ml(n,e,!0);return t&&L0(a,t),Kc>0&&!i&&zr&&(a.shapeFlag&6?zr[zr.indexOf(n)]=a:zr.push(a)),a.patchFlag=-2,a}if(Yk(n)&&(n=n.__vccOpts),e){e=Bk(e);let{class:a,style:l}=e;a&&!_n(a)&&(e.class=mt(a)),Xt(l)&&(nf(l)&&!ot(l)&&(l=gr({},l)),e.style=wt(l))}const o=_n(n)?1:Bw(n)?128:q2(n)?64:Xt(n)?4:vt(n)?2:0;return c(n,e,t,r,s,o,i,!0)}function Bk(n){return n?nf(n)||Pw(n)?gr({},n):n:null}function ml(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,u=e?Vk(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&$w(u),ref:e&&e.ref?t&&i?ot(i)?i.concat(Fd(e)):[i,Fd(e)]:Fd(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Xe?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&ml(n.ssContent),ssFallback:n.ssFallback&&ml(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&O0(d,l.clone(d)),d}function bt(n=" ",e=0){return fn(lf,null,n,e)}function Ls(n,e){const t=fn(Md,null,n);return t.staticCount=e,t}function be(n="",e=!1){return e?(K(),nh(fo,null,n)):fn(fo,null,n)}function Ps(n){return n==null||typeof n=="boolean"?fn(fo):ot(n)?fn(Xe,null,n.slice()):rh(n)?Zi(n):fn(lf,null,String(n))}function Zi(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:ml(n)}function L0(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(ot(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),L0(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!Pw(e)?e._ctx=Gr:s===3&&Gr&&(Gr.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else vt(e)?(e={default:e,_ctx:Gr},t=32):(e=String(e),r&64?(t=16,e=[bt(e)]):t=8);n.children=e,n.shapeFlag|=t}function Vk(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=mt([e.class,r.class]));else if(s==="style")e.style=wt([e.style,r.style]);else if(Yh(s)){const i=e[s],o=r[s];o&&i!==o&&!(ot(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Is(n,e,t,r=null){Ks(n,e,7,[t,r])}const $k=xw();let Hk=0;function jk(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||$k,i={uid:Hk++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new WT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ow(r,s),emitsOptions:bw(r,s),emit:null,emitted:null,propsDefaults:zt,inheritAttrs:r.inheritAttrs,ctx:zt,data:zt,props:zt,attrs:zt,slots:zt,refs:zt,setupState:zt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=Ek.bind(null,i),n.ce&&n.ce(i),i}let hr=null;const Hw=()=>hr||Gr;let sh,gm;{const n=ef(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};sh=e("__VUE_INSTANCE_SETTERS__",t=>hr=t),gm=e("__VUE_SSR_SETTERS__",t=>qc=t)}const pu=n=>{const e=hr;return sh(n),n.scope.on(),()=>{n.scope.off(),sh(e)}},Qy=()=>{hr&&hr.scope.off(),sh(null)};function jw(n){return n.vnode.shapeFlag&4}let qc=!1;function Wk(n,e=!1,t=!1){e&&gm(e);const{props:r,children:s}=n.vnode,i=jw(n);Sk(n,r,i,e),kk(n,s,t||e);const o=i?Kk(n,e):void 0;return e&&gm(!1),o}function Kk(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,dk);const{setup:r}=t;if(r){bi();const s=n.setupContext=r.length>1?Gk(n):null,i=pu(n),o=fu(r,n,0,[n.props,s]),a=LT(o);if(Ri(),i(),(a||n.sp)&&!wc(n)&&Tw(n),a){if(o.then(Qy,Qy),e)return o.then(l=>{Xy(n,l)}).catch(l=>{rf(l,n,0)});n.asyncDep=o}else Xy(n,o)}else Ww(n)}function Xy(n,e,t){vt(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Xt(e)&&(n.setupState=cw(e)),Ww(n)}function Ww(n,e,t){const r=n.type;n.render||(n.render=r.render||Fs);{const s=pu(n);bi();try{hk(n)}finally{Ri(),s()}}}const qk={get(n,e){return cr(n,"get",""),n[e]}};function Gk(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,qk),slots:n.slots,emit:n.emit,expose:e}}function cf(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(cw(P0(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Cc)return Cc[t](n)},has(e,t){return t in e||t in Cc}})):n.proxy}function zk(n,e=!0){return vt(n)?n.displayName||n.name:n.name||e&&n.__name}function Yk(n){return vt(n)&&"__vccOpts"in n}const Be=(n,e)=>M2(n,e,qc);function Kw(n,e,t){try{th(-1);const r=arguments.length;return r===2?Xt(e)&&!ot(e)?rh(e)?fn(n,null,[e]):fn(n,e):fn(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&rh(t)&&(t=[t]),fn(n,e,t))}finally{th(1)}}const Qk="3.5.26";/**
* @vue/runtime-dom v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let vm;const Jy=typeof window<"u"&&window.trustedTypes;if(Jy)try{vm=Jy.createPolicy("vue",{createHTML:n=>n})}catch{}const qw=vm?n=>vm.createHTML(n):n=>n,Xk="http://www.w3.org/2000/svg",Jk="http://www.w3.org/1998/Math/MathML",ci=typeof document<"u"?document:null,Zy=ci&&ci.createElement("template"),Zk={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?ci.createElementNS(Xk,n):e==="mathml"?ci.createElementNS(Jk,n):t?ci.createElement(n,{is:t}):ci.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>ci.createTextNode(n),createComment:n=>ci.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ci.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Zy.innerHTML=qw(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=Zy.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},eP=Symbol("_vtc");function tP(n,e,t){const r=n[eP];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const e_=Symbol("_vod"),nP=Symbol("_vsh"),rP=Symbol(""),sP=/(?:^|;)\s*display\s*:/;function iP(n,e,t){const r=n.style,s=_n(t);let i=!1;if(t&&!s){if(e)if(_n(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Ld(r,a,"")}else for(const o in e)t[o]==null&&Ld(r,o,"");for(const o in t)o==="display"&&(i=!0),Ld(r,o,t[o])}else if(s){if(e!==t){const o=r[rP];o&&(t+=";"+o),r.cssText=t,i=sP.test(t)}}else e&&n.removeAttribute("style");e_ in n&&(n[e_]=i?r.display:"",n[nP]&&(r.display="none"))}const t_=/\s*!important$/;function Ld(n,e,t){if(ot(t))t.forEach(r=>Ld(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=oP(n,e);t_.test(t)?n.setProperty(Io(r),t.replace(t_,""),"important"):n[r]=t}}const n_=["Webkit","Moz","ms"],Sp={};function oP(n,e){const t=Sp[e];if(t)return t;let r=rs(e);if(r!=="filter"&&r in n)return Sp[e]=r;r=Jh(r);for(let s=0;s<n_.length;s++){const i=n_[s]+r;if(i in n)return Sp[e]=i}return e}const r_="http://www.w3.org/1999/xlink";function s_(n,e,t,r,s,i=o2(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(r_,e.slice(6,e.length)):n.setAttributeNS(r_,e,t):t==null||i&&!$T(t)?n.removeAttribute(e):n.setAttribute(e,i?"":Ws(t)?String(t):t)}function i_(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?qw(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=$T(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function fi(n,e,t,r){n.addEventListener(e,t,r)}function aP(n,e,t,r){n.removeEventListener(e,t,r)}const o_=Symbol("_vei");function lP(n,e,t,r,s=null){const i=n[o_]||(n[o_]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=cP(e);if(r){const u=i[e]=hP(r,s);fi(n,a,u,l)}else o&&(aP(n,a,o,l),i[e]=void 0)}}const a_=/(?:Once|Passive|Capture)$/;function cP(n){let e;if(a_.test(n)){e={};let r;for(;r=n.match(a_);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Io(n.slice(2)),e]}let xp=0;const uP=Promise.resolve(),dP=()=>xp||(uP.then(()=>xp=0),xp=Date.now());function hP(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Ks(fP(r,t.value),e,5,[r])};return t.value=n,t.attached=dP(),t}function fP(n,e){if(ot(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const l_=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,pP=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?tP(n,r,o):e==="style"?iP(n,t,r):Yh(e)?w0(e)||lP(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):mP(n,e,r,o))?(i_(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&s_(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!_n(r))?i_(n,rs(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),s_(n,e,r,o))};function mP(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&l_(e)&&vt(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&n.tagName==="IFRAME"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return l_(e)&&_n(t)?!1:e in n}const po=n=>{const e=n.props["onUpdate:modelValue"]||!1;return ot(e)?t=>Nd(e,t):e};function gP(n){n.target.composing=!0}function c_(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ns=Symbol("_assign");function u_(n,e,t){return e&&(n=n.trim()),t&&(n=Zh(n)),n}const Ne={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[ns]=po(s);const i=r||s.props&&s.props.type==="number";fi(n,e?"change":"input",o=>{o.target.composing||n[ns](u_(n.value,t,i))}),(t||i)&&fi(n,"change",()=>{n.value=u_(n.value,t,i)}),e||(fi(n,"compositionstart",gP),fi(n,"compositionend",c_),fi(n,"change",c_))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[ns]=po(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?Zh(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},Go={deep:!0,created(n,e,t){n[ns]=po(t),fi(n,"change",()=>{const r=n._modelValue,s=gl(n),i=n.checked,o=n[ns];if(ot(r)){const a=A0(r,s),l=a!==-1;if(i&&!l)o(r.concat(s));else if(!i&&l){const u=[...r];u.splice(a,1),o(u)}}else if(Nl(r)){const a=new Set(r);i?a.add(s):a.delete(s),o(a)}else o(Gw(n,i))})},mounted:d_,beforeUpdate(n,e,t){n[ns]=po(t),d_(n,e,t)}};function d_(n,{value:e,oldValue:t},r){n._modelValue=e;let s;if(ot(e))s=A0(e,r.props.value)>-1;else if(Nl(e))s=e.has(r.props.value);else{if(e===t)return;s=Xo(e,Gw(n,!0))}n.checked!==s&&(n.checked=s)}const h_={created(n,{value:e},t){n.checked=Xo(e,t.props.value),n[ns]=po(t),fi(n,"change",()=>{n[ns](gl(n))})},beforeUpdate(n,{value:e,oldValue:t},r){n[ns]=po(r),e!==t&&(n.checked=Xo(e,r.props.value))}},st={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const s=Nl(e);fi(n,"change",()=>{const i=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?Zh(gl(o)):gl(o));n[ns](n.multiple?s?new Set(i):i:i[0]),n._assigning=!0,sf(()=>{n._assigning=!1})}),n[ns]=po(r)},mounted(n,{value:e}){f_(n,e)},beforeUpdate(n,e,t){n[ns]=po(t)},updated(n,{value:e}){n._assigning||f_(n,e)}};function f_(n,e){const t=n.multiple,r=ot(e);if(!(t&&!r&&!Nl(e))){for(let s=0,i=n.options.length;s<i;s++){const o=n.options[s],a=gl(o);if(t)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(u=>String(u)===String(a)):o.selected=A0(e,a)>-1}else o.selected=e.has(a);else if(Xo(gl(o),e)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!t&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function gl(n){return"_value"in n?n._value:n.value}function Gw(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const vP=["ctrl","shift","alt","meta"],yP={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>vP.some(t=>n[`${t}Key`]&&!e.includes(t))},nn=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=yP[e[o]];if(a&&a(s,e))return}return n(s,...i)})},_P={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},zw=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=Io(s.key);if(e.some(o=>o===i||_P[o]===i))return n(s)})},EP=gr({patchProp:pP},Zk);let p_;function TP(){return p_||(p_=Nk(EP))}const wP=(...n)=>{const e=TP().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=AP(r);if(!s)return;const i=e._component;!vt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,CP(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function CP(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function AP(n){return _n(n)?document.querySelector(n):n}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Yw;const uf=n=>Yw=n,Qw=Symbol();function ym(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var Ic;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(Ic||(Ic={}));function IP(){const n=KT(!0),e=n.run(()=>ae({}));let t=[],r=[];const s=P0({install(i){uf(s),s._a=i,i.provide(Qw,s),i.config.globalProperties.$pinia=s,r.forEach(o=>t.push(o)),r=[]},use(i){return this._a?t.push(i):r.push(i),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return s}const Xw=()=>{};function m_(n,e,t,r=Xw){n.push(e);const s=()=>{const i=n.indexOf(e);i>-1&&(n.splice(i,1),r())};return!t&&qT()&&l2(s),s}function Na(n,...e){n.slice().forEach(t=>{t(...e)})}const SP=n=>n(),g_=Symbol(),bp=Symbol();function _m(n,e){n instanceof Map&&e instanceof Map?e.forEach((t,r)=>n.set(r,t)):n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],s=n[t];ym(s)&&ym(r)&&n.hasOwnProperty(t)&&!pn(r)&&!Ei(r)?n[t]=_m(s,r):n[t]=r}return n}const xP=Symbol();function bP(n){return!ym(n)||!n.hasOwnProperty(xP)}const{assign:Yi}=Object;function RP(n){return!!(pn(n)&&n.effect)}function kP(n,e,t,r){const{state:s,actions:i,getters:o}=e,a=t.state.value[n];let l;function u(){a||(t.state.value[n]=s?s():{});const d=P2(t.state.value[n]);return Yi(d,i,Object.keys(o||{}).reduce((f,p)=>(f[p]=P0(Be(()=>{uf(t);const m=t._s.get(n);return o[p].call(m,m)})),f),{}))}return l=Jw(n,u,e,t,r,!0),l}function Jw(n,e,t={},r,s,i){let o;const a=Yi({actions:{}},t),l={deep:!0};let u,d,f=[],p=[],m;const g=r.state.value[n];!i&&!g&&(r.state.value[n]={}),ae({});let v;function y(R){let x;u=d=!1,typeof R=="function"?(R(r.state.value[n]),x={type:Ic.patchFunction,storeId:n,events:m}):(_m(r.state.value[n],R),x={type:Ic.patchObject,payload:R,storeId:n,events:m});const b=v=Symbol();sf().then(()=>{v===b&&(u=!0)}),d=!0,Na(f,x,r.state.value[n])}const L=i?function(){const{state:x}=t,b=x?x():{};this.$patch(N=>{Yi(N,b)})}:Xw;function D(){o.stop(),f=[],p=[],r._s.delete(n)}const A=(R,x="")=>{if(g_ in R)return R[bp]=x,R;const b=function(){uf(r);const N=Array.from(arguments),M=[],F=[];function oe(ge){M.push(ge)}function Q(ge){F.push(ge)}Na(p,{args:N,name:b[bp],store:j,after:oe,onError:Q});let ne;try{ne=R.apply(this&&this.$id===n?this:j,N)}catch(ge){throw Na(F,ge),ge}return ne instanceof Promise?ne.then(ge=>(Na(M,ge),ge)).catch(ge=>(Na(F,ge),Promise.reject(ge))):(Na(M,ne),ne)};return b[g_]=!0,b[bp]=x,b},C={_p:r,$id:n,$onAction:m_.bind(null,p),$patch:y,$reset:L,$subscribe(R,x={}){const b=m_(f,R,x.detached,()=>N()),N=o.run(()=>Ti(()=>r.state.value[n],M=>{(x.flush==="sync"?d:u)&&R({storeId:n,type:Ic.direct,events:m},M)},Yi({},l,x)));return b},$dispose:D},j=hu(C);r._s.set(n,j);const w=(r._a&&r._a.runWithContext||SP)(()=>r._e.run(()=>(o=KT()).run(()=>e({action:A}))));for(const R in w){const x=w[R];if(pn(x)&&!RP(x)||Ei(x))i||(g&&bP(x)&&(pn(x)?x.value=g[R]:_m(x,g[R])),r.state.value[n][R]=x);else if(typeof x=="function"){const b=A(x,R);w[R]=b,a.actions[R]=x}}return Yi(j,w),Yi(kt(j),w),Object.defineProperty(j,"$state",{get:()=>r.state.value[n],set:R=>{y(x=>{Yi(x,R)})}}),r._p.forEach(R=>{Yi(j,o.run(()=>R({store:j,app:r._a,pinia:r,options:a})))}),g&&i&&t.hydrate&&t.hydrate(j.$state,g),u=!0,d=!0,j}/*! #__NO_SIDE_EFFECTS__ */function pa(n,e,t){let r,s;const i=typeof e=="function";typeof n=="string"?(r=n,s=i?t:e):(s=n,r=n.id);function o(a,l){const u=H2();return a=a||(u?fs(Qw,null):null),a&&uf(a),a=Yw,a._s.has(r)||(i?Jw(r,e,s,a):kP(r,s,a)),a._s.get(r)}return o.$id=r,o}const PP="modulepreload",NP=function(n){return"/"+n},v_={},Jo=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=NP(l),l in v_)return;v_[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":PP,u||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};var y_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},OP=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},eC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,u=l?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let p=(a&15)<<2|u>>6,m=u&63;l||(m=64,o||(p=64)),r.push(t[d],t[f],t[p],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Zw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):OP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||u==null||f==null)throw new DP;const p=i<<2|a>>4;if(r.push(p),u!==64){const m=a<<4&240|u>>2;if(r.push(m),f!==64){const g=u<<6&192|f;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class DP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MP=function(n){const e=Zw(n);return eC.encodeByteArray(e,!0)},ih=function(n){return MP(n).replace(/\./g,"")},tC=function(n){try{return eC.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LP=()=>FP().__FIREBASE_DEFAULTS__,UP=()=>{if(typeof process>"u"||typeof y_>"u")return;const n=y_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},BP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&tC(n[1]);return e&&JSON.parse(e)},df=()=>{try{return LP()||UP()||BP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nC=n=>{var e,t;return(t=(e=df())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},rC=n=>{const e=nC(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},sC=()=>{var n;return(n=df())===null||n===void 0?void 0:n.config},iC=n=>{var e;return(e=df())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[ih(JSON.stringify(t)),ih(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vr())}function jP(){var n;const e=(n=df())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function KP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function qP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GP(){const n=vr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function zP(){return!jP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function YP(){try{return typeof indexedDB=="object"}catch{return!1}}function QP(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP="FirebaseError";class Xs extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=XP,Object.setPrototypeOf(this,Xs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mu.prototype.create)}}class mu{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?JP(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Xs(s,a,r)}}function JP(n,e){return n.replace(ZP,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const ZP=/\{\$([^}]+)}/g;function eN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function oh(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(__(i)&&__(o)){if(!oh(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function __(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function tN(n,e){const t=new nN(n,e);return t.subscribe.bind(t)}class nN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");rN(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Rp),s.error===void 0&&(s.error=Rp),s.complete===void 0&&(s.complete=Rp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(n){return n&&n._delegate?n._delegate:n}class mo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new VP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(oN(e))try{this.getOrInitializeService({instanceIdentifier:Uo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Uo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Uo){return this.instances.has(e)}getOptions(e=Uo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:iN(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Uo){return this.component?this.component.multipleInstances?e:Uo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iN(n){return n===Uo?void 0:n}function oN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new sN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(It||(It={}));const lN={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},cN=It.INFO,uN={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},dN=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=uN[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let U0=class{constructor(e){this.name=e,this._logLevel=cN,this._logHandler=dN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}};const hN=(n,e)=>e.some(t=>n instanceof t);let E_,T_;function fN(){return E_||(E_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pN(){return T_||(T_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oC=new WeakMap,Em=new WeakMap,aC=new WeakMap,kp=new WeakMap,B0=new WeakMap;function mN(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(lo(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&oC.set(t,n)}).catch(()=>{}),B0.set(e,n),e}function gN(n){if(Em.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Em.set(n,e)}let Tm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Em.get(n);if(e==="objectStoreNames")return n.objectStoreNames||aC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return lo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function vN(n){Tm=n(Tm)}function yN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Pp(this),e,...t);return aC.set(r,e.sort?e.sort():[e]),lo(r)}:pN().includes(n)?function(...e){return n.apply(Pp(this),e),lo(oC.get(this))}:function(...e){return lo(n.apply(Pp(this),e))}}function _N(n){return typeof n=="function"?yN(n):(n instanceof IDBTransaction&&gN(n),hN(n,fN())?new Proxy(n,Tm):n)}function lo(n){if(n instanceof IDBRequest)return mN(n);if(kp.has(n))return kp.get(n);const e=_N(n);return e!==n&&(kp.set(n,e),B0.set(e,n)),e}const Pp=n=>B0.get(n);function EN(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=lo(o);return r&&o.addEventListener("upgradeneeded",l=>{r(lo(o.result),l.oldVersion,l.newVersion,lo(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const TN=["get","getKey","getAll","getAllKeys","count"],wN=["put","add","delete","clear"],Np=new Map;function w_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Np.get(e))return Np.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=wN.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||TN.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),s&&l.done]))[0]};return Np.set(e,i),i}vN(n=>({...n,get:(e,t,r)=>w_(e,t)||n.get(e,t,r),has:(e,t)=>!!w_(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(AN(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function AN(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wm="@firebase/app",C_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=new U0("@firebase/app"),IN="@firebase/app-compat",SN="@firebase/analytics-compat",xN="@firebase/analytics",bN="@firebase/app-check-compat",RN="@firebase/app-check",kN="@firebase/auth",PN="@firebase/auth-compat",NN="@firebase/database",ON="@firebase/data-connect",DN="@firebase/database-compat",MN="@firebase/functions",FN="@firebase/functions-compat",LN="@firebase/installations",UN="@firebase/installations-compat",BN="@firebase/messaging",VN="@firebase/messaging-compat",$N="@firebase/performance",HN="@firebase/performance-compat",jN="@firebase/remote-config",WN="@firebase/remote-config-compat",KN="@firebase/storage",qN="@firebase/storage-compat",GN="@firebase/firestore",zN="@firebase/vertexai-preview",YN="@firebase/firestore-compat",QN="firebase",XN="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="[DEFAULT]",JN={[wm]:"fire-core",[IN]:"fire-core-compat",[xN]:"fire-analytics",[SN]:"fire-analytics-compat",[RN]:"fire-app-check",[bN]:"fire-app-check-compat",[kN]:"fire-auth",[PN]:"fire-auth-compat",[NN]:"fire-rtdb",[ON]:"fire-data-connect",[DN]:"fire-rtdb-compat",[MN]:"fire-fn",[FN]:"fire-fn-compat",[LN]:"fire-iid",[UN]:"fire-iid-compat",[BN]:"fire-fcm",[VN]:"fire-fcm-compat",[$N]:"fire-perf",[HN]:"fire-perf-compat",[jN]:"fire-rc",[WN]:"fire-rc-compat",[KN]:"fire-gcs",[qN]:"fire-gcs-compat",[GN]:"fire-fst",[YN]:"fire-fst-compat",[zN]:"fire-vertex","fire-js":"fire-js",[QN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah=new Map,ZN=new Map,Am=new Map;function A_(n,e){try{n.container.addComponent(e)}catch(t){Pi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Zo(n){const e=n.name;if(Am.has(e))return Pi.debug(`There were multiple attempts to register component ${e}.`),!1;Am.set(e,n);for(const t of ah.values())A_(t,n);for(const t of ZN.values())A_(t,n);return!0}function hf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ds(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},co=new mu("app","Firebase",eO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw co.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol=XN;function lC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Cm,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw co.create("bad-app-name",{appName:String(s)});if(t||(t=sC()),!t)throw co.create("no-options");const i=ah.get(s);if(i){if(oh(t,i.options)&&oh(r,i.config))return i;throw co.create("duplicate-app",{appName:s})}const o=new aN(s);for(const l of Am.values())o.addComponent(l);const a=new tO(t,r,o);return ah.set(s,a),a}function V0(n=Cm){const e=ah.get(n);if(!e&&n===Cm&&sC())return lC();if(!e)throw co.create("no-app",{appName:n});return e}function Us(n,e,t){var r;let s=(r=JN[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pi.warn(a.join(" "));return}Zo(new mo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO="firebase-heartbeat-database",rO=1,Gc="firebase-heartbeat-store";let Op=null;function cC(){return Op||(Op=EN(nO,rO,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gc)}catch(t){console.warn(t)}}}}).catch(n=>{throw co.create("idb-open",{originalErrorMessage:n.message})})),Op}async function sO(n){try{const t=(await cC()).transaction(Gc),r=await t.objectStore(Gc).get(uC(n));return await t.done,r}catch(e){if(e instanceof Xs)Pi.warn(e.message);else{const t=co.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Pi.warn(t.message)}}}async function I_(n,e){try{const r=(await cC()).transaction(Gc,"readwrite");await r.objectStore(Gc).put(e,uC(n)),await r.done}catch(t){if(t instanceof Xs)Pi.warn(t.message);else{const r=co.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Pi.warn(r.message)}}}function uC(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=1024,oO=30*24*60*60*1e3;class aO{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new cO(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=S_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=oO}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Pi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=S_(),{heartbeatsToSend:r,unsentEntries:s}=lO(this._heartbeatsCache.heartbeats),i=ih(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Pi.warn(t),""}}}function S_(){return new Date().toISOString().substring(0,10)}function lO(n,e=iO){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),x_(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),x_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class cO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YP()?QP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await sO(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return I_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return I_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function x_(n){return ih(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uO(n){Zo(new mo("platform-logger",e=>new CN(e),"PRIVATE")),Zo(new mo("heartbeat",e=>new aO(e),"PRIVATE")),Us(wm,C_,n),Us(wm,C_,"esm2017"),Us("fire-js","")}uO("");function $0(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function dC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dO=dC,hC=new mu("auth","Firebase",dC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh=new U0("@firebase/auth");function hO(n,...e){lh.logLevel<=It.WARN&&lh.warn(`Auth (${Ol}): ${n}`,...e)}function Ud(n,...e){lh.logLevel<=It.ERROR&&lh.error(`Auth (${Ol}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(n,...e){throw j0(n,...e)}function ps(n,...e){return j0(n,...e)}function H0(n,e,t){const r=Object.assign(Object.assign({},dO()),{[e]:t});return new mu("auth","Firebase",r).create(e,{appName:n.name})}function uo(n){return H0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fO(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&qs(n,"argument-error"),H0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function j0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return hC.create(n,...e)}function ut(n,e,...t){if(!n)throw j0(e,...t)}function mi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ud(e),new Error(e)}function Ni(n,e){n||mi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function pO(){return b_()==="http:"||b_()==="https:"}function b_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pO()||KP()||"connection"in navigator)?navigator.onLine:!0}function gO(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ni(t>e,"Short delay should be less than long delay!"),this.isMobile=HP()||qP()}get(){return mO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n,e){Ni(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;mi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;mi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;mi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO=new vu(3e4,6e4);function ff(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Dl(n,e,t,r,s={}){return pC(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=gu(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:l},i);return WP()||(u.referrerPolicy="no-referrer"),fC.fetch()(gC(n,n.config.apiHost,t,a),u)})}async function pC(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},vO),e);try{const s=new _O(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ud(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ud(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ud(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw ud(n,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw H0(n,d,u);qs(n,d)}}catch(s){if(s instanceof Xs)throw s;qs(n,"network-request-failed",{message:String(s)})}}async function mC(n,e,t,r,s={}){const i=await Dl(n,e,t,r,s);return"mfaPendingCredential"in i&&qs(n,"multi-factor-auth-required",{_serverResponse:i}),i}function gC(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?W0(n.config,s):`${n.config.apiScheme}://${s}`}class _O{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ps(this.auth,"network-request-failed")),yO.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ud(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ps(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EO(n,e){return Dl(n,"POST","/v1/accounts:delete",e)}async function vC(n,e){return Dl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TO(n,e=!1){const t=En(n),r=await t.getIdToken(e),s=K0(r);ut(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Sc(Dp(s.auth_time)),issuedAtTime:Sc(Dp(s.iat)),expirationTime:Sc(Dp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Dp(n){return Number(n)*1e3}function K0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ud("JWT malformed, contained fewer than 3 sections"),null;try{const s=tC(t);return s?JSON.parse(s):(Ud("Failed to decode base64 JWT payload"),null)}catch(s){return Ud("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function R_(n){const e=K0(n);return ut(e,"internal-error"),ut(typeof e.exp<"u","internal-error"),ut(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Xs&&wO(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function wO({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sc(this.lastLoginAt),this.creationTime=Sc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ch(n){var e;const t=n.auth,r=await n.getIdToken(),s=await zc(n,vC(t,{idToken:r}));ut(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?yC(i.providerUserInfo):[],a=IO(n.providerData,o),l=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Sm(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function AO(n){const e=En(n);await ch(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IO(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function yC(n){return n.map(e=>{var{providerId:t}=e,r=$0(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SO(n,e){const t=await pC(n,{},async()=>{const r=gu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=gC(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",fC.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function xO(n,e){return Dl(n,"POST","/v2/accounts:revokeToken",ff(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ut(e.idToken,"internal-error"),ut(typeof e.idToken<"u","internal-error"),ut(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):R_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ut(e.length!==0,"internal-error");const t=R_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ut(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await SO(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new nl;return r&&(ut(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ut(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ut(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nl,this.toJSON())}_performRefresh(){return mi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(n,e){ut(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class gi{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=$0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new CO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Sm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await zc(this,this.stsTokenManager.getToken(this.auth,e));return ut(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return TO(this,e)}reload(){return AO(this)}_assign(e){this!==e&&(ut(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new gi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ch(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ds(this.auth.app))return Promise.reject(uo(this.auth));const e=await this.getIdToken();return await zc(this,EO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,u,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(s=t.email)!==null&&s!==void 0?s:void 0,m=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=t.photoURL)!==null&&o!==void 0?o:void 0,v=(a=t.tenantId)!==null&&a!==void 0?a:void 0,y=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,L=(u=t.createdAt)!==null&&u!==void 0?u:void 0,D=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:A,emailVerified:C,isAnonymous:j,providerData:z,stsTokenManager:w}=t;ut(A&&w,e,"internal-error");const R=nl.fromJSON(this.name,w);ut(typeof A=="string",e,"internal-error"),qi(f,e.name),qi(p,e.name),ut(typeof C=="boolean",e,"internal-error"),ut(typeof j=="boolean",e,"internal-error"),qi(m,e.name),qi(g,e.name),qi(v,e.name),qi(y,e.name),qi(L,e.name),qi(D,e.name);const x=new gi({uid:A,auth:e,email:p,emailVerified:C,displayName:f,isAnonymous:j,photoURL:g,phoneNumber:m,tenantId:v,stsTokenManager:R,createdAt:L,lastLoginAt:D});return z&&Array.isArray(z)&&(x.providerData=z.map(b=>Object.assign({},b))),y&&(x._redirectEventId=y),x}static async _fromIdTokenResponse(e,t,r=!1){const s=new nl;s.updateFromServerResponse(t);const i=new gi({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ch(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ut(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?yC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new nl;a.updateFromIdToken(r);const l=new gi({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Sm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_=new Map;function vi(n){Ni(n instanceof Function,"Expected a class definition");let e=k_.get(n);return e?(Ni(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,k_.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}_C.type="NONE";const P_=_C;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(n,e,t){return`firebase:${n}:${e}:${t}`}class rl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Bd(this.userKey,s.apiKey,i),this.fullPersistenceKey=Bd("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?gi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new rl(vi(P_),e,r);const s=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||vi(P_);const o=Bd(r,e.config.apiKey,e.name);let a=null;for(const u of t)try{const d=await u._get(o);if(d){const f=gi._fromJSON(e,d);u!==i&&(a=f),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new rl(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new rl(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(CC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(EC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IC(e))return"Blackberry";if(SC(e))return"Webos";if(TC(e))return"Safari";if((e.includes("chrome/")||wC(e))&&!e.includes("edge/"))return"Chrome";if(AC(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function EC(n=vr()){return/firefox\//i.test(n)}function TC(n=vr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wC(n=vr()){return/crios\//i.test(n)}function CC(n=vr()){return/iemobile/i.test(n)}function AC(n=vr()){return/android/i.test(n)}function IC(n=vr()){return/blackberry/i.test(n)}function SC(n=vr()){return/webos/i.test(n)}function q0(n=vr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function bO(n=vr()){var e;return q0(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function RO(){return GP()&&document.documentMode===10}function xC(n=vr()){return q0(n)||AC(n)||SC(n)||IC(n)||/windows phone/i.test(n)||CC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(n,e=[]){let t;switch(n){case"Browser":t=N_(vr());break;case"Worker":t=`${N_(vr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ol}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PO(n,e={}){return Dl(n,"GET","/v2/passwordPolicy",ff(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO=6;class OO{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:NO,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new O_(this),this.idTokenSubscription=new O_(this),this.beforeStateQueue=new kO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=vi(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await rl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await vC(this,{idToken:e}),r=await gi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ds(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ch(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ds(this.app))return Promise.reject(uo(this));const t=e?En(e):null;return t&&ut(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ut(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ds(this.app)?Promise.reject(uo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ds(this.app)?Promise.reject(uo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await PO(this),t=new OO(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new mu("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await xO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&vi(e)||this._popupRedirectResolver;ut(t,this,"argument-error"),this.redirectPersistenceManager=await rl.create(this,[vi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ut(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&hO(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function yu(n){return En(n)}class O_{constructor(e){this.auth=e,this.observer=null,this.addObserver=tN(t=>this.observer=t)}get next(){return ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function MO(n){G0=n}function FO(n){return G0.loadJS(n)}function LO(){return G0.gapiScript}function UO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BO(n,e){const t=hf(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(oh(i,e??{}))return s;qs(s,"already-initialized")}return t.initialize({options:e})}function VO(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(vi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function $O(n,e,t){const r=yu(n);ut(r._canInitEmulator,r,"emulator-config-failed"),ut(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=RC(e),{host:o,port:a}=HO(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),jO()}function RC(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function HO(n){const e=RC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:D_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:D_(o)}}}function D_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function jO(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return mi("not implemented")}_getIdTokenResponse(e){return mi("not implemented")}_linkToIdToken(e,t){return mi("not implemented")}_getReauthenticationResolver(e){return mi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sl(n,e){return mC(n,"POST","/v1/accounts:signInWithIdp",ff(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO="http://localhost";class ea extends kC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ea(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=$0(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new ea(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return sl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,sl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,sl(e,t)}buildRequest(){const e={requestUri:WO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=gu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u extends z0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends _u{constructor(){super("facebook.com")}static credential(e){return ea._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return to.credentialFromTaggedObject(e)}static credentialFromError(e){return to.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return to.credential(e.oauthAccessToken)}catch{return null}}}to.FACEBOOK_SIGN_IN_METHOD="facebook.com";to.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends _u{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ea._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return pi.credential(t,r)}catch{return null}}}pi.GOOGLE_SIGN_IN_METHOD="google.com";pi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no extends _u{constructor(){super("github.com")}static credential(e){return ea._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return no.credentialFromTaggedObject(e)}static credentialFromError(e){return no.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return no.credential(e.oauthAccessToken)}catch{return null}}}no.GITHUB_SIGN_IN_METHOD="github.com";no.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro extends _u{constructor(){super("twitter.com")}static credential(e,t){return ea._fromParams({providerId:ro.PROVIDER_ID,signInMethod:ro.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ro.credentialFromTaggedObject(e)}static credentialFromError(e){return ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ro.credential(t,r)}catch{return null}}}ro.TWITTER_SIGN_IN_METHOD="twitter.com";ro.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KO(n,e){return mC(n,"POST","/v1/accounts:signUp",ff(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await gi._fromIdTokenResponse(e,r,s),o=M_(r);return new go({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=M_(r);return new go({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function M_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F_(n){var e;if(Ds(n.app))return Promise.reject(uo(n));const t=yu(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new go({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await KO(t,{returnSecureToken:!0}),s=await go._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh extends Xs{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,uh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new uh(e,t,r,s)}}function PC(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?uh._fromErrorAndOperation(n,i,e,r):i})}async function qO(n,e,t=!1){const r=await zc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return go._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GO(n,e,t=!1){const{auth:r}=n;if(Ds(r.app))return Promise.reject(uo(r));const s="reauthenticate";try{const i=await zc(n,PC(r,s,e,n),t);ut(i.idToken,r,"internal-error");const o=K0(i.idToken);ut(o,r,"internal-error");const{sub:a}=o;return ut(n.uid===a,r,"user-mismatch"),go._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&qs(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zO(n,e,t=!1){if(Ds(n.app))return Promise.reject(uo(n));const r="signIn",s=await PC(n,r,e),i=await go._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function YO(n,e,t,r){return En(n).onIdTokenChanged(e,t,r)}function QO(n,e,t){return En(n).beforeAuthStateChanged(e,t)}function XO(n,e,t,r){return En(n).onAuthStateChanged(e,t,r)}function JO(n){return En(n).signOut()}const dh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(dh,"1"),this.storage.removeItem(dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZO=1e3,eD=10;class OC extends NC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);RO()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,eD):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},ZO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}OC.type="LOCAL";const tD=OC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC extends NC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}DC.type="SESSION";const MC=DC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new pf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(t.origin,i)),l=await nD(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=Y0("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(){return window}function sD(n){Bs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(){return typeof Bs().WorkerGlobalScope<"u"&&typeof Bs().importScripts=="function"}async function iD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oD(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function aD(){return FC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="firebaseLocalStorageDb",lD=1,hh="firebaseLocalStorage",UC="fbase_key";class Eu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function mf(n,e){return n.transaction([hh],e?"readwrite":"readonly").objectStore(hh)}function cD(){const n=indexedDB.deleteDatabase(LC);return new Eu(n).toPromise()}function xm(){const n=indexedDB.open(LC,lD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(hh,{keyPath:UC})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(hh)?e(r):(r.close(),await cD(),e(await xm()))})})}async function L_(n,e,t){const r=mf(n,!0).put({[UC]:e,value:t});return new Eu(r).toPromise()}async function uD(n,e){const t=mf(n,!1).get(e),r=await new Eu(t).toPromise();return r===void 0?null:r.value}function U_(n,e){const t=mf(n,!0).delete(e);return new Eu(t).toPromise()}const dD=800,hD=3;class BC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>hD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return FC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pf._getInstance(aD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await iD(),!this.activeServiceWorker)return;this.sender=new rD(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xm();return await L_(e,dh,"1"),await U_(e,dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>L_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>uD(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>U_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=mf(s,!1).getAll();return new Eu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}BC.type="LOCAL";const fD=BC;new vu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(n,e){return e?vi(e):(ut(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0 extends kC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return sl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return sl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function pD(n){return zO(n.auth,new Q0(n),n.bypassAuthState)}function mD(n){const{auth:e,user:t}=n;return ut(t,e,"internal-error"),GO(t,new Q0(n),n.bypassAuthState)}async function gD(n){const{auth:e,user:t}=n;return ut(t,e,"internal-error"),qO(t,new Q0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return pD;case"linkViaPopup":case"linkViaRedirect":return gD;case"reauthViaPopup":case"reauthViaRedirect":return mD;default:qs(this.auth,"internal-error")}}resolve(e){Ni(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ni(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new vu(2e3,1e4);async function yD(n,e,t){if(Ds(n.app))return Promise.reject(ps(n,"operation-not-supported-in-this-environment"));const r=yu(n);fO(n,e,z0);const s=VC(r,t);return new Vo(r,"signInViaPopup",e,s).executeNotNull()}class Vo extends $C{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Vo.currentPopupAction&&Vo.currentPopupAction.cancel(),Vo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ut(e,this.auth,"internal-error"),e}async onExecution(){Ni(this.filter.length===1,"Popup operations only handle one event");const e=Y0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ps(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ps(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ps(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,vD.get())};e()}}Vo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D="pendingRedirect",Vd=new Map;class ED extends $C{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Vd.get(this.auth._key());if(!e){try{const r=await TD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Vd.set(this.auth._key(),e)}return this.bypassAuthState||Vd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function TD(n,e){const t=AD(e),r=CD(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function wD(n,e){Vd.set(n._key(),e)}function CD(n){return vi(n._redirectPersistence)}function AD(n){return Bd(_D,n.config.apiKey,n.name)}async function ID(n,e,t=!1){if(Ds(n.app))return Promise.reject(uo(n));const r=yu(n),s=VC(r,e),o=await new ED(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=10*60*1e3;class xD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!bD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!HC(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ps(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=SD&&this.cachedEventUids.clear(),this.cachedEventUids.has(B_(e))}saveEventToCache(e){this.cachedEventUids.add(B_(e)),this.lastProcessedEventTime=Date.now()}}function B_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function HC({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function bD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HC(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RD(n,e={}){return Dl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,PD=/^https?/;async function ND(n){if(n.config.emulator)return;const{authorizedDomains:e}=await RD(n);for(const t of e)try{if(OD(t))return}catch{}qs(n,"unauthorized-domain")}function OD(n){const e=Im(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!PD.test(t))return!1;if(kD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD=new vu(3e4,6e4);function V_(){const n=Bs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function MD(n){return new Promise((e,t)=>{var r,s,i;function o(){V_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{V_(),t(ps(n,"network-request-failed"))},timeout:DD.get()})}if(!((s=(r=Bs().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Bs().gapi)===null||i===void 0)&&i.load)o();else{const a=UO("iframefcb");return Bs()[a]=()=>{gapi.load?o():t(ps(n,"network-request-failed"))},FO(`${LO()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw $d=null,e})}let $d=null;function FD(n){return $d=$d||MD(n),$d}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD=new vu(5e3,15e3),UD="__/auth/iframe",BD="emulator/auth/iframe",VD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$D=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function HD(n){const e=n.config;ut(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?W0(e,BD):`https://${n.config.authDomain}/${UD}`,r={apiKey:e.apiKey,appName:n.name,v:Ol},s=$D.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${gu(r).slice(1)}`}async function jD(n){const e=await FD(n),t=Bs().gapi;return ut(t,n,"internal-error"),e.open({where:document.body,url:HD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VD,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=ps(n,"network-request-failed"),a=Bs().setTimeout(()=>{i(o)},LD.get());function l(){Bs().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KD=500,qD=600,GD="_blank",zD="http://localhost";class $_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YD(n,e,t,r=KD,s=qD){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},WD),{width:r.toString(),height:s.toString(),top:i,left:o}),u=vr().toLowerCase();t&&(a=wC(u)?GD:t),EC(u)&&(e=e||zD,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[m,g])=>`${p}${m}=${g},`,"");if(bO(u)&&a!=="_self")return QD(e||"",a),new $_(null);const f=window.open(e||"",a,d);ut(f,n,"popup-blocked");try{f.focus()}catch{}return new $_(f)}function QD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="__/auth/handler",JD="emulator/auth/handler",ZD=encodeURIComponent("fac");async function H_(n,e,t,r,s,i){ut(n.config.authDomain,n,"auth-domain-config-required"),ut(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ol,eventId:s};if(e instanceof z0){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",eN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof _u){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await n._getAppCheckToken(),u=l?`#${ZD}=${encodeURIComponent(l)}`:"";return`${e4(n)}?${gu(a).slice(1)}${u}`}function e4({config:n}){return n.emulator?W0(n,JD):`https://${n.authDomain}/${XD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="webStorageSupport";class t4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=MC,this._completeRedirectFn=ID,this._overrideRedirectResult=wD}async _openPopup(e,t,r,s){var i;Ni((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await H_(e,t,r,Im(),s);return YD(e,o,Y0())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await H_(e,t,r,Im(),s);return sD(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Ni(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await jD(e),r=new xD(e);return t.register("authEvent",s=>(ut(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mp,{type:Mp},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Mp];o!==void 0&&t(!!o),qs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ND(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xC()||TC()||q0()}}const n4=t4;var j_="@firebase/auth",W_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function i4(n){Zo(new mo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ut(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bC(n)},u=new DO(r,s,i,l);return VO(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Zo(new mo("auth-internal",e=>{const t=yu(e.getProvider("auth").getImmediate());return(r=>new r4(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Us(j_,W_,s4(n)),Us(j_,W_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4=5*60,a4=iC("authIdTokenMaxAge")||o4;let K_=null;const l4=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>a4)return;const s=t==null?void 0:t.token;K_!==s&&(K_=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function c4(n=V0()){const e=hf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=BO(n,{popupRedirectResolver:n4,persistence:[fD,tD,MC]}),r=iC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=l4(i.toString());QO(t,o,()=>o(t.currentUser)),YO(t,a=>o(a))}}const s=nC("auth");return s&&$O(t,`http://${s}`),t}function u4(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}MO({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ps("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",u4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});i4("Browser");var q_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zo,jC;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,R){function x(){}x.prototype=R.prototype,w.D=R.prototype,w.prototype=new x,w.prototype.constructor=w,w.C=function(b,N,M){for(var F=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)F[oe-2]=arguments[oe];return R.prototype[N].apply(b,F)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,R,x){x||(x=0);var b=Array(16);if(typeof R=="string")for(var N=0;16>N;++N)b[N]=R.charCodeAt(x++)|R.charCodeAt(x++)<<8|R.charCodeAt(x++)<<16|R.charCodeAt(x++)<<24;else for(N=0;16>N;++N)b[N]=R[x++]|R[x++]<<8|R[x++]<<16|R[x++]<<24;R=w.g[0],x=w.g[1],N=w.g[2];var M=w.g[3],F=R+(M^x&(N^M))+b[0]+3614090360&4294967295;R=x+(F<<7&4294967295|F>>>25),F=M+(N^R&(x^N))+b[1]+3905402710&4294967295,M=R+(F<<12&4294967295|F>>>20),F=N+(x^M&(R^x))+b[2]+606105819&4294967295,N=M+(F<<17&4294967295|F>>>15),F=x+(R^N&(M^R))+b[3]+3250441966&4294967295,x=N+(F<<22&4294967295|F>>>10),F=R+(M^x&(N^M))+b[4]+4118548399&4294967295,R=x+(F<<7&4294967295|F>>>25),F=M+(N^R&(x^N))+b[5]+1200080426&4294967295,M=R+(F<<12&4294967295|F>>>20),F=N+(x^M&(R^x))+b[6]+2821735955&4294967295,N=M+(F<<17&4294967295|F>>>15),F=x+(R^N&(M^R))+b[7]+4249261313&4294967295,x=N+(F<<22&4294967295|F>>>10),F=R+(M^x&(N^M))+b[8]+1770035416&4294967295,R=x+(F<<7&4294967295|F>>>25),F=M+(N^R&(x^N))+b[9]+2336552879&4294967295,M=R+(F<<12&4294967295|F>>>20),F=N+(x^M&(R^x))+b[10]+4294925233&4294967295,N=M+(F<<17&4294967295|F>>>15),F=x+(R^N&(M^R))+b[11]+2304563134&4294967295,x=N+(F<<22&4294967295|F>>>10),F=R+(M^x&(N^M))+b[12]+1804603682&4294967295,R=x+(F<<7&4294967295|F>>>25),F=M+(N^R&(x^N))+b[13]+4254626195&4294967295,M=R+(F<<12&4294967295|F>>>20),F=N+(x^M&(R^x))+b[14]+2792965006&4294967295,N=M+(F<<17&4294967295|F>>>15),F=x+(R^N&(M^R))+b[15]+1236535329&4294967295,x=N+(F<<22&4294967295|F>>>10),F=R+(N^M&(x^N))+b[1]+4129170786&4294967295,R=x+(F<<5&4294967295|F>>>27),F=M+(x^N&(R^x))+b[6]+3225465664&4294967295,M=R+(F<<9&4294967295|F>>>23),F=N+(R^x&(M^R))+b[11]+643717713&4294967295,N=M+(F<<14&4294967295|F>>>18),F=x+(M^R&(N^M))+b[0]+3921069994&4294967295,x=N+(F<<20&4294967295|F>>>12),F=R+(N^M&(x^N))+b[5]+3593408605&4294967295,R=x+(F<<5&4294967295|F>>>27),F=M+(x^N&(R^x))+b[10]+38016083&4294967295,M=R+(F<<9&4294967295|F>>>23),F=N+(R^x&(M^R))+b[15]+3634488961&4294967295,N=M+(F<<14&4294967295|F>>>18),F=x+(M^R&(N^M))+b[4]+3889429448&4294967295,x=N+(F<<20&4294967295|F>>>12),F=R+(N^M&(x^N))+b[9]+568446438&4294967295,R=x+(F<<5&4294967295|F>>>27),F=M+(x^N&(R^x))+b[14]+3275163606&4294967295,M=R+(F<<9&4294967295|F>>>23),F=N+(R^x&(M^R))+b[3]+4107603335&4294967295,N=M+(F<<14&4294967295|F>>>18),F=x+(M^R&(N^M))+b[8]+1163531501&4294967295,x=N+(F<<20&4294967295|F>>>12),F=R+(N^M&(x^N))+b[13]+2850285829&4294967295,R=x+(F<<5&4294967295|F>>>27),F=M+(x^N&(R^x))+b[2]+4243563512&4294967295,M=R+(F<<9&4294967295|F>>>23),F=N+(R^x&(M^R))+b[7]+1735328473&4294967295,N=M+(F<<14&4294967295|F>>>18),F=x+(M^R&(N^M))+b[12]+2368359562&4294967295,x=N+(F<<20&4294967295|F>>>12),F=R+(x^N^M)+b[5]+4294588738&4294967295,R=x+(F<<4&4294967295|F>>>28),F=M+(R^x^N)+b[8]+2272392833&4294967295,M=R+(F<<11&4294967295|F>>>21),F=N+(M^R^x)+b[11]+1839030562&4294967295,N=M+(F<<16&4294967295|F>>>16),F=x+(N^M^R)+b[14]+4259657740&4294967295,x=N+(F<<23&4294967295|F>>>9),F=R+(x^N^M)+b[1]+2763975236&4294967295,R=x+(F<<4&4294967295|F>>>28),F=M+(R^x^N)+b[4]+1272893353&4294967295,M=R+(F<<11&4294967295|F>>>21),F=N+(M^R^x)+b[7]+4139469664&4294967295,N=M+(F<<16&4294967295|F>>>16),F=x+(N^M^R)+b[10]+3200236656&4294967295,x=N+(F<<23&4294967295|F>>>9),F=R+(x^N^M)+b[13]+681279174&4294967295,R=x+(F<<4&4294967295|F>>>28),F=M+(R^x^N)+b[0]+3936430074&4294967295,M=R+(F<<11&4294967295|F>>>21),F=N+(M^R^x)+b[3]+3572445317&4294967295,N=M+(F<<16&4294967295|F>>>16),F=x+(N^M^R)+b[6]+76029189&4294967295,x=N+(F<<23&4294967295|F>>>9),F=R+(x^N^M)+b[9]+3654602809&4294967295,R=x+(F<<4&4294967295|F>>>28),F=M+(R^x^N)+b[12]+3873151461&4294967295,M=R+(F<<11&4294967295|F>>>21),F=N+(M^R^x)+b[15]+530742520&4294967295,N=M+(F<<16&4294967295|F>>>16),F=x+(N^M^R)+b[2]+3299628645&4294967295,x=N+(F<<23&4294967295|F>>>9),F=R+(N^(x|~M))+b[0]+4096336452&4294967295,R=x+(F<<6&4294967295|F>>>26),F=M+(x^(R|~N))+b[7]+1126891415&4294967295,M=R+(F<<10&4294967295|F>>>22),F=N+(R^(M|~x))+b[14]+2878612391&4294967295,N=M+(F<<15&4294967295|F>>>17),F=x+(M^(N|~R))+b[5]+4237533241&4294967295,x=N+(F<<21&4294967295|F>>>11),F=R+(N^(x|~M))+b[12]+1700485571&4294967295,R=x+(F<<6&4294967295|F>>>26),F=M+(x^(R|~N))+b[3]+2399980690&4294967295,M=R+(F<<10&4294967295|F>>>22),F=N+(R^(M|~x))+b[10]+4293915773&4294967295,N=M+(F<<15&4294967295|F>>>17),F=x+(M^(N|~R))+b[1]+2240044497&4294967295,x=N+(F<<21&4294967295|F>>>11),F=R+(N^(x|~M))+b[8]+1873313359&4294967295,R=x+(F<<6&4294967295|F>>>26),F=M+(x^(R|~N))+b[15]+4264355552&4294967295,M=R+(F<<10&4294967295|F>>>22),F=N+(R^(M|~x))+b[6]+2734768916&4294967295,N=M+(F<<15&4294967295|F>>>17),F=x+(M^(N|~R))+b[13]+1309151649&4294967295,x=N+(F<<21&4294967295|F>>>11),F=R+(N^(x|~M))+b[4]+4149444226&4294967295,R=x+(F<<6&4294967295|F>>>26),F=M+(x^(R|~N))+b[11]+3174756917&4294967295,M=R+(F<<10&4294967295|F>>>22),F=N+(R^(M|~x))+b[2]+718787259&4294967295,N=M+(F<<15&4294967295|F>>>17),F=x+(M^(N|~R))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+R&4294967295,w.g[1]=w.g[1]+(N+(F<<21&4294967295|F>>>11))&4294967295,w.g[2]=w.g[2]+N&4294967295,w.g[3]=w.g[3]+M&4294967295}r.prototype.u=function(w,R){R===void 0&&(R=w.length);for(var x=R-this.blockSize,b=this.B,N=this.h,M=0;M<R;){if(N==0)for(;M<=x;)s(this,w,M),M+=this.blockSize;if(typeof w=="string"){for(;M<R;)if(b[N++]=w.charCodeAt(M++),N==this.blockSize){s(this,b),N=0;break}}else for(;M<R;)if(b[N++]=w[M++],N==this.blockSize){s(this,b),N=0;break}}this.h=N,this.o+=R},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var R=1;R<w.length-8;++R)w[R]=0;var x=8*this.o;for(R=w.length-8;R<w.length;++R)w[R]=x&255,x/=256;for(this.u(w),w=Array(16),R=x=0;4>R;++R)for(var b=0;32>b;b+=8)w[x++]=this.g[R]>>>b&255;return w};function i(w,R){var x=a;return Object.prototype.hasOwnProperty.call(x,w)?x[w]:x[w]=R(w)}function o(w,R){this.h=R;for(var x=[],b=!0,N=w.length-1;0<=N;N--){var M=w[N]|0;b&&M==R||(x[N]=M,b=!1)}this.g=x}var a={};function l(w){return-128<=w&&128>w?i(w,function(R){return new o([R|0],0>R?-1:0)}):new o([w|0],0>w?-1:0)}function u(w){if(isNaN(w)||!isFinite(w))return f;if(0>w)return y(u(-w));for(var R=[],x=1,b=0;w>=x;b++)R[b]=w/x|0,x*=4294967296;return new o(R,0)}function d(w,R){if(w.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(w.charAt(0)=="-")return y(d(w.substring(1),R));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=u(Math.pow(R,8)),b=f,N=0;N<w.length;N+=8){var M=Math.min(8,w.length-N),F=parseInt(w.substring(N,N+M),R);8>M?(M=u(Math.pow(R,M)),b=b.j(M).add(u(F))):(b=b.j(x),b=b.add(u(F)))}return b}var f=l(0),p=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(v(this))return-y(this).m();for(var w=0,R=1,x=0;x<this.g.length;x++){var b=this.i(x);w+=(0<=b?b:4294967296+b)*R,R*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(g(this))return"0";if(v(this))return"-"+y(this).toString(w);for(var R=u(Math.pow(w,6)),x=this,b="";;){var N=C(x,R).g;x=L(x,N.j(R));var M=((0<x.g.length?x.g[0]:x.h)>>>0).toString(w);if(x=N,g(x))return M+b;for(;6>M.length;)M="0"+M;b=M+b}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function g(w){if(w.h!=0)return!1;for(var R=0;R<w.g.length;R++)if(w.g[R]!=0)return!1;return!0}function v(w){return w.h==-1}n.l=function(w){return w=L(this,w),v(w)?-1:g(w)?0:1};function y(w){for(var R=w.g.length,x=[],b=0;b<R;b++)x[b]=~w.g[b];return new o(x,~w.h).add(p)}n.abs=function(){return v(this)?y(this):this},n.add=function(w){for(var R=Math.max(this.g.length,w.g.length),x=[],b=0,N=0;N<=R;N++){var M=b+(this.i(N)&65535)+(w.i(N)&65535),F=(M>>>16)+(this.i(N)>>>16)+(w.i(N)>>>16);b=F>>>16,M&=65535,F&=65535,x[N]=F<<16|M}return new o(x,x[x.length-1]&-2147483648?-1:0)};function L(w,R){return w.add(y(R))}n.j=function(w){if(g(this)||g(w))return f;if(v(this))return v(w)?y(this).j(y(w)):y(y(this).j(w));if(v(w))return y(this.j(y(w)));if(0>this.l(m)&&0>w.l(m))return u(this.m()*w.m());for(var R=this.g.length+w.g.length,x=[],b=0;b<2*R;b++)x[b]=0;for(b=0;b<this.g.length;b++)for(var N=0;N<w.g.length;N++){var M=this.i(b)>>>16,F=this.i(b)&65535,oe=w.i(N)>>>16,Q=w.i(N)&65535;x[2*b+2*N]+=F*Q,D(x,2*b+2*N),x[2*b+2*N+1]+=M*Q,D(x,2*b+2*N+1),x[2*b+2*N+1]+=F*oe,D(x,2*b+2*N+1),x[2*b+2*N+2]+=M*oe,D(x,2*b+2*N+2)}for(b=0;b<R;b++)x[b]=x[2*b+1]<<16|x[2*b];for(b=R;b<2*R;b++)x[b]=0;return new o(x,0)};function D(w,R){for(;(w[R]&65535)!=w[R];)w[R+1]+=w[R]>>>16,w[R]&=65535,R++}function A(w,R){this.g=w,this.h=R}function C(w,R){if(g(R))throw Error("division by zero");if(g(w))return new A(f,f);if(v(w))return R=C(y(w),R),new A(y(R.g),y(R.h));if(v(R))return R=C(w,y(R)),new A(y(R.g),R.h);if(30<w.g.length){if(v(w)||v(R))throw Error("slowDivide_ only works with positive integers.");for(var x=p,b=R;0>=b.l(w);)x=j(x),b=j(b);var N=z(x,1),M=z(b,1);for(b=z(b,2),x=z(x,2);!g(b);){var F=M.add(b);0>=F.l(w)&&(N=N.add(x),M=F),b=z(b,1),x=z(x,1)}return R=L(w,N.j(R)),new A(N,R)}for(N=f;0<=w.l(R);){for(x=Math.max(1,Math.floor(w.m()/R.m())),b=Math.ceil(Math.log(x)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),M=u(x),F=M.j(R);v(F)||0<F.l(w);)x-=b,M=u(x),F=M.j(R);g(M)&&(M=p),N=N.add(M),w=L(w,F)}return new A(N,w)}n.A=function(w){return C(this,w).h},n.and=function(w){for(var R=Math.max(this.g.length,w.g.length),x=[],b=0;b<R;b++)x[b]=this.i(b)&w.i(b);return new o(x,this.h&w.h)},n.or=function(w){for(var R=Math.max(this.g.length,w.g.length),x=[],b=0;b<R;b++)x[b]=this.i(b)|w.i(b);return new o(x,this.h|w.h)},n.xor=function(w){for(var R=Math.max(this.g.length,w.g.length),x=[],b=0;b<R;b++)x[b]=this.i(b)^w.i(b);return new o(x,this.h^w.h)};function j(w){for(var R=w.g.length+1,x=[],b=0;b<R;b++)x[b]=w.i(b)<<1|w.i(b-1)>>>31;return new o(x,w.h)}function z(w,R){var x=R>>5;R%=32;for(var b=w.g.length-x,N=[],M=0;M<b;M++)N[M]=0<R?w.i(M+x)>>>R|w.i(M+x+1)<<32-R:w.i(M+x);return new o(N,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,jC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,zo=o}).apply(typeof q_<"u"?q_:typeof self<"u"?self:typeof window<"u"?window:{});var dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var WC,uc,KC,Hd,bm,qC,GC,zC;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,_,k){return h==Array.prototype||h==Object.prototype||(h[_]=k.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof dd=="object"&&dd];for(var _=0;_<h.length;++_){var k=h[_];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var r=t(this);function s(h,_){if(_)e:{var k=r;h=h.split(".");for(var W=0;W<h.length-1;W++){var de=h[W];if(!(de in k))break e;k=k[de]}h=h[h.length-1],W=k[h],_=_(W),_!=W&&_!=null&&e(k,h,{configurable:!0,writable:!0,value:_})}}function i(h,_){h instanceof String&&(h+="");var k=0,W=!1,de={next:function(){if(!W&&k<h.length){var we=k++;return{value:_(we,h[we]),done:!1}}return W=!0,{done:!0,value:void 0}}};return de[Symbol.iterator]=function(){return de},de}s("Array.prototype.values",function(h){return h||function(){return i(this,function(_,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var _=typeof h;return _=_!="object"?_:h?Array.isArray(h)?"array":_:"null",_=="array"||_=="object"&&typeof h.length=="number"}function u(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function d(h,_,k){return h.call.apply(h.bind,arguments)}function f(h,_,k){if(!h)throw Error();if(2<arguments.length){var W=Array.prototype.slice.call(arguments,2);return function(){var de=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(de,W),h.apply(_,de)}}return function(){return h.apply(_,arguments)}}function p(h,_,k){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function m(h,_){var k=Array.prototype.slice.call(arguments,1);return function(){var W=k.slice();return W.push.apply(W,arguments),h.apply(this,W)}}function g(h,_){function k(){}k.prototype=_.prototype,h.aa=_.prototype,h.prototype=new k,h.prototype.constructor=h,h.Qb=function(W,de,we){for(var Ke=Array(arguments.length-2),Gt=2;Gt<arguments.length;Gt++)Ke[Gt-2]=arguments[Gt];return _.prototype[de].apply(W,Ke)}}function v(h){const _=h.length;if(0<_){const k=Array(_);for(let W=0;W<_;W++)k[W]=h[W];return k}return[]}function y(h,_){for(let k=1;k<arguments.length;k++){const W=arguments[k];if(l(W)){const de=h.length||0,we=W.length||0;h.length=de+we;for(let Ke=0;Ke<we;Ke++)h[de+Ke]=W[Ke]}else h.push(W)}}class L{constructor(_,k){this.i=_,this.j=k,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function D(h){return/^[\s\xa0]*$/.test(h)}function A(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function C(h){return C[" "](h),h}C[" "]=function(){};var j=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function z(h,_,k){for(const W in h)_.call(k,h[W],W,h)}function w(h,_){for(const k in h)_.call(void 0,h[k],k,h)}function R(h){const _={};for(const k in h)_[k]=h[k];return _}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(h,_){let k,W;for(let de=1;de<arguments.length;de++){W=arguments[de];for(k in W)h[k]=W[k];for(let we=0;we<x.length;we++)k=x[we],Object.prototype.hasOwnProperty.call(W,k)&&(h[k]=W[k])}}function N(h){var _=1;h=h.split(":");const k=[];for(;0<_&&h.length;)k.push(h.shift()),_--;return h.length&&k.push(h.join(":")),k}function M(h){a.setTimeout(()=>{throw h},0)}function F(){var h=Ee;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class oe{constructor(){this.h=this.g=null}add(_,k){const W=Q.get();W.set(_,k),this.h?this.h.next=W:this.g=W,this.h=W}}var Q=new L(()=>new ne,h=>h.reset());class ne{constructor(){this.next=this.g=this.h=null}set(_,k){this.h=_,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,xe=!1,Ee=new oe,Pe=()=>{const h=a.Promise.resolve(void 0);ge=()=>{h.then(he)}};var he=()=>{for(var h;h=F();){try{h.h.call(h.g)}catch(k){M(k)}var _=Q;_.j(h),100>_.h&&(_.h++,h.next=_.g,_.g=h)}xe=!1};function E(){this.s=this.s,this.C=this.C}E.prototype.s=!1,E.prototype.ma=function(){this.s||(this.s=!0,this.N())},E.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var U=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};a.addEventListener("test",k,_),a.removeEventListener("test",k,_)}catch{}return h}();function ee(h,_){if(T.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var k=this.type=h.type,W=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget){if(j){e:{try{C(_.nodeName);var de=!0;break e}catch{}de=!1}de||(_=null)}}else k=="mouseover"?_=h.fromElement:k=="mouseout"&&(_=h.toElement);this.relatedTarget=_,W?(this.clientX=W.clientX!==void 0?W.clientX:W.pageX,this.clientY=W.clientY!==void 0?W.clientY:W.pageY,this.screenX=W.screenX||0,this.screenY=W.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:le[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ee.aa.h.call(this)}}g(ee,T);var le={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var se="closure_listenable_"+(1e6*Math.random()|0),ve=0;function te(h,_,k,W,de){this.listener=h,this.proxy=null,this.src=_,this.type=k,this.capture=!!W,this.ha=de,this.key=++ve,this.da=this.fa=!1}function O(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function H(h){this.src=h,this.g={},this.h=0}H.prototype.add=function(h,_,k,W,de){var we=h.toString();h=this.g[we],h||(h=this.g[we]=[],this.h++);var Ke=S(h,_,W,de);return-1<Ke?(_=h[Ke],k||(_.fa=!1)):(_=new te(_,this.src,we,!!W,de),_.fa=k,h.push(_)),_};function I(h,_){var k=_.type;if(k in h.g){var W=h.g[k],de=Array.prototype.indexOf.call(W,_,void 0),we;(we=0<=de)&&Array.prototype.splice.call(W,de,1),we&&(O(_),h.g[k].length==0&&(delete h.g[k],h.h--))}}function S(h,_,k,W){for(var de=0;de<h.length;++de){var we=h[de];if(!we.da&&we.listener==_&&we.capture==!!k&&we.ha==W)return de}return-1}var B="closure_lm_"+(1e6*Math.random()|0),ie={};function ue(h,_,k,W,de){if(Array.isArray(_)){for(var we=0;we<_.length;we++)ue(h,_[we],k,W,de);return null}return k=it(k),h&&h[se]?h.K(_,k,u(W)?!!W.capture:!1,de):re(h,_,k,!1,W,de)}function re(h,_,k,W,de,we){if(!_)throw Error("Invalid event type");var Ke=u(de)?!!de.capture:!!de,Gt=qe(h);if(Gt||(h[B]=Gt=new H(h)),k=Gt.add(_,k,W,Ke,we),k.proxy)return k;if(W=Re(),k.proxy=W,W.src=h,W.listener=k,h.addEventListener)U||(de=Ke),de===void 0&&(de=!1),h.addEventListener(_.toString(),W,de);else if(h.attachEvent)h.attachEvent(Se(_.toString()),W);else if(h.addListener&&h.removeListener)h.addListener(W);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Re(){function h(k){return _.call(h.src,h.listener,k)}const _=et;return h}function Oe(h,_,k,W,de){if(Array.isArray(_))for(var we=0;we<_.length;we++)Oe(h,_[we],k,W,de);else W=u(W)?!!W.capture:!!W,k=it(k),h&&h[se]?(h=h.i,_=String(_).toString(),_ in h.g&&(we=h.g[_],k=S(we,k,W,de),-1<k&&(O(we[k]),Array.prototype.splice.call(we,k,1),we.length==0&&(delete h.g[_],h.h--)))):h&&(h=qe(h))&&(_=h.g[_.toString()],h=-1,_&&(h=S(_,k,W,de)),(k=-1<h?_[h]:null)&&Me(k))}function Me(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[se])I(_.i,h);else{var k=h.type,W=h.proxy;_.removeEventListener?_.removeEventListener(k,W,h.capture):_.detachEvent?_.detachEvent(Se(k),W):_.addListener&&_.removeListener&&_.removeListener(W),(k=qe(_))?(I(k,h),k.h==0&&(k.src=null,_[B]=null)):O(h)}}}function Se(h){return h in ie?ie[h]:ie[h]="on"+h}function et(h,_){if(h.da)h=!0;else{_=new ee(_,this);var k=h.listener,W=h.ha||h.src;h.fa&&Me(h),h=k.call(W,_)}return h}function qe(h){return h=h[B],h instanceof H?h:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function it(h){return typeof h=="function"?h:(h[Qe]||(h[Qe]=function(_){return h.handleEvent(_)}),h[Qe])}function tt(){E.call(this),this.i=new H(this),this.M=this,this.F=null}g(tt,E),tt.prototype[se]=!0,tt.prototype.removeEventListener=function(h,_,k,W){Oe(this,h,_,k,W)};function lt(h,_){var k,W=h.F;if(W)for(k=[];W;W=W.F)k.push(W);if(h=h.M,W=_.type||_,typeof _=="string")_=new T(_,h);else if(_ instanceof T)_.target=_.target||h;else{var de=_;_=new T(W,h),b(_,de)}if(de=!0,k)for(var we=k.length-1;0<=we;we--){var Ke=_.g=k[we];de=yt(Ke,W,!0,_)&&de}if(Ke=_.g=h,de=yt(Ke,W,!0,_)&&de,de=yt(Ke,W,!1,_)&&de,k)for(we=0;we<k.length;we++)Ke=_.g=k[we],de=yt(Ke,W,!1,_)&&de}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var h=this.i,_;for(_ in h.g){for(var k=h.g[_],W=0;W<k.length;W++)O(k[W]);delete h.g[_],h.h--}}this.F=null},tt.prototype.K=function(h,_,k,W){return this.i.add(String(h),_,!1,k,W)},tt.prototype.L=function(h,_,k,W){return this.i.add(String(h),_,!0,k,W)};function yt(h,_,k,W){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();for(var de=!0,we=0;we<_.length;++we){var Ke=_[we];if(Ke&&!Ke.da&&Ke.capture==k){var Gt=Ke.listener,qn=Ke.ha||Ke.src;Ke.fa&&I(h.i,Ke),de=Gt.call(qn,W)!==!1&&de}}return de&&!W.defaultPrevented}function Nn(h,_,k){if(typeof h=="function")k&&(h=p(h,k));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:a.setTimeout(h,_||0)}function Cn(h){h.g=Nn(()=>{h.g=null,h.i&&(h.i=!1,Cn(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class yr extends E{constructor(_,k){super(),this.m=_,this.l=k,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Cn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function On(h){E.call(this),this.h=h,this.g={}}g(On,E);var is=[];function $i(h){z(h.g,function(_,k){this.g.hasOwnProperty(k)&&Me(_)},h),h.g={}}On.prototype.N=function(){On.aa.N.call(this),$i(this)},On.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var An=a.JSON.stringify,Rr=a.JSON.parse,Ia=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function Zs(){}Zs.prototype.h=null;function Gl(h){return h.h||(h.h=h.i())}function zl(){}var Ro={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Yl(){T.call(this,"d")}g(Yl,T);function Hi(){T.call(this,"c")}g(Hi,T);var ei={},Ku=null;function Sa(){return Ku=Ku||new tt}ei.La="serverreachability";function qu(h){T.call(this,ei.La,h)}g(qu,T);function ko(h){const _=Sa();lt(_,new qu(_))}ei.STAT_EVENT="statevent";function Gu(h,_){T.call(this,ei.STAT_EVENT,h),this.stat=_}g(Gu,T);function Kn(h){const _=Sa();lt(_,new Gu(_,h))}ei.Ma="timingevent";function zu(h,_){T.call(this,ei.Ma,h),this.size=_}g(zu,T);function ti(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},_)}function Po(){this.g=!0}Po.prototype.xa=function(){this.g=!1};function dp(h,_,k,W,de,we){h.info(function(){if(h.g)if(we)for(var Ke="",Gt=we.split("&"),qn=0;qn<Gt.length;qn++){var Rt=Gt[qn].split("=");if(1<Rt.length){var rr=Rt[0];Rt=Rt[1];var sr=rr.split("_");Ke=2<=sr.length&&sr[1]=="type"?Ke+(rr+"="+Rt+"&"):Ke+(rr+"=redacted&")}}else Ke=null;else Ke=we;return"XMLHTTP REQ ("+W+") [attempt "+de+"]: "+_+`
`+k+`
`+Ke})}function hp(h,_,k,W,de,we,Ke){h.info(function(){return"XMLHTTP RESP ("+W+") [ attempt "+de+"]: "+_+`
`+k+`
`+we+" "+Ke})}function V(h,_,k,W){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+G(h,k)+(W?" "+W:"")})}function X(h,_){h.info(function(){return"TIMEOUT: "+_})}Po.prototype.info=function(){};function G(h,_){if(!h.g)return _;if(!_)return null;try{var k=JSON.parse(_);if(k){for(h=0;h<k.length;h++)if(Array.isArray(k[h])){var W=k[h];if(!(2>W.length)){var de=W[1];if(Array.isArray(de)&&!(1>de.length)){var we=de[0];if(we!="noop"&&we!="stop"&&we!="close")for(var Ke=1;Ke<de.length;Ke++)de[Ke]=""}}}}return An(k)}catch{return _}}var Y={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},J={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Z;function pe(){}g(pe,Zs),pe.prototype.g=function(){return new XMLHttpRequest},pe.prototype.i=function(){return{}},Z=new pe;function Ce(h,_,k,W){this.j=h,this.i=_,this.l=k,this.R=W||1,this.U=new On(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new me}function me(){this.i=null,this.g="",this.h=!1}var ye={},_e={};function Le(h,_,k){h.L=1,h.v=Xu(ri(_)),h.m=k,h.P=!0,We(h,null)}function We(h,_){h.F=Date.now(),Ge(h),h.A=ri(h.v);var k=h.A,W=h.R;Array.isArray(W)||(W=[String(W)]),uy(k.i,"t",W),h.C=0,k=h.j.J,h.h=new me,h.g=by(h.j,k?_:null,!h.m),0<h.O&&(h.M=new yr(p(h.Y,h,h.g),h.O)),_=h.U,k=h.g,W=h.ca;var de="readystatechange";Array.isArray(de)||(de&&(is[0]=de.toString()),de=is);for(var we=0;we<de.length;we++){var Ke=ue(k,de[we],W||_.handleEvent,!1,_.h||_);if(!Ke)break;_.g[Ke.key]=Ke}_=h.H?R(h.H):{},h.m?(h.u||(h.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,_)):(h.u="GET",h.g.ea(h.A,h.u,null,_)),ko(),dp(h.i,h.u,h.A,h.l,h.R,h.m)}Ce.prototype.ca=function(h){h=h.target;const _=this.M;_&&si(h)==3?_.j():this.Y(h)},Ce.prototype.Y=function(h){try{if(h==this.g)e:{const sr=si(this.g);var _=this.g.Ba();const ka=this.g.Z();if(!(3>sr)&&(sr!=3||this.g&&(this.h.h||this.g.oa()||vy(this.g)))){this.J||sr!=4||_==7||(_==8||0>=ka?ko(3):ko(2)),qt(this);var k=this.g.Z();this.X=k;t:if(ze(this)){var W=vy(this.g);h="";var de=W.length,we=si(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){an(this),Ft(this);var Ke="";break t}this.h.i=new a.TextDecoder}for(_=0;_<de;_++)this.h.h=!0,h+=this.h.i.decode(W[_],{stream:!(we&&_==de-1)});W.length=0,this.h.g+=h,this.C=0,Ke=this.h.g}else Ke=this.g.oa();if(this.o=k==200,hp(this.i,this.u,this.A,this.l,this.R,sr,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Gt,qn=this.g;if((Gt=qn.g?qn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(Gt)){var Rt=Gt;break t}}Rt=null}if(k=Rt)V(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ni(this,k);else{this.o=!1,this.s=3,Kn(12),an(this),Ft(this);break e}}if(this.P){k=!0;let os;for(;!this.J&&this.C<Ke.length;)if(os=Ve(this,Ke),os==_e){sr==4&&(this.s=4,Kn(14),k=!1),V(this.i,this.l,null,"[Incomplete Response]");break}else if(os==ye){this.s=4,Kn(15),V(this.i,this.l,Ke,"[Invalid Chunk]"),k=!1;break}else V(this.i,this.l,os,null),ni(this,os);if(ze(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sr!=4||Ke.length!=0||this.h.h||(this.s=1,Kn(16),k=!1),this.o=this.o&&k,!k)V(this.i,this.l,Ke,"[Invalid Chunked Response]"),an(this),Ft(this);else if(0<Ke.length&&!this.W){this.W=!0;var rr=this.j;rr.g==this&&rr.ba&&!rr.M&&(rr.j.info("Great, no buffering proxy detected. Bytes received: "+Ke.length),vp(rr),rr.M=!0,Kn(11))}}else V(this.i,this.l,Ke,null),ni(this,Ke);sr==4&&an(this),this.o&&!this.J&&(sr==4?Ay(this.j,this):(this.o=!1,Ge(this)))}else YR(this.g),k==400&&0<Ke.indexOf("Unknown SID")?(this.s=3,Kn(12)):(this.s=0,Kn(13)),an(this),Ft(this)}}}catch{}finally{}};function ze(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Ve(h,_){var k=h.C,W=_.indexOf(`
`,k);return W==-1?_e:(k=Number(_.substring(k,W)),isNaN(k)?ye:(W+=1,W+k>_.length?_e:(_=_.slice(W,W+k),h.C=W+k,_)))}Ce.prototype.cancel=function(){this.J=!0,an(this)};function Ge(h){h.S=Date.now()+h.I,ct(h,h.I)}function ct(h,_){if(h.B!=null)throw Error("WatchDog timer not null");h.B=ti(p(h.ba,h),_)}function qt(h){h.B&&(a.clearTimeout(h.B),h.B=null)}Ce.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(X(this.i,this.A),this.L!=2&&(ko(),Kn(17)),an(this),this.s=2,Ft(this)):ct(this,this.S-h)};function Ft(h){h.j.G==0||h.J||Ay(h.j,h)}function an(h){qt(h);var _=h.M;_&&typeof _.ma=="function"&&_.ma(),h.M=null,$i(h.U),h.g&&(_=h.g,h.g=null,_.abort(),_.ma())}function ni(h,_){try{var k=h.j;if(k.G!=0&&(k.g==h||Ur(k.h,h))){if(!h.K&&Ur(k.h,h)&&k.G==3){try{var W=k.Da.g.parse(_)}catch{W=null}if(Array.isArray(W)&&W.length==3){var de=W;if(de[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<h.F)rd(k),td(k);else break e;gp(k),Kn(18)}}else k.za=de[1],0<k.za-k.T&&37500>de[2]&&k.F&&k.v==0&&!k.C&&(k.C=ti(p(k.Za,k),6e3));if(1>=xa(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Do(k,11)}else if((h.K||k.g==h)&&rd(k),!D(_))for(de=k.Da.g.parse(_),_=0;_<de.length;_++){let Rt=de[_];if(k.T=Rt[0],Rt=Rt[1],k.G==2)if(Rt[0]=="c"){k.K=Rt[1],k.ia=Rt[2];const rr=Rt[3];rr!=null&&(k.la=rr,k.j.info("VER="+k.la));const sr=Rt[4];sr!=null&&(k.Aa=sr,k.j.info("SVER="+k.Aa));const ka=Rt[5];ka!=null&&typeof ka=="number"&&0<ka&&(W=1.5*ka,k.L=W,k.j.info("backChannelRequestTimeoutMs_="+W)),W=k;const os=h.g;if(os){const id=os.g?os.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(id){var we=W.h;we.g||id.indexOf("spdy")==-1&&id.indexOf("quic")==-1&&id.indexOf("h2")==-1||(we.j=we.l,we.g=new Set,we.h&&(fp(we,we.h),we.h=null))}if(W.D){const yp=os.g?os.g.getResponseHeader("X-HTTP-Session-Id"):null;yp&&(W.ya=yp,en(W.I,W.D,yp))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-h.F,k.j.info("Handshake RTT: "+k.R+"ms")),W=k;var Ke=h;if(W.qa=xy(W,W.J?W.ia:null,W.W),Ke.K){ny(W.h,Ke);var Gt=Ke,qn=W.L;qn&&(Gt.I=qn),Gt.B&&(qt(Gt),Ge(Gt)),W.g=Ke}else wy(W);0<k.i.length&&nd(k)}else Rt[0]!="stop"&&Rt[0]!="close"||Do(k,7);else k.G==3&&(Rt[0]=="stop"||Rt[0]=="close"?Rt[0]=="stop"?Do(k,7):mp(k):Rt[0]!="noop"&&k.l&&k.l.ta(Rt),k.v=0)}}ko(4)}catch{}}var No=class{constructor(h,_){this.g=h,this.map=_}};function ji(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function As(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function xa(h){return h.h?1:h.g?h.g.size:0}function Ur(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function fp(h,_){h.g?h.g.add(_):h.h=_}function ny(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}ji.prototype.cancel=function(){if(this.i=ry(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function ry(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const k of h.g.values())_=_.concat(k.D);return _}return v(h.i)}function DR(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var _=[],k=h.length,W=0;W<k;W++)_.push(h[W]);return _}_=[],k=0;for(W in h)_[k++]=h[W];return _}function MR(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var _=[];h=h.length;for(var k=0;k<h;k++)_.push(k);return _}_=[],k=0;for(const W in h)_[k++]=W;return _}}}function sy(h,_){if(h.forEach&&typeof h.forEach=="function")h.forEach(_,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,_,void 0);else for(var k=MR(h),W=DR(h),de=W.length,we=0;we<de;we++)_.call(void 0,W[we],k&&k[we],h)}var iy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function FR(h,_){if(h){h=h.split("&");for(var k=0;k<h.length;k++){var W=h[k].indexOf("="),de=null;if(0<=W){var we=h[k].substring(0,W);de=h[k].substring(W+1)}else we=h[k];_(we,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Oo(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Oo){this.h=h.h,Yu(this,h.j),this.o=h.o,this.g=h.g,Qu(this,h.s),this.l=h.l;var _=h.i,k=new Jl;k.i=_.i,_.g&&(k.g=new Map(_.g),k.h=_.h),oy(this,k),this.m=h.m}else h&&(_=String(h).match(iy))?(this.h=!1,Yu(this,_[1]||"",!0),this.o=Ql(_[2]||""),this.g=Ql(_[3]||"",!0),Qu(this,_[4]),this.l=Ql(_[5]||"",!0),oy(this,_[6]||"",!0),this.m=Ql(_[7]||"")):(this.h=!1,this.i=new Jl(null,this.h))}Oo.prototype.toString=function(){var h=[],_=this.j;_&&h.push(Xl(_,ay,!0),":");var k=this.g;return(k||_=="file")&&(h.push("//"),(_=this.o)&&h.push(Xl(_,ay,!0),"@"),h.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&h.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(Xl(k,k.charAt(0)=="/"?BR:UR,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",Xl(k,$R)),h.join("")};function ri(h){return new Oo(h)}function Yu(h,_,k){h.j=k?Ql(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function Qu(h,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);h.s=_}else h.s=null}function oy(h,_,k){_ instanceof Jl?(h.i=_,HR(h.i,h.h)):(k||(_=Xl(_,VR)),h.i=new Jl(_,h.h))}function en(h,_,k){h.i.set(_,k)}function Xu(h){return en(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Ql(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Xl(h,_,k){return typeof h=="string"?(h=encodeURI(h).replace(_,LR),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function LR(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var ay=/[#\/\?@]/g,UR=/[#\?:]/g,BR=/[#\?]/g,VR=/[#\?@]/g,$R=/#/g;function Jl(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function Wi(h){h.g||(h.g=new Map,h.h=0,h.i&&FR(h.i,function(_,k){h.add(decodeURIComponent(_.replace(/\+/g," ")),k)}))}n=Jl.prototype,n.add=function(h,_){Wi(this),this.i=null,h=ba(this,h);var k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(_),this.h+=1,this};function ly(h,_){Wi(h),_=ba(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function cy(h,_){return Wi(h),_=ba(h,_),h.g.has(_)}n.forEach=function(h,_){Wi(this),this.g.forEach(function(k,W){k.forEach(function(de){h.call(_,de,W,this)},this)},this)},n.na=function(){Wi(this);const h=Array.from(this.g.values()),_=Array.from(this.g.keys()),k=[];for(let W=0;W<_.length;W++){const de=h[W];for(let we=0;we<de.length;we++)k.push(_[W])}return k},n.V=function(h){Wi(this);let _=[];if(typeof h=="string")cy(this,h)&&(_=_.concat(this.g.get(ba(this,h))));else{h=Array.from(this.g.values());for(let k=0;k<h.length;k++)_=_.concat(h[k])}return _},n.set=function(h,_){return Wi(this),this.i=null,h=ba(this,h),cy(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},n.get=function(h,_){return h?(h=this.V(h),0<h.length?String(h[0]):_):_};function uy(h,_,k){ly(h,_),0<k.length&&(h.i=null,h.g.set(ba(h,_),v(k)),h.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(var k=0;k<_.length;k++){var W=_[k];const we=encodeURIComponent(String(W)),Ke=this.V(W);for(W=0;W<Ke.length;W++){var de=we;Ke[W]!==""&&(de+="="+encodeURIComponent(String(Ke[W]))),h.push(de)}}return this.i=h.join("&")};function ba(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function HR(h,_){_&&!h.j&&(Wi(h),h.i=null,h.g.forEach(function(k,W){var de=W.toLowerCase();W!=de&&(ly(this,W),uy(this,de,k))},h)),h.j=_}function jR(h,_){const k=new Po;if(a.Image){const W=new Image;W.onload=m(Ki,k,"TestLoadImage: loaded",!0,_,W),W.onerror=m(Ki,k,"TestLoadImage: error",!1,_,W),W.onabort=m(Ki,k,"TestLoadImage: abort",!1,_,W),W.ontimeout=m(Ki,k,"TestLoadImage: timeout",!1,_,W),a.setTimeout(function(){W.ontimeout&&W.ontimeout()},1e4),W.src=h}else _(!1)}function WR(h,_){const k=new Po,W=new AbortController,de=setTimeout(()=>{W.abort(),Ki(k,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:W.signal}).then(we=>{clearTimeout(de),we.ok?Ki(k,"TestPingServer: ok",!0,_):Ki(k,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(de),Ki(k,"TestPingServer: error",!1,_)})}function Ki(h,_,k,W,de){try{de&&(de.onload=null,de.onerror=null,de.onabort=null,de.ontimeout=null),W(k)}catch{}}function KR(){this.g=new Ia}function qR(h,_,k){const W=k||"";try{sy(h,function(de,we){let Ke=de;u(de)&&(Ke=An(de)),_.push(W+we+"="+encodeURIComponent(Ke))})}catch(de){throw _.push(W+"type="+encodeURIComponent("_badmap")),de}}function Ju(h){this.l=h.Ub||null,this.j=h.eb||!1}g(Ju,Zs),Ju.prototype.g=function(){return new Zu(this.l,this.j)},Ju.prototype.i=function(h){return function(){return h}}({});function Zu(h,_){tt.call(this),this.D=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Zu,tt),n=Zu.prototype,n.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=_,this.readyState=1,ec(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(_.body=h),(this.D||a).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zl(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ec(this)),this.g&&(this.readyState=3,ec(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dy(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function dy(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?Zl(this):ec(this),this.readyState==3&&dy(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Zl(this))},n.Qa=function(h){this.g&&(this.response=h,Zl(this))},n.ga=function(){this.g&&Zl(this)};function Zl(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ec(h)}n.setRequestHeader=function(h,_){this.u.append(h,_)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var k=_.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=_.next();return h.join(`\r
`)};function ec(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Zu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function hy(h){let _="";return z(h,function(k,W){_+=W,_+=":",_+=k,_+=`\r
`}),_}function pp(h,_,k){e:{for(W in k){var W=!1;break e}W=!0}W||(k=hy(k),typeof h=="string"?k!=null&&encodeURIComponent(String(k)):en(h,_,k))}function un(h){tt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(un,tt);var GR=/^https?$/i,zR=["POST","PUT"];n=un.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,_,k,W){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Z.g(),this.v=this.o?Gl(this.o):Gl(Z),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(we){fy(this,we);return}if(h=k||"",k=new Map(this.headers),W)if(Object.getPrototypeOf(W)===Object.prototype)for(var de in W)k.set(de,W[de]);else if(typeof W.keys=="function"&&typeof W.get=="function")for(const we of W.keys())k.set(we,W.get(we));else throw Error("Unknown input type for opt_headers: "+String(W));W=Array.from(k.keys()).find(we=>we.toLowerCase()=="content-type"),de=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(zR,_,void 0))||W||de||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[we,Ke]of k)this.g.setRequestHeader(we,Ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gy(this),this.u=!0,this.g.send(h),this.u=!1}catch(we){fy(this,we)}};function fy(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.m=5,py(h),ed(h)}function py(h){h.A||(h.A=!0,lt(h,"complete"),lt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,lt(this,"complete"),lt(this,"abort"),ed(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ed(this,!0)),un.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?my(this):this.bb())},n.bb=function(){my(this)};function my(h){if(h.h&&typeof o<"u"&&(!h.v[1]||si(h)!=4||h.Z()!=2)){if(h.u&&si(h)==4)Nn(h.Ea,0,h);else if(lt(h,"readystatechange"),si(h)==4){h.h=!1;try{const Ke=h.Z();e:switch(Ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var k;if(!(k=_)){var W;if(W=Ke===0){var de=String(h.D).match(iy)[1]||null;!de&&a.self&&a.self.location&&(de=a.self.location.protocol.slice(0,-1)),W=!GR.test(de?de.toLowerCase():"")}k=W}if(k)lt(h,"complete"),lt(h,"success");else{h.m=6;try{var we=2<si(h)?h.g.statusText:""}catch{we=""}h.l=we+" ["+h.Z()+"]",py(h)}}finally{ed(h)}}}}function ed(h,_){if(h.g){gy(h);const k=h.g,W=h.v[0]?()=>{}:null;h.g=null,h.v=null,_||lt(h,"ready");try{k.onreadystatechange=W}catch{}}}function gy(h){h.I&&(a.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function si(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<si(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),Rr(_)}};function vy(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function YR(h){const _={};h=(h.g&&2<=si(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let W=0;W<h.length;W++){if(D(h[W]))continue;var k=N(h[W]);const de=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const we=_[de]||[];_[de]=we,we.push(k)}w(_,function(W){return W.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function tc(h,_,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||_}function yy(h){this.Aa=0,this.i=[],this.j=new Po,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=tc("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=tc("baseRetryDelayMs",5e3,h),this.cb=tc("retryDelaySeedMs",1e4,h),this.Wa=tc("forwardChannelMaxRetries",2,h),this.wa=tc("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ji(h&&h.concurrentRequestLimit),this.Da=new KR,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=yy.prototype,n.la=8,n.G=1,n.connect=function(h,_,k,W){Kn(0),this.W=h,this.H=_||{},k&&W!==void 0&&(this.H.OSID=k,this.H.OAID=W),this.F=this.X,this.I=xy(this,null,this.W),nd(this)};function mp(h){if(_y(h),h.G==3){var _=h.U++,k=ri(h.I);if(en(k,"SID",h.K),en(k,"RID",_),en(k,"TYPE","terminate"),nc(h,k),_=new Ce(h,h.j,_),_.L=2,_.v=Xu(ri(k)),k=!1,a.navigator&&a.navigator.sendBeacon)try{k=a.navigator.sendBeacon(_.v.toString(),"")}catch{}!k&&a.Image&&(new Image().src=_.v,k=!0),k||(_.g=by(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Ge(_)}Sy(h)}function td(h){h.g&&(vp(h),h.g.cancel(),h.g=null)}function _y(h){td(h),h.u&&(a.clearTimeout(h.u),h.u=null),rd(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function nd(h){if(!As(h.h)&&!h.s){h.s=!0;var _=h.Ga;ge||Pe(),xe||(ge(),xe=!0),Ee.add(_,h),h.B=0}}function QR(h,_){return xa(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=_.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=ti(p(h.Ga,h,_),Iy(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const de=new Ce(this,this.j,h);let we=this.o;if(this.S&&(we?(we=R(we),b(we,this.S)):we=this.S),this.m!==null||this.O||(de.H=we,we=null),this.P)e:{for(var _=0,k=0;k<this.i.length;k++){t:{var W=this.i[k];if("__data__"in W.map&&(W=W.map.__data__,typeof W=="string")){W=W.length;break t}W=void 0}if(W===void 0)break;if(_+=W,4096<_){_=k;break e}if(_===4096||k===this.i.length-1){_=k+1;break e}}_=1e3}else _=1e3;_=Ty(this,de,_),k=ri(this.I),en(k,"RID",h),en(k,"CVER",22),this.D&&en(k,"X-HTTP-Session-Id",this.D),nc(this,k),we&&(this.O?_="headers="+encodeURIComponent(String(hy(we)))+"&"+_:this.m&&pp(k,this.m,we)),fp(this.h,de),this.Ua&&en(k,"TYPE","init"),this.P?(en(k,"$req",_),en(k,"SID","null"),de.T=!0,Le(de,k,null)):Le(de,k,_),this.G=2}}else this.G==3&&(h?Ey(this,h):this.i.length==0||As(this.h)||Ey(this))};function Ey(h,_){var k;_?k=_.l:k=h.U++;const W=ri(h.I);en(W,"SID",h.K),en(W,"RID",k),en(W,"AID",h.T),nc(h,W),h.m&&h.o&&pp(W,h.m,h.o),k=new Ce(h,h.j,k,h.B+1),h.m===null&&(k.H=h.o),_&&(h.i=_.D.concat(h.i)),_=Ty(h,k,1e3),k.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),fp(h.h,k),Le(k,W,_)}function nc(h,_){h.H&&z(h.H,function(k,W){en(_,W,k)}),h.l&&sy({},function(k,W){en(_,W,k)})}function Ty(h,_,k){k=Math.min(h.i.length,k);var W=h.l?p(h.l.Na,h.l,h):null;e:{var de=h.i;let we=-1;for(;;){const Ke=["count="+k];we==-1?0<k?(we=de[0].g,Ke.push("ofs="+we)):we=0:Ke.push("ofs="+we);let Gt=!0;for(let qn=0;qn<k;qn++){let Rt=de[qn].g;const rr=de[qn].map;if(Rt-=we,0>Rt)we=Math.max(0,de[qn].g-100),Gt=!1;else try{qR(rr,Ke,"req"+Rt+"_")}catch{W&&W(rr)}}if(Gt){W=Ke.join("&");break e}}}return h=h.i.splice(0,k),_.D=h,W}function wy(h){if(!h.g&&!h.u){h.Y=1;var _=h.Fa;ge||Pe(),xe||(ge(),xe=!0),Ee.add(_,h),h.v=0}}function gp(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=ti(p(h.Fa,h),Iy(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Cy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=ti(p(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Kn(10),td(this),Cy(this))};function vp(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function Cy(h){h.g=new Ce(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var _=ri(h.qa);en(_,"RID","rpc"),en(_,"SID",h.K),en(_,"AID",h.T),en(_,"CI",h.F?"0":"1"),!h.F&&h.ja&&en(_,"TO",h.ja),en(_,"TYPE","xmlhttp"),nc(h,_),h.m&&h.o&&pp(_,h.m,h.o),h.L&&(h.g.I=h.L);var k=h.g;h=h.ia,k.L=1,k.v=Xu(ri(_)),k.m=null,k.P=!0,We(k,h)}n.Za=function(){this.C!=null&&(this.C=null,td(this),gp(this),Kn(19))};function rd(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function Ay(h,_){var k=null;if(h.g==_){rd(h),vp(h),h.g=null;var W=2}else if(Ur(h.h,_))k=_.D,ny(h.h,_),W=1;else return;if(h.G!=0){if(_.o)if(W==1){k=_.m?_.m.length:0,_=Date.now()-_.F;var de=h.B;W=Sa(),lt(W,new zu(W,k)),nd(h)}else wy(h);else if(de=_.s,de==3||de==0&&0<_.X||!(W==1&&QR(h,_)||W==2&&gp(h)))switch(k&&0<k.length&&(_=h.h,_.i=_.i.concat(k)),de){case 1:Do(h,5);break;case 4:Do(h,10);break;case 3:Do(h,6);break;default:Do(h,2)}}}function Iy(h,_){let k=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(k*=2),k*_}function Do(h,_){if(h.j.info("Error code "+_),_==2){var k=p(h.fb,h),W=h.Xa;const de=!W;W=new Oo(W||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Yu(W,"https"),Xu(W),de?jR(W.toString(),k):WR(W.toString(),k)}else Kn(2);h.G=0,h.l&&h.l.sa(_),Sy(h),_y(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Kn(2)):(this.j.info("Failed to ping google.com"),Kn(1))};function Sy(h){if(h.G=0,h.ka=[],h.l){const _=ry(h.h);(_.length!=0||h.i.length!=0)&&(y(h.ka,_),y(h.ka,h.i),h.h.i.length=0,v(h.i),h.i.length=0),h.l.ra()}}function xy(h,_,k){var W=k instanceof Oo?ri(k):new Oo(k);if(W.g!="")_&&(W.g=_+"."+W.g),Qu(W,W.s);else{var de=a.location;W=de.protocol,_=_?_+"."+de.hostname:de.hostname,de=+de.port;var we=new Oo(null);W&&Yu(we,W),_&&(we.g=_),de&&Qu(we,de),k&&(we.l=k),W=we}return k=h.D,_=h.ya,k&&_&&en(W,k,_),en(W,"VER",h.la),nc(h,W),W}function by(h,_,k){if(_&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Ca&&!h.pa?new un(new Ju({eb:k})):new un(h.pa),_.Ha(h.J),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ry(){}n=Ry.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function sd(){}sd.prototype.g=function(h,_){return new Br(h,_)};function Br(h,_){tt.call(this),this.g=new yy(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(h?h["X-WebChannel-Client-Profile"]=_.va:h={"X-WebChannel-Client-Profile":_.va}),this.g.S=h,(h=_&&_.Sb)&&!D(h)&&(this.g.m=h),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!D(_)&&(this.g.D=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new Ra(this)}g(Br,tt),Br.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Br.prototype.close=function(){mp(this.g)},Br.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.u&&(k={},k.__data__=An(h),h=k);_.i.push(new No(_.Ya++,h)),_.G==3&&nd(_)},Br.prototype.N=function(){this.g.l=null,delete this.j,mp(this.g),delete this.g,Br.aa.N.call(this)};function ky(h){Yl.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const k in _){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}g(ky,Yl);function Py(){Hi.call(this),this.status=1}g(Py,Hi);function Ra(h){this.g=h}g(Ra,Ry),Ra.prototype.ua=function(){lt(this.g,"a")},Ra.prototype.ta=function(h){lt(this.g,new ky(h))},Ra.prototype.sa=function(h){lt(this.g,new Py)},Ra.prototype.ra=function(){lt(this.g,"b")},sd.prototype.createWebChannel=sd.prototype.g,Br.prototype.send=Br.prototype.o,Br.prototype.open=Br.prototype.m,Br.prototype.close=Br.prototype.close,zC=function(){return new sd},GC=function(){return Sa()},qC=ei,bm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Y.NO_ERROR=0,Y.TIMEOUT=8,Y.HTTP_ERROR=6,Hd=Y,J.COMPLETE="complete",KC=J,zl.EventType=Ro,Ro.OPEN="a",Ro.CLOSE="b",Ro.ERROR="c",Ro.MESSAGE="d",tt.prototype.listen=tt.prototype.K,uc=zl,un.prototype.listenOnce=un.prototype.L,un.prototype.getLastError=un.prototype.Ka,un.prototype.getLastErrorCode=un.prototype.Ba,un.prototype.getStatus=un.prototype.Z,un.prototype.getResponseJson=un.prototype.Oa,un.prototype.getResponseText=un.prototype.oa,un.prototype.send=un.prototype.ea,un.prototype.setWithCredentials=un.prototype.Ha,WC=un}).apply(typeof dd<"u"?dd:typeof self<"u"?self:typeof window<"u"?window:{});const G_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lr.UNAUTHENTICATED=new lr(null),lr.GOOGLE_CREDENTIALS=new lr("google-credentials-uid"),lr.FIRST_PARTY=new lr("first-party-uid"),lr.MOCK_USER=new lr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ml="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=new U0("@firebase/firestore");function ic(){return ta.logLevel}function Ze(n,...e){if(ta.logLevel<=It.DEBUG){const t=e.map(X0);ta.debug(`Firestore (${Ml}): ${n}`,...t)}}function Oi(n,...e){if(ta.logLevel<=It.ERROR){const t=e.map(X0);ta.error(`Firestore (${Ml}): ${n}`,...t)}}function na(n,...e){if(ta.logLevel<=It.WARN){const t=e.map(X0);ta.warn(`Firestore (${Ml}): ${n}`,...t)}}function X0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(n="Unexpected state"){const e=`FIRESTORE (${Ml}) INTERNAL ASSERTION FAILED: `+n;throw Oi(e),new Error(e)}function Ht(n,e){n||dt()}function gt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ye extends Xs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(lr.UNAUTHENTICATED))}shutdown(){}}class d4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class h4{constructor(e){this.t=e,this.currentUser=lr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ht(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new wi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new wi,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new wi)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ht(typeof r.accessToken=="string"),new YC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ht(e===null||typeof e=="string"),new lr(e)}}class f4{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=lr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class p4{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new f4(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(lr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class m4{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g4{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ht(this.o===void 0);const r=i=>{i.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Ze("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ht(typeof t.token=="string"),this.R=t.token,new m4(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=v4(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function Nt(n,e){return n<e?-1:n>e?1:0}function vl(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return bn.fromMillis(Date.now())}static fromDate(e){return bn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new bn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Nt(this.nanoseconds,e.nanoseconds):Nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pt(e)}static min(){return new pt(new bn(0,0))}static max(){return new pt(new bn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,t,r){t===void 0?t=0:t>e.length&&dt(),r===void 0?r=e.length-t:r>e.length-t&&dt(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Yc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yc?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class rn extends Yc{construct(e,t,r){return new rn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ye(ke.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new rn(t)}static emptyPath(){return new rn([])}}const y4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vn extends Yc{construct(e,t,r){return new Vn(e,t,r)}static isValidIdentifier(e){return y4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Vn(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Ye(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Ye(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ye(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Ye(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vn(t)}static emptyPath(){return new Vn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.path=e}static fromPath(e){return new nt(rn.fromString(e))}static fromName(e){return new nt(rn.fromString(e).popFirst(5))}static empty(){return new nt(rn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return rn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nt(new rn(e.slice()))}}function _4(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=pt.fromTimestamp(r===1e9?new bn(t+1,0):new bn(t,r));return new vo(s,nt.empty(),e)}function E4(n){return new vo(n.readTime,n.key,-1)}class vo{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new vo(pt.min(),nt.empty(),-1)}static max(){return new vo(pt.max(),nt.empty(),-1)}}function T4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=nt.comparator(n.documentKey,e.documentKey),t!==0?t:Nt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class C4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tu(n){if(n.code!==ke.FAILED_PRECONDITION||n.message!==w4)throw n;Ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Fe((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Fe?t:Fe.resolve(t)}catch(t){return Fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Fe.reject(t)}static resolve(e){return new Fe((t,r)=>{t(e)})}static reject(e){return new Fe((t,r)=>{r(e)})}static waitFor(e){return new Fe((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=Fe.resolve(!1);for(const r of e)t=t.next(s=>s?Fe.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new Fe((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const u=l;t(e[u]).next(d=>{o[u]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new Fe((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function A4(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function wu(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Z0.oe=-1;function gf(n){return n==null}function fh(n){return n===0&&1/n==-1/0}function I4(n){return typeof n=="number"&&Number.isInteger(n)&&!fh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ma(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function XC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,t){this.comparator=e,this.root=t||Qn.EMPTY}insert(e,t){return new cn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qn.BLACK,null,null))}remove(e){return new cn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hd(this.root,e,this.comparator,!1)}getReverseIterator(){return new hd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hd(this.root,e,this.comparator,!0)}}class hd{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qn{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Qn.RED,this.left=s??Qn.EMPTY,this.right=i??Qn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Qn(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Qn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Qn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dt();const e=this.left.check();if(e!==this.right.check())throw dt();return e+(this.isRed()?0:1)}}Qn.EMPTY=null,Qn.RED=!0,Qn.BLACK=!1;Qn.EMPTY=new class{constructor(){this.size=0}get key(){throw dt()}get value(){throw dt()}get color(){throw dt()}get left(){throw dt()}get right(){throw dt()}copy(e,t,r,s,i){return this}insert(e,t,r){return new Qn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.comparator=e,this.data=new cn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Y_(this.data.getIterator())}getIteratorFrom(e){return new Y_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Zn(this.comparator);return t.data=e,t}}class Y_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.fields=e,e.sort(Vn.comparator)}static empty(){return new Yr([])}unionWith(e){let t=new Zn(Vn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Yr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vl(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new JC("Invalid base64 string: "+i):i}}(e);return new Wn(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Wn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wn.EMPTY_BYTE_STRING=new Wn("");const S4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(n){if(Ht(!!n),typeof n=="string"){let e=0;const t=S4.exec(n);if(Ht(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vn(n.seconds),nanos:vn(n.nanos)}}function vn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ra(n){return typeof n=="string"?Wn.fromBase64String(n):Wn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function tg(n){const e=n.mapValue.fields.__previous_value__;return eg(e)?tg(e):e}function Qc(n){const e=yo(n.mapValue.fields.__local_write_time__.timestampValue);return new bn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e,t,r,s,i,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class yl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new yl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof yl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd={mapValue:{}};function sa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?eg(n)?4:R4(n)?9007199254740991:b4(n)?10:11:dt()}function Gs(n,e){if(n===e)return!0;const t=sa(n);if(t!==sa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Qc(n).isEqual(Qc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=yo(s.timestampValue),a=yo(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return ra(s.bytesValue).isEqual(ra(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return vn(s.geoPointValue.latitude)===vn(i.geoPointValue.latitude)&&vn(s.geoPointValue.longitude)===vn(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return vn(s.integerValue)===vn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=vn(s.doubleValue),a=vn(i.doubleValue);return o===a?fh(o)===fh(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return vl(n.arrayValue.values||[],e.arrayValue.values||[],Gs);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(z_(o)!==z_(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Gs(o[l],a[l])))return!1;return!0}(n,e);default:return dt()}}function Xc(n,e){return(n.values||[]).find(t=>Gs(t,e))!==void 0}function _l(n,e){if(n===e)return 0;const t=sa(n),r=sa(e);if(t!==r)return Nt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Nt(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=vn(i.integerValue||i.doubleValue),l=vn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return Q_(n.timestampValue,e.timestampValue);case 4:return Q_(Qc(n),Qc(e));case 5:return Nt(n.stringValue,e.stringValue);case 6:return function(i,o){const a=ra(i),l=ra(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=Nt(a[u],l[u]);if(d!==0)return d}return Nt(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Nt(vn(i.latitude),vn(o.latitude));return a!==0?a:Nt(vn(i.longitude),vn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return X_(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,u,d;const f=i.fields||{},p=o.fields||{},m=(a=f.value)===null||a===void 0?void 0:a.arrayValue,g=(l=p.value)===null||l===void 0?void 0:l.arrayValue,v=Nt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return v!==0?v:X_(m,g)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===fd.mapValue&&o===fd.mapValue)return 0;if(i===fd.mapValue)return 1;if(o===fd.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const p=Nt(l[f],d[f]);if(p!==0)return p;const m=_l(a[l[f]],u[d[f]]);if(m!==0)return m}return Nt(l.length,d.length)}(n.mapValue,e.mapValue);default:throw dt()}}function Q_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Nt(n,e);const t=yo(n),r=yo(e),s=Nt(t.seconds,r.seconds);return s!==0?s:Nt(t.nanos,r.nanos)}function X_(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=_l(t[s],r[s]);if(i)return i}return Nt(t.length,r.length)}function El(n){return Rm(n)}function Rm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=yo(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ra(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return nt.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Rm(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Rm(t.fields[o])}`;return s+"}"}(n.mapValue):dt()}function J_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function km(n){return!!n&&"integerValue"in n}function ng(n){return!!n&&"arrayValue"in n}function Z_(n){return!!n&&"nullValue"in n}function e1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jd(n){return!!n&&"mapValue"in n}function b4(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function xc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ma(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=xc(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=xc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function R4(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this.value=e}static empty(){return new kr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xc(t)}setAll(e){let t=Vn.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=xc(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];jd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){ma(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new kr(xc(this.value))}}function ZC(n){const e=[];return ma(n.fields,(t,r)=>{const s=new Vn([t]);if(jd(r)){const i=ZC(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Yr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ur(e,0,pt.min(),pt.min(),pt.min(),kr.empty(),0)}static newFoundDocument(e,t,r,s){return new ur(e,1,t,pt.min(),r,s,0)}static newNoDocument(e,t){return new ur(e,2,t,pt.min(),pt.min(),kr.empty(),0)}static newUnknownDocument(e,t){return new ur(e,3,t,pt.min(),pt.min(),kr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ur&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ur(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,t){this.position=e,this.inclusive=t}}function t1(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=nt.comparator(nt.fromName(o.referenceValue),t.key):r=_l(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function n1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Gs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t="asc"){this.field=e,this.dir=t}}function k4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{}class xn extends eA{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new N4(e,t,r):t==="array-contains"?new M4(e,r):t==="in"?new F4(e,r):t==="not-in"?new L4(e,r):t==="array-contains-any"?new U4(e,r):new xn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new O4(e,r):new D4(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(_l(t,this.value)):t!==null&&sa(this.value)===sa(t)&&this.matchesComparison(_l(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends eA{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Es(e,t)}matches(e){return tA(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function tA(n){return n.op==="and"}function nA(n){return P4(n)&&tA(n)}function P4(n){for(const e of n.filters)if(e instanceof Es)return!1;return!0}function Pm(n){if(n instanceof xn)return n.field.canonicalString()+n.op.toString()+El(n.value);if(nA(n))return n.filters.map(e=>Pm(e)).join(",");{const e=n.filters.map(t=>Pm(t)).join(",");return`${n.op}(${e})`}}function rA(n,e){return n instanceof xn?function(r,s){return s instanceof xn&&r.op===s.op&&r.field.isEqual(s.field)&&Gs(r.value,s.value)}(n,e):n instanceof Es?function(r,s){return s instanceof Es&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&rA(o,s.filters[a]),!0):!1}(n,e):void dt()}function sA(n){return n instanceof xn?function(t){return`${t.field.canonicalString()} ${t.op} ${El(t.value)}`}(n):n instanceof Es?function(t){return t.op.toString()+" {"+t.getFilters().map(sA).join(" ,")+"}"}(n):"Filter"}class N4 extends xn{constructor(e,t,r){super(e,t,r),this.key=nt.fromName(r.referenceValue)}matches(e){const t=nt.comparator(e.key,this.key);return this.matchesComparison(t)}}class O4 extends xn{constructor(e,t){super(e,"in",t),this.keys=iA("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class D4 extends xn{constructor(e,t){super(e,"not-in",t),this.keys=iA("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function iA(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>nt.fromName(r.referenceValue))}class M4 extends xn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ng(t)&&Xc(t.arrayValue,this.value)}}class F4 extends xn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xc(this.value.arrayValue,t)}}class L4 extends xn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Xc(this.value.arrayValue,t)}}class U4 extends xn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ng(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Xc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function r1(n,e=null,t=[],r=[],s=null,i=null,o=null){return new B4(n,e,t,r,s,i,o)}function rg(n){const e=gt(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Pm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),gf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>El(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>El(r)).join(",")),e.ue=t}return e.ue}function sg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!k4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!n1(n.startAt,e.startAt)&&n1(n.endAt,e.endAt)}function Nm(n){return nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function V4(n,e,t,r,s,i,o,a){return new Fl(n,e,t,r,s,i,o,a)}function vf(n){return new Fl(n)}function s1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function oA(n){return n.collectionGroup!==null}function bc(n){const e=gt(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Zn(Vn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Jc(i,r))}),t.has(Vn.keyField().canonicalString())||e.ce.push(new Jc(Vn.keyField(),r))}return e.ce}function Vs(n){const e=gt(n);return e.le||(e.le=$4(e,bc(n))),e.le}function $4(n,e){if(n.limitType==="F")return r1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Jc(s.field,i)});const t=n.endAt?new ph(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ph(n.startAt.position,n.startAt.inclusive):null;return r1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Om(n,e){const t=n.filters.concat([e]);return new Fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Dm(n,e,t){return new Fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yf(n,e){return sg(Vs(n),Vs(e))&&n.limitType===e.limitType}function aA(n){return`${rg(Vs(n))}|lt:${n.limitType}`}function Ua(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>sA(s)).join(", ")}]`),gf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>El(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>El(s)).join(",")),`Target(${r})`}(Vs(n))}; limitType=${n.limitType})`}function _f(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):nt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of bc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const u=t1(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,bc(r),s)||r.endAt&&!function(o,a,l){const u=t1(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,bc(r),s))}(n,e)}function H4(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function lA(n){return(e,t)=>{let r=!1;for(const s of bc(n)){const i=j4(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function j4(n,e,t){const r=n.field.isKeyField()?nt.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),u=a.data.field(i);return l!==null&&u!==null?_l(l,u):dt()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return dt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ma(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return XC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4=new cn(nt.comparator);function Di(){return W4}const cA=new cn(nt.comparator);function dc(...n){let e=cA;for(const t of n)e=e.insert(t.key,t);return e}function uA(n){let e=cA;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function $o(){return Rc()}function dA(){return Rc()}function Rc(){return new Ll(n=>n.toString(),(n,e)=>n.isEqual(e))}const K4=new cn(nt.comparator),q4=new Zn(nt.comparator);function At(...n){let e=q4;for(const t of n)e=e.add(t);return e}const G4=new Zn(Nt);function z4(){return G4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fh(e)?"-0":e}}function hA(n){return{integerValue:""+n}}function Y4(n,e){return I4(e)?hA(e):ig(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(){this._=void 0}}function Q4(n,e,t){return n instanceof mh?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&eg(i)&&(i=tg(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Zc?pA(n,e):n instanceof eu?mA(n,e):function(s,i){const o=fA(s,i),a=i1(o)+i1(s.Pe);return km(o)&&km(s.Pe)?hA(a):ig(s.serializer,a)}(n,e)}function X4(n,e,t){return n instanceof Zc?pA(n,e):n instanceof eu?mA(n,e):t}function fA(n,e){return n instanceof gh?function(r){return km(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class mh extends Ef{}class Zc extends Ef{constructor(e){super(),this.elements=e}}function pA(n,e){const t=gA(e);for(const r of n.elements)t.some(s=>Gs(s,r))||t.push(r);return{arrayValue:{values:t}}}class eu extends Ef{constructor(e){super(),this.elements=e}}function mA(n,e){let t=gA(e);for(const r of n.elements)t=t.filter(s=>!Gs(s,r));return{arrayValue:{values:t}}}class gh extends Ef{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function i1(n){return vn(n.integerValue||n.doubleValue)}function gA(n){return ng(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function J4(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Zc&&s instanceof Zc||r instanceof eu&&s instanceof eu?vl(r.elements,s.elements,Gs):r instanceof gh&&s instanceof gh?Gs(r.Pe,s.Pe):r instanceof mh&&s instanceof mh}(n.transform,e.transform)}class Z4{constructor(e,t){this.version=e,this.transformResults=t}}class ms{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ms}static exists(e){return new ms(void 0,e)}static updateTime(e){return new ms(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Tf{}function vA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new og(n.key,ms.none()):new Cu(n.key,n.data,ms.none());{const t=n.data,r=kr.empty();let s=new Zn(Vn.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new So(n.key,r,new Yr(s.toArray()),ms.none())}}function eM(n,e,t){n instanceof Cu?function(s,i,o){const a=s.value.clone(),l=a1(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof So?function(s,i,o){if(!Wd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=a1(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(yA(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function kc(n,e,t,r){return n instanceof Cu?function(i,o,a,l){if(!Wd(i.precondition,o))return a;const u=i.value.clone(),d=l1(i.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof So?function(i,o,a,l){if(!Wd(i.precondition,o))return a;const u=l1(i.fieldTransforms,l,o),d=o.data;return d.setAll(yA(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return Wd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function tM(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=fA(r.transform,s||null);i!=null&&(t===null&&(t=kr.empty()),t.set(r.field,i))}return t||null}function o1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&vl(r,s,(i,o)=>J4(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Cu extends Tf{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class So extends Tf{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function yA(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function a1(n,e,t){const r=new Map;Ht(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,X4(o,a,t[s]))}return r}function l1(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,Q4(i,o,e))}return r}class og extends Tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nM extends Tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&eM(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=kc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=kc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=dA();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=vA(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(pt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),At())}isEqual(e){return this.batchId===e.batchId&&vl(this.mutations,e.mutations,(t,r)=>o1(t,r))&&vl(this.baseMutations,e.baseMutations,(t,r)=>o1(t,r))}}class ag{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Ht(e.mutations.length===r.length);let s=function(){return K4}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ag(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sn,St;function oM(n){switch(n){default:return dt();case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0}}function _A(n){if(n===void 0)return Oi("GRPC error has no .code"),ke.UNKNOWN;switch(n){case Sn.OK:return ke.OK;case Sn.CANCELLED:return ke.CANCELLED;case Sn.UNKNOWN:return ke.UNKNOWN;case Sn.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case Sn.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case Sn.INTERNAL:return ke.INTERNAL;case Sn.UNAVAILABLE:return ke.UNAVAILABLE;case Sn.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case Sn.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case Sn.NOT_FOUND:return ke.NOT_FOUND;case Sn.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case Sn.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case Sn.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case Sn.ABORTED:return ke.ABORTED;case Sn.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case Sn.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case Sn.DATA_LOSS:return ke.DATA_LOSS;default:return dt()}}(St=Sn||(Sn={}))[St.OK=0]="OK",St[St.CANCELLED=1]="CANCELLED",St[St.UNKNOWN=2]="UNKNOWN",St[St.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",St[St.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",St[St.NOT_FOUND=5]="NOT_FOUND",St[St.ALREADY_EXISTS=6]="ALREADY_EXISTS",St[St.PERMISSION_DENIED=7]="PERMISSION_DENIED",St[St.UNAUTHENTICATED=16]="UNAUTHENTICATED",St[St.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",St[St.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",St[St.ABORTED=10]="ABORTED",St[St.OUT_OF_RANGE=11]="OUT_OF_RANGE",St[St.UNIMPLEMENTED=12]="UNIMPLEMENTED",St[St.INTERNAL=13]="INTERNAL",St[St.UNAVAILABLE=14]="UNAVAILABLE",St[St.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM=new zo([4294967295,4294967295],0);function c1(n){const e=aM().encode(n),t=new jC;return t.update(e),new Uint8Array(t.digest())}function u1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new zo([t,r],0),new zo([s,i],0)]}class lg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new hc(`Invalid padding: ${t}`);if(r<0)throw new hc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new hc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new hc(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=zo.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(zo.fromNumber(r)));return s.compare(lM)===1&&(s=new zo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=c1(e),[r,s]=u1(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new lg(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=c1(e),[r,s]=u1(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class hc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Au.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new wf(pt.min(),s,new cn(Nt),Di(),At())}}class Au{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Au(r,t,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class EA{constructor(e,t){this.targetId=e,this.me=t}}class TA{constructor(e,t,r=Wn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class d1{constructor(){this.fe=0,this.ge=f1(),this.pe=Wn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=At(),t=At(),r=At();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:dt()}}),new Au(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=f1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ht(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class cM{constructor(e){this.Le=e,this.Be=new Map,this.ke=Di(),this.qe=h1(),this.Qe=new cn(Nt)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:dt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Nm(i))if(r===0){const o=new nt(i.path);this.Ue(t,o,ur.newNoDocument(o,pt.min()))}else Ht(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=ra(r).toUint8Array()}catch(l){if(l instanceof JC)return na("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new lg(o,s,i)}catch(l){return na(l instanceof hc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Nm(a.target)){const l=new nt(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,ur.newNoDocument(l,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=At();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new wf(e,t,this.Qe,this.ke,r);return this.ke=Di(),this.qe=h1(),this.Qe=new cn(Nt),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new d1,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Zn(Nt),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||Ze("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new d1),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function h1(){return new cn(nt.comparator)}function f1(){return new cn(nt.comparator)}const uM={asc:"ASCENDING",desc:"DESCENDING"},dM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hM={and:"AND",or:"OR"};class fM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Mm(n,e){return n.useProto3Json||gf(e)?e:{value:e}}function vh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function pM(n,e){return vh(n,e.toTimestamp())}function $s(n){return Ht(!!n),pt.fromTimestamp(function(t){const r=yo(t);return new bn(r.seconds,r.nanos)}(n))}function cg(n,e){return Fm(n,e).canonicalString()}function Fm(n,e){const t=function(s){return new rn(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function CA(n){const e=rn.fromString(n);return Ht(bA(e)),e}function Lm(n,e){return cg(n.databaseId,e.path)}function Fp(n,e){const t=CA(e);if(t.get(1)!==n.databaseId.projectId)throw new Ye(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ye(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new nt(IA(t))}function AA(n,e){return cg(n.databaseId,e)}function mM(n){const e=CA(n);return e.length===4?rn.emptyPath():IA(e)}function Um(n){return new rn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function IA(n){return Ht(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function p1(n,e,t){return{name:Lm(n,e),fields:t.value.mapValue.fields}}function gM(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:dt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Ht(d===void 0||typeof d=="string"),Wn.fromBase64String(d||"")):(Ht(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Wn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?ke.UNKNOWN:_A(u.code);return new Ye(d,u.message||"")}(o);t=new TA(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Fp(n,r.document.name),i=$s(r.document.updateTime),o=r.document.createTime?$s(r.document.createTime):pt.min(),a=new kr({mapValue:{fields:r.document.fields}}),l=ur.newFoundDocument(s,i,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Kd(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Fp(n,r.document),i=r.readTime?$s(r.readTime):pt.min(),o=ur.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Kd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Fp(n,r.document),i=r.removedTargetIds||[];t=new Kd([],i,s,null)}else{if(!("filter"in e))return dt();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new iM(s,i),a=r.targetId;t=new EA(a,o)}}return t}function vM(n,e){let t;if(e instanceof Cu)t={update:p1(n,e.key,e.value)};else if(e instanceof og)t={delete:Lm(n,e.key)};else if(e instanceof So)t={update:p1(n,e.key,e.data),updateMask:SM(e.fieldMask)};else{if(!(e instanceof nM))return dt();t={verify:Lm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof mh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Zc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof eu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof gh)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw dt()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:pM(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:dt()}(n,e.precondition)),t}function yM(n,e){return n&&n.length>0?(Ht(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?$s(s.updateTime):$s(i);return o.isEqual(pt.min())&&(o=$s(i)),new Z4(o,s.transformResults||[])}(t,e))):[]}function _M(n,e){return{documents:[AA(n,e.path)]}}function EM(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=AA(n,s);const i=function(u){if(u.length!==0)return xA(Es.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Ba(p.field),direction:CM(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Mm(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:s}}function TM(n){let e=mM(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Ht(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const p=SA(f);return p instanceof Es&&nA(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(g){return new Jc(Va(g.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,gf(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,m=f.values||[];return new ph(m,p)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const p=!f.before,m=f.values||[];return new ph(m,p)}(t.endAt)),V4(e,s,o,i,a,"F",l,u)}function wM(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dt()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function SA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Va(t.unaryFilter.field);return xn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Va(t.unaryFilter.field);return xn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Va(t.unaryFilter.field);return xn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Va(t.unaryFilter.field);return xn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return dt()}}(n):n.fieldFilter!==void 0?function(t){return xn.create(Va(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dt()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Es.create(t.compositeFilter.filters.map(r=>SA(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return dt()}}(t.compositeFilter.op))}(n):dt()}function CM(n){return uM[n]}function AM(n){return dM[n]}function IM(n){return hM[n]}function Ba(n){return{fieldPath:n.canonicalString()}}function Va(n){return Vn.fromServerFormat(n.fieldPath)}function xA(n){return n instanceof xn?function(t){if(t.op==="=="){if(e1(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NAN"}};if(Z_(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(e1(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NOT_NAN"}};if(Z_(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ba(t.field),op:AM(t.op),value:t.value}}}(n):n instanceof Es?function(t){const r=t.getFilters().map(s=>xA(s));return r.length===1?r[0]:{compositeFilter:{op:IM(t.op),filters:r}}}(n):dt()}function SM(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function bA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,t,r,s,i=pt.min(),o=pt.min(),a=Wn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new so(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new so(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new so(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new so(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.ct=e}}function bM(n){const e=TM({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Dm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{constructor(){this.un=new kM}addToCollectionParentIndex(e,t){return this.un.add(t),Fe.resolve()}getCollectionParents(e,t){return Fe.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Fe.resolve()}deleteFieldIndex(e,t){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,t){return Fe.resolve()}getDocumentsMatchingTarget(e,t){return Fe.resolve(null)}getIndexType(e,t){return Fe.resolve(0)}getFieldIndexes(e,t){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,t){return Fe.resolve(vo.min())}getMinOffsetFromCollectionGroup(e,t){return Fe.resolve(vo.min())}updateCollectionGroup(e,t,r){return Fe.resolve()}updateIndexEntries(e,t){return Fe.resolve()}}class kM{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Zn(rn.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Zn(rn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Tl(0)}static kn(){return new Tl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(){this.changes=new Ll(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ur.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&kc(r.mutation,s,Yr.empty(),bn.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,At()).next(()=>r))}getLocalViewOfDocuments(e,t,r=At()){const s=$o();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=dc();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=$o();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,At()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Di();const o=Rc(),a=function(){return Rc()}();return t.forEach((l,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof So)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),kc(d.mutation,u,d.mutation.getFieldMask(),bn.now())):o.set(u.key,Yr.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new NM(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Rc();let s=new cn((o,a)=>o-a),i=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let d=r.get(l)||Yr.empty();d=a.applyToLocalView(u,d),r.set(l,d);const f=(s.get(a.batchId)||At()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,f=dA();d.forEach(p=>{if(!i.has(p)){const m=vA(t.get(p),r.get(p));m!==null&&f.set(p,m),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Fe.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return nt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):oA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):Fe.resolve($o());let a=-1,l=i;return o.next(u=>Fe.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?Fe.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,At())).next(d=>({batchId:a,changes:uA(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new nt(t)).next(r=>{let s=dc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=dc();return this.indexManager.getCollectionParents(e,i).next(a=>Fe.forEach(a,l=>{const u=function(f,p){return new Fl(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,ur.newInvalidDocument(d)))});let a=dc();return o.forEach((l,u)=>{const d=i.get(l);d!==void 0&&kc(d.mutation,u,Yr.empty(),bn.now()),_f(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Fe.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:$s(s.createTime)}}(t)),Fe.resolve()}getNamedQuery(e,t){return Fe.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:bM(s.bundledQuery),readTime:$s(s.readTime)}}(t)),Fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(){this.overlays=new cn(nt.comparator),this.Ir=new Map}getOverlay(e,t){return Fe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=$o();return Fe.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),Fe.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),Fe.resolve()}getOverlaysForCollection(e,t,r){const s=$o(),i=t.length+1,o=new nt(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return Fe.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new cn((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=$o(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=$o(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=s)););return Fe.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sM(t,r));let i=this.Ir.get(t);i===void 0&&(i=At(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(){this.sessionToken=Wn.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(){this.Tr=new Zn(Un.Er),this.dr=new Zn(Un.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new Un(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Un(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new nt(new rn([])),r=new Un(t,e),s=new Un(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new nt(new rn([])),r=new Un(t,e),s=new Un(t,e+1);let i=At();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Un(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Un{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return nt.comparator(e.key,t.key)||Nt(e.wr,t.wr)}static Ar(e,t){return Nt(e.wr,t.wr)||nt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Zn(Un.Er)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new rM(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new Un(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Fe.resolve(o)}lookupMutationBatch(e,t){return Fe.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return Fe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Un(t,0),s=new Un(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),Fe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(Nt);return t.forEach(s=>{const i=new Un(s,0),o=new Un(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),Fe.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;nt.isDocumentKey(i)||(i=i.child(""));const o=new Un(new nt(i),0);let a=new Zn(Nt);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(l.wr)),!0)},o),Fe.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ht(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Fe.forEach(t.mutations,s=>{const i=new Un(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new Un(t,0),s=this.br.firstAfterOrEqual(r);return Fe.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(e){this.Mr=e,this.docs=function(){return new cn(nt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Fe.resolve(r?r.document.mutableCopy():ur.newInvalidDocument(t))}getEntries(e,t){let r=Di();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ur.newInvalidDocument(s))}),Fe.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Di();const o=t.path,a=new nt(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||T4(E4(d),r)<=0||(s.has(d.key)||_f(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return Fe.resolve(i)}getAllFromCollectionGroup(e,t,r,s){dt()}Or(e,t){return Fe.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new BM(this)}getSize(e){return Fe.resolve(this.size)}}class BM extends PM{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),Fe.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(e){this.persistence=e,this.Nr=new Ll(t=>rg(t),sg),this.lastRemoteSnapshotVersion=pt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ug,this.targetCount=0,this.kr=Tl.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),Fe.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Tl(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Fe.resolve()}updateTargetData(e,t){return this.Kn(t),Fe.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),Fe.waitFor(i).next(()=>s)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return Fe.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),Fe.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),Fe.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return Fe.resolve(r)}containsKey(e,t){return Fe.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Z0(0),this.Kr=!1,this.Kr=!0,this.$r=new FM,this.referenceDelegate=e(this),this.Ur=new VM(this),this.indexManager=new RM,this.remoteDocumentCache=function(s){return new UM(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new xM(t),this.Gr=new DM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new MM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new LM(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){Ze("MemoryPersistence","Starting transaction:",e);const s=new HM(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return Fe.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class HM extends C4{constructor(e){super(),this.currentSequenceNumber=e}}class dg{constructor(e){this.persistence=e,this.Jr=new ug,this.Yr=null}static Zr(e){return new dg(e)}get Xr(){if(this.Yr)return this.Yr;throw dt()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),Fe.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),Fe.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Fe.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.Xr,r=>{const s=nt.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,pt.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return Fe.or([()=>Fe.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=At(),s=At();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hg(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return zP()?8:A4(vr())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new jM;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(ic()<=It.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Ua(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Fe.resolve()):(ic()<=It.DEBUG&&Ze("QueryEngine","Query:",Ua(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(ic()<=It.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Ua(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vs(t))):Fe.resolve())}Yi(e,t){if(s1(t))return Fe.resolve(null);let r=Vs(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Dm(t,null,"F"),r=Vs(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=At(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(t,a);return this.ns(t,u,o,l.readTime)?this.Yi(e,Dm(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,r,s){return s1(t)||s.isEqual(pt.min())?Fe.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?Fe.resolve(null):(ic()<=It.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ua(t)),this.rs(e,o,t,_4(s,-1)).next(a=>a))})}ts(e,t){let r=new Zn(lA(e));return t.forEach((s,i)=>{_f(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return ic()<=It.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Ua(t)),this.Ji.getDocumentsMatchingQuery(e,t,vo.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new cn(Nt),this._s=new Ll(i=>rg(i),sg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OM(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function qM(n,e,t,r){return new KM(n,e,t,r)}async function RA(n,e){const t=gt(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=At();for(const u of s){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of i){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function GM(n,e){const t=gt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const f=u.batch,p=f.keys();let m=Fe.resolve();return p.forEach(g=>{m=m.next(()=>d.getEntry(l,g)).next(v=>{const y=u.docVersions.get(g);Ht(y!==null),v.version.compareTo(y)<0&&(f.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),d.addEntry(v)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=At();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function kA(n){const e=gt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function zM(n,e){const t=gt(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const p=s.get(f);if(!p)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(Wn.EMPTY_BYTE_STRING,pt.min()).withLastLimboFreeSnapshotVersion(pt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(f,m),function(v,y,L){return v.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,m,d)&&a.push(t.Ur.updateTargetData(i,m))});let l=Di(),u=At();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(YM(i,o,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!r.isEqual(pt.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return Fe.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(t.os=s,i))}function YM(n,e,t){let r=At(),s=At();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Di();return t.forEach((a,l)=>{const u=i.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(pt.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Ze("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function QM(n,e){const t=gt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function XM(n,e){const t=gt(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,Fe.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new so(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function Bm(n,e,t){const r=gt(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!wu(o))throw o;Ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function m1(n,e,t){const r=gt(n);let s=pt.min(),i=At();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const f=gt(l),p=f._s.get(d);return p!==void 0?Fe.resolve(f.os.get(p)):f.Ur.getTargetData(u,d)}(r,o,Vs(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:pt.min(),t?i:At())).next(a=>(JM(r,H4(e),a),{documents:a,Ts:i})))}function JM(n,e,t){let r=n.us.get(e)||pt.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}class g1{constructor(){this.activeTargetIds=z4()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZM{constructor(){this.so=new g1,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new g1,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd=null;function Lp(){return pd===null?pd=function(){return 268435456+Math.round(2147483648*Math.random())}():pd++,"0x"+pd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="WebChannelConnection";class rF extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Lp(),l=this.xo(t,r.toUriEncodedString());Ze("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(t,l,u,s).then(d=>(Ze("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw na("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ml}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=tF[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Lp();return new Promise((o,a)=>{const l=new WC;l.setWithCredentials(!0),l.listenOnce(KC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Hd.NO_ERROR:const d=l.getResponseJson();Ze(ir,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Hd.TIMEOUT:Ze(ir,`RPC '${e}' ${i} timed out`),a(new Ye(ke.DEADLINE_EXCEEDED,"Request time out"));break;case Hd.HTTP_ERROR:const f=l.getStatus();if(Ze(ir,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const g=function(y){const L=y.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(L)>=0?L:ke.UNKNOWN}(m.status);a(new Ye(g,m.message))}else a(new Ye(ke.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Ye(ke.UNAVAILABLE,"Connection failed."));break;default:dt()}}finally{Ze(ir,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);Ze(ir,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",u,r,15)})}Bo(e,t,r){const s=Lp(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=zC(),a=GC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");Ze(ir,`Creating RPC '${e}' stream ${s}: ${d}`,l);const f=o.createWebChannel(d,l);let p=!1,m=!1;const g=new nF({Io:y=>{m?Ze(ir,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(p||(Ze(ir,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),Ze(ir,`RPC '${e}' stream ${s} sending:`,y),f.send(y))},To:()=>f.close()}),v=(y,L,D)=>{y.listen(L,A=>{try{D(A)}catch(C){setTimeout(()=>{throw C},0)}})};return v(f,uc.EventType.OPEN,()=>{m||(Ze(ir,`RPC '${e}' stream ${s} transport opened.`),g.yo())}),v(f,uc.EventType.CLOSE,()=>{m||(m=!0,Ze(ir,`RPC '${e}' stream ${s} transport closed`),g.So())}),v(f,uc.EventType.ERROR,y=>{m||(m=!0,na(ir,`RPC '${e}' stream ${s} transport errored:`,y),g.So(new Ye(ke.UNAVAILABLE,"The operation could not be completed")))}),v(f,uc.EventType.MESSAGE,y=>{var L;if(!m){const D=y.data[0];Ht(!!D);const A=D,C=A.error||((L=A[0])===null||L===void 0?void 0:L.error);if(C){Ze(ir,`RPC '${e}' stream ${s} received error:`,C);const j=C.status;let z=function(x){const b=Sn[x];if(b!==void 0)return _A(b)}(j),w=C.message;z===void 0&&(z=ke.INTERNAL,w="Unknown error status: "+j+" with message "+C.message),m=!0,g.So(new Ye(z,w)),f.close()}else Ze(ir,`RPC '${e}' stream ${s} received:`,D),g.bo(D)}}),v(a,qC.STAT_EVENT,y=>{y.stat===bm.PROXY?Ze(ir,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===bm.NOPROXY&&Ze(ir,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function Up(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(n){return new fM(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&Ze("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,t,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new PA(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===ke.RESOURCE_EXHAUSTED?(Oi(t.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new Ye(ke.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(Ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sF extends NA{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=gM(this.serializer,e),r=function(i){if(!("targetChange"in i))return pt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pt.min():o.readTime?$s(o.readTime):pt.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Um(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=Nm(l)?{documents:_M(i,l)}:{query:EM(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=wA(i,o.resumeToken);const u=Mm(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(pt.min())>0){a.readTime=vh(i,o.snapshotVersion.toTimestamp());const u=Mm(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=wM(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Um(this.serializer),t.removeTarget=e,this.a_(t)}}class iF extends NA{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ht(!!e.streamToken),this.lastStreamToken=e.streamToken,Ht(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ht(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=yM(e.writeResults,e.commitTime),r=$s(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Um(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>vM(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Ye(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Fm(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ye(ke.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Fm(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ye(ke.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class aF{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Oi(t),this.D_=!1):Ze("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{ga(this)&&(Ze("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=gt(l);u.L_.add(4),await Iu(u),u.q_.set("Unknown"),u.L_.delete(4),await Af(u)}(this))})}),this.q_=new aF(r,s)}}async function Af(n){if(ga(n))for(const e of n.B_)await e(!0)}async function Iu(n){for(const e of n.B_)await e(!1)}function OA(n,e){const t=gt(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),gg(t)?mg(t):Ul(t).r_()&&pg(t,e))}function fg(n,e){const t=gt(n),r=Ul(t);t.N_.delete(e),r.r_()&&DA(t,e),t.N_.size===0&&(r.r_()?r.o_():ga(t)&&t.q_.set("Unknown"))}function pg(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ul(n).A_(e)}function DA(n,e){n.Q_.xe(e),Ul(n).R_(e)}function mg(n){n.Q_=new cM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Ul(n).start(),n.q_.v_()}function gg(n){return ga(n)&&!Ul(n).n_()&&n.N_.size>0}function ga(n){return gt(n).L_.size===0}function MA(n){n.Q_=void 0}async function cF(n){n.q_.set("Online")}async function uF(n){n.N_.forEach((e,t)=>{pg(n,e)})}async function dF(n,e){MA(n),gg(n)?(n.q_.M_(e),mg(n)):n.q_.set("Unknown")}async function hF(n,e,t){if(n.q_.set("Online"),e instanceof TA&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){Ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await yh(n,r)}else if(e instanceof Kd?n.Q_.Ke(e):e instanceof EA?n.Q_.He(e):n.Q_.We(e),!t.isEqual(pt.min()))try{const r=await kA(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=i.N_.get(l);if(!d)return;i.N_.set(l,d.withResumeToken(Wn.EMPTY_BYTE_STRING,d.snapshotVersion)),DA(i,l);const f=new so(d.target,l,u,d.sequenceNumber);pg(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){Ze("RemoteStore","Failed to raise snapshot:",r),await yh(n,r)}}async function yh(n,e,t){if(!wu(e))throw e;n.L_.add(1),await Iu(n),n.q_.set("Offline"),t||(t=()=>kA(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Ze("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Af(n)})}function FA(n,e){return e().catch(t=>yh(n,t,e))}async function If(n){const e=gt(n),t=_o(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;fF(e);)try{const s=await QM(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,pF(e,s)}catch(s){await yh(e,s)}LA(e)&&UA(e)}function fF(n){return ga(n)&&n.O_.length<10}function pF(n,e){n.O_.push(e);const t=_o(n);t.r_()&&t.V_&&t.m_(e.mutations)}function LA(n){return ga(n)&&!_o(n).n_()&&n.O_.length>0}function UA(n){_o(n).start()}async function mF(n){_o(n).p_()}async function gF(n){const e=_o(n);for(const t of n.O_)e.m_(t.mutations)}async function vF(n,e,t){const r=n.O_.shift(),s=ag.from(r,e,t);await FA(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await If(n)}async function yF(n,e){e&&_o(n).V_&&await async function(r,s){if(function(o){return oM(o)&&o!==ke.ABORTED}(s.code)){const i=r.O_.shift();_o(r).s_(),await FA(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await If(r)}}(n,e),LA(n)&&UA(n)}async function y1(n,e){const t=gt(n);t.asyncQueue.verifyOperationInProgress(),Ze("RemoteStore","RemoteStore received new credentials");const r=ga(t);t.L_.add(3),await Iu(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Af(t)}async function _F(n,e){const t=gt(n);e?(t.L_.delete(2),await Af(t)):e||(t.L_.add(2),await Iu(t),t.q_.set("Unknown"))}function Ul(n){return n.K_||(n.K_=function(t,r,s){const i=gt(t);return i.w_(),new sF(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:cF.bind(null,n),Ro:uF.bind(null,n),mo:dF.bind(null,n),d_:hF.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),gg(n)?mg(n):n.q_.set("Unknown")):(await n.K_.stop(),MA(n))})),n.K_}function _o(n){return n.U_||(n.U_=function(t,r,s){const i=gt(t);return i.w_(),new iF(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:mF.bind(null,n),mo:yF.bind(null,n),f_:gF.bind(null,n),g_:vF.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await If(n)):(await n.U_.stop(),n.O_.length>0&&(Ze("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new wi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new vg(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ye(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yg(n,e){if(Oi("AsyncQueue",`${e}: ${n}`),wu(n))return new Ye(ke.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e){this.comparator=e?(t,r)=>e(t,r)||nt.comparator(t.key,r.key):(t,r)=>nt.comparator(t.key,r.key),this.keyedMap=dc(),this.sortedSet=new cn(this.comparator)}static emptySet(e){return new il(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof il)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new il;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(){this.W_=new cn(nt.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):dt():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class wl{constructor(e,t,r,s,i,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new wl(e,t,il.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class TF{constructor(){this.queries=E1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=gt(t),i=s.queries;s.queries=E1(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new Ye(ke.ABORTED,"Firestore shutting down"))}}function E1(){return new Ll(n=>aA(n),yf)}async function _g(n,e){const t=gt(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new EF,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=yg(o,`Initialization of query '${Ua(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&Tg(t)}async function Eg(n,e){const t=gt(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function wF(n,e){const t=gt(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&Tg(t)}function CF(n,e,t){const r=gt(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function Tg(n){n.Y_.forEach(e=>{e.next()})}var Vm,T1;(T1=Vm||(Vm={})).ea="default",T1.Cache="cache";class wg{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new wl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=wl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Vm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e){this.key=e}}class VA{constructor(e){this.key=e}}class AF{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=At(),this.mutatedKeys=At(),this.Aa=lA(e),this.Ra=new il(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new _1,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const p=s.get(d),m=_f(this.query,f)?f:null,g=!!p&&this.mutatedKeys.has(p.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let y=!1;p&&m?p.data.isEqual(m.data)?g!==v&&(r.track({type:3,doc:m}),y=!0):this.ga(p,m)||(r.track({type:2,doc:m}),y=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(a=!0)):!p&&m?(r.track({type:0,doc:m}),y=!0):p&&!m&&(r.track({type:1,doc:p}),y=!0,(l||u)&&(a=!0)),y&&(m?(o=o.add(m),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(m,g){const v=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt()}};return v(m)-v(g)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new wl(this.query,e.Ra,i,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new _1,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=At(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new VA(r))}),this.da.forEach(r=>{e.has(r)||t.push(new BA(r))}),t}ba(e){this.Ta=e.Ts,this.da=At();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return wl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class IF{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class SF{constructor(e){this.key=e,this.va=!1}}class xF{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ll(a=>aA(a),yf),this.Ma=new Map,this.xa=new Set,this.Oa=new cn(nt.comparator),this.Na=new Map,this.La=new ug,this.Ba={},this.ka=new Map,this.qa=Tl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function bF(n,e,t=!0){const r=qA(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await $A(r,e,t,!0),s}async function RF(n,e){const t=qA(n);await $A(t,e,!0,!1)}async function $A(n,e,t,r){const s=await XM(n.localStore,Vs(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await kF(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&OA(n.remoteStore,s),a}async function kF(n,e,t,r,s){n.Ka=(f,p,m)=>async function(v,y,L,D){let A=y.view.ma(L);A.ns&&(A=await m1(v.localStore,y.query,!1).then(({documents:w})=>y.view.ma(w,A)));const C=D&&D.targetChanges.get(y.targetId),j=D&&D.targetMismatches.get(y.targetId)!=null,z=y.view.applyChanges(A,v.isPrimaryClient,C,j);return C1(v,y.targetId,z.wa),z.snapshot}(n,f,p,m);const i=await m1(n.localStore,e,!0),o=new AF(e,i.Ts),a=o.ma(i.documents),l=Au.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),u=o.applyChanges(a,n.isPrimaryClient,l);C1(n,t,u.wa);const d=new IF(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function PF(n,e,t){const r=gt(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!yf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Bm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&fg(r.remoteStore,s.targetId),$m(r,s.targetId)}).catch(Tu)):($m(r,s.targetId),await Bm(r.localStore,s.targetId,!0))}async function NF(n,e){const t=gt(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),fg(t.remoteStore,r.targetId))}async function OF(n,e,t){const r=VF(n);try{const s=await function(o,a){const l=gt(o),u=bn.now(),d=a.reduce((m,g)=>m.add(g.key),At());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Di(),v=At();return l.cs.getEntries(m,d).next(y=>{g=y,g.forEach((L,D)=>{D.isValidDocument()||(v=v.add(L))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,g)).next(y=>{f=y;const L=[];for(const D of a){const A=tM(D,f.get(D.key).overlayedDocument);A!=null&&L.push(new So(D.key,A,ZC(A.value.mapValue),ms.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,L,a)}).next(y=>{p=y;const L=y.applyToLocalDocumentSet(f,v);return l.documentOverlayCache.saveOverlays(m,y.batchId,L)})}).then(()=>({batchId:p.batchId,changes:uA(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new cn(Nt)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,t),await Su(r,s.changes),await If(r.remoteStore)}catch(s){const i=yg(s,"Failed to persist write");t.reject(i)}}async function HA(n,e){const t=gt(n);try{const r=await zM(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(Ht(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Ht(o.va):s.removedDocuments.size>0&&(Ht(o.va),o.va=!1))}),await Su(t,r,e)}catch(r){await Tu(r)}}function w1(n,e,t){const r=gt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=gt(o);l.onlineState=a;let u=!1;l.queries.forEach((d,f)=>{for(const p of f.j_)p.Z_(a)&&(u=!0)}),u&&Tg(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function DF(n,e,t){const r=gt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new cn(nt.comparator);o=o.insert(i,ur.newNoDocument(i,pt.min()));const a=At().add(i),l=new wf(pt.min(),new Map,new cn(Nt),o,a);await HA(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),Cg(r)}else await Bm(r.localStore,e,!1).then(()=>$m(r,e,t)).catch(Tu)}async function MF(n,e){const t=gt(n),r=e.batch.batchId;try{const s=await GM(t.localStore,e);WA(t,r,null),jA(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Su(t,s)}catch(s){await Tu(s)}}async function FF(n,e,t){const r=gt(n);try{const s=await function(o,a){const l=gt(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(Ht(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);WA(r,e,t),jA(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Su(r,s)}catch(s){await Tu(s)}}function jA(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function WA(n,e,t){const r=gt(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function $m(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||KA(n,r)})}function KA(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(fg(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Cg(n))}function C1(n,e,t){for(const r of t)r instanceof BA?(n.La.addReference(r.key,e),LF(n,r)):r instanceof VA?(Ze("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||KA(n,r.key)):dt()}function LF(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(Ze("SyncEngine","New document in limbo: "+t),n.xa.add(r),Cg(n))}function Cg(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new nt(rn.fromString(e)),r=n.qa.next();n.Na.set(r,new SF(t)),n.Oa=n.Oa.insert(t,r),OA(n.remoteStore,new so(Vs(vf(t.path)),r,"TargetPurposeLimboResolution",Z0.oe))}}async function Su(n,e,t){const r=gt(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){s.push(u);const f=hg.Wi(l.targetId,u);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,u){const d=gt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Fe.forEach(u,p=>Fe.forEach(p.$i,m=>d.persistence.referenceDelegate.addReference(f,p.targetId,m)).next(()=>Fe.forEach(p.Ui,m=>d.persistence.referenceDelegate.removeReference(f,p.targetId,m)))))}catch(f){if(!wu(f))throw f;Ze("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const m=d.os.get(p),g=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(g);d.os=d.os.insert(p,v)}}}(r.localStore,i))}async function UF(n,e){const t=gt(n);if(!t.currentUser.isEqual(e)){Ze("SyncEngine","User change. New user:",e.toKey());const r=await RA(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new Ye(ke.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Su(t,r.hs)}}function BF(n,e){const t=gt(n),r=t.Na.get(e);if(r&&r.va)return At().add(r.key);{let s=At();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}function qA(n){const e=gt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=HA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DF.bind(null,e),e.Ca.d_=wF.bind(null,e.eventManager),e.Ca.$a=CF.bind(null,e.eventManager),e}function VF(n){const e=gt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FF.bind(null,e),e}class _h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return qM(this.persistence,new WM,e.initialUser,this.serializer)}Ga(e){return new $M(dg.Zr,this.serializer)}Wa(e){return new ZM}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_h.provider={build:()=>new _h};class Hm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>w1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=UF.bind(null,this.syncEngine),await _F(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new TF}()}createDatastore(e){const t=Cf(e.databaseInfo.databaseId),r=function(i){return new rF(i)}(e.databaseInfo);return function(i,o,a,l){return new oF(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new lF(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>w1(this.syncEngine,t,0),function(){return v1.D()?new v1:new eF}())}createSyncEngine(e,t){return function(s,i,o,a,l,u,d){const f=new xF(s,i,o,a,l,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=gt(s);Ze("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Iu(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Hm.provider={build:()=>new Hm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Oi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $F{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=lr.UNAUTHENTICATED,this.clientId=J0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Ze("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Ze("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=yg(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Bp(n,e){n.asyncQueue.verifyOperationInProgress(),Ze("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await RA(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function A1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await HF(n);Ze("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>y1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>y1(e.remoteStore,s)),n._onlineComponents=e}async function HF(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ze("FirestoreClient","Using user provided OfflineComponentProvider");try{await Bp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===ke.FAILED_PRECONDITION||s.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;na("Error using user provided cache. Falling back to memory cache: "+t),await Bp(n,new _h)}}else Ze("FirestoreClient","Using default OfflineComponentProvider"),await Bp(n,new _h);return n._offlineComponents}async function GA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ze("FirestoreClient","Using user provided OnlineComponentProvider"),await A1(n,n._uninitializedComponentsProvider._online)):(Ze("FirestoreClient","Using default OnlineComponentProvider"),await A1(n,new Hm))),n._onlineComponents}function jF(n){return GA(n).then(e=>e.syncEngine)}async function Eh(n){const e=await GA(n),t=e.eventManager;return t.onListen=bF.bind(null,e.syncEngine),t.onUnlisten=PF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=RF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=NF.bind(null,e.syncEngine),t}function WF(n,e,t={}){const r=new wi;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const d=new Ag({next:p=>{d.Za(),o.enqueueAndForget(()=>Eg(i,f));const m=p.docs.has(a);!m&&p.fromCache?u.reject(new Ye(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?u.reject(new Ye(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new wg(vf(a.path),d,{includeMetadataChanges:!0,_a:!0});return _g(i,f)}(await Eh(n),n.asyncQueue,e,t,r)),r.promise}function KF(n,e,t={}){const r=new wi;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const d=new Ag({next:p=>{d.Za(),o.enqueueAndForget(()=>Eg(i,f)),p.fromCache&&l.source==="server"?u.reject(new Ye(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new wg(a,d,{includeMetadataChanges:!0,_a:!0});return _g(i,f)}(await Eh(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YA(n,e,t){if(!t)throw new Ye(ke.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function QA(n,e,t,r){if(e===!0&&r===!0)throw new Ye(ke.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function S1(n){if(!nt.isDocumentKey(n))throw new Ye(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function x1(n){if(nt.isDocumentKey(n))throw new Ye(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Sf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":dt()}function Nr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ye(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Sf(n);throw new Ye(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Ye(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ye(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ye(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ye(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ye(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xf{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ye(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ye(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new QC;switch(r.type){case"firstParty":return new p4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ye(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=I1.get(t);r&&(Ze("ComponentProvider","Removing Datastore"),I1.delete(t),r.terminate())}(this),Promise.resolve()}}function XA(n,e,t,r={}){var s;const i=(n=Nr(n,xf))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&na("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=lr.MOCK_USER;else{a=$P(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Ye(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new lr(u)}n._authCredentials=new d4(new YC(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Bi(this.firestore,e,this._query)}}class er{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new er(this.firestore,e,this._key)}}class Ci extends Bi{constructor(e,t,r){super(e,t,vf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new er(this.firestore,null,new nt(e))}withConverter(e){return new Ci(this.firestore,e,this._path)}}function Yt(n,e,...t){if(n=En(n),YA("collection","path",e),n instanceof xf){const r=rn.fromString(e,...t);return x1(r),new Ci(n,null,r)}{if(!(n instanceof er||n instanceof Ci))throw new Ye(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(rn.fromString(e,...t));return x1(r),new Ci(n.firestore,null,r)}}function Hs(n,e,...t){if(n=En(n),arguments.length===1&&(e=J0.newId()),YA("doc","path",e),n instanceof xf){const r=rn.fromString(e,...t);return S1(r),new er(n,null,new nt(r))}{if(!(n instanceof er||n instanceof Ci))throw new Ye(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(rn.fromString(e,...t));return S1(r),new er(n.firestore,n instanceof Ci?n.converter:null,new nt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new PA(this,"async_queue_retry"),this.Vu=()=>{const r=Up();r&&Ze("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Up();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Up();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new wi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!wu(e))throw e;Ze("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Oi("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=vg.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&dt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function k1(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class Mi extends xf{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new R1,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new R1(e),this._firestoreClient=void 0,await e}}}function Ig(n,e){const t=typeof n=="object"?n:V0(),r=typeof n=="string"?n:"(default)",s=hf(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=rC("firestore");i&&XA(s,...i)}return s}function xu(n){if(n._terminated)throw new Ye(ke.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||qF(n),n._firestoreClient}function qF(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,u,d){return new x4(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,zA(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new $F(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ia(Wn.fromBase64String(e))}catch(t){throw new Ye(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ia(Wn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ye(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ye(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ye(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Nt(this._lat,e._lat)||Nt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF=/^__.*__$/;class zF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new So(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cu(e,this.data,t,this.fieldTransforms)}}class JA{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new So(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ZA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt()}}class Sg{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Sg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Th(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ZA(this.Cu)&&GF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class YF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Cf(e)}Qu(e,t,r,s=!1){return new Sg({Cu:e,methodName:t,qu:r,path:Vn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xg(n){const e=n._freezeSettings(),t=Cf(n._databaseId);return new YF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function QF(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);bg("Data must be an object, but it was:",o,r);const a=eI(r,o);let l,u;if(i.merge)l=new Yr(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const p=jm(e,f,t);if(!o.contains(p))throw new Ye(ke.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);nI(d,p)||d.push(p)}l=new Yr(d),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new zF(new kr(a),l,u)}class Pf extends bf{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pf}}function XF(n,e,t,r){const s=n.Qu(1,e,t);bg("Data must be an object, but it was:",s,r);const i=[],o=kr.empty();ma(r,(l,u)=>{const d=Rg(e,l,t);u=En(u);const f=s.Nu(d);if(u instanceof Pf)i.push(d);else{const p=Ru(u,f);p!=null&&(i.push(d),o.set(d,p))}});const a=new Yr(i);return new JA(o,a,s.fieldTransforms)}function JF(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[jm(e,r,t)],l=[s];if(i.length%2!=0)throw new Ye(ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(jm(e,i[p])),l.push(i[p+1]);const u=[],d=kr.empty();for(let p=a.length-1;p>=0;--p)if(!nI(u,a[p])){const m=a[p];let g=l[p];g=En(g);const v=o.Nu(m);if(g instanceof Pf)u.push(m);else{const y=Ru(g,v);y!=null&&(u.push(m),d.set(m,y))}}const f=new Yr(u);return new JA(d,f,o.fieldTransforms)}function ZF(n,e,t,r=!1){return Ru(t,n.Qu(r?4:3,e))}function Ru(n,e){if(tI(n=En(n)))return bg("Unsupported field value:",e,n),eI(n,e);if(n instanceof bf)return function(r,s){if(!ZA(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Ru(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=En(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Y4(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=bn.fromDate(r);return{timestampValue:vh(s.serializer,i)}}if(r instanceof bn){const i=new bn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vh(s.serializer,i)}}if(r instanceof Rf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ia)return{bytesValue:wA(s.serializer,r._byteString)};if(r instanceof er){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:cg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof kf)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return ig(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Sf(r)}`)}(n,e)}function eI(n,e){const t={};return XC(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ma(n,(r,s)=>{const i=Ru(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function tI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof bn||n instanceof Rf||n instanceof ia||n instanceof er||n instanceof bf||n instanceof kf)}function bg(n,e,t){if(!tI(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Sf(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function jm(n,e,t){if((e=En(e))instanceof bu)return e._internalPath;if(typeof e=="string")return Rg(n,e);throw Th("Field path arguments must be of type string or ",n,!1,void 0,t)}const eL=new RegExp("[~\\*/\\[\\]]");function Rg(n,e,t){if(e.search(eL)>=0)throw Th(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bu(...e.split("."))._internalPath}catch{throw Th(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Th(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new Ye(ke.INVALID_ARGUMENT,a+n+l)}function nI(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new er(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new tL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Nf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class tL extends rI{data(){return super.data()}}function Nf(n,e){return typeof e=="string"?Rg(n,e):e instanceof bu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ye(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kg{}class Pg extends kg{}function xr(n,e,...t){let r=[];e instanceof kg&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof Of).length,a=i.filter(l=>l instanceof ku).length;if(o>1||o>0&&a>0)throw new Ye(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class ku extends Pg{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ku(e,t,r)}_apply(e){const t=this._parse(e);return iI(e._query,t),new Bi(e.firestore,e.converter,Om(e._query,t))}_parse(e){const t=xg(e.firestore);return function(i,o,a,l,u,d,f){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ye(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){N1(f,d);const m=[];for(const g of f)m.push(P1(l,i,g));p={arrayValue:{values:m}}}else p=P1(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||N1(f,d),p=ZF(a,o,f,d==="in"||d==="not-in");return xn.create(u,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ir(n,e,t){const r=e,s=Nf("where",n);return ku._create(s,r,t)}class Of extends kg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Of(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Es.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)iI(o,l),o=Om(o,l)}(e._query,t),new Bi(e.firestore,e.converter,Om(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Df extends Pg{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Df(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new Ye(ke.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ye(ke.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jc(i,o)}(e._query,this._field,this._direction);return new Bi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Fl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function Ng(n,e="asc"){const t=e,r=Nf("orderBy",n);return Df._create(r,t)}function P1(n,e,t){if(typeof(t=En(t))=="string"){if(t==="")throw new Ye(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!oA(e)&&t.indexOf("/")!==-1)throw new Ye(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(rn.fromString(t));if(!nt.isDocumentKey(r))throw new Ye(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return J_(n,new nt(r))}if(t instanceof er)return J_(n,t._key);throw new Ye(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sf(t)}.`)}function N1(n,e){if(!Array.isArray(n)||n.length===0)throw new Ye(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iI(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ye(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ye(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class oI{convertValue(e,t="none"){switch(sa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ra(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw dt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ma(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>vn(o.doubleValue));return new kf(i)}convertGeoPoint(e){return new Rf(vn(e.latitude),vn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=tg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Qc(e));default:return null}}convertTimestamp(e){const t=yo(e);return new bn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=rn.fromString(e);Ht(bA(r));const s=new yl(r.get(1),r.get(3)),i=new nt(r.popFirst(5));return s.isEqual(t)||Oi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nL(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Og extends rI{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Pc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Nf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Pc extends Og{data(e={}){return super.data(e)}}class Dg{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new za(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Pc(this._firestore,this._userDataWriter,r.key,r,new za(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ye(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Pc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new za(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Pc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new za(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:rL(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function rL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mf(n){n=Nr(n,er);const e=Nr(n.firestore,Mi);return WF(xu(e),n._key).then(t=>lI(e,n,t))}class Mg extends oI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ia(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new er(this.firestore,null,t)}}function Zt(n){n=Nr(n,Bi);const e=Nr(n.firestore,Mi),t=xu(e),r=new Mg(e);return sI(n._query),KF(t,n._query).then(s=>new Dg(e,r,n,s))}function Fg(n,e,t){n=Nr(n,er);const r=Nr(n.firestore,Mi),s=nL(n.converter,e,t);return Lf(r,[QF(xg(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,ms.none())])}function Ff(n,e,t,...r){n=Nr(n,er);const s=Nr(n.firestore,Mi),i=xg(s);let o;return o=typeof(e=En(e))=="string"||e instanceof bu?JF(i,"updateDoc",n._key,e,t,r):XF(i,"updateDoc",n._key,e),Lf(s,[o.toMutation(n._key,ms.exists(!0))])}function sL(n){return Lf(Nr(n.firestore,Mi),[new og(n._key,ms.none())])}function aI(n,...e){var t,r,s;n=En(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||k1(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(k1(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,u,d;if(n instanceof er)u=Nr(n.firestore,Mi),d=vf(n._key.path),l={next:f=>{e[o]&&e[o](lI(u,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Nr(n,Bi);u=Nr(f.firestore,Mi),d=f._query;const p=new Mg(u);l={next:m=>{e[o]&&e[o](new Dg(u,p,f,m))},error:e[o+1],complete:e[o+2]},sI(n._query)}return function(p,m,g,v){const y=new Ag(v),L=new wg(m,y,g);return p.asyncQueue.enqueueAndForget(async()=>_g(await Eh(p),L)),()=>{y.Za(),p.asyncQueue.enqueueAndForget(async()=>Eg(await Eh(p),L))}}(xu(u),d,a,l)}function Lf(n,e){return function(r,s){const i=new wi;return r.asyncQueue.enqueueAndForget(async()=>OF(await jF(r),s,i)),i.promise}(xu(n),e)}function lI(n,e,t){const r=t.docs.get(e._key),s=new Mg(n);return new Og(n,s,e._key,r,new za(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Ml=s})(Ol),Zo(new mo("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Mi(new h4(r.getProvider("auth-internal")),new g4(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Ye(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yl(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Us(G_,"4.7.3",e),Us(G_,"4.7.3","esm2017")})();const O1=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:oI,Bytes:ia,CollectionReference:Ci,DocumentReference:er,DocumentSnapshot:Og,FieldPath:bu,FieldValue:bf,Firestore:Mi,FirestoreError:Ye,GeoPoint:Rf,Query:Bi,QueryCompositeFilterConstraint:Of,QueryConstraint:Pg,QueryDocumentSnapshot:Pc,QueryFieldFilterConstraint:ku,QueryOrderByConstraint:Df,QuerySnapshot:Dg,SnapshotMetadata:za,Timestamp:bn,VectorValue:kf,_AutoId:J0,_ByteString:Wn,_DatabaseId:yl,_DocumentKey:nt,_EmptyAuthCredentialsProvider:QC,_FieldPath:Vn,_cast:Nr,_logWarn:na,_validateIsNotUsedTogether:QA,collection:Yt,connectFirestoreEmulator:XA,deleteDoc:sL,doc:Hs,ensureFirestoreConfigured:xu,executeWrite:Lf,getDoc:Mf,getDocs:Zt,getFirestore:Ig,onSnapshot:aI,orderBy:Ng,query:xr,setDoc:Fg,updateDoc:Ff,where:Ir},Symbol.toStringTag,{value:"Module"}));var iL="firebase",oL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Us(iL,oL,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL="type.googleapis.com/google.protobuf.Int64Value",lL="type.googleapis.com/google.protobuf.UInt64Value";function cI(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function Wm(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Wm(e));if(typeof n=="function"||typeof n=="object")return cI(n,e=>Wm(e));throw new Error("Data cannot be encoded in JSON: "+n)}function wh(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case aL:case lL:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>wh(e)):typeof n=="function"||typeof n=="object"?cI(n,e=>wh(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ol extends Xs{constructor(e,t,r){super(`${Lg}/${e}`,t||""),this.details=r}}function cL(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function uL(n,e){let t=cL(n),r=t,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!D1[o])return new ol("internal","internal");t=D1[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=wh(s))}}catch{}return t==="ok"?null:new ol(t,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||t.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="us-central1";function hL(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new ol("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class fL{constructor(e,t,r,s,i=Km,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new dL(t,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=Km}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function pL(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}function mL(n,e,t){return r=>vL(n,e,r,{})}async function gL(n,e,t,r){t["Content-Type"]="application/json";let s;try{s=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function vL(n,e,t,r){const s=n._url(e);return yL(n,s,t,r)}async function yL(n,e,t,r){t=Wm(t);const s={data:t},i={},o=await n.contextProvider.getContext(r.limitedUseAppCheckTokens);o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=r.timeout||7e4,l=hL(a),u=await Promise.race([gL(e,s,i,n.fetchImpl),l.promise,n.cancelAllRequests]);if(l.cancel(),!u)throw new ol("cancelled","Firebase Functions instance was deleted.");const d=uL(u.status,u.json);if(d)throw d;if(!u.json)throw new ol("internal","Response is not valid JSON object.");let f=u.json.data;if(typeof f>"u"&&(f=u.json.result),typeof f>"u")throw new ol("internal","Response is missing data field.");return{data:wh(f)}}const M1="@firebase/functions",F1="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L="auth-internal",EL="app-check-internal",TL="messaging-internal";function wL(n,e){const t=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(_L),a=r.getProvider(TL),l=r.getProvider(EL);return new fL(i,o,a,l,s,n)};Zo(new mo(Lg,t,"PUBLIC").setMultipleInstances(!0)),Us(M1,F1,e),Us(M1,F1,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(n=V0(),e=Km){const r=hf(En(n),Lg).getImmediate({identifier:e}),s=rC("functions");return s&&AL(r,...s),r}function AL(n,e,t){pL(En(n),e,t)}function uI(n,e,t){return mL(En(n),e)}wL(fetch.bind(self));const IL={apiKey:"AIzaSyCizwhrXubtiUaasWh8y-9u-plTltyT3v0",authDomain:"munkh-zaisan.firebaseapp.com",projectId:"munkh-zaisan",storageBucket:"munkh-zaisan.firebasestorage.app",messagingSenderId:"168681350058",appId:"1:168681350058:web:a6f34f9e5ee6362b2e01d3",measurementId:"G-BEWRJ14YC5"},Ug=lC(IL),$a=c4(Ug),Ct=Ig(Ug),dI=CL(Ug),SL=new pi;/*! @azure/msal-common v14.16.1 2025-08-05 */const Ae={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},md={CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},Bl=[Ae.OPENID_SCOPE,Ae.PROFILE_SCOPE,Ae.OFFLINE_ACCESS_SCOPE],L1=[...Bl,Ae.EMAIL_SCOPE],wr={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},Ln={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},ho={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},gd={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Bn={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},U1={PLAIN:"plain",S256:"S256"},Pu={QUERY:"query",FRAGMENT:"fragment"},xL={...Pu},hI={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},vd={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},dr={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},ht={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},Bg="appmetadata",bL="client_info",Nc="1",Ch={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Vr={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Gn={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Kt={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Oc={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},B1={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},V1={username:"username",password:"password"},yd={httpSuccess:200,httpBadRequest:400},Oa={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Vp={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Qi={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},RL={Pop:"pop"},kL=300;/*! @azure/msal-common v14.16.1 2025-08-05 */const Vg="unexpected_error",PL="post_request_failed";/*! @azure/msal-common v14.16.1 2025-08-05 */const $1={[Vg]:"Unexpected error in authentication.",[PL]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class sn extends Error{constructor(e,t,r){const s=t?`${e}: ${t}`:e;super(s),Object.setPrototypeOf(this,sn.prototype),this.errorCode=e||Ae.EMPTY_STRING,this.errorMessage=t||Ae.EMPTY_STRING,this.subError=r||Ae.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function fI(n,e){return new sn(n,e?`${$1[n]} ${e}`:$1[n])}/*! @azure/msal-common v14.16.1 2025-08-05 */const $g="client_info_decoding_error",pI="client_info_empty_error",Hg="token_parsing_error",mI="null_or_empty_token",ui="endpoints_resolution_error",gI="network_error",vI="openid_config_error",yI="hash_not_deserialized",Cl="invalid_state",_I="state_mismatch",Ah="state_not_found",EI="nonce_mismatch",jg="auth_time_not_found",TI="max_age_transpired",NL="multiple_matching_tokens",OL="multiple_matching_accounts",wI="multiple_matching_appMetadata",CI="request_cannot_be_made",AI="cannot_remove_empty_scope",II="cannot_append_scopeset",qm="empty_input_scopeset",DL="device_code_polling_cancelled",ML="device_code_expired",FL="device_code_unknown_error",Wg="no_account_in_silent_request",SI="invalid_cache_record",Kg="invalid_cache_environment",Gm="no_account_found",zm="no_crypto_object",Ym="unexpected_credential_type",LL="invalid_assertion",UL="invalid_client_credential",yi="token_refresh_required",BL="user_timeout_reached",xI="token_claims_cnf_required_for_signedjwt",bI="authorization_code_missing_from_server_response",VL="binding_key_not_removed",RI="end_session_endpoint_not_supported",qg="key_id_missing",$L="no_network_connectivity",HL="user_canceled",jL="missing_tenant_id_error",Tt="method_not_implemented",WL="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.16.1 2025-08-05 */const H1={[$g]:"The client info could not be parsed/decoded correctly",[pI]:"The client info was empty",[Hg]:"Token cannot be parsed",[mI]:"The token is null or empty",[ui]:"Endpoints cannot be resolved",[gI]:"Network request failed",[vI]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[yI]:"The hash parameters could not be deserialized",[Cl]:"State was not the expected format",[_I]:"State mismatch error",[Ah]:"State not found",[EI]:"Nonce mismatch error",[jg]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[TI]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[NL]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[OL]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[wI]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[CI]:"Token request cannot be made without authorization code or refresh token.",[AI]:"Cannot remove null or empty scope from ScopeSet",[II]:"Cannot append ScopeSet",[qm]:"Empty input ScopeSet cannot be processed",[DL]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[ML]:"Device code is expired.",[FL]:"Device code stopped polling for unknown reasons.",[Wg]:"Please pass an account object, silent flow is not supported without account information",[SI]:"Cache record object was null or undefined.",[Kg]:"Invalid environment when attempting to create cache entry",[Gm]:"No account found in cache for given key.",[zm]:"No crypto object detected.",[Ym]:"Unexpected credential type.",[LL]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[UL]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[yi]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[BL]:"User defined timeout for device code polling reached",[xI]:"Cannot generate a POP jwt if the token_claims are not populated",[bI]:"Server response does not contain an authorization code to proceed",[VL]:"Could not remove the credential's binding key from storage.",[RI]:"The provided authority does not support logout",[qg]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[$L]:"No network connectivity. Check your internet connection.",[HL]:"User cancelled the flow.",[jL]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Tt]:"This method has not been implemented",[WL]:"The nested app auth bridge is disabled"};class Uf extends sn{constructor(e,t){super(e,t?`${H1[e]}: ${t}`:H1[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Uf.prototype)}}function Ue(n,e){return new Uf(n,e)}/*! @azure/msal-common v14.16.1 2025-08-05 */const Ih={createNewGuid:()=>{throw Ue(Tt)},base64Decode:()=>{throw Ue(Tt)},base64Encode:()=>{throw Ue(Tt)},base64UrlEncode:()=>{throw Ue(Tt)},encodeKid:()=>{throw Ue(Tt)},async getPublicKeyThumbprint(){throw Ue(Tt)},async removeTokenBindingKey(){throw Ue(Tt)},async clearKeystore(){throw Ue(Tt)},async signJwt(){throw Ue(Tt)},async hashString(){throw Ue(Tt)}};/*! @azure/msal-common v14.16.1 2025-08-05 */var ln;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(ln||(ln={}));class Eo{constructor(e,t,r){this.level=ln.Info;const s=()=>{},i=e||Eo.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||s,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:ln.Info,this.correlationId=i.correlationId||Ae.EMPTY_STRING,this.packageName=t||Ae.EMPTY_STRING,this.packageVersion=r||Ae.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ln.Info}}clone(e,t,r){return new Eo({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${ln[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:ln.Error,containsPii:!1,correlationId:t||Ae.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:ln.Error,containsPii:!0,correlationId:t||Ae.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:ln.Warning,containsPii:!1,correlationId:t||Ae.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:ln.Warning,containsPii:!0,correlationId:t||Ae.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:ln.Info,containsPii:!1,correlationId:t||Ae.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:ln.Info,containsPii:!0,correlationId:t||Ae.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:ln.Verbose,containsPii:!1,correlationId:t||Ae.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:ln.Verbose,containsPii:!0,correlationId:t||Ae.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:ln.Trace,containsPii:!1,correlationId:t||Ae.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:ln.Trace,containsPii:!0,correlationId:t||Ae.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.16.1 2025-08-05 */const kI="@azure/msal-common",Gg="14.16.1";/*! @azure/msal-common v14.16.1 2025-08-05 */const zg={None:"none"};/*! @azure/msal-common v14.16.1 2025-08-05 */function va(n,e){const t=KL(n);try{const r=e(t);return JSON.parse(r)}catch{throw Ue(Hg)}}function KL(n){if(!n)throw Ue(mI);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw Ue(Hg);return t[2]}function PI(n,e){if(e===0||Date.now()-3e5>n+e)throw Ue(TI)}/*! @azure/msal-common v14.16.1 2025-08-05 */function zs(){return Math.round(new Date().getTime()/1e3)}function Qm(n,e){const t=Number(n)||0;return zs()+e>t}function qL(n){return Number(n)>zs()}/*! @azure/msal-common v14.16.1 2025-08-05 */function Ya(n){return[GL(n),zL(n),YL(n),QL(n),XL(n)].join(dr.CACHE_KEY_SEPARATOR).toLowerCase()}function Bf(n,e,t,r,s){return{credentialType:ht.ID_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t,realm:s}}function Vf(n,e,t,r,s,i,o,a,l,u,d,f,p,m,g){var y,L;const v={homeAccountId:n,credentialType:ht.ACCESS_TOKEN,secret:t,cachedAt:zs().toString(),expiresOn:o.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:s,target:i,tokenType:d||Kt.BEARER};if(f&&(v.userAssertionHash=f),u&&(v.refreshOn=u.toString()),m&&(v.requestedClaims=m,v.requestedClaimsHash=g),((y=v.tokenType)==null?void 0:y.toLowerCase())!==Kt.BEARER.toLowerCase())switch(v.credentialType=ht.ACCESS_TOKEN_WITH_AUTH_SCHEME,v.tokenType){case Kt.POP:const D=va(t,l);if(!((L=D==null?void 0:D.cnf)!=null&&L.kid))throw Ue(xI);v.keyId=D.cnf.kid;break;case Kt.SSH:v.keyId=p}return v}function NI(n,e,t,r,s,i,o){const a={credentialType:ht.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t};return i&&(a.userAssertionHash=i),s&&(a.familyId=s),o&&(a.expiresOn=o.toString()),a}function Yg(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function j1(n){return n?Yg(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===ht.ACCESS_TOKEN||n.credentialType===ht.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function W1(n){return n?Yg(n)&&n.hasOwnProperty("realm")&&n.credentialType===ht.ID_TOKEN:!1}function K1(n){return n?Yg(n)&&n.credentialType===ht.REFRESH_TOKEN:!1}function GL(n){return[n.homeAccountId,n.environment].join(dr.CACHE_KEY_SEPARATOR).toLowerCase()}function zL(n){const e=n.credentialType===ht.REFRESH_TOKEN&&n.familyId||n.clientId;return[n.credentialType,e,n.realm||""].join(dr.CACHE_KEY_SEPARATOR).toLowerCase()}function YL(n){return(n.target||"").toLowerCase()}function QL(n){return(n.requestedClaimsHash||"").toLowerCase()}function XL(n){return n.tokenType&&n.tokenType.toLowerCase()!==Kt.BEARER.toLowerCase()?n.tokenType.toLowerCase():""}function JL(n,e){const t=n.indexOf(Gn.CACHE_KEY)===0;let r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&r}function ZL(n,e){let t=!1;n&&(t=n.indexOf(Oc.THROTTLING_PREFIX)===0);let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),t&&r}function e3({environment:n,clientId:e}){return[Bg,n,e].join(dr.CACHE_KEY_SEPARATOR).toLowerCase()}function t3(n,e){return e?n.indexOf(Bg)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function n3(n,e){return e?n.indexOf(Ch.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function q1(){return zs()+Ch.REFRESH_TIME_SECONDS}function _d(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function $p(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function G1(n){return n.expiresAt<=zs()}/*! @azure/msal-common v14.16.1 2025-08-05 */const OI="redirect_uri_empty",r3="claims_request_parsing_error",DI="authority_uri_insecure",fc="url_parse_error",MI="empty_url_error",FI="empty_input_scopes_error",LI="invalid_prompt_value",Qg="invalid_claims",UI="token_request_empty",BI="logout_request_empty",VI="invalid_code_challenge_method",Xg="pkce_params_missing",Jg="invalid_cloud_discovery_metadata",$I="invalid_authority_metadata",HI="untrusted_authority",$f="missing_ssh_jwk",jI="missing_ssh_kid",s3="missing_nonce_authentication_header",i3="invalid_authentication_header",WI="cannot_set_OIDCOptions",KI="cannot_allow_native_broker",qI="authority_mismatch";/*! @azure/msal-common v14.16.1 2025-08-05 */const o3={[OI]:"A redirect URI is required for all calls, and none has been set.",[r3]:"Could not parse the given claims request object.",[DI]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[fc]:"URL could not be parsed into appropriate segments.",[MI]:"URL was empty or null.",[FI]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[LI]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Qg]:"Given claims parameter must be a stringified JSON object.",[UI]:"Token request was empty and not found in cache.",[BI]:"The logout request was null or undefined.",[VI]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Xg]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Jg]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[$I]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[HI]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[$f]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[jI]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[s3]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[i3]:"Invalid authentication header provided",[WI]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[KI]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[qI]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Zg extends sn{constructor(e){super(e,o3[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Zg.prototype)}}function Qt(n){return new Zg(n)}/*! @azure/msal-common v14.16.1 2025-08-05 */class gs{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),s=i=>decodeURIComponent(i.replace(/\+/g," "));return r.forEach(i=>{if(i.trim()){const[o,a]=i.split(/=(.+)/g,2);o&&a&&(t[s(o)]=s(a))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class yn{constructor(e){const t=e?gs.trimArrayEntries([...e]):[],r=t?gs.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(s=>this.scopes.add(s))}static fromString(e){const r=(e||Ae.EMPTY_STRING).split(" ");return new yn(r)}static createSearchScopes(e){const t=new yn(e);return t.containsOnlyOIDCScopes()?t.removeScope(Ae.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Qt(FI)}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new yn(t);return e?r.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return L1.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw Ue(II)}}removeScope(e){if(!e)throw Ue(AI);this.scopes.delete(e.trim())}removeOIDCScopes(){L1.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw Ue(qm);const t=new Set;return e.scopes.forEach(r=>t.add(r.toLowerCase())),this.scopes.forEach(r=>t.add(r.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw Ue(qm);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),s=this.getScopeCount();return t.size<s+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):Ae.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.16.1 2025-08-05 */function Sh(n,e){if(!n)throw Ue(pI);try{const t=e(n);return JSON.parse(t)}catch{throw Ue($g)}}function Qa(n){if(!n)throw Ue($g);const e=n.split(dr.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?Ae.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.16.1 2025-08-05 */function xh(n,e){return!!n&&!!e&&n===e.split(".")[1]}function ev(n,e,t,r){if(r){const{oid:s,sub:i,tid:o,name:a,tfp:l,acr:u}=r,d=o||l||u||"";return{tenantId:d,localAccountId:s||i||"",name:a,isHomeTenant:xh(d,n)}}else return{tenantId:t,localAccountId:e,isHomeTenant:xh(t,n)}}function tv(n,e,t,r){let s=n;if(e){const{isHomeTenant:i,...o}=e;s={...n,...o}}if(t){const{isHomeTenant:i,...o}=ev(n.homeAccountId,n.localAccountId,n.tenantId,t);return s={...s,...o,idTokenClaims:t,idToken:r},s}return s}/*! @azure/msal-common v14.16.1 2025-08-05 */const cs={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.16.1 2025-08-05 */function GI(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v14.16.1 2025-08-05 */const Ai={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.16.1 2025-08-05 */class Fn{generateAccountId(){return[this.homeAccountId,this.environment].join(dr.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Fn.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(dr.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){var u,d,f,p,m,g;const s=new Fn;t.authorityType===cs.Adfs?s.authorityType=vd.ADFS_ACCOUNT_TYPE:t.protocolMode===Ai.AAD?s.authorityType=vd.MSSTS_ACCOUNT_TYPE:s.authorityType=vd.GENERIC_ACCOUNT_TYPE;let i;e.clientInfo&&r&&(i=Sh(e.clientInfo,r)),s.clientInfo=e.clientInfo,s.homeAccountId=e.homeAccountId,s.nativeAccountId=e.nativeAccountId;const o=e.environment||t&&t.getPreferredCache();if(!o)throw Ue(Kg);s.environment=o,s.realm=(i==null?void 0:i.utid)||GI(e.idTokenClaims)||"",s.localAccountId=(i==null?void 0:i.uid)||((u=e.idTokenClaims)==null?void 0:u.oid)||((d=e.idTokenClaims)==null?void 0:d.sub)||"";const a=((f=e.idTokenClaims)==null?void 0:f.preferred_username)||((p=e.idTokenClaims)==null?void 0:p.upn),l=(m=e.idTokenClaims)!=null&&m.emails?e.idTokenClaims.emails[0]:null;if(s.username=a||l||"",s.name=((g=e.idTokenClaims)==null?void 0:g.name)||"",s.cloudGraphHostName=e.cloudGraphHostName,s.msGraphHost=e.msGraphHost,e.tenantProfiles)s.tenantProfiles=e.tenantProfiles;else{const v=ev(e.homeAccountId,s.localAccountId,s.realm,e.idTokenClaims);s.tenantProfiles=[v]}return s}static createFromAccountInfo(e,t,r){var i;const s=new Fn;return s.authorityType=e.authorityType||vd.GENERIC_ACCOUNT_TYPE,s.homeAccountId=e.homeAccountId,s.localAccountId=e.localAccountId,s.nativeAccountId=e.nativeAccountId,s.realm=e.tenantId,s.environment=e.environment,s.username=e.username,s.name=e.name,s.cloudGraphHostName=t,s.msGraphHost=r,s.tenantProfiles=Array.from(((i=e.tenantProfiles)==null?void 0:i.values())||[]),s}static generateHomeAccountId(e,t,r,s,i){if(!(t===cs.Adfs||t===cs.Dsts)){if(e)try{const o=Sh(e,s.base64Decode);if(o.uid&&o.utid)return`${o.uid}.${o.utid}`}catch{}r.warning("No client info in response")}return(i==null?void 0:i.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let s=!0;if(r){const i=e.idTokenClaims||{},o=t.idTokenClaims||{};s=i.iat===o.iat&&i.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&s}}/*! @azure/msal-common v14.16.1 2025-08-05 */function zI(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function bh(n){if(!n||n.indexOf("=")<0)return null;try{const e=zI(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw Ue(yI)}return null}/*! @azure/msal-common v14.16.1 2025-08-05 */class xt{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Qt(MI);e.includes("#")||(this._urlString=xt.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return gs.endsWith(t,"?")?t=t.slice(0,-1):gs.endsWith(t,"?/")&&(t=t.slice(0,-2)),gs.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Qt(fc)}if(!e.HostNameAndPort||!e.PathSegments)throw Qt(fc);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Qt(DI)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return xt.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return e&&r.length!==0&&(r[0]===ho.COMMON||r[0]===ho.ORGANIZATIONS)&&(r[0]=e),xt.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Qt(fc);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let s=r.AbsolutePath.split("/");return s=s.filter(i=>i&&i.length>0),r.PathSegments=s,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Qt(fc);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===Ae.FORWARD_SLASH){const s=new xt(t).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new xt(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!bh(e)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const YI={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},z1=YI.endpointMetadata,nv=YI.instanceDiscoveryMetadata,QI=new Set;nv.metadata.forEach(n=>{n.aliases.forEach(e=>{QI.add(e)})});function a3(n,e){var s;let t;const r=n.canonicalAuthority;if(r){const i=new xt(r).getUrlComponents().HostNameAndPort;t=Y1(i,(s=n.cloudDiscoveryMetadata)==null?void 0:s.metadata,Vr.CONFIG,e)||Y1(i,nv.metadata,Vr.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function Y1(n,e,t,r){if(r==null||r.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const s=Rh(e,n);if(s)return r==null||r.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),s.aliases;r==null||r.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function l3(n){return Rh(nv.metadata,n)}function Rh(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(r.aliases.includes(e))return r}return null}/*! @azure/msal-common v14.16.1 2025-08-05 */const rv="cache_quota_exceeded",sv="cache_error_unknown";/*! @azure/msal-common v14.16.1 2025-08-05 */const Hp={[rv]:"Exceeded cache storage capacity.",[sv]:"Unexpected error occurred when using cache storage."};class al extends Error{constructor(e,t){const r=t||(Hp[e]?Hp[e]:Hp[sv]);super(`${e}: ${r}`),Object.setPrototypeOf(this,al.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}function XI(n){return n instanceof Error?n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED"||n.message.includes("exceeded the quota")?new al(rv):new al(n.name,n.message):new al(sv)}/*! @azure/msal-common v14.16.1 2025-08-05 */class Al{constructor(e,t,r,s){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(kI,Gg),this.staticAuthorityOptions=s}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(t||{},e),e,t)}getAccountInfoFilteredBy(e,t){const r=this.getAllAccounts(t,e);return r.length>1?r.sort(i=>i.idTokenClaims?-1:1)[0]:r.length===1?r[0]:null}getBaseAccountInfo(e,t){const r=this.getAccountsFilteredBy(e,t);return r.length>0?r[0].getAccountInfo():null}buildTenantProfiles(e,t,r){return e.flatMap(s=>this.getTenantProfilesFromAccountEntity(s,t,r==null?void 0:r.tenantId,r))}getTenantedAccountInfoByFilter(e,t,r,s,i){let o=null,a;if(i&&!this.tenantProfileMatchesFilter(r,i))return null;const l=this.getIdToken(e,s,t,r.tenantId);return l&&(a=va(l.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,i))?null:(o=tv(e,r,a,l==null?void 0:l.secret),o)}getTenantProfilesFromAccountEntity(e,t,r,s){const i=e.getAccountInfo();let o=i.tenantProfiles||new Map;const a=this.getTokenKeys();if(r){const u=o.get(r);if(u)o=new Map([[r,u]]);else return[]}const l=[];return o.forEach(u=>{const d=this.getTenantedAccountInfoByFilter(i,a,u,t,s);d&&l.push(d)}),l}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,r){var s;if(!e)throw Ue(SI);try{e.account&&this.setAccount(e.account,t),e.idToken&&(r==null?void 0:r.idToken)!==!1&&this.setIdTokenCredential(e.idToken,t),e.accessToken&&(r==null?void 0:r.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&(r==null?void 0:r.refreshToken)!==!1&&this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(i){throw(s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: failed"),i instanceof sn?i:XI(i)}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},s=this.getTokenKeys(),i=yn.fromString(e.target);s.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,r,!1))return;const a=this.getAccessTokenCredential(o,t);a&&this.credentialMatchesFilter(a,r)&&yn.fromString(a.target).intersectingScopeSets(i)&&this.removeAccessToken(o,t)}),this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const r=this.getAccountKeys(),s=[];return r.forEach(i=>{var u;if(!this.isAccountKey(i,e.homeAccountId))return;const o=this.getAccount(i,t,this.commonLogger);if(!o||e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId)||e.username&&!this.matchUsername(o.username,e.username)||e.environment&&!this.matchEnvironment(o,e.environment)||e.realm&&!this.matchRealm(o,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;const a={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},l=(u=o.tenantProfiles)==null?void 0:u.filter(d=>this.tenantProfileMatchesFilter(d,a));l&&l.length===0||s.push(o)}),s}isAccountKey(e,t,r){return!(e.split(dr.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(dr.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(t.indexOf(ht.ID_TOKEN.toLowerCase())===-1&&t.indexOf(ht.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(ht.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(ht.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(ht.REFRESH_TOKEN.toLowerCase())>-1){const r=`${ht.REFRESH_TOKEN}${dr.CACHE_KEY_SEPARATOR}${this.clientId}${dr.CACHE_KEY_SEPARATOR}`,s=`${ht.REFRESH_TOKEN}${dr.CACHE_KEY_SEPARATOR}${Nc}${dr.CACHE_KEY_SEPARATOR}`;if(t.indexOf(r.toLowerCase())===-1&&t.indexOf(s.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===ht.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===Kt.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach(s=>{if(!this.isAppMetadata(s))return;const i=this.getAppMetadata(s);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(r[s]=i))}),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach(s=>{if(!this.isAuthorityMetadata(s)||s.indexOf(this.clientId)===-1)return;const i=this.getAuthorityMetadata(s);i&&i.aliases.indexOf(e)!==-1&&(r=i)}),r}async removeAllAccounts(e){const t=this.getAccountKeys(),r=[];t.forEach(s=>{r.push(this.removeAccount(s,e))}),await Promise.all(r)}async removeAccount(e,t){const r=this.getAccount(e,t,this.commonLogger);r&&(await this.removeAccountContext(r,t),this.removeItem(e,t))}async removeAccountContext(e,t){const r=this.getTokenKeys(),s=e.generateAccountId();r.idToken.forEach(i=>{i.indexOf(s)===0&&this.removeIdToken(i,t)}),r.accessToken.forEach(i=>{i.indexOf(s)===0&&this.removeAccessToken(i,t)}),r.refreshToken.forEach(i=>{i.indexOf(s)===0&&this.removeRefreshToken(i,t)}),this.getKeys().forEach(i=>{i.includes(s)&&this.removeItem(i,t)})}updateOutdatedCachedAccount(e,t,r,s){var i;if(t&&t.isSingleTenant()){(i=this.commonLogger)==null||i.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const o=this.getAccountKeys().filter(f=>f.startsWith(t.homeAccountId)),a=[];o.forEach(f=>{const p=this.getCachedAccountEntity(f,r);p&&a.push(p)});const l=a.find(f=>xh(f.realm,f.homeAccountId))||a[0];l.tenantProfiles=a.map(f=>({tenantId:f.realm,localAccountId:f.localAccountId,name:f.name,isHomeTenant:xh(f.realm,f.homeAccountId)}));const u=Al.toObject(new Fn,{...l}),d=u.generateAccountKey();return o.forEach(f=>{f!==d&&this.removeOutdatedAccount(e,r)}),this.setAccount(u,r),s==null||s.verbose("Updated an outdated account entity in the cache"),u}return t}removeAccessToken(e,t){const r=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),!r||r.credentialType.toLowerCase()!==ht.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||r.tokenType!==Kt.POP)return;const s=r.keyId;s&&this.cryptoImpl.removeTokenBindingKey(s).catch(()=>{this.commonLogger.error("Binding key could not be removed")})}removeAppMetadata(e){return this.getKeys().forEach(r=>{this.isAppMetadata(r)&&this.removeItem(r,e)}),!0}readAccountFromCache(e,t){const r=Fn.generateAccountCacheKey(e);return this.getAccount(r,t,this.commonLogger)}getIdToken(e,t,r,s,i){this.commonLogger.trace("CacheManager - getIdToken called");const o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ht.ID_TOKEN,clientId:this.clientId,realm:s},a=this.getIdTokensByFilter(o,t,r),l=a.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let u=a;if(!s){const d=new Map;a.forEach((p,m)=>{p.realm===e.tenantId&&d.set(m,p)});const f=d.size;if(f<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(f===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),d.values().next().value;u=d}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),u.forEach((d,f)=>{this.removeIdToken(f,t)}),i&&t&&i.addFields({multiMatchedID:a.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t,r){const s=r&&r.idToken||this.getTokenKeys().idToken,i=new Map;return s.forEach(o=>{if(!this.idTokenKeyMatchesFilter(o,{clientId:this.clientId,...e}))return;const a=this.getIdTokenCredential(o,t);a&&this.credentialMatchesFilter(a,e)&&i.set(o,a)}),i}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,r,s,i){this.commonLogger.trace("CacheManager - getAccessToken called");const o=yn.createSearchScopes(t.scopes),a=t.authenticationScheme||Kt.BEARER,l=a.toLowerCase()!==Kt.BEARER.toLowerCase()?ht.ACCESS_TOKEN_WITH_AUTH_SCHEME:ht.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:s||e.tenantId,target:o,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=r&&r.accessToken||this.getTokenKeys().accessToken,f=[];d.forEach(m=>{if(this.accessTokenKeyMatchesFilter(m,u,!0)){const g=this.getAccessTokenCredential(m,t.correlationId);g&&this.credentialMatchesFilter(g,u)&&f.push(g)}});const p=f.length;return p<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):p>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),f.forEach(m=>{this.removeAccessToken(Ya(m),t.correlationId)}),i&&t.correlationId&&i.addFields({multiMatchedAT:f.length},t.correlationId),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),f[0])}accessTokenKeyMatchesFilter(e,t,r){const s=e.toLowerCase();if(t.clientId&&s.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&s.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&s.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&s.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const i=t.target.asArray();for(let o=0;o<i.length;o++){if(r&&!s.includes(i[o].toLowerCase()))return!1;if(!r&&s.includes(i[o].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const r=this.getTokenKeys(),s=[];return r.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;const o=this.getAccessTokenCredential(i,t);o&&this.credentialMatchesFilter(o,e)&&s.push(o)}),s}getRefreshToken(e,t,r,s,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=t?Nc:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ht.REFRESH_TOKEN,clientId:this.clientId,familyId:o},l=s&&s.refreshToken||this.getTokenKeys().refreshToken,u=[];l.forEach(f=>{if(this.refreshTokenKeyMatchesFilter(f,a)){const p=this.getRefreshTokenCredential(f,r);p&&this.credentialMatchesFilter(p,a)&&u.push(p)}});const d=u.length;return d<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(d>1&&i&&r&&i.addFields({multiMatchedRT:d},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&r.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),s=Object.keys(r).map(o=>r[o]),i=s.length;if(i<1)return null;if(i>1)throw Ue(wI);return s[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Nc)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const r=e.oid||e.sub;return t===r}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var r;return t.toLowerCase()===((r=e.name)==null?void 0:r.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const s=a3(this.staticAuthorityOptions,this.commonLogger);if(s.includes(t)&&s.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var r;return((r=e.realm)==null?void 0:r.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==ht.ACCESS_TOKEN&&e.credentialType!==ht.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:yn.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(Bg)!==-1}isAuthorityMetadata(e){return e.indexOf(Ch.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Ch.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class c3 extends Al{setAccount(){throw Ue(Tt)}getAccount(){throw Ue(Tt)}getCachedAccountEntity(){throw Ue(Tt)}setIdTokenCredential(){throw Ue(Tt)}getIdTokenCredential(){throw Ue(Tt)}setAccessTokenCredential(){throw Ue(Tt)}getAccessTokenCredential(){throw Ue(Tt)}setRefreshTokenCredential(){throw Ue(Tt)}getRefreshTokenCredential(){throw Ue(Tt)}setAppMetadata(){throw Ue(Tt)}getAppMetadata(){throw Ue(Tt)}setServerTelemetry(){throw Ue(Tt)}getServerTelemetry(){throw Ue(Tt)}setAuthorityMetadata(){throw Ue(Tt)}getAuthorityMetadata(){throw Ue(Tt)}getAuthorityMetadataKeys(){throw Ue(Tt)}setThrottlingCache(){throw Ue(Tt)}getThrottlingCache(){throw Ue(Tt)}removeItem(){throw Ue(Tt)}getKeys(){throw Ue(Tt)}getAccountKeys(){throw Ue(Tt)}getTokenKeys(){throw Ue(Tt)}updateCredentialCacheKey(){throw Ue(Tt)}removeOutdatedAccount(){throw Ue(Tt)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const JI={tokenRenewalOffsetSeconds:kL,preventCorsPreflight:!1},u3={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ln.Info,correlationId:Ae.EMPTY_STRING},d3={claimsBasedCachingEnabled:!1},h3={async sendGetRequestAsync(){throw Ue(Tt)},async sendPostRequestAsync(){throw Ue(Tt)}},f3={sku:Ae.SKU,version:Gg,cpu:Ae.EMPTY_STRING,os:Ae.EMPTY_STRING},p3={clientSecret:Ae.EMPTY_STRING,clientAssertion:void 0},m3={azureCloudInstance:zg.None,tenant:`${Ae.DEFAULT_COMMON_TENANT}`},g3={application:{appName:"",appVersion:""}};function v3({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:r,storageInterface:s,networkInterface:i,cryptoInterface:o,clientCredentials:a,libraryInfo:l,telemetry:u,serverTelemetryManager:d,persistencePlugin:f,serializableCache:p}){const m={...u3,...t};return{authOptions:y3(n),systemOptions:{...JI,...e},loggerOptions:m,cacheOptions:{...d3,...r},storageInterface:s||new c3(n.clientId,Ih,new Eo(m)),networkInterface:i||h3,cryptoInterface:o||Ih,clientCredentials:a||p3,libraryInfo:{...f3,...l},telemetry:{...g3,...u},serverTelemetryManager:d||null,persistencePlugin:f||null,serializableCache:p||null}}function y3(n){return{clientCapabilities:[],azureCloudOptions:m3,skipAuthorityMetadataCache:!1,instanceAware:!1,...n}}function Xm(n){return n.authOptions.authority.options.protocolMode===Ai.OIDC}/*! @azure/msal-common v14.16.1 2025-08-05 */const Qr={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.16.1 2025-08-05 */const oa="client_id",ZI="redirect_uri",Q1="response_type",_3="response_mode",E3="grant_type",T3="claims",w3="scope",C3="refresh_token",A3="state",I3="nonce",S3="prompt",x3="code",b3="code_challenge",R3="code_challenge_method",k3="code_verifier",P3="client-request-id",N3="x-client-SKU",O3="x-client-VER",D3="x-client-OS",M3="x-client-CPU",F3="x-client-current-telemetry",L3="x-client-last-telemetry",U3="x-ms-lib-capability",B3="x-app-name",V3="x-app-ver",$3="post_logout_redirect_uri",H3="id_token_hint",j3="device_code",W3="client_secret",K3="client_assertion",q3="client_assertion_type",X1="token_type",J1="req_cnf",G3="assertion",z3="requested_token_use",Z1="return_spa_code",Y3="nativebroker",Q3="logout_hint",X3="sid",J3="login_hint",Z3="domain_hint",eU="x-client-xtra-sku",iv="brk_client_id",Jm="brk_redirect_uri";/*! @azure/msal-common v14.16.1 2025-08-05 */class Ha{static validateRedirectUri(e){if(!e)throw Qt(OI)}static validatePrompt(e){const t=[];for(const r in Bn)t.push(Bn[r]);if(t.indexOf(e)<0)throw Qt(LI)}static validateClaims(e){try{JSON.parse(e)}catch{throw Qt(Qg)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Qt(Xg);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([U1.PLAIN,U1.S256].indexOf(e)<0)throw Qt(VI)}}/*! @azure/msal-common v14.16.1 2025-08-05 */function tU(n,e,t){if(!e)return;const r=n.get(oa);r&&n.has(iv)&&(t==null||t.addFields({embeddedClientId:r,embeddedRedirectUri:n.get(ZI)},e))}class Dc{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(Q1,encodeURIComponent(Ae.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Q1,encodeURIComponent(`${Ae.TOKEN_RESPONSE_TYPE} ${Ae.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(_3,encodeURIComponent(e||xL.QUERY))}addNativeBroker(){this.parameters.set(Y3,encodeURIComponent("1"))}addScopes(e,t=!0,r=Bl){t&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");const s=t?[...e||[],...r]:e||[],i=new yn(s);this.parameters.set(w3,encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(oa,encodeURIComponent(e))}addRedirectUri(e){Ha.validateRedirectUri(e),this.parameters.set(ZI,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Ha.validateRedirectUri(e),this.parameters.set($3,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(H3,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(Z3,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(J3,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(wr.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(wr.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(X3,encodeURIComponent(e))}addClaims(e,t){const r=this.addClientCapabilitiesToClaims(e,t);Ha.validateClaims(r),this.parameters.set(T3,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(P3,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(N3,e.sku),this.parameters.set(O3,e.version),e.os&&this.parameters.set(D3,e.os),e.cpu&&this.parameters.set(M3,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(B3,e.appName),e!=null&&e.appVersion&&this.parameters.set(V3,e.appVersion)}addPrompt(e){Ha.validatePrompt(e),this.parameters.set(`${S3}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(A3,encodeURIComponent(e))}addNonce(e){this.parameters.set(I3,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Ha.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(b3,encodeURIComponent(e)),this.parameters.set(R3,encodeURIComponent(t));else throw Qt(Xg)}addAuthorizationCode(e){this.parameters.set(x3,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(j3,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(C3,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(k3,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(W3,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(K3,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(q3,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(G3,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(z3,encodeURIComponent(e))}addGrantType(e){this.parameters.set(E3,encodeURIComponent(e))}addClientInfo(){this.parameters.set(bL,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,r])=>{!this.parameters.has(t)&&r&&this.parameters.set(t,r)})}addClientCapabilitiesToClaims(e,t){let r;if(!e)r={};else try{r=JSON.parse(e)}catch{throw Qt(Qg)}return t&&t.length>0&&(r.hasOwnProperty(gd.ACCESS_TOKEN)||(r[gd.ACCESS_TOKEN]={}),r[gd.ACCESS_TOKEN][gd.XMS_CC]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(V1.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(V1.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(X1,Kt.POP),this.parameters.set(J1,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(X1,Kt.SSH),this.parameters.set(J1,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(F3,e.generateCurrentRequestHeaderValue()),this.parameters.set(L3,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(U3,Oc.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(Q3,encodeURIComponent(e))}addBrokerParameters(e){const t={};t[iv]=e.brokerClientId,t[Jm]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,r)=>{e.push(`${r}=${t}`)}),tU(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v14.16.1 2025-08-05 */function nU(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.16.1 2025-08-05 */function rU(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v14.16.1 2025-08-05 */function sU(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v14.16.1 2025-08-05 */const fe={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},iU={InProgress:1};/*! @azure/msal-common v14.16.1 2025-08-05 */const ya=(n,e,t,r,s)=>(...i)=>{t.trace(`Executing function ${e}`);const o=r==null?void 0:r.startMeasurement(e,s);if(s){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},s)}try{const a=n(...i);return o==null||o.end({success:!0}),t.trace(`Returning result from ${e}`),a}catch(a){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw o==null||o.end({success:!1},a),a}},je=(n,e,t,r,s)=>(...i)=>{t.trace(`Executing function ${e}`);const o=r==null?void 0:r.startMeasurement(e,s);if(s){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},s)}return r==null||r.setPreQueueTime(e,s),n(...i).then(a=>(t.trace(`Returning result from ${e}`),o==null||o.end({success:!0}),a)).catch(a=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw o==null||o.end({success:!1},a),a})};/*! @azure/msal-common v14.16.1 2025-08-05 */class Hf{constructor(e,t,r,s){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=s}async detectRegion(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)t.region_source=Oa.ENVIRONMENT_VARIABLE;else{const i=Hf.IMDS_OPTIONS;try{const o=await je(this.getRegionFromIMDS.bind(this),fe.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(Ae.IMDS_VERSION,i);if(o.status===yd.httpSuccess&&(r=o.body,t.region_source=Oa.IMDS),o.status===yd.httpBadRequest){const a=await je(this.getCurrentVersion.bind(this),fe.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return t.region_source=Oa.FAILED_AUTO_DETECTION,null;const l=await je(this.getRegionFromIMDS.bind(this),fe.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);l.status===yd.httpSuccess&&(r=l.body,t.region_source=Oa.IMDS)}}catch{return t.region_source=Oa.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=Oa.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(fe.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${Ae.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,Ae.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(fe.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${Ae.IMDS_ENDPOINT}?format=json`,e);return r.status===yd.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}Hf.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.16.1 2025-08-05 */class ar{constructor(e,t,r,s,i,o,a,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=s,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=o,this.managedIdentity=l||!1,this.regionDiscovery=new Hf(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(Ae.CIAM_AUTH_URL))return cs.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case Ae.ADFS:return cs.Adfs;case Ae.DSTS:return cs.Dsts}return cs.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new xt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Ue(ui)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Ue(ui)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Ue(ui)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Ue(RI);return this.replacePath(this.metadata.end_session_endpoint)}else throw Ue(ui)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Ue(ui)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Ue(ui)}canReplaceTenant(e){return e.PathSegments.length===1&&!ar.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===cs.Default&&this.protocolMode===Ai.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const s=new xt(this.metadata.canonical_authority).getUrlComponents(),i=s.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,l)=>{let u=i[l];if(l===0&&this.canReplaceTenant(s)){const d=new xt(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];u!==d&&(this.logger.verbose(`Replacing tenant domain name ${u} with id ${d}`),u=d)}a!==u&&(t=t.replace(`/${u}/`,`/${a}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===cs.Adfs||this.protocolMode!==Ai.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var s,i;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await je(this.updateCloudDiscoveryMetadata.bind(this),fe.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await je(this.updateEndpointMetadata.bind(this),fe.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),(i=this.performanceClient)==null||i.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:q1(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==Vr.CACHE&&(r==null?void 0:r.source)!==Vr.CACHE&&(e.expiresAt=q1(),e.canonical_authority=this.canonicalAuthority);const s=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(s,e),this.metadata=e}async updateEndpointMetadata(e){var s,i,o;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Vr.HARDCODED_VALUES&&(i=this.authorityOptions.azureRegionConfiguration)!=null&&i.azureRegion&&t.metadata){const a=await je(this.updateMetadataWithRegionalInformation.bind(this),fe.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);_d(e,a,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let r=await je(this.getEndpointMetadataFromNetwork.bind(this),fe.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return(o=this.authorityOptions.azureRegionConfiguration)!=null&&o.azureRegion&&(r=await je(this.updateMetadataWithRegionalInformation.bind(this),fe.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),_d(e,r,!0),Vr.NETWORK;throw Ue(vI,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),_d(e,t,!1),{source:Vr.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const s=this.getEndpointMetadataFromHardcodedValues();if(s)return _d(e,s,!1),{source:Vr.HARDCODED_VALUES,metadata:s};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=G1(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Vr.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new xt(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Qt($I)}return null}async getEndpointMetadataFromNetwork(){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(fe.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const s=await this.networkInterface.sendGetRequestAsync(t,e);return nU(s.body)?s.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(s){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${s}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in z1?z1[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var r,s,i;(r=this.performanceClient)==null||r.addQueueMeasurement(fe.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=(s=this.authorityOptions.azureRegionConfiguration)==null?void 0:s.azureRegion;if(t){if(t!==Ae.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Vp.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,ar.replaceWithRegionalInformation(e,t);const o=await je(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),fe.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(o)return this.regionDiscoveryMetadata.region_outcome=Vp.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=o,ar.replaceWithRegionalInformation(e,o);this.regionDiscoveryMetadata.region_outcome=Vp.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await je(this.getCloudDiscoveryMetadataFromNetwork.bind(this),fe.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return $p(e,r,!0),Vr.NETWORK;throw Qt(HI)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||Ae.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||Ae.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||Ae.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),$p(e,t,!1),Vr.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const s=l3(this.hostnameAndPort);if(s)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),$p(e,s,!1),Vr.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=G1(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),Vr.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===cs.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),ar.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Rh(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Qt(Jg)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),ar.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${Ae.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const i=await this.networkInterface.sendGetRequestAsync(e,t);let o,a;if(rU(i.body))o=i.body,a=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else if(sU(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),o=i.body,o.error===Ae.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Rh(a,this.hostnameAndPort)}catch(i){if(i instanceof sn)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{const o=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${o.name}
Error Description: ${o.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=ar.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&xt.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==zg.None){const s=t.tenant?t.tenant:Ae.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${s}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return Ae.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Ue(ui)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return QI.has(e)}static isPublicCloudAuthority(e){return Ae.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const s=new xt(e);s.validateAsUri();const i=s.getUrlComponents();let o=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(o=`${t}.${Ae.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=xt.constructAuthorityUriFromObject({...s.getUrlComponents(),HostNameAndPort:o}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=ar.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=ar.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=ar.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const s=new xt(e).getUrlComponents();if(s.PathSegments.length===0&&s.HostNameAndPort.endsWith(Ae.CIAM_AUTH_URL)){const i=s.HostNameAndPort.split(".")[0];t=`${t}${i}${Ae.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}ar.reservedTenantDomains=new Set(["{tenant}","{tenantid}",ho.COMMON,ho.CONSUMERS,ho.ORGANIZATIONS]);function oU(n){var s;const r=(s=new xt(n).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:s.toLowerCase();switch(r){case ho.COMMON:case ho.ORGANIZATIONS:case ho.CONSUMERS:return;default:return r}}function eS(n){return n.endsWith(Ae.FORWARD_SLASH)?n:`${n}${Ae.FORWARD_SLASH}`}function aU(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw Qt(Jg)}return{canonicalAuthority:n.authority?eS(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v14.16.1 2025-08-05 */async function tS(n,e,t,r,s,i,o){o==null||o.addQueueMeasurement(fe.AuthorityFactoryCreateDiscoveredInstance,i);const a=ar.transformCIAMAuthority(eS(n)),l=new ar(a,e,t,r,s,i,o);try{return await je(l.resolveEndpointsAsync.bind(l),fe.AuthorityResolveEndpointsAsync,s,o,i)(),l}catch{throw Ue(ui)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class To extends sn{constructor(e,t,r,s,i){super(e,t,r),this.name="ServerError",this.errorNo=s,this.status=i,Object.setPrototypeOf(this,To.prototype)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class Ns{static generateThrottlingStorageKey(e){return`${Oc.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,r){var o;const s=Ns.generateThrottlingStorageKey(t),i=e.getThrottlingCache(s);if(i){if(i.throttleTime<Date.now()){e.removeItem(s,r);return}throw new To(((o=i.errorCodes)==null?void 0:o.join(" "))||Ae.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,r,s){if(Ns.checkResponseStatus(r)||Ns.checkResponseForRetryAfter(r)){const i={throttleTime:Ns.calculateThrottleTime(parseInt(r.headers[wr.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Ns.generateThrottlingStorageKey(t),i,s)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(wr.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(Math.min(r+(t||Oc.DEFAULT_THROTTLE_TIME_SECONDS),r+Oc.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,r,s){const i={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:s,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},o=this.generateThrottlingStorageKey(i);e.removeItem(o,r.correlationId)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class jf extends sn{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,jf.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function eE(n,e,t){return new jf(n,e,t)}/*! @azure/msal-common v14.16.1 2025-08-05 */class ov{constructor(e,t){this.config=v3(e),this.logger=new Eo(this.config.loggerOptions,kI,Gg),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[wr.CONTENT_TYPE]=Ae.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Qr.HOME_ACCOUNT_ID:try{const r=Qa(e.credential);t[wr.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case Qr.UPN:t[wr.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,r,s,i,o){var l;o&&((l=this.performanceClient)==null||l.addQueueMeasurement(o,i));const a=await this.sendPostRequest(s,e,{body:t,headers:r},i);return this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,s){var o,a,l;Ns.preProcess(this.cacheManager,e,s);let i;try{i=await je(this.networkClient.sendPostRequestAsync.bind(this.networkClient),fe.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,s)(t,r);const u=i.headers||{};(a=this.performanceClient)==null||a.addFields({refreshTokenSize:((o=i.body.refresh_token)==null?void 0:o.length)||0,httpVerToken:u[wr.X_MS_HTTP_VERSION]||"",requestId:u[wr.X_MS_REQUEST_ID]||""},s)}catch(u){if(u instanceof jf){const d=u.responseHeaders;throw d&&((l=this.performanceClient)==null||l.addFields({httpVerToken:d[wr.X_MS_HTTP_VERSION]||"",requestId:d[wr.X_MS_REQUEST_ID]||"",contentTypeHeader:d[wr.CONTENT_TYPE]||void 0,contentLengthHeader:d[wr.CONTENT_LENGTH]||void 0,httpStatus:u.httpStatus},s)),u.error}throw u instanceof sn?u:Ue(gI)}return Ns.postProcess(this.cacheManager,e,i,s),i}async updateAuthority(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(fe.UpdateTokenEndpointAuthority,t);const r=`https://${e}/${this.authority.tenant}/`,s=await tS(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=s}createTokenQueryParameters(e){const t=new Dc(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}/*! @azure/msal-common v14.16.1 2025-08-05 */const kh="no_tokens_found",nS="native_account_unavailable",av="refresh_token_expired",lU="interaction_required",cU="consent_required",uU="login_required",Wf="bad_token";/*! @azure/msal-common v14.16.1 2025-08-05 */const tE=[lU,cU,uU,Wf],dU=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],hU={[kh]:"No refresh token found in the cache. Please sign-in.",[nS]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[av]:"Refresh token has expired.",[Wf]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class Ts extends sn{constructor(e,t,r,s,i,o,a,l){super(e,t,r),Object.setPrototypeOf(this,Ts.prototype),this.timestamp=s||Ae.EMPTY_STRING,this.traceId=i||Ae.EMPTY_STRING,this.correlationId=o||Ae.EMPTY_STRING,this.claims=a||Ae.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function nE(n,e,t){const r=!!n&&tE.indexOf(n)>-1,s=!!t&&dU.indexOf(t)>-1,i=!!e&&tE.some(o=>e.indexOf(o)>-1);return r||i||s}function Zm(n){return new Ts(n,hU[n])}/*! @azure/msal-common v14.16.1 2025-08-05 */class vs{static setRequestState(e,t,r){const s=vs.generateLibraryState(e,r);return t?`${s}${Ae.RESOURCE_DELIM}${t}`:s}static generateLibraryState(e,t){if(!e)throw Ue(zm);const r={id:e.createNewGuid()};t&&(r.meta=t);const s=JSON.stringify(r);return e.base64Encode(s)}static parseRequestState(e,t){if(!e)throw Ue(zm);if(!t)throw Ue(Cl);try{const r=t.split(Ae.RESOURCE_DELIM),s=r[0],i=r.length>1?r.slice(1).join(Ae.RESOURCE_DELIM):Ae.EMPTY_STRING,o=e.base64Decode(s),a=JSON.parse(o);return{userRequestState:i||Ae.EMPTY_STRING,libraryState:a}}catch{throw Ue(Cl)}}}/*! @azure/msal-common v14.16.1 2025-08-05 */const fU={SW:"sw"};class Il{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(fe.PopTokenGenerateCnf,e.correlationId);const r=await je(this.generateKid.bind(this),fe.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),s=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:s}}async generateKid(e){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(fe.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:fU.SW}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,s){const{resourceRequestMethod:i,resourceRequestUri:o,shrClaims:a,shrNonce:l,shrOptions:u}=r,d=o?new xt(o):void 0,f=d==null?void 0:d.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:zs(),m:i==null?void 0:i.toUpperCase(),u:f==null?void 0:f.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:f==null?void 0:f.AbsolutePath,q:f!=null&&f.QueryString?[[],f.QueryString]:void 0,client_claims:a||void 0,...s},t,u,r.correlationId)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class pU{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.16.1 2025-08-05 */function mU(n){var r,s;const e="code=",t=(r=n.error_uri)==null?void 0:r.lastIndexOf(e);return t&&t>=0?(s=n.error_uri)==null?void 0:s.substring(t+e.length):void 0}class aa{constructor(e,t,r,s,i,o,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=s,this.serializableCache=i,this.persistencePlugin=o,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?Ue(Ah,"Cached State"):Ue(Ah,"Server State");let r,s;try{r=decodeURIComponent(e.state)}catch{throw Ue(Cl,e.state)}try{s=decodeURIComponent(t)}catch{throw Ue(Cl,e.state)}if(r!==s)throw Ue(_I);if(e.error||e.error_description||e.suberror){const i=mU(e);throw nE(e.error,e.error_description,e.suberror)?new Ts(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",i):new To(e.error||"",e.error_description,e.suberror,i)}}validateTokenResponse(e,t){var r;if(e.error||e.error_description||e.suberror){const s=`Error(s): ${e.error_codes||Ae.NOT_AVAILABLE} - Timestamp: ${e.timestamp||Ae.NOT_AVAILABLE} - Description: ${e.error_description||Ae.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||Ae.NOT_AVAILABLE} - Trace ID: ${e.trace_id||Ae.NOT_AVAILABLE}`,i=(r=e.error_codes)!=null&&r.length?e.error_codes[0]:void 0,o=new To(e.error,s,e.suberror,i,e.status);if(t&&e.status&&e.status>=md.SERVER_ERROR_RANGE_START&&e.status<=md.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${o}`);return}else if(t&&e.status&&e.status>=md.CLIENT_ERROR_RANGE_START&&e.status<=md.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${o}`);return}throw nE(e.error,e.error_description,e.suberror)?new Ts(e.error,e.error_description,e.suberror,e.timestamp||Ae.EMPTY_STRING,e.trace_id||Ae.EMPTY_STRING,e.correlation_id||Ae.EMPTY_STRING,e.claims||Ae.EMPTY_STRING,i):o}}async handleServerTokenResponse(e,t,r,s,i,o,a,l,u){var g;(g=this.performanceClient)==null||g.addQueueMeasurement(fe.HandleServerTokenResponse,e.correlation_id);let d;if(e.id_token){if(d=va(e.id_token||Ae.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&d.nonce!==i.nonce)throw Ue(EI);if(s.maxAge||s.maxAge===0){const v=d.auth_time;if(!v)throw Ue(jg);PI(v,s.maxAge)}}this.homeAccountIdentifier=Fn.generateHomeAccountId(e.client_info||Ae.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,d);let f;i&&i.state&&(f=vs.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||s.sshKid||void 0;const p=this.generateCacheRecord(e,t,r,s,d,o,i);let m;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new pU(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(m)),a&&!l&&p.account){const v=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(v,s.correlationId,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await aa.generateAuthenticationResult(this.cryptoObj,t,p,!1,s,d,f,void 0,u)}await this.cacheStorage.saveCacheRecord(p,s.correlationId,s.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&m&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(m))}return aa.generateAuthenticationResult(this.cryptoObj,t,p,!1,s,d,f,e,u)}generateCacheRecord(e,t,r,s,i,o,a){const l=t.getPreferredCache();if(!l)throw Ue(Kg);const u=GI(i);let d,f;e.id_token&&i&&(d=Bf(this.homeAccountIdentifier,l,e.id_token,this.clientId,u||""),f=lv(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,s.correlationId,i,e.client_info,l,u,a,void 0,this.logger));let p=null;if(e.access_token){const v=e.scope?yn.fromString(e.scope):new yn(s.scopes||[]),y=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,L=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,D=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,A=r+y,C=A+L,j=D&&D>0?r+D:void 0;p=Vf(this.homeAccountIdentifier,l,e.access_token,this.clientId,u||t.tenant||"",v.printScopes(),A,C,this.cryptoObj.base64Decode,j,e.token_type,o,e.key_id,s.claims,s.requestedClaimsHash)}let m=null;if(e.refresh_token){let v;if(e.refresh_token_expires_in){const y=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;v=r+y}m=NI(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,o,v)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:l,familyId:e.foci}),{account:f,idToken:d,accessToken:p,refreshToken:m,appMetadata:g}}static async generateAuthenticationResult(e,t,r,s,i,o,a,l,u){var A,C,j,z,w;let d=Ae.EMPTY_STRING,f=[],p=null,m,g,v=Ae.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===Kt.POP&&!i.popKid){const R=new Il(e),{secret:x,keyId:b}=r.accessToken;if(!b)throw Ue(qg);d=await R.signPopToken(x,b,i)}else d=r.accessToken.secret;f=yn.fromString(r.accessToken.target).asArray(),p=new Date(Number(r.accessToken.expiresOn)*1e3),m=new Date(Number(r.accessToken.extendedExpiresOn)*1e3),r.accessToken.refreshOn&&(g=new Date(Number(r.accessToken.refreshOn)*1e3))}r.appMetadata&&(v=r.appMetadata.familyId===Nc?Nc:"");const y=(o==null?void 0:o.oid)||(o==null?void 0:o.sub)||"",L=(o==null?void 0:o.tid)||"";l!=null&&l.spa_accountid&&r.account&&(r.account.nativeAccountId=l==null?void 0:l.spa_accountid);const D=r.account?tv(r.account.getAccountInfo(),void 0,o,(A=r.idToken)==null?void 0:A.secret):null;return{authority:t.canonicalAuthority,uniqueId:y,tenantId:L,scopes:f,account:D,idToken:((C=r==null?void 0:r.idToken)==null?void 0:C.secret)||"",idTokenClaims:o||{},accessToken:d,fromCache:s,expiresOn:p,extExpiresOn:m,refreshOn:g,correlationId:i.correlationId,requestId:u||Ae.EMPTY_STRING,familyId:v,tokenType:((j=r.accessToken)==null?void 0:j.tokenType)||Ae.EMPTY_STRING,state:a?a.userRequestState:Ae.EMPTY_STRING,cloudGraphHostName:((z=r.account)==null?void 0:z.cloudGraphHostName)||Ae.EMPTY_STRING,msGraphHost:((w=r.account)==null?void 0:w.msGraphHost)||Ae.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function lv(n,e,t,r,s,i,o,a,l,u,d,f){f==null||f.verbose("setCachedAccount called");const m=n.getAccountKeys().find(D=>D.startsWith(t));let g=null;m&&(g=n.getAccount(m,s,f));const v=g||Fn.createAccount({homeAccountId:t,idTokenClaims:i,clientInfo:o,environment:a,cloudGraphHostName:u==null?void 0:u.cloud_graph_host_name,msGraphHost:u==null?void 0:u.msgraph_host,nativeAccountId:d},e,r),y=v.tenantProfiles||[],L=l||v.realm;if(L&&!y.find(D=>D.tenantId===L)){const D=ev(t,v.localAccountId,L,i);y.push(D)}return v.tenantProfiles=y,v}/*! @azure/msal-common v14.16.1 2025-08-05 */async function rS(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v14.16.1 2025-08-05 */class sS extends ov{constructor(e,t){var r;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(r=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:r.defaultScopes}async getAuthCodeUrl(e){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(fe.GetAuthCodeUrl,e.correlationId);const t=await je(this.createAuthCodeUrlQueryString.bind(this),fe.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return xt.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){var a,l;if((a=this.performanceClient)==null||a.addQueueMeasurement(fe.AuthClientAcquireToken,e.correlationId),!e.code)throw Ue(CI);const r=zs(),s=await je(this.executeTokenRequest.bind(this),fe.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=(l=s.headers)==null?void 0:l[wr.X_MS_REQUEST_ID],o=new aa(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return o.validateTokenResponse(s.body),je(o.handleServerTokenResponse.bind(o),fe.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,r,e,t,void 0,void 0,void 0,i)}handleFragmentResponse(e,t){if(new aa(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw Ue(bI);return e}getLogoutUri(e){if(!e)throw Qt(BI);const t=this.createLogoutUrlQueryString(e);return xt.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var u,d;(u=this.performanceClient)==null||u.addQueueMeasurement(fe.AuthClientExecuteTokenRequest,t.correlationId);const r=this.createTokenQueryParameters(t),s=xt.appendQueryString(e.tokenEndpoint,r),i=await je(this.createTokenRequestBody.bind(this),fe.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let o;if(t.clientInfo)try{const f=Sh(t.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${f.uid}${dr.CLIENT_INFO_SEPARATOR}${f.utid}`,type:Qr.HOME_ACCOUNT_ID}}catch(f){this.logger.verbose("Could not parse client info for CCS Header: "+f)}const a=this.createTokenRequestHeaders(o||t.ccsCredential),l={clientId:((d=t.tokenBodyParameters)==null?void 0:d.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return je(this.executePostToTokenEndpoint.bind(this),fe.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(s,i,a,l,t.correlationId,fe.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,i;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Dc(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[oa])||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Ha.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!Xm(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const o=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await rS(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(o.assertionType)}if(t.addGrantType(hI.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===Kt.POP){const o=new Il(this.cryptoUtils,this.performanceClient);let a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await je(o.generateCnf.bind(o),fe.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}else if(e.authenticationScheme===Kt.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw Qt($f);(!gs.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let r;if(e.clientInfo)try{const o=Sh(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${o.uid}${dr.CLIENT_INFO_SEPARATOR}${o.utid}`,type:Qr.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case Qr.HOME_ACCOUNT_ID:try{const o=Qa(r.credential);t.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Qr.UPN:t.addCcsUpn(r.credential);break}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Z1])&&t.addExtraQueryParameters({[Z1]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){var i,o;const t=e.correlationId||this.config.cryptoInterface.createNewGuid();(i=this.performanceClient)==null||i.addQueueMeasurement(fe.AuthClientCreateQueryString,t);const r=new Dc(t,this.performanceClient);r.addClientId(e.embeddedClientId||((o=e.extraQueryParameters)==null?void 0:o[oa])||this.config.authOptions.clientId);const s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(r.addScopes(s,!0,this.oidcDefaultScopes),r.addRedirectUri(e.redirectUri),r.addCorrelationId(t),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),Xm(this.config)||r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==Bn.SELECT_ACCOUNT)if(e.sid&&e.prompt===Bn.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){const a=this.extractAccountSid(e.account);let l=this.extractLoginHint(e.account);if(l&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(l);try{const u=Qa(e.account.homeAccountId);r.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&e.prompt===Bn.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(a);try{const u=Qa(e.account.homeAccountId);r.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{const u=Qa(e.account.homeAccountId);r.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,r),e.nativeBroker&&(r.addNativeBroker(),e.authenticationScheme===Kt.POP)){const a=new Il(this.cryptoUtils);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await je(a.generateCnf.bind(a),fe.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}return r.createQueryString()}createLogoutUrlQueryString(e){const t=new Dc(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return((t=e.idTokenClaims)==null?void 0:t.sid)||null}extractLoginHint(e){var t;return((t=e.idTokenClaims)==null?void 0:t.login_hint)||null}}/*! @azure/msal-common v14.16.1 2025-08-05 */const gU=300;class e0 extends ov{constructor(e,t){super(e,t)}async acquireToken(e){var o,a;(o=this.performanceClient)==null||o.addQueueMeasurement(fe.RefreshTokenClientAcquireToken,e.correlationId);const t=zs(),r=await je(this.executeTokenRequest.bind(this),fe.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=(a=r.headers)==null?void 0:a[wr.X_MS_REQUEST_ID],i=new aa(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(r.body),je(i.handleServerTokenResponse.bind(i),fe.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){var r;if(!e)throw Qt(UI);if((r=this.performanceClient)==null||r.addQueueMeasurement(fe.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw Ue(Wg);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await je(this.acquireTokenWithCachedRefreshToken.bind(this),fe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(s){const i=s instanceof Ts&&s.errorCode===kh,o=s instanceof To&&s.errorCode===B1.INVALID_GRANT_ERROR&&s.subError===B1.CLIENT_MISMATCH_ERROR;if(i||o)return je(this.acquireTokenWithCachedRefreshToken.bind(this),fe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw s}return je(this.acquireTokenWithCachedRefreshToken.bind(this),fe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(fe.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const r=ya(this.cacheManager.getRefreshToken.bind(this.cacheManager),fe.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!r)throw Zm(kh);if(r.expiresOn&&Qm(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||gU))throw Zm(av);const s={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Kt.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Qr.HOME_ACCOUNT_ID}};try{return await je(this.acquireToken.bind(this),fe.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(s)}catch(o){if(o instanceof Ts&&o.subError===Wf){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const a=Ya(r);this.cacheManager.removeRefreshToken(a,e.correlationId)}throw o}}async executeTokenRequest(e,t){var l,u;(l=this.performanceClient)==null||l.addQueueMeasurement(fe.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=this.createTokenQueryParameters(e),s=xt.appendQueryString(t.tokenEndpoint,r),i=await je(this.createTokenRequestBody.bind(this),fe.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),o=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:((u=e.tokenBodyParameters)==null?void 0:u.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return je(this.executePostToTokenEndpoint.bind(this),fe.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(s,i,o,a,e.correlationId,fe.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,i,o;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,r=new Dc(t,this.performanceClient);if(r.addClientId(e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[oa])||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,(o=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:o.defaultScopes),r.addGrantType(hI.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!Xm(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await rS(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(a.assertionType)}if(e.authenticationScheme===Kt.POP){const a=new Il(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await je(a.generateCnf.bind(a),fe.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}else if(e.authenticationScheme===Kt.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw Qt($f);if((!gs.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Qr.HOME_ACCOUNT_ID:try{const a=Qa(e.ccsCredential.credential);r.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Qr.UPN:r.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}/*! @azure/msal-common v14.16.1 2025-08-05 */class vU extends ov{constructor(e,t){super(e,t)}async acquireToken(e){var t;try{const[r,s]=await this.acquireCachedToken({...e,scopes:(t=e.scopes)!=null&&t.length?e.scopes:[...Bl]});return s===Qi.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new e0(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),r}catch(r){if(r instanceof Uf&&r.errorCode===yi)return new e0(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw r}}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(fe.SilentFlowClientAcquireCachedToken,e.correlationId);let t=Qi.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!gs.isEmptyObj(e.claims))throw this.setCacheOutcome(Qi.FORCE_REFRESH_OR_CLAIMS,e.correlationId),Ue(yi);if(!e.account)throw Ue(Wg);const r=e.account.tenantId||oU(e.authority),s=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,s,r,this.performanceClient);if(i){if(qL(i.cachedAt)||Qm(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Qi.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),Ue(yi);i.refreshOn&&Qm(i.refreshOn,0)&&(t=Qi.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Qi.NO_CACHED_ACCESS_TOKEN,e.correlationId),Ue(yi);const o=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,s,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(o)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await je(this.generateResultFromCacheRecord.bind(this),fe.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){var r,s;(r=this.serverTelemetryManager)==null||r.setCacheOutcome(e),(s=this.performanceClient)==null||s.addFields({cacheOutcome:e},t),e!==Qi.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(fe.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let r;if(e.idToken&&(r=va(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const i=r==null?void 0:r.auth_time;if(!i)throw Ue(jg);PI(i,t.maxAge)}return aa.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const yU={sendGetRequestAsync:()=>Promise.reject(Ue(Tt)),sendPostRequestAsync:()=>Promise.reject(Ue(Tt))};/*! @azure/msal-common v14.16.1 2025-08-05 */const rE=",",iS="|";function _U(n){const{skus:e,libraryName:t,libraryVersion:r,extensionName:s,extensionVersion:i}=n,o=new Map([[0,[t,r]],[2,[s,i]]]);let a=[];if(e!=null&&e.length){if(a=e.split(rE),a.length<4)return e}else a=Array.from({length:4},()=>iS);return o.forEach((l,u)=>{var d,f;l.length===2&&((d=l[0])!=null&&d.length)&&((f=l[1])!=null&&f.length)&&EU({skuArr:a,index:u,skuName:l[0],skuVersion:l[1]})}),a.join(rE)}function EU(n){const{skuArr:e,index:t,skuName:r,skuVersion:s}=n;t>=e.length||(e[t]=[r,s].join(iS))}class tu{constructor(e,t){this.cacheOutcome=Qi.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Ae.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Ae.EMPTY_STRING,this.telemetryCacheKey=Gn.CACHE_KEY+dr.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${Gn.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r!=null&&r.length&&t.push(`broker_error=${r}`);const s=t.join(Gn.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),o=[e,i].join(Gn.VALUE_SEPARATOR);return[Gn.SCHEMA_VERSION,o,s].join(Gn.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=tu.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(Gn.VALUE_SEPARATOR),s=e.errors.slice(0,t).join(Gn.VALUE_SEPARATOR),i=e.errors.length,o=t<i?Gn.OVERFLOW_TRUE:Gn.OVERFLOW_FALSE,a=[i,o].join(Gn.VALUE_SEPARATOR);return[Gn.SCHEMA_VERSION,e.cacheHits,r,s,a].join(Gn.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=Gn.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof sn?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Gn.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=tu.maxErrorsToSend(e),r=e.errors.length;if(t===r)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const s={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s,this.correlationId)}}static maxErrorsToSend(e){let t,r=0,s=0;const i=e.errors.length;for(t=0;t<i;t++){const o=e.failedRequests[2*t]||Ae.EMPTY_STRING,a=e.failedRequests[2*t+1]||Ae.EMPTY_STRING,l=e.errors[t]||Ae.EMPTY_STRING;if(s+=o.toString().length+a.toString().length+l.length+3,s<Gn.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||Ae.EMPTY_STRING),e.push(this.regionSource||Ae.EMPTY_STRING),e.push(this.regionOutcome||Ae.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return _U(e)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const oS="missing_kid_error",aS="missing_alg_error";/*! @azure/msal-common v14.16.1 2025-08-05 */const TU={[oS]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[aS]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class cv extends sn{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,cv.prototype)}}function sE(n){return new cv(n,TU[n])}/*! @azure/msal-common v14.16.1 2025-08-05 */class uv{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw sE(oS);if(!e.alg)throw sE(aS);const t=new uv({typ:e.typ||RL.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class iE{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class wU{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:iU.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new iE}}startPerformanceMeasurement(){return new iE}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const dv="pkce_not_created",t0="crypto_nonexistent",Kf="empty_navigate_uri",lS="hash_empty_error",hv="no_state_in_hash",cS="hash_does_not_contain_known_properties",uS="unable_to_parse_state",dS="state_interaction_type_mismatch",hS="interaction_in_progress",fS="popup_window_error",pS="empty_window_error",la="user_cancelled",CU="monitor_popup_timeout",mS="monitor_window_timeout",gS="redirect_in_iframe",vS="block_iframe_reload",yS="block_nested_popups",AU="iframe_closed_prematurely",qf="silent_logout_unsupported",_S="no_account_error",IU="silent_prompt_value_error",ES="no_token_request_cache_error",TS="unable_to_parse_token_request_cache_error",fv="no_cached_authority_error",SU="auth_request_not_set_error",xU="invalid_cache_type",Gf="non_browser_environment",ja="database_not_open",Ph="no_network_connectivity",wS="post_request_failed",CS="get_request_failed",n0="failed_to_parse_response",AS="unable_to_load_token",pv="crypto_key_not_found",IS="auth_code_required",SS="auth_code_or_nativeAccountId_required",xS="spa_code_and_nativeAccountId_present",mv="database_unavailable",bS="unable_to_acquire_token_from_native_platform",RS="native_handshake_timeout",kS="native_extension_not_installed",Nu="native_connection_not_established",PS="uninitialized_public_client_application",NS="native_prompt_not_supported",OS="invalid_base64_string",DS="invalid_pop_token_request",MS="failed_to_build_headers",FS="failed_to_parse_headers";/*! @azure/msal-browser v3.30.0 2025-08-05 */const oi="For more visit: aka.ms/msaljs/browser-errors",bU={[dv]:"The PKCE code challenge and verifier could not be generated.",[t0]:"The crypto object or function is not available.",[Kf]:"Navigation URI is empty. Please check stack trace for more info.",[lS]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${oi}`,[hv]:"Hash does not contain state. Please verify that the request originated from msal.",[cS]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${oi}`,[uS]:"Unable to parse state. Please verify that the request originated from msal.",[dS]:"Hash contains state but the interaction type does not match the caller.",[hS]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${oi}`,[fS]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[pS]:"window.open returned null or undefined window object.",[la]:"User cancelled the flow.",[CU]:`Token acquisition in popup failed due to timeout.  ${oi}`,[mS]:`Token acquisition in iframe failed due to timeout.  ${oi}`,[gS]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[vS]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${oi}`,[yS]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[AU]:"The iframe being monitored was closed prematurely.",[qf]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[_S]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[IU]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[ES]:"No token request found in cache.",[TS]:"The cached token request could not be parsed.",[fv]:"No cached authority found.",[SU]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[xU]:"Invalid cache type",[Gf]:"Login and token requests are not supported in non-browser environments.",[ja]:"Database is not open!",[Ph]:"No network connectivity. Check your internet connection.",[wS]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[CS]:"Network request failed. Please check the network trace to determine root cause.",[n0]:"Failed to parse network response. Check network trace.",[AS]:"Error loading token to cache.",[pv]:"Cryptographic Key or Keypair not found in browser storage.",[IS]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[SS]:"An authorization code or nativeAccountId must be provided to this flow.",[xS]:"Request cannot contain both spa code and native account id.",[mv]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[bS]:`Unable to acquire token from native platform.  ${oi}`,[RS]:"Timed out while attempting to establish connection to browser extension",[kS]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Nu]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${oi}`,[PS]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${oi}`,[NS]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[OS]:"Invalid base64 encoded string.",[DS]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[MS]:"Failed to build request headers object.",[FS]:"Failed to parse response headers"};class Ou extends sn{constructor(e,t){super(e,bU[e],t),Object.setPrototypeOf(this,Ou.prototype),this.name="BrowserAuthError"}}function Je(n,e){return new Ou(n,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Wr={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Xa={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Ho={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},Pr={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},oE={GET:"GET",POST:"POST"},Bt={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Zr={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys",VERSION:"msal.version"},Ed={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},tn={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var rt;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})(rt||(rt={}));const aE={scopes:Bl},LS="jwk",r0="msal.db",RU=1,kU=`${r0}.keys`,$r={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},PU=[$r.Default,$r.Skip,$r.RefreshTokenAndNetwork],NU="msal.browser.log.level",OU="msal.browser.log.pii";/*! @azure/msal-browser v3.30.0 2025-08-05 */function Td(n){return encodeURIComponent(gv(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function zf(n){return US(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function gv(n){return US(new TextEncoder().encode(n))}function US(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const DU="RSASSA-PKCS1-v1_5",BS="SHA-256",MU=2048,FU=new Uint8Array([1,0,1]),lE="0123456789abcdef",cE=new Uint32Array(1),LU="crypto_subtle_undefined",vv={name:DU,hash:BS,modulusLength:MU,publicExponent:FU};function UU(n){if(!window)throw Je(Gf);if(!window.crypto)throw Je(t0);if(!n&&!window.crypto.subtle)throw Je(t0,LU)}async function VS(n,e,t){e==null||e.addQueueMeasurement(fe.Sha256Digest,t);const s=new TextEncoder().encode(n);return window.crypto.subtle.digest(BS,s)}function BU(n){return window.crypto.getRandomValues(n)}function jp(){return window.crypto.getRandomValues(cE),cE[0]}function Ys(){const n=Date.now(),e=jp()*1024+(jp()&1023),t=new Uint8Array(16),r=Math.trunc(e/2**30),s=e&2**30-1,i=jp();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|r>>>8,t[7]=r,t[8]=128|s>>>24,t[9]=s>>>16,t[10]=s>>>8,t[11]=s,t[12]=i>>>24,t[13]=i>>>16,t[14]=i>>>8,t[15]=i;let o="";for(let a=0;a<t.length;a++)o+=lE.charAt(t[a]>>>4),o+=lE.charAt(t[a]&15),(a===3||a===5||a===7||a===9)&&(o+="-");return o}async function VU(n,e){return window.crypto.subtle.generateKey(vv,n,e)}async function Wp(n){return window.crypto.subtle.exportKey(LS,n)}async function $U(n,e,t){return window.crypto.subtle.importKey(LS,n,vv,e,t)}async function HU(n,e){return window.crypto.subtle.sign(vv,n,e)}async function $S(n){const e=await VS(n),t=new Uint8Array(e);return zf(t)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const yv="storage_not_supported",jU="stubbed_public_client_application_called",HS="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.30.0 2025-08-05 */const WU={[yv]:"Given storage configuration option was not supported.",[jU]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[HS]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class _v extends sn{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,_v.prototype)}}function Ev(n){return new _v(n,WU[n])}/*! @azure/msal-browser v3.30.0 2025-08-05 */function KU(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function qU(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Tv(){return window.parent!==window}function GU(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Wr.POPUP_NAME_PREFIX}.`)===0}function _i(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function zU(){const e=new xt(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function YU(){if(xt.hashContainsKnownProperties(window.location.hash)&&Tv())throw Je(vS)}function QU(n){if(Tv()&&!n)throw Je(gS)}function XU(){if(GU())throw Je(yS)}function jS(){if(typeof window>"u")throw Je(Gf)}function WS(n){if(!n)throw Je(PS)}function wv(n){jS(),YU(),XU(),WS(n)}function uE(n,e){if(wv(n),QU(e.system.allowRedirectInIframe),e.cache.cacheLocation===Pr.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw Ev(HS)}function KS(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function JU(){return Ys()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Nh{navigateInternal(e,t){return Nh.defaultNavigateWindow(e,t)}navigateExternal(e,t){return Nh.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(r=>{setTimeout(()=>{r(!0)},t.timeout)})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class ZU{async sendGetRequestAsync(e,t){let r,s={},i=0;const o=dE(t);try{r=await fetch(e,{method:oE.GET,headers:o})}catch{throw Je(window.navigator.onLine?CS:Ph)}s=hE(r.headers);try{return i=r.status,{headers:s,body:await r.json(),status:i}}catch{throw eE(Je(n0),i,s)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",s=dE(t);let i,o=0,a={};try{i=await fetch(e,{method:oE.POST,headers:s,body:r})}catch{throw Je(window.navigator.onLine?wS:Ph)}a=hE(i.headers);try{return o=i.status,{headers:a,body:await i.json(),status:o}}catch{throw eE(Je(n0),o,a)}}}function dE(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([r,s])=>{e.append(r,s)}),e}catch{throw Je(MS)}}function hE(n){try{const e={};return n.forEach((t,r)=>{e[r]=t}),e}catch{throw Je(FS)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const e6=6e4,s0=1e4,t6=3e4,n6=2e3;function r6({auth:n,cache:e,system:t,telemetry:r},s){const i={clientId:Ae.EMPTY_STRING,authority:`${Ae.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:Ae.EMPTY_STRING,authorityMetadata:Ae.EMPTY_STRING,redirectUri:typeof window<"u"?_i():"",postLogoutRedirectUri:Ae.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Ai.AAD,OIDCOptions:{serverResponseType:Pu.FRAGMENT,defaultScopes:[Ae.OPENID_SCOPE,Ae.PROFILE_SCOPE,Ae.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:zg.None,tenant:Ae.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},o={cacheLocation:Pr.SessionStorage,temporaryCacheLocation:Pr.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===Pr.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:ln.Info,piiLoggingEnabled:!1},u={...{...JI,loggerOptions:a,networkClient:s?new ZU:yU,navigationClient:new Nh,loadFrameTimeout:0,windowHashTimeout:(t==null?void 0:t.loadFrameTimeout)||e6,iframeHashTimeout:(t==null?void 0:t.loadFrameTimeout)||s0,navigateFrameWait:0,redirectNavigationTimeout:t6,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(t==null?void 0:t.nativeBrokerHandshakeTimeout)||n6,pollIntervalMilliseconds:Wr.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:(t==null?void 0:t.loggerOptions)||a},d={application:{appName:Ae.EMPTY_STRING,appVersion:Ae.EMPTY_STRING},client:new wU};if((n==null?void 0:n.protocolMode)!==Ai.OIDC&&(n!=null&&n.OIDCOptions)&&new Eo(u.loggerOptions).warning(JSON.stringify(Qt(WI))),n!=null&&n.protocolMode&&n.protocolMode!==Ai.AAD&&(u!=null&&u.allowNativeBroker))throw Qt(KI);return{auth:{...i,...n,OIDCOptions:{...i.OIDCOptions,...n==null?void 0:n.OIDCOptions}},cache:{...o,...e},system:u,telemetry:{...d,...r}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const s6="@azure/msal-browser",Sl="3.30.0";/*! @azure/msal-browser v3.30.0 2025-08-05 */class Cv{static loggerCallback(e,t){switch(e){case ln.Error:console.error(t);return;case ln.Info:console.info(t);return;case ln.Verbose:console.debug(t);return;case ln.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=r6(e,this.browserEnvironment);let t;try{t=window[Pr.SessionStorage]}catch{}const r=t==null?void 0:t.getItem(NU),s=(l=t==null?void 0:t.getItem(OU))==null?void 0:l.toLowerCase(),i=s==="true"?!0:s==="false"?!1:void 0,o={...this.config.system.loggerOptions},a=r&&Object.keys(ln).includes(r)?ln[r]:void 0;a&&(o.loggerCallback=Cv.loggerCallback,o.logLevel=a),i!==void 0&&(o.piiLoggingEnabled=i),this.logger=new Eo(o,s6,Sl),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class ca extends Cv{getModuleName(){return ca.MODULE_NAME}getId(){return ca.ID}async initialize(){return this.available=typeof window<"u",this.available}}ca.MODULE_NAME="";ca.ID="StandardOperatingContext";/*! @azure/msal-browser v3.30.0 2025-08-05 */function js(n){return new TextDecoder().decode(i6(n))}function i6(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Je(OS)}const t=atob(e);return Uint8Array.from(t,r=>r.codePointAt(0)||0)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class o6{constructor(){this.dbName=r0,this.version=RU,this.tableName=kU,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",s=>{s.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",s=>{const i=s;this.db=i.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>t(Je(mv)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(Je(ja));const o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);o.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result)}),o.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((r,s)=>{if(!this.db)return s(Je(ja));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",l=>{this.closeConnection(),s(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(Je(ja));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);o.addEventListener("success",()=>{this.closeConnection(),t()}),o.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Je(ja));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",o=>{const a=o;this.closeConnection(),e(a.target.result)}),i.addEventListener("error",o=>{this.closeConnection(),t(o)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(Je(ja));const o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);o.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result===1)}),o.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const r=window.indexedDB.deleteDatabase(r0),s=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(s),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(s),e(!0))),r.addEventListener("error",()=>(clearTimeout(s),t(!1)))})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class i0{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class a6{constructor(e){this.inMemoryCache=new i0,this.indexedDBCache=new o6,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Ou&&e.errorCode===mv)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(r){this.handleDatabaseAccessError(r)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class xl{constructor(e,t,r){this.logger=e,UU(r??!1),this.cache=new a6(this.logger),this.performanceClient=t}createNewGuid(){return Ys()}base64Encode(e){return gv(e)}base64Decode(e){return js(e)}base64UrlEncode(e){return Td(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var d;const t=(d=this.performanceClient)==null?void 0:d.startMeasurement(fe.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await VU(xl.EXTRACTABLE,xl.POP_KEY_USAGES),s=await Wp(r.publicKey),i={e:s.e,kty:s.kty,n:s.n},o=fE(i),a=await this.hashString(o),l=await Wp(r.privateKey),u=await $U(l,!1,["sign"]);return await this.cache.setItem(a,{privateKey:u,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,s){var A;const i=(A=this.performanceClient)==null?void 0:A.startMeasurement(fe.CryptoOptsSignJwt,s),o=await this.cache.getItem(t);if(!o)throw Je(pv);const a=await Wp(o.publicKey),l=fE(a),u=Td(JSON.stringify({kid:t})),d=uv.getShrHeaderString({...r==null?void 0:r.header,alg:a.alg,kid:u}),f=Td(d);e.cnf={jwk:JSON.parse(l)};const p=Td(JSON.stringify(e)),m=`${f}.${p}`,v=new TextEncoder().encode(m),y=await HU(o.privateKey,v),L=zf(new Uint8Array(y)),D=`${m}.${L}`;return i&&i.end({success:!0}),D}async hashString(e){return $S(e)}}xl.POP_KEY_USAGES=["sign","verify"];xl.EXTRACTABLE=!0;function fE(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v3.30.0 2025-08-05 */class l6{constructor(){if(!window.localStorage)throw Ev(yv)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class c6{constructor(){if(!window.sessionStorage)throw Ev(yv)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function qS(n,e){if(!e)return null;try{return vs.parseRequestState(n,e).libraryState.meta}catch{throw Ue(Cl)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const u6=24*60*60*1e3;class d6{getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let s=0;s<r.length;s++){const i=r[s],[o,...a]=decodeURIComponent(i).trim().split("="),l=a.join("=");if(o===t)return l}return""}setItem(e,t,r,s=!0){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(r){const o=h6(r);i+=`expires=${o};`}s&&(i+="Secure;"),document.cookie=i}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(r=>{const s=decodeURIComponent(r).trim().split("=");t.push(s[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function h6(n){const e=new Date;return new Date(e.getTime()+n*u6).toUTCString()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class o0 extends Al{constructor(e,t,r,s,i,o){super(e,r,s,i),this.cacheConfig=t,this.logger=s,this.internalStorage=new i0,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new d6,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=o}setupBrowserStorage(e){try{switch(e){case Pr.LocalStorage:return new l6;case Pr.SessionStorage:return new c6;case Pr.MemoryStorage:default:break}}catch(t){this.logger.error(t)}return this.cacheConfig.cacheLocation=Pr.MemoryStorage,new i0}migrateCacheEntries(){const e=this.browserStorage.getItem(Zr.VERSION);e&&this.logger.info(`MSAL.js was last initialized with version ${e}`),e!==Sl&&this.browserStorage.setItem(Zr.VERSION,Sl);const t=`${Ae.CACHE_PREFIX}.${Ln.ID_TOKEN}`,r=`${Ae.CACHE_PREFIX}.${Ln.CLIENT_INFO}`,s=`${Ae.CACHE_PREFIX}.${Ln.ERROR}`,i=`${Ae.CACHE_PREFIX}.${Ln.ERROR_DESC}`,o=this.browserStorage.getItem(t),a=this.browserStorage.getItem(r),l=this.browserStorage.getItem(s),u=this.browserStorage.getItem(i),d=[o,a,l,u];[Ln.ID_TOKEN,Ln.CLIENT_INFO,Ln.ERROR,Ln.ERROR_DESC].forEach((p,m)=>{const g=d[m];g&&this.setTemporaryCache(p,g,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.cryptoImpl.createNewGuid(),t=this.getItem(Zr.ACCOUNT_KEYS),r=this.getItem(`${Zr.TOKEN_KEYS}.${this.clientId}`);if(t&&r){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(i=>{if(this.isCredentialKey(i)){const o=this.getItem(i);if(o){const a=this.validateAndParseJson(o);if(a&&a.hasOwnProperty("credentialType"))switch(a.credentialType){case ht.ID_TOKEN:if(W1(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${i} found, saving key to token key map`);const l=a,u=this.updateCredentialCacheKey(i,l,e);this.addTokenKey(u,ht.ID_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${i}`);break;case ht.ACCESS_TOKEN:case ht.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(j1(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${i} found, saving key to token key map`);const l=a,u=this.updateCredentialCacheKey(i,l,e);this.addTokenKey(u,ht.ACCESS_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${i}`);break;case ht.REFRESH_TOKEN:if(K1(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${i} found, saving key to token key map`);const l=a,u=this.updateCredentialCacheKey(i,l,e);this.addTokenKey(u,ht.REFRESH_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${i}`);break}}}if(this.isAccountKey(i)){const o=this.getItem(i);if(o){const a=this.validateAndParseJson(o);a&&Fn.isAccountEntity(a)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${i} found, saving key to account key map`),this.addAccountKeyToMap(i,e))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t,r){let s=[];for(let o=0;o<=20;o++)try{this.browserStorage.setItem(e,t),o>0&&this.removeAccessTokenKeys(s.slice(0,o),r);break}catch(a){const l=XI(a);if(l.errorCode===rv&&o<20){if(s.length||(e===`${Zr.TOKEN_KEYS}.${this.clientId}`?s=JSON.parse(t).accessToken:s=this.getTokenKeys().accessToken),s.length<=o)throw l;this.removeAccessToken(s[o],r,!1)}else throw l}}getAccount(e,t,r){this.logger.trace("BrowserCacheManager.getAccount called");const s=this.getCachedAccountEntity(e,t);return this.updateOutdatedCachedAccount(e,s,t,r)}getCachedAccountEntity(e,t){const r=this.getItem(e);if(!r)return this.removeAccountKeyFromMap(e,t),null;const s=this.validateAndParseJson(r);return!s||!Fn.isAccountEntity(s)?null:Al.toObject(new Fn,s)}setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey();e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addAccountKeyToMap(r,t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(Zr.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const r=this.getAccountKeys();r.indexOf(e)===-1?(r.push(e),this.setItem(Zr.ACCOUNT_KEYS,JSON.stringify(r),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const r=this.getAccountKeys(),s=r.indexOf(e);if(s>-1){if(r.splice(s,1),r.length===0){this.removeItem(Zr.ACCOUNT_KEYS);return}else this.setItem(Zr.ACCOUNT_KEYS,JSON.stringify(r),t);this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeOutdatedAccount(e,t){this.removeItem(e),this.removeAccountKeyFromMap(e,t)}removeIdToken(e,t){super.removeIdToken(e,t),this.removeTokenKey(e,ht.ID_TOKEN,t)}removeAccessToken(e,t,r=!0){var s;super.removeAccessToken(e,t),(s=this.performanceClient)==null||s.incrementFields({accessTokensRemoved:1},t),r&&this.removeTokenKey(e,ht.ACCESS_TOKEN,t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");const r=this.getTokenKeys();let s=0;if(e.forEach(i=>{const o=r.accessToken.indexOf(i);o>-1&&(r.accessToken.splice(o,1),s++)}),s>0){this.logger.info(`removed ${s} accessToken keys from tokenKeys map`),this.setTokenKeys(r,t);return}}removeRefreshToken(e,t){super.removeRefreshToken(e,t),this.removeTokenKey(e,ht.REFRESH_TOKEN,t)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${Zr.TOKEN_KEYS}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}setTokenKeys(e,t){if(e.idToken.length===0&&e.accessToken.length===0&&e.refreshToken.length===0){this.removeItem(`${Zr.TOKEN_KEYS}.${this.clientId}`);return}else this.setItem(`${Zr.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(e),t)}addTokenKey(e,t,r){this.logger.trace("BrowserCacheManager addTokenKey called");const s=this.getTokenKeys();switch(t){case ht.ID_TOKEN:s.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),s.idToken.push(e));break;case ht.ACCESS_TOKEN:const i=s.accessToken.indexOf(e);i!==-1&&s.accessToken.splice(i,1),this.logger.trace(`access token ${i===-1?"added to":"updated in"} map`),s.accessToken.push(e);break;case ht.REFRESH_TOKEN:s.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),s.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Ue(Ym)}this.setTokenKeys(s,r)}removeTokenKey(e,t,r,s=this.getTokenKeys()){switch(this.logger.trace("BrowserCacheManager removeTokenKey called"),t){case ht.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const i=s.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),s.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case ht.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=s.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),s.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case ht.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const a=s.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),s.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Ue(Ym)}this.setTokenKeys(s,r)}getIdTokenCredential(e,t){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const s=this.validateAndParseJson(r);return!s||!W1(s)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),s)}setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=Ya(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,ht.ID_TOKEN,t)}getAccessTokenCredential(e,t){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,ht.ACCESS_TOKEN,t),null;const s=this.validateAndParseJson(r);return!s||!j1(s)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),s)}setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=Ya(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,ht.ACCESS_TOKEN,t)}getRefreshTokenCredential(e,t){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,ht.REFRESH_TOKEN,t),null;const s=this.validateAndParseJson(r);return!s||!K1(s)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),s)}setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=Ya(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,ht.REFRESH_TOKEN,t)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!t3(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r)}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const r=e3(e);this.setItem(r,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!JL(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r)}setServerTelemetry(e,t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),r)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&n3(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(Ed.WRAPPER_SKU,e),this.internalStorage.setItem(Ed.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(Ed.WRAPPER_SKU)||Ae.EMPTY_STRING,t=this.internalStorage.getItem(Ed.WRAPPER_VER)||Ae.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(Ln.ACTIVE_ACCOUNT_FILTERS),r=this.getItem(t);if(!r){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const i=this.generateCacheKey(Ln.ACTIVE_ACCOUNT),o=this.getItem(i);if(!o)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const a=this.getAccountInfoFilteredBy({localAccountId:o},e);return a?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(a,e),a):null}const s=this.validateAndParseJson(r);return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:s.homeAccountId,localAccountId:s.localAccountId,tenantId:s.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const r=this.generateCacheKey(Ln.ACTIVE_ACCOUNT_FILTERS),s=this.generateCacheKey(Ln.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Date.now().toString()};this.setItem(r,JSON.stringify(i),t),this.setItem(s,e.localAccountId,t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r),this.browserStorage.removeItem(s)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!ZL(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r)}setThrottlingCache(e,t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),r)}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const i=this.cookieStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}const s=this.temporaryCacheStorage.getItem(r);if(!s){if(this.cacheConfig.cacheLocation===Pr.LocalStorage){const i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s}setTemporaryCache(e,t,r){const s=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(s,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(s,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(e){await this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(t=>{(t.indexOf(Ae.CACHE_PREFIX)!==-1||t.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(t)}),this.browserStorage.getKeys().forEach(t=>{(t.indexOf(Ae.CACHE_PREFIX)!==-1||t.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(t)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(fe.ClearTokensAndKeysWithClaims,t);const r=this.getTokenKeys();let s=0;r.accessToken.forEach(i=>{const o=this.getAccessTokenCredential(i,t);o!=null&&o.requestedClaimsHash&&i.includes(o.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(i,t),s++)}),s>0&&this.logger.warning(`${s} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):gs.startsWith(e,Ae.CACHE_PREFIX)||gs.startsWith(e,Ln.ADAL_ID_TOKEN)?e:`${Ae.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=vs.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Bt.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=vs.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Bt.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=vs.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Bt.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;const s=this.generateAuthorityKey(r);return this.getTemporaryCache(s)}updateCacheEntries(e,t,r,s,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const o=this.generateStateKey(e);this.setTemporaryCache(o,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,r,!1),i){const u={credential:i.homeAccountId,type:Qr.HOME_ACCOUNT_ID};this.setTemporaryCache(Bt.CCS_CREDENTIAL,JSON.stringify(u),!0)}else if(s){const u={credential:s,type:Qr.UPN};this.setTemporaryCache(Bt.CCS_CREDENTIAL,JSON.stringify(u),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(Bt.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Bt.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Bt.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Bt.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(Bt.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(Bt.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||Ae.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(Bt.REQUEST_STATE)===-1)return;const r=this.temporaryCacheStorage.getItem(t);if(!r)return;const s=qS(this.cryptoImpl,r);s&&s.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=gv(JSON.stringify(e));this.setTemporaryCache(Bt.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(Bt.REQUEST_PARAMS,!0);if(!t)throw Je(ES);let r;try{r=JSON.parse(js(t))}catch(s){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${s}`),Je(TS)}if(this.removeTemporaryItem(this.generateCacheKey(Bt.REQUEST_PARAMS)),!r.authority){const s=this.generateAuthorityKey(e),i=this.getTemporaryCache(s);if(!i)throw Je(fv);r.authority=i}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Bt.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${Ae.CACHE_PREFIX}.${Bt.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${Ae.CACHE_PREFIX}.${Bt.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Je(hS);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(Ln.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(Ln.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(Ln.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(Ln.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=t||e;if(r){const s=va(r,js);if(s.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),s.preferred_username;if(s.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),s.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t,r){const s=Ya(t);if(e!==s){const i=this.getItem(e);if(i)return this.browserStorage.removeItem(e),this.setItem(s,i,r),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),s;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){var a,l,u;const r=Bf((a=e.account)==null?void 0:a.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const i=Vf((u=e.account)==null?void 0:u.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,js,void 0,e.tokenType,void 0,t.sshKid,t.claims,s),o={idToken:r,accessToken:i};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(s){if(s instanceof al&&this.performanceClient&&t)try{const i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},t)}catch{}throw s}}}const f6=(n,e)=>{const t={cacheLocation:Pr.MemoryStorage,temporaryCacheLocation:Pr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new o0(n,t,Ih,e)};/*! @azure/msal-browser v3.30.0 2025-08-05 */function p6(n,e,t,r,s){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(r,s):[]}function m6(n,e,t,r){if(e.trace("getAccount called"),Object.keys(n).length===0)return e.warning("getAccount: No accountFilter provided"),null;const s=t.getAccountInfoFilteredBy(n,r);return s?(e.verbose("getAccount: Account matching provided filter found, returning"),s):(e.verbose("getAccount: No matching account found, returning null"),null)}function g6(n,e,t,r){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const s=t.getAccountInfoFilteredBy({username:n},r);return s?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),s):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function v6(n,e,t,r){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const s=t.getAccountInfoFilteredBy({homeAccountId:n},r);return s?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),s):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function y6(n,e,t,r){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const s=t.getAccountInfoFilteredBy({localAccountId:n},r);return s?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),s):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function _6(n,e,t){e.setActiveAccount(n,t)}function E6(n,e){return n.getActiveAccount(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const at={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.30.0 2025-08-05 */class T6{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Eo({})}addEventCallback(e,t,r){if(typeof window<"u"){const s=r||JU();return this.eventCallbacks.has(s)?(this.logger.error(`Event callback with id: ${s} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(s,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${s}`),s)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,s){if(typeof window<"u"){const i={eventType:e,interactionType:t||null,payload:r||null,error:s||null,timestamp:Date.now()};this.eventCallbacks.forEach(([o,a],l)=>{(a.length===0||a.includes(e))&&(this.logger.verbose(`Emitting event to callback ${l}: ${e}`),o.apply(null,[i]))})}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class GS{constructor(e,t,r,s,i,o,a,l,u){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=o,this.nativeMessageHandler=l,this.correlationId=u||Ys(),this.logger=s.clone(Wr.MSAL_SKU,Sl,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){Fn.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(this.correlationId),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,this.correlationId));try{await this.browserStorage.removeAccount(Fn.generateAccountCacheKey(e),this.correlationId),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(this.correlationId),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return xt.getAbsoluteUrl(t,_i())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new tu(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(fe.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const s={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,o=r!=null&&r.length?r==="true":this.config.auth.instanceAware,a=t&&o?this.config.auth.authority.replace(xt.getDomainFromUrl(i),t.environment):i,l=ar.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),u=await je(tS,fe.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,s,this.logger,this.correlationId,this.performanceClient);if(t&&!u.isAlias(t.environment))throw Qt(qI);return u}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const w6=32;async function C6(n,e,t){n.addQueueMeasurement(fe.GeneratePkceCodes,t);const r=ya(A6,fe.GenerateCodeVerifier,e,n,t)(n,e,t),s=await je(I6,fe.GenerateCodeChallengeFromVerifier,e,n,t)(r,n,e,t);return{verifier:r,challenge:s}}function A6(n,e,t){try{const r=new Uint8Array(w6);return ya(BU,fe.GetRandomValues,e,n,t)(r),zf(r)}catch{throw Je(dv)}}async function I6(n,e,t,r){e.addQueueMeasurement(fe.GenerateCodeChallengeFromVerifier,r);try{const s=await je(VS,fe.Sha256Digest,t,e,r)(n,e,r);return zf(new Uint8Array(s))}catch{throw Je(dv)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function Av(n,e,t,r){t.addQueueMeasurement(fe.InitializeBaseRequest,n.correlationId);const s=n.authority||e.auth.authority,i=[...n&&n.scopes||[]],o={...n,correlationId:n.correlationId,authority:s,scopes:i};if(!o.authenticationScheme)o.authenticationScheme=Kt.BEARER,r.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(o.authenticationScheme===Kt.SSH){if(!n.sshJwk)throw Qt($f);if(!n.sshKid)throw Qt(jI)}r.verbose(`Authentication Scheme set to "${o.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!gs.isEmptyObj(n.claims)&&(o.requestedClaimsHash=await $S(n.claims)),o}async function S6(n,e,t,r,s){r.addQueueMeasurement(fe.InitializeSilentRequest,n.correlationId);const i=await je(Av,fe.InitializeBaseRequest,s,r,n.correlationId)(n,t,r,s);return{...n,...i,account:e,forceRefresh:n.forceRefresh||!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Vl extends GS{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(fe.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const t=await je(C6,fe.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:Ae.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=Ae.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const t={correlationId:this.correlationId||Ys(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=xt.getAbsoluteUrl(e.postLogoutRedirectUri,_i())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=xt.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,_i())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=xt.getAbsoluteUrl(_i(),_i())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(fe.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await je(this.getClientConfiguration.bind(this),fe.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new sS(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:s,requestExtraQueryParameters:i,account:o}=e;this.performanceClient.addQueueMeasurement(fe.StandardInteractionClientGetClientConfiguration,this.correlationId);const a=await je(this.getDiscoveredAuthority.bind(this),fe.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:s,requestExtraQueryParameters:i,account:o}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Wr.MSAL_SKU,version:Sl,cpu:Ae.EMPTY_STRING,os:Ae.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(fe.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),s={interactionType:t},i=vs.setRequestState(this.browserCrypto,e&&e.state||Ae.EMPTY_STRING,s),a={...await je(Av,fe.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:i,nonce:e.nonce||Ys(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return a;const l=e.account||this.browserStorage.getActiveAccount(this.correlationId);if(l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),a.account=l),!a.loginHint&&!l){const u=this.browserStorage.getLegacyLoginHint();u&&(a.loginHint=u)}return a}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const x6="ContentError",zS="user_switch";/*! @azure/msal-browser v3.30.0 2025-08-05 */const b6="USER_INTERACTION_REQUIRED",R6="USER_CANCEL",k6="NO_NETWORK",P6="PERSISTENT_ERROR",N6="DISABLED",O6="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.30.0 2025-08-05 */const D6=-2147186943,M6={[zS]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Os extends sn{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Os.prototype),this.name="NativeAuthError",this.ext=r}}function Wa(n){if(n.ext&&n.ext.status&&(n.ext.status===P6||n.ext.status===N6)||n.ext&&n.ext.error&&n.ext.error===D6)return!0;switch(n.errorCode){case x6:return!0;default:return!1}}function a0(n,e,t){if(t&&t.status)switch(t.status){case O6:return Zm(nS);case b6:return new Ts(n,e);case R6:return Je(la);case k6:return Je(Ph)}return new Os(n,M6[n]||e,t)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class YS extends Vl{async acquireToken(e){this.performanceClient.addQueueMeasurement(fe.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(tn.acquireTokenSilent_silentFlow),r=await je(this.getClientConfiguration.bind(this),fe.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),s=new vU(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const o=(await je(s.acquireCachedToken.bind(s),fe.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),o}catch(i){throw i instanceof Ou&&i.errorCode===pv&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t==null?void 0:t.account)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class ll extends GS{constructor(e,t,r,s,i,o,a,l,u,d,f,p){var g;super(e,t,r,s,i,o,l,u,p),this.apiId=a,this.accountId=d,this.nativeMessageHandler=u,this.nativeStorageManager=f,this.silentCacheClient=new YS(e,this.nativeStorageManager,r,s,i,o,l,u,p),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const m=this.nativeMessageHandler.getExtensionId()===Xa.PREFERRED_EXTENSION_ID?"chrome":(g=this.nativeMessageHandler.getExtensionId())!=null&&g.length?"unknown":void 0;this.skus=tu.makeExtraSkuString({libraryName:Wr.MSAL_SKU,libraryVersion:Sl,extensionName:m,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[eU]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(fe.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(fe.NativeInteractionClientAcquireToken,e.correlationId),r=zs();try{const s=await this.initializeNativeRequest(e);try{const u=await this.acquireTokensFromCache(this.accountId,s);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),u}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...i}=s,o={method:Ho.GetToken,request:i},a=await this.nativeMessageHandler.sendMessage(o),l=this.validateNativeResponse(a);return await this.handleNativeResponse(l,s,r).then(u=>(t.end({success:!0,isNativeBroker:!0,requestId:u.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),u)).catch(u=>{throw t.end({success:!1,errorCode:u.errorCode,subErrorCode:u.subError,isNativeBroker:!0}),u})}catch(s){throw s instanceof Os&&this.serverTelemetryManager.setNativeBrokerErrorCode(s.errorCode),s}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:yn.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Ue(Gm);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},t.correlationId);if(!r)throw Ue(Gm);try{const s=this.createSilentCacheRequest(t,r),i=await this.silentCacheClient.acquireToken(s),o={...r,idTokenClaims:i==null?void 0:i.idTokenClaims,idToken:i==null?void 0:i.idToken};return{...i,account:o}}catch(s){throw s}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const s=await this.initializeNativeRequest(r),i={method:Ho.GetToken,request:s};try{const l=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(l)}catch(l){if(l instanceof Os&&(this.serverTelemetryManager.setNativeBrokerErrorCode(l.errorCode),Wa(l)))throw l}this.browserStorage.setTemporaryCache(Bt.NATIVE_REQUEST,JSON.stringify(s),!0);const o={apiId:tn.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,o)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(e==null||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:s,...i}=r;s&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Bt.NATIVE_REQUEST));const o={method:Ho.GetToken,request:i},a=zs();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(l);const u=this.handleNativeResponse(l,i,a);this.browserStorage.setInteractionInProgress(!1);const d=await u;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),d}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){var d;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=va(e.id_token,js),i=this.createHomeAccountIdentifier(e,s),o=(d=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId))==null?void 0:d.homeAccountId;if(i!==o&&e.account.id!==t.accountId)throw a0(zS);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=lv(this.browserStorage,a,i,js,this.correlationId,s,e.client_info,void 0,s.tid,void 0,e.account.id,this.logger),u=await this.generateAuthenticationResult(e,t,s,l,a.canonicalAuthority,r);return this.cacheAccount(l),this.cacheNativeTokens(e,t,i,s,e.access_token,u.tenantId,r),u}createHomeAccountIdentifier(e,t){return Fn.generateHomeAccountId(e.client_info||Ae.EMPTY_STRING,cs.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?yn.fromString(e.scope):yn.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===Kt.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new Il(this.browserCrypto),s={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw Ue(qg);return r.signPopToken(e.access_token,t.keyId,s)}else return e.access_token}async generateAuthenticationResult(e,t,r,s,i,o){const a=this.addTelemetryFromNativeResponse(e),l=e.scope?yn.fromString(e.scope):yn.fromString(t.scope),u=e.account.properties||{},d=u.UID||r.oid||r.sub||Ae.EMPTY_STRING,f=u.TenantId||r.tid||Ae.EMPTY_STRING,p=tv(s.getAccountInfo(),void 0,r,e.id_token);p.nativeAccountId!==e.account.id&&(p.nativeAccountId=e.account.id);const m=await this.generatePopAccessToken(e,t),g=t.tokenType===Kt.POP?Kt.POP:Kt.BEARER;return{authority:i,uniqueId:d,tenantId:f,scopes:l.asArray(),account:p,idToken:e.id_token,idTokenClaims:r,accessToken:m,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(o+e.expires_in)*1e3),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,this.correlationId).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,r,s,i,o,a){const l=Bf(r,t.authority,e.id_token||"",t.clientId,s.tid||""),u=t.tokenType===Kt.POP?Ae.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,d=a+u,f=this.generateScopes(e,t),p=Vf(r,t.authority,i,t.clientId,s.tid||o,f.printScopes(),d,0,js,void 0,t.tokenType,void 0,t.keyId),m={idToken:l,accessToken:p};this.nativeStorageManager.saveCacheRecord(m,t.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw fI(Vg,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new xt(t);r.validateAsUri();const{scopes:s,...i}=e,o=new yn(s||[]);o.appendScopes(Bl);const a=()=>{switch(this.apiId){case tn.ssoSilent:case tn.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Bn.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case Bn.NONE:case Bn.CONSENT:case Bn.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Je(NS)}},l={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw Je(DS);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=Xa.MATS_TELEMETRY,e.authenticationScheme===Kt.POP){const u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},d=new Il(this.browserCrypto);let f;if(l.keyId)f=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const p=await je(d.generateCnf.bind(d),fe.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(u,this.logger);f=p.reqCnfString,l.keyId=p.kid,l.signPopToken=!0}l.reqCnf=f}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var i;const t=e.extraParameters&&e.extraParameters.hasOwnProperty(iv)&&e.extraParameters.hasOwnProperty(Jm)&&e.extraParameters.hasOwnProperty(oa);if(!e.embeddedClientId&&!t)return;let r="";const s=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Jm],r=e.extraParameters[oa]),e.extraParameters={child_client_id:r,child_redirect_uri:s},(i=this.performanceClient)==null||i.addFields({embeddedClientId:r,embeddedRedirectUri:s},e.correlationId)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Ms{constructor(e,t,r,s){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(fe.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Xa.CHANNEL_ID,extensionId:this.extensionId,responseId:Ys(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((r,s)=>{this.resolvers.set(t.responseId,{resolve:r,reject:s})})}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const s=new Ms(e,t,r,Xa.PREFERRED_EXTENSION_ID);return await s.sendHandshakeRequest(),s}catch{const i=new Ms(e,t,r);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Xa.CHANNEL_ID,extensionId:this.extensionId,responseId:Ys(),body:{method:Ho.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Je(RS)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Xa.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===Ho.HandshakeRequest){const r=this.handshakeResolvers.get(t.responseId);if(!r){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(Je(kS))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),s=this.handshakeResolvers.get(t.responseId);try{const i=t.body.method;if(i===Ho.Response){if(!r)return;const o=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(o)}`),o.status!=="Success")r.reject(a0(o.code,o.description,o.ext));else if(o.result)o.result.code&&o.result.description?r.reject(a0(o.result.code,o.result.description,o.result.ext)):r.resolve(o.result);else throw fI(Vg,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(i===Ho.HandshakeResponse){if(!s){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),s.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(i):s&&s.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,r,s){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(s)switch(s){case Kt.BEARER:case Kt.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Iv{constructor(e,t,r,s,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=s,this.performanceClient=i}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(fe.HandleCodeResponse,t.correlationId);let r;try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(s){throw s instanceof To&&s.subError===la?Je(la):s}return je(this.handleCodeResponseFromServer.bind(this),fe.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(fe.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await je(this.authModule.updateAuthority.bind(this.authModule),fe.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const i=this.createCcsCredentials(t);i&&(this.authCodeRequest.ccsCredential=i)}return await je(this.authModule.acquireToken.bind(this.authModule),fe.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Qr.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Qr.UPN}:null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function QS(n,e,t){const r=bh(n);if(!r)throw zI(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),Je(cS)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Je(lS));return r}function F6(n,e,t){if(!n.state)throw Je(hv);const r=qS(e,n.state);if(!r)throw Je(uS);if(r.interactionType!==t)throw Je(dS)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class L6 extends Vl{constructor(e,t,r,s,i,o,a,l,u,d){super(e,t,r,s,i,o,a,u,d),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e){try{const r={popupName:this.generatePopupName(e.scopes||Bl,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r))}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},s=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,s,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,s,i))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t){var i;this.logger.verbose("acquireTokenPopupAsync called");const r=this.initializeServerTelemetryManager(tn.acquireTokenPopup),s=await je(this.initializeAuthorizationRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,rt.Popup);KS(s.authority);try{const o=await je(this.initializeAuthorizationCodeRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(s),a=await je(this.createAuthCodeClient.bind(this),fe.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:s.authority,requestAzureCloudOptions:s.azureCloudOptions,requestExtraQueryParameters:s.extraQueryParameters,account:s.account}),l=Ms.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let u;l&&(u=this.performanceClient.startMeasurement(fe.FetchAccountIdWithNativeBroker,e.correlationId));const d=await a.getAuthCodeUrl({...s,nativeBroker:l}),f=new Iv(a,this.browserStorage,o,this.logger,this.performanceClient),p=this.initiateAuthRequest(d,t);this.eventHandler.emitEvent(at.POPUP_OPENED,rt.Popup,{popupWindow:p},null);const m=await this.monitorPopupForHash(p,t.popupWindowParent),g=ya(QS,fe.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(m,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Ns.removeThrottle(this.browserStorage,this.config.auth.clientId,o),g.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Je(Nu);const y=new ll(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tn.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,this.nativeStorage,s.correlationId),{userRequestState:L}=vs.parseRequestState(this.browserCrypto,s.state);return await y.acquireToken({...s,state:L,prompt:void 0})}return await f.handleCodeResponse(g,s)}catch(o){throw(i=t.popup)==null||i.close(),o instanceof sn&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),o}}async logoutPopupAsync(e,t,r,s){var o,a,l,u;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(at.LOGOUT_START,rt.Popup,e);const i=this.initializeServerTelemetryManager(tn.logoutPopup);try{await this.clearCacheOnLogout(e.account);const d=await je(this.createAuthCodeClient.bind(this),fe.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:r,account:e.account||void 0});try{d.authority.endSessionEndpoint}catch{if((o=e.account)!=null&&o.homeAccountId&&e.postLogoutRedirectUri&&d.authority.protocolMode===Ai.OIDC){if(this.browserStorage.removeAccount((a=e.account)==null?void 0:a.homeAccountId,this.correlationId),this.eventHandler.emitEvent(at.LOGOUT_SUCCESS,rt.Popup,e),s){const m={apiId:tn.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=xt.getAbsoluteUrl(s,_i());await this.navigationClient.navigateInternal(g,m)}(l=t.popup)==null||l.close();return}}const f=d.getLogoutUri(e);this.eventHandler.emitEvent(at.LOGOUT_SUCCESS,rt.Popup,e);const p=this.openPopup(f,t);if(this.eventHandler.emitEvent(at.POPUP_OPENED,rt.Popup,{popupWindow:p},null),await this.monitorPopupForHash(p,t.popupWindowParent).catch(()=>{}),s){const m={apiId:tn.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=xt.getAbsoluteUrl(s,_i());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${g}`),await this.navigationClient.navigateInternal(g,m)}else this.logger.verbose("No main window navigation requested")}catch(d){throw(u=t.popup)==null||u.close(),d instanceof sn&&(d.setCorrelationId(this.correlationId),i.cacheFailedRequest(d)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(at.LOGOUT_FAILURE,rt.Popup,null,d),this.eventHandler.emitEvent(at.LOGOUT_END,rt.Popup),d}this.eventHandler.emitEvent(at.LOGOUT_END,rt.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Je(Kf)}monitorPopupForHash(e,t){return new Promise((r,s)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),s(Je(la));return}let o="";try{o=e.location.href}catch{}if(!o||o==="about:blank")return;clearInterval(i);let a="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===Pu.QUERY?a=e.location.search:a=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw Je(pS);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),Je(fS)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:s}){var m,g,v,y;const i=s.screenLeft?s.screenLeft:s.screenX,o=s.screenTop?s.screenTop:s.screenY,a=s.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=s.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let u=(m=r.popupSize)==null?void 0:m.width,d=(g=r.popupSize)==null?void 0:g.height,f=(v=r.popupPosition)==null?void 0:v.top,p=(y=r.popupPosition)==null?void 0:y.left;return(!u||u<0||u>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),u=Wr.POPUP_WIDTH),(!d||d<0||d>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),d=Wr.POPUP_HEIGHT),(!f||f<0||f>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,l/2-Wr.POPUP_HEIGHT/2+o)),(!p||p<0||p>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),p=Math.max(0,a/2-Wr.POPUP_WIDTH/2+i)),s.open(e,t,`width=${u}, height=${d}, top=${f}, left=${p}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(rt.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${Wr.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${Wr.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class pE{constructor(e,t,r,s,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=s,this.performanceClient=i}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Bt.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Bt.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:tn.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,r);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,r);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Je(Kf)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(r);if(!s)throw Ue(Ah,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,s)}catch(u){throw u instanceof To&&u.subError===la?Je(la):u}const o=this.browserStorage.generateNonceKey(s),a=this.browserStorage.getTemporaryCache(o);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&await je(this.authModule.updateAuthority.bind(this.authModule),fe.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId),i.nonce=a||void 0,i.state=s,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{const u=this.checkCcsCredentials();u&&(this.authCodeRequest.ccsCredential=u)}const l=await this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(t),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(Bt.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function U6(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation"),e=n.length?n[0]:void 0;return e==null?void 0:e.type}class B6 extends Vl{constructor(e,t,r,s,i,o,a,l,u,d){super(e,t,r,s,i,o,a,u,d),this.nativeStorage=l}async acquireToken(e){const t=await je(this.initializeAuthorizationRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,rt.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const r=this.initializeServerTelemetryManager(tn.acquireTokenRedirect),s=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(at.RESTORE_FROM_BFCACHE,rt.Redirect))};try{const i=await je(this.initializeAuthorizationCodeRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),o=await je(this.createAuthCodeClient.bind(this),fe.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new pE(o,this.browserStorage,i,this.logger,this.performanceClient),l=await o.getAuthCodeUrl({...t,nativeBroker:Ms.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),u=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",s),await a.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof sn&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),window.removeEventListener("pageshow",s),this.browserStorage.cleanRequestByState(t.state),i}}async handleRedirectPromise(e="",t){const r=this.initializeServerTelemetryManager(tn.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[s,i]=this.getRedirectResponse(e||"");if(!s)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(rt.Redirect),U6()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const o=this.browserStorage.getTemporaryCache(Bt.ORIGIN_URI,!0)||Ae.EMPTY_STRING,a=xt.removeHashFromUrl(o),l=xt.removeHashFromUrl(window.location.href);if(a===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),o.indexOf("#")>-1&&qU(o),await this.handleResponse(s,r);if(this.config.auth.navigateToLoginRequestUrl){if(!Tv()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Bt.URL_HASH,i,!0);const u={apiId:tn.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let d=!0;if(!o||o==="null"){const f=zU();this.browserStorage.setTemporaryCache(Bt.ORIGIN_URI,f,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),d=await this.navigationClient.navigateInternal(f,u)}else this.logger.verbose(`Navigating to loginRequestUrl: ${o}`),d=await this.navigationClient.navigateInternal(o,u);if(!d)return await this.handleResponse(s,r)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(s,r);return null}catch(s){throw s instanceof sn&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),this.browserStorage.cleanRequestByInteractionType(rt.Redirect),s}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===Pu.QUERY?t=window.location.search:t=window.location.hash);let r=bh(t);if(r){try{F6(r,this.browserCrypto,rt.Redirect)}catch(i){return i instanceof sn&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return KU(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const s=this.browserStorage.getTemporaryCache(Bt.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Bt.URL_HASH)),s&&(r=bh(s),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,s]):[null,""]}async handleResponse(e,t){const r=e.state;if(!r)throw Je(hv);const s=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Je(Nu);const l=new ll(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tn.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,s.correlationId),{userRequestState:u}=vs.parseRequestState(this.browserCrypto,r);return l.acquireToken({...s,state:u,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}const i=this.browserStorage.getCachedAuthority(r);if(!i)throw Je(fv);const o=await je(this.createAuthCodeClient.bind(this),fe.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});return Ns.removeThrottle(this.browserStorage,this.config.auth.clientId,s),new pE(o,this.browserStorage,s,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){var s,i;this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(tn.logout);try{this.eventHandler.emitEvent(at.LOGOUT_START,rt.Redirect,e),await this.clearCacheOnLogout(t.account);const o={apiId:tn.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await je(this.createAuthCodeClient.bind(this),fe.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===Ai.OIDC)try{a.authority.endSessionEndpoint}catch{if((s=t.account)!=null&&s.homeAccountId){this.browserStorage.removeAccount((i=t.account)==null?void 0:i.homeAccountId,this.correlationId),this.eventHandler.emitEvent(at.LOGOUT_SUCCESS,rt.Redirect,t);return}}const l=a.getLogoutUri(t);if(this.eventHandler.emitEvent(at.LOGOUT_SUCCESS,rt.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,o);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,o);return}}catch(o){throw o instanceof sn&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),this.eventHandler.emitEvent(at.LOGOUT_FAILURE,rt.Redirect,null,o),this.eventHandler.emitEvent(at.LOGOUT_END,rt.Redirect),o}this.eventHandler.emitEvent(at.LOGOUT_END,rt.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return xt.getAbsoluteUrl(t,_i())}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function V6(n,e,t,r,s){if(e.addQueueMeasurement(fe.SilentHandlerInitiateAuthRequest,r),!n)throw t.info("Navigate url is empty"),Je(Kf);return s?je(H6,fe.SilentHandlerLoadFrame,t,e,r)(n,s,e,r):ya(j6,fe.SilentHandlerLoadFrameSync,t,e,r)(n)}async function $6(n,e,t,r,s,i,o){return r.addQueueMeasurement(fe.SilentHandlerMonitorIframeForHash,i),new Promise((a,l)=>{e<s0&&s.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${s0}ms). This may result in timeouts.`);const u=window.setTimeout(()=>{window.clearInterval(d),l(Je(mS))},e),d=window.setInterval(()=>{let f="";const p=n.contentWindow;try{f=p?p.location.href:""}catch{}if(!f||f==="about:blank")return;let m="";p&&(o===Pu.QUERY?m=p.location.search:m=p.location.hash),window.clearTimeout(u),window.clearInterval(d),a(m)},t)}).finally(()=>{ya(W6,fe.RemoveHiddenIframe,s,r,i)(n)})}function H6(n,e,t,r){return t.addQueueMeasurement(fe.SilentHandlerLoadFrame,r),new Promise((s,i)=>{const o=XS();window.setTimeout(()=>{if(!o){i("Unable to load iframe");return}o.src=n,s(o)},e)})}function j6(n){const e=XS();return e.src=n,e}function XS(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function W6(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class K6 extends Vl{constructor(e,t,r,s,i,o,a,l,u,d,f){super(e,t,r,s,i,o,l,d,f),this.apiId=a,this.nativeStorage=u}async acquireToken(e){this.performanceClient.addQueueMeasurement(fe.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Bn.NONE&&t.prompt!==Bn.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Bn.NONE}`),t.prompt=Bn.NONE):t.prompt=Bn.NONE;const r=await je(this.initializeAuthorizationRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,rt.Silent);KS(r.authority);const s=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await je(this.createAuthCodeClient.bind(this),fe.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:s,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),await je(this.silentTokenHelper.bind(this),fe.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,r)}catch(o){if(o instanceof sn&&(o.setCorrelationId(this.correlationId),s.cacheFailedRequest(o)),!i||!(o instanceof sn)||o.errorCode!==Wr.INVALID_GRANT_ERROR)throw o;this.performanceClient.addFields({retryError:o.errorCode},this.correlationId);const a=await je(this.initializeAuthorizationRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,rt.Silent);return await je(this.silentTokenHelper.bind(this),fe.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,a)}}logout(){return Promise.reject(Je(qf))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(fe.SilentIframeClientTokenHelper,r);const s=await je(this.initializeAuthorizationCodeRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(t),i=await je(e.getAuthCodeUrl.bind(e),fe.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...t,nativeBroker:Ms.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),o=new Iv(e,this.browserStorage,s,this.logger,this.performanceClient),a=await je(V6,fe.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,u=await je($6,fe.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,l),d=ya(QS,fe.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(u,l,this.logger);if(d.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Je(Nu);const f=new ll(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,d.accountId,this.browserStorage,r),{userRequestState:p}=vs.parseRequestState(this.browserCrypto,t.state);return je(f.acquireToken.bind(f),fe.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...t,state:p,prompt:t.prompt||Bn.NONE})}return je(o.handleCodeResponse.bind(o),fe.HandleCodeResponse,this.logger,this.performanceClient,r)(d,t)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class q6 extends Vl{async acquireToken(e){this.performanceClient.addQueueMeasurement(fe.SilentRefreshClientAcquireToken,e.correlationId);const t=await je(Av,fe.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const s=this.initializeServerTelemetryManager(tn.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:s,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return je(i.acquireTokenByRefreshToken.bind(i),fe.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(o=>{throw o.setCorrelationId(this.correlationId),s.cacheFailedRequest(o),o})}logout(){return Promise.reject(Je(qf))}async createRefreshTokenClient(e){const t=await je(this.getClientConfiguration.bind(this),fe.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new e0(t,this.performanceClient)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class G6{constructor(e,t,r,s){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=r,this.cryptoObj=s}loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw Je(Gf);const s=e.correlationId||Ys(),i=t.id_token?va(t.id_token,js):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new ar(ar.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||Ys()):void 0,l=this.loadAccount(e,r.clientInfo||t.client_info||"",s,i,a),u=this.loadIdToken(t,l.homeAccountId,l.environment,l.realm,s),d=this.loadAccessToken(e,t,l.homeAccountId,l.environment,l.realm,r,s),f=this.loadRefreshToken(t,l.homeAccountId,l.environment,s);return this.generateAuthenticationResult(e,{account:l,idToken:u,accessToken:d,refreshToken:f},i,a)}loadAccount(e,t,r,s,i){if(this.logger.verbose("TokenCache - loading account"),e.account){const u=Fn.createFromAccountInfo(e.account);return this.storage.setAccount(u,r),u}else if(!i||!t&&!s)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Je(AS);const o=Fn.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,s),a=s==null?void 0:s.tid,l=lv(this.storage,i,o,js,r,s,t,i.hostnameAndPort,a,void 0,void 0,this.logger);return this.storage.setAccount(l,r),l}loadIdToken(e,t,r,s,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const o=Bf(t,r,e.id_token,this.config.auth.clientId,s);return this.storage.setIdTokenCredential(o,i),o}loadAccessToken(e,t,r,s,i,o,a){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const l=t.scope?yn.fromString(t.scope):new yn(e.scopes),u=o.expiresOn||t.expires_in+new Date().getTime()/1e3,d=o.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,f=Vf(r,s,t.access_token,this.config.auth.clientId,i,l.printScopes(),u,d,js);return this.storage.setAccessTokenCredential(f,a),f}loadRefreshToken(e,t,r,s){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const i=NI(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(i,s),i}generateAuthenticationResult(e,t,r,s){var d,f,p;let i="",o=[],a=null,l;t!=null&&t.accessToken&&(i=t.accessToken.secret,o=yn.fromString(t.accessToken.target).asArray(),a=new Date(Number(t.accessToken.expiresOn)*1e3),l=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const u=t.account;return{authority:s?s.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:o,account:u.getAccountInfo(),idToken:((d=t.idToken)==null?void 0:d.secret)||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((f=t.refreshToken)==null?void 0:f.familyId)||"",tokenType:((p=t==null?void 0:t.accessToken)==null?void 0:p.tokenType)||"",state:e.state||"",cloudGraphHostName:u.cloudGraphHostName||"",msGraphHost:u.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class z6 extends sS{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Y6 extends Vl{constructor(e,t,r,s,i,o,a,l,u,d){super(e,t,r,s,i,o,l,u,d),this.apiId=a}async acquireToken(e){if(!e.code)throw Je(IS);const t=await je(this.initializeAuthorizationRequest.bind(this),fe.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,rt.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const s={...t,code:e.code},i=await je(this.getClientConfiguration.bind(this),fe.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new z6(i);this.logger.verbose("Auth code client created");const a=new Iv(o,this.browserStorage,s,this.logger,this.performanceClient);return await je(a.handleCodeResponseFromServer.bind(a),fe.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(s){throw s instanceof sn&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),s}}logout(){return Promise.reject(Je(qf))}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function Ss(n){const e=n==null?void 0:n.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function wd(n,e){try{wv(n)}catch(t){throw e.end({success:!1},t),t}}class Yf{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new xl(this.logger,this.performanceClient):Ih,this.eventHandler=new T6(this.logger),this.browserStorage=this.isBrowserEnvironment?new o0(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,aU(this.config.auth),this.performanceClient):f6(this.config.auth.clientId,this.logger);const t={cacheLocation:Pr.MemoryStorage,temporaryCacheLocation:Pr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new o0(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new G6(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const r=new Yf(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(at.INITIALIZE_END);return}const t=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,s=this.performanceClient.startMeasurement(fe.InitializeClientApplication,t);if(this.eventHandler.emitEvent(at.INITIALIZE_START),r)try{this.nativeExtensionProvider=await Ms.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await je(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),fe.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(at.INITIALIZE_END),s.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),WS(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return typeof r>"u"?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),s=r&&Ms.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=s?r==null?void 0:r.correlationId:this.browserStorage.getTemporaryCache(Bt.CORRELATION_ID,!0)||"",o=this.performanceClient.startMeasurement(fe.AcquireTokenRedirect,i);this.eventHandler.emitEvent(at.HANDLE_REDIRECT_START,rt.Redirect);let a;if(s&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new ll(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tn.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=je(l.handleRedirectPromise.bind(l),fe.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,o.event.correlationId)(this.performanceClient,o.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(i);a=je(l.handleRedirectPromise.bind(l),fe.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,o.event.correlationId)(e,o)}return a.then(l=>(l?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(at.LOGIN_SUCCESS,rt.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_SUCCESS,rt.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),o.end({success:!0,accountType:Ss(l.account)})):o.event.errorCode?o.end({success:!1}):o.discard(),this.eventHandler.emitEvent(at.HANDLE_REDIRECT_END,rt.Redirect),l)).catch(l=>{const u=l;throw t.length>0?this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_FAILURE,rt.Redirect,null,u):this.eventHandler.emitEvent(at.LOGIN_FAILURE,rt.Redirect,null,u),this.eventHandler.emitEvent(at.HANDLE_REDIRECT_END,rt.Redirect),o.end({success:!1},u),l})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement(fe.AcquireTokenPreRedirect,t);r.add({accountType:Ss(e.account),scenarioId:e.scenarioId});const s=e.onRedirectNavigate;if(s)e.onRedirectNavigate=o=>{const a=typeof s=="function"?s(o):void 0;return a!==!1?r.end({success:!0}):r.discard(),a};else{const o=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=a=>{const l=typeof o=="function"?o(a):void 0;return l!==!1?r.end({success:!0}):r.discard(),l}}const i=this.getAllAccounts().length>0;try{uE(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_START,rt.Redirect,e):this.eventHandler.emitEvent(at.LOGIN_START,rt.Redirect,e);let o;return this.nativeExtensionProvider&&this.canUseNative(e)?o=new ll(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tn.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch(l=>{if(l instanceof Os&&Wa(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(l instanceof Ts)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):o=this.createRedirectClient(t).acquireToken(e),await o}catch(o){throw r.end({success:!1},o),i?this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_FAILURE,rt.Redirect,null,o):this.eventHandler.emitEvent(at.LOGIN_FAILURE,rt.Redirect,null,o),o}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(fe.AcquireTokenPopup,t);r.add({scenarioId:e.scenarioId,accountType:Ss(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),wd(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(o){return Promise.reject(o)}const s=this.getAllAccounts();s.length>0?this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_START,rt.Popup,e):this.eventHandler.emitEvent(at.LOGIN_START,rt.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative({...e,correlationId:t},tn.acquireTokenPopup).then(o=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,accountType:Ss(o.account)}),o)).catch(o=>{if(o instanceof Os&&Wa(o))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(o instanceof Ts)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),o}):i=this.createPopupClient(t).acquireToken(e),i.then(o=>(s.length<this.getAllAccounts().length?this.eventHandler.emitEvent(at.LOGIN_SUCCESS,rt.Popup,o):this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_SUCCESS,rt.Popup,o),r.end({success:!0,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Ss(o.account)}),o)).catch(o=>(s.length>0?this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_FAILURE,rt.Popup,null,o):this.eventHandler.emitEvent(at.LOGIN_FAILURE,rt.Popup,null,o),r.end({success:!1},o),Promise.reject(o)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var i,o;const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(fe.SsoSilent,t),(i=this.ssoSilentMeasurement)==null||i.add({scenarioId:e.scenarioId,accountType:Ss(e.account)}),wd(this.initialized,this.ssoSilentMeasurement),(o=this.ssoSilentMeasurement)==null||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(at.SSO_SILENT_START,rt.Silent,r);let s;return this.canUseNative(r)?s=this.acquireTokenNative(r,tn.ssoSilent).catch(a=>{if(a instanceof Os&&Wa(a))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw a}):s=this.createSilentIframeClient(r.correlationId).acquireToken(r),s.then(a=>{var l;return this.eventHandler.emitEvent(at.SSO_SILENT_SUCCESS,rt.Silent,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Ss(a.account)}),a}).catch(a=>{var l;throw this.eventHandler.emitEvent(at.SSO_SILENT_FAILURE,rt.Silent,null,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},a),a}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(fe.AcquireTokenByCode,t);wd(this.initialized,r),this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_BY_CODE_START,rt.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Je(xS);if(e.code){const s=e.code;let i=this.hybridAuthCodeResponses.get(s);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(o=>(this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_BY_CODE_SUCCESS,rt.Silent,o),this.hybridAuthCodeResponses.delete(s),r.end({success:!0,isNativeBroker:o.fromNativeBroker,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Ss(o.account)}),o)).catch(o=>{throw this.hybridAuthCodeResponses.delete(s),this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_BY_CODE_FAILURE,rt.Silent,null,o),r.end({success:!1},o),o}),this.hybridAuthCodeResponses.set(s,i)),await i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const s=await this.acquireTokenNative({...e,correlationId:t},tn.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof Os&&Wa(i)&&(this.nativeExtensionProvider=void 0),i});return r.end({accountType:Ss(s.account),success:!0}),s}else throw Je(bS);else throw Je(SS)}catch(s){throw this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_BY_CODE_FAILURE,rt.Silent,null,s),r.end({success:!1},s),s}}async acquireTokenByCodeAsync(e){var s;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(fe.AcquireTokenByCodeAsync,e.correlationId),(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>{var o;return(o=this.acquireTokenByCodeAsyncMeasurement)==null||o.end({success:!0,fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker}),i}).catch(i=>{var o;throw(o=this.acquireTokenByCodeAsyncMeasurement)==null||o.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(fe.AcquireTokenFromCache,e.correlationId),t){case $r.Default:case $r.AccessToken:case $r.AccessTokenAndRefreshToken:const r=this.createSilentCacheClient(e.correlationId);return je(r.acquireToken.bind(r),fe.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ue(yi)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(fe.AcquireTokenByRefreshToken,e.correlationId),t){case $r.Default:case $r.AccessTokenAndRefreshToken:case $r.RefreshToken:case $r.RefreshTokenAndNetwork:const r=this.createSilentRefreshClient(e.correlationId);return je(r.acquireToken.bind(r),fe.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ue(yi)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(fe.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return je(t.acquireToken.bind(t),fe.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return uE(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return wv(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return p6(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return m6(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return g6(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return v6(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return y6(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();_6(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return E6(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=Fn.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Je(Nu);return new ll(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Ms.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Bn.NONE:case Bn.CONSENT:case Bn.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new L6(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new B6(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new K6(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tn.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new YS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new q6(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Y6(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tn.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return jS(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){var t;try{(t=e.key)!=null&&t.includes(Ln.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(at.ACTIVE_ACCOUNT_CHANGED);const r=e.newValue||e.oldValue;if(!r)return;const s=JSON.parse(r);if(typeof s!="object"||!Fn.isAccountEntity(s))return;const o=Al.toObject(new Fn,s).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(at.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(at.ACCOUNT_REMOVED,void 0,o))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Ys():Ae.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||aE})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||aE})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(fe.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),wd(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const s=e.account||this.getActiveAccount();if(!s)throw Je(_S);r.add({accountType:Ss(s)});const i={clientId:this.config.auth.clientId,authority:e.authority||Ae.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:s.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},o=JSON.stringify(i),a=this.activeSilentTokenRequests.get(o);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const l=je(this.acquireTokenSilentAsync.bind(this),fe.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},s).then(u=>(this.activeSilentTokenRequests.delete(o),r.end({success:!0,fromCache:u.fromCache,isNativeBroker:u.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),u)).catch(u=>{throw this.activeSilentTokenRequests.delete(o),r.end({success:!1},u),u});return this.activeSilentTokenRequests.set(o,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),{...await a,state:e.state}}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(fe.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_START,rt.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const s=await je(S6,fe.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||$r.Default;return this.acquireTokenSilentNoIframe(s,i).catch(async a=>{if(Q6(a,i))if(this.activeIframeRequest)if(i!==$r.Skip){const[u,d]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${d}`,s.correlationId);const f=this.performanceClient.startMeasurement(fe.AwaitConcurrentIframe,s.correlationId);f.add({awaitIframeCorrelationId:d});const p=await u;if(f.end({success:p}),p)return this.logger.verbose(`Parallel iframe request with correlationId: ${d} succeeded. Retrying cache and/or RT redemption`,s.correlationId),this.acquireTokenSilentNoIframe(s,i);throw this.logger.info(`Iframe request with correlationId: ${d} failed. Interaction is required.`),a}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",s.correlationId),je(this.acquireTokenBySilentIframe.bind(this),fe.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s);else{let u;return this.activeIframeRequest=[new Promise(d=>{u=d}),s.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",s.correlationId),je(this.acquireTokenBySilentIframe.bind(this),fe.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s).then(d=>(u(!0),d)).catch(d=>{throw u(!1),d}).finally(()=>{this.activeIframeRequest=void 0})}else throw a}).then(a=>(this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_SUCCESS,rt.Silent,a),e.correlationId&&this.performanceClient.addFields({fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker},e.correlationId),a)).catch(a=>{throw this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_FAILURE,rt.Silent,null,a),a}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,t){return Ms.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,tn.acquireTokenSilent_silentFlow).catch(async r=>{throw r instanceof Os&&Wa(r)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,Ue(yi)):r})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),je(this.acquireTokenFromCache.bind(this),fe.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(r=>{if(t===$r.AccessToken)throw r;return this.eventHandler.emitEvent(at.ACQUIRE_TOKEN_NETWORK_START,rt.Silent,e),je(this.acquireTokenByRefreshToken.bind(this),fe.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}function Q6(n,e){const t=!(n instanceof Ts&&n.subError!==Wf),r=n.errorCode===Wr.INVALID_GRANT_ERROR||n.errorCode===yi,s=t&&r||n.errorCode===kh||n.errorCode===av,i=PU.includes(e);return s&&i}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function X6(n,e){const t=new ca(n);return await t.initialize(),Yf.createController(t,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Sv{static async createPublicClientApplication(e){const t=await X6(e);return new Sv(e,t)}constructor(e,t){this.controller=t||new Yf(new ca(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const J6={auth:{clientId:"69a6554e-8220-4fff-b2d5-895e6031f816",authority:"https://login.microsoftonline.com/consumers",redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}},Kp={scopes:["User.Read","Files.ReadWrite","offline_access"]},li=new Sv(J6);async function Z6(){await li.initialize()}const Js=pa("auth",()=>{const n=ae(null),e=ae(null),t=ae(null),r=ae(null),s=ae(!0);function i(){console.log("Initializing auth listener and handling MSAL redirect..."),li.handleRedirectPromise().then(g=>{g?(console.log("MSAL redirect response received:",g.account.username),t.value=g.account,r.value=g.accessToken,console.log("Microsoft redirect login successful:",g.account.username)):console.log("No MSAL redirect response (direct page load)")}).catch(g=>{console.error("Error handling MSAL redirect:",g)}),XO($a,async g=>{if(console.log("Firebase auth state changed:",g==null?void 0:g.uid),g){n.value=g,await u(g.uid);const v=li.getAllAccounts();v.length>0&&(t.value=v[0],console.log("Restored Microsoft account from cache:",v[0].username))}else n.value=null,e.value=null;s.value=!1})}async function o(){try{const g=await yD($a,SL);return n.value=g.user,await u(g.user.uid),g.user}catch(g){throw console.error("Google sign-in error:",g),g}}async function a(){try{const g=li.getAllAccounts();if(g.length>0){console.log("Microsoft account already exists:",g[0].username),t.value=g[0];return}await li.loginRedirect(Kp)}catch(g){throw console.error("Microsoft sign-in error:",g),g}}async function l(){if(!t.value)throw new Error("Not signed in with Microsoft");try{const g=await li.acquireTokenSilent({...Kp,account:t.value});return r.value=g.accessToken,g.accessToken}catch{throw await li.acquireTokenRedirect(Kp),new Error("Redirecting for authentication...")}}async function u(g){try{const v=await Mf(Hs(Ct,"users",g));v.exists()?e.value=v.data():e.value=null}catch(v){console.error("Error loading user data:",v)}}async function d(g){try{const{collection:v,query:y,where:L,getDocs:D}=await Jo(async()=>{const{collection:z,query:w,where:R,getDocs:x}=await Promise.resolve().then(()=>O1);return{collection:z,query:w,where:R,getDocs:x}},void 0),A=v(Ct,"employees"),C=y(A,L("Email","==",g)),j=await D(C);if(!j.empty){const z=j.docs[0].data();return z.isSupervisor===!0||z.Role==="Supervisor"}return!1}catch(v){return console.error("Error checking supervisor status:",v),!1}}async function f(g,v=!1){var x,b,N;if(console.log("registerUser called with:",{employeeData:g,isSupervisor:v,hasUser:!!n.value,hasMsalAccount:!!t.value}),!v&&((x=n.value)!=null&&x.email)&&await d(n.value.email)&&(v=!0,console.log("User is supervisor based on employees collection")),v&&!n.value){console.log("Creating anonymous Firebase user for supervisor...");const M=await F_($a);n.value=M.user,console.log("Anonymous user created:",M.user.uid)}if(!n.value)throw new Error("No authenticated user");const{collection:y,query:L,where:D,getDocs:A,deleteDoc:C}=await Jo(async()=>{const{collection:M,query:F,where:oe,getDocs:Q,deleteDoc:ne}=await Promise.resolve().then(()=>O1);return{collection:M,query:F,where:oe,getDocs:Q,deleteDoc:ne}},void 0),j=y(Ct,"users"),z=L(j,D("employeeId","==",g.Id)),w=await A(z);if(!w.empty)for(const M of w.docs)M.id!==n.value.uid&&(console.log(`Found duplicate user with employeeId ${g.Id}. Removing old user: ${M.id}`),await C(Hs(Ct,"users",M.id)),console.log(`Deleted duplicate user: ${M.id}`));const R={uid:n.value.uid,email:n.value.email||((b=t.value)==null?void 0:b.username),displayName:n.value.displayName||((N=t.value)==null?void 0:N.name),photoURL:n.value.photoURL,employeeId:g.Id,employeeFirstName:g.FirstName,employeeLastName:g.EmployeeLastName||g.LastName,position:g.Position,role:v?"Supervisor":"Employee",isSupervisor:v,registeredAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return console.log("Saving user info to Firestore:",R),await Fg(Hs(Ct,"users",n.value.uid),R),e.value=R,console.log("User registered successfully"),R}async function p(){if(!n.value){const g=await F_($a);return n.value=g.user,g.user}return n.value}async function m(){try{await JO($a),t.value&&(await li.logoutPopup({account:t.value}),t.value=null,r.value=null),n.value=null,e.value=null}catch(g){throw console.error("Sign out error:",g),g}}return{user:n,userData:e,msalAccount:t,msalAccessToken:r,msalInstance:li,loading:s,initAuthListener:i,signInWithGoogle:o,signInWithMicrosoft:a,getMicrosoftToken:l,registerUser:f,createAnonymousUser:p,checkEmployeeSupervisorStatus:d,signOut:m}}),e5={key:0,class:"in-app-browser-overlay"},t5={__name:"App",setup(n){const e=Js(),t=ae(!1),r=()=>{const a=navigator.userAgent||navigator.vendor||window.opera;return a.indexOf("FBAN")>-1||a.indexOf("FBAV")>-1||a.indexOf("Messenger")>-1||a.indexOf("Instagram")>-1},s=()=>{const a=window.location.href,l=navigator.userAgent||navigator.vendor||window.opera;if(/android/i.test(l)){const u=`intent://${a.replace(/https?:\/\//,"")}#Intent;scheme=https;action=android.intent.action.VIEW;end;`;window.location.href=u,setTimeout(()=>{i()},2e3);return}if(/iPad|iPhone|iPod/.test(l)){const u=a.replace(/^https:\/\//,"x-safari-https://").replace(/^http:\/\//,"x-safari-http://");window.location.href=u,setTimeout(()=>{i()},2e3);return}i()},i=()=>{const a=window.location.href;navigator.clipboard.writeText(a).then(()=>{alert("Link !   browser- ,  link-  .")}).catch(()=>{const l=document.createElement("textarea");l.value=a,document.body.appendChild(l),l.select(),document.execCommand("copy"),document.body.removeChild(l),alert("Link !   browser- ,  link-  .")})},o=()=>{t.value=!1,sessionStorage.setItem("in-app-browser-warning-dismissed","true")};return kn(async()=>{const a=sessionStorage.getItem("in-app-browser-warning-dismissed");r()&&!a&&(t.value=!0),await Z6(),e.initAuthListener()}),(a,l)=>{const u=lk("router-view");return K(),q("div",null,[t.value?(K(),q("div",e5,[c("div",{class:"in-app-browser-modal"},[l[0]||(l[0]=c("div",{class:"modal-icon"},"",-1)),l[1]||(l[1]=c("h2",null,"Browser-  ",-1)),l[2]||(l[2]=c("p",null," Facebook Messenger browser- .",-1)),l[3]||(l[3]=c("p",null,"     .",-1)),c("button",{onClick:s,class:"open-browser-btn"},"   Browser-  "),l[4]||(l[4]=c("div",{class:"divider"},[c("span",null,"")],-1)),l[5]||(l[5]=c("div",{class:"manual-instructions"},[c("p",null,[c("strong",null," :")]),c("p",null,[bt("    "),c("strong",null,""),bt("   "),c("strong",null,'"Open in Browser"'),bt("  ")])],-1)),c("button",{onClick:o,class:"dismiss-btn"},"  ")])])):be("",!0),fn(u)])}}};/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const Ka=typeof document<"u";function JS(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function n5(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&JS(n.default)}const Dt=Object.assign;function qp(n,e){const t={};for(const r in e){const s=e[r];t[r]=ws(s)?s.map(n):n(s)}return t}const Mc=()=>{},ws=Array.isArray;function mE(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}const ZS=/#/g,r5=/&/g,s5=/\//g,i5=/=/g,o5=/\?/g,ex=/\+/g,a5=/%5B/g,l5=/%5D/g,tx=/%5E/g,c5=/%60/g,nx=/%7B/g,u5=/%7C/g,rx=/%7D/g,d5=/%20/g;function xv(n){return n==null?"":encodeURI(""+n).replace(u5,"|").replace(a5,"[").replace(l5,"]")}function h5(n){return xv(n).replace(nx,"{").replace(rx,"}").replace(tx,"^")}function l0(n){return xv(n).replace(ex,"%2B").replace(d5,"+").replace(ZS,"%23").replace(r5,"%26").replace(c5,"`").replace(nx,"{").replace(rx,"}").replace(tx,"^")}function f5(n){return l0(n).replace(i5,"%3D")}function p5(n){return xv(n).replace(ZS,"%23").replace(o5,"%3F")}function m5(n){return p5(n).replace(s5,"%2F")}function nu(n){if(n==null)return null;try{return decodeURIComponent(""+n)}catch{}return""+n}const g5=/\/$/,v5=n=>n.replace(g5,"");function Gp(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return l=a>=0&&l>a?-1:l,l>=0&&(r=e.slice(0,l),i=e.slice(l,a>0?a:e.length),s=n(i.slice(1))),a>=0&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=T5(r??e,t),{fullPath:r+i+o,path:r,query:s,hash:nu(o)}}function y5(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function gE(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function _5(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&bl(e.matched[r],t.matched[s])&&sx(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function bl(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function sx(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(var t in n)if(!E5(n[t],e[t]))return!1;return!0}function E5(n,e){return ws(n)?vE(n,e):ws(e)?vE(e,n):(n==null?void 0:n.valueOf())===(e==null?void 0:e.valueOf())}function vE(n,e){return ws(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function T5(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const Gi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let c0=function(n){return n.pop="pop",n.push="push",n}({}),zp=function(n){return n.back="back",n.forward="forward",n.unknown="",n}({});function w5(n){if(!n)if(Ka){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),v5(n)}const C5=/^[^#]+#/;function A5(n,e){return n.replace(C5,"#")+e}function I5(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Qf=()=>({left:window.scrollX,top:window.scrollY});function S5(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=I5(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function yE(n,e){return(history.state?history.state.position-e:-1)+n}const u0=new Map;function x5(n,e){u0.set(n,e)}function b5(n){const e=u0.get(n);return u0.delete(n),e}function R5(n){return typeof n=="string"||n&&typeof n=="object"}function ix(n){return typeof n=="string"||typeof n=="symbol"}let dn=function(n){return n[n.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",n[n.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",n[n.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",n[n.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",n[n.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",n}({});const ox=Symbol("");dn.MATCHER_NOT_FOUND+"",dn.NAVIGATION_GUARD_REDIRECT+"",dn.NAVIGATION_ABORTED+"",dn.NAVIGATION_CANCELLED+"",dn.NAVIGATION_DUPLICATED+"";function Rl(n,e){return Dt(new Error,{type:n,[ox]:!0},e)}function ai(n,e){return n instanceof Error&&ox in n&&(e==null||!!(n.type&e))}const k5=["params","query","hash"];function P5(n){if(typeof n=="string")return n;if(n.path!=null)return n.path;const e={};for(const t of k5)t in n&&(e[t]=n[t]);return JSON.stringify(e,null,2)}function N5(n){const e={};if(n===""||n==="?")return e;const t=(n[0]==="?"?n.slice(1):n).split("&");for(let r=0;r<t.length;++r){const s=t[r].replace(ex," "),i=s.indexOf("="),o=nu(i<0?s:s.slice(0,i)),a=i<0?null:nu(s.slice(i+1));if(o in e){let l=e[o];ws(l)||(l=e[o]=[l]),l.push(a)}else e[o]=a}return e}function _E(n){let e="";for(let t in n){const r=n[t];if(t=f5(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(ws(r)?r.map(s=>s&&l0(s)):[r&&l0(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function O5(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=ws(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const D5=Symbol(""),EE=Symbol(""),Xf=Symbol(""),ax=Symbol(""),d0=Symbol("");function oc(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function eo(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const u=p=>{p===!1?l(Rl(dn.NAVIGATION_ABORTED,{from:t,to:e})):p instanceof Error?l(p):R5(p)?l(Rl(dn.NAVIGATION_GUARD_REDIRECT,{from:e,to:p})):(o&&r.enterCallbacks[s]===o&&typeof p=="function"&&o.push(p),a())},d=i(()=>n.call(r&&r.instances[s],e,t,u));let f=Promise.resolve(d);n.length<3&&(f=f.then(u)),f.catch(p=>l(p))})}function Yp(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(JS(l)){const u=(l.__vccOpts||l)[e];u&&i.push(eo(u,t,r,o,a,s))}else{let u=l();i.push(()=>u.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=n5(d)?d.default:d;o.mods[a]=d,o.components[a]=f;const p=(f.__vccOpts||f)[e];return p&&eo(p,t,r,o,a,s)()}))}}return i}function M5(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(u=>bl(u,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(u=>bl(u,l))||s.push(l))}return[t,r,s]}/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let F5=()=>location.protocol+"//"+location.host;function lx(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let o=s.includes(n.slice(i))?n.slice(i).length:1,a=s.slice(o);return a[0]!=="/"&&(a="/"+a),gE(a,"")}return gE(t,n)+r+s}function L5(n,e,t,r){let s=[],i=[],o=null;const a=({state:p})=>{const m=lx(n,location),g=t.value,v=e.value;let y=0;if(p){if(t.value=m,e.value=p,o&&o===g){o=null;return}y=v?p.position-v.position:0}else r(m);s.forEach(L=>{L(t.value,g,{delta:y,type:c0.pop,direction:y?y>0?zp.forward:zp.back:zp.unknown})})};function l(){o=t.value}function u(p){s.push(p);const m=()=>{const g=s.indexOf(p);g>-1&&s.splice(g,1)};return i.push(m),m}function d(){if(document.visibilityState==="hidden"){const{history:p}=window;if(!p.state)return;p.replaceState(Dt({},p.state,{scroll:Qf()}),"")}}function f(){for(const p of i)p();i=[],window.removeEventListener("popstate",a),window.removeEventListener("pagehide",d),document.removeEventListener("visibilitychange",d)}return window.addEventListener("popstate",a),window.addEventListener("pagehide",d),document.addEventListener("visibilitychange",d),{pauseListeners:l,listen:u,destroy:f}}function TE(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?Qf():null}}function U5(n){const{history:e,location:t}=window,r={value:lx(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,u,d){const f=n.indexOf("#"),p=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:F5()+n+l;try{e[d?"replaceState":"pushState"](u,"",p),s.value=u}catch(m){console.error(m),t[d?"replace":"assign"](p)}}function o(l,u){i(l,Dt({},e.state,TE(s.value.back,l,s.value.forward,!0),u,{position:s.value.position}),!0),r.value=l}function a(l,u){const d=Dt({},s.value,e.state,{forward:l,scroll:Qf()});i(d.current,d,!0),i(l,Dt({},TE(r.value,l,null),{position:d.position+1},u),!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function B5(n){n=w5(n);const e=U5(n),t=L5(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=Dt({location:"",base:n,go:r,createHref:A5.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}let jo=function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.Group=2]="Group",n}({});var Dn=function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.ParamRegExp=2]="ParamRegExp",n[n.ParamRegExpEnd=3]="ParamRegExpEnd",n[n.EscapeNext=4]="EscapeNext",n}(Dn||{});const V5={type:jo.Static,value:""},$5=/[a-zA-Z0-9_]/;function H5(n){if(!n)return[[]];if(n==="/")return[[V5]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(m){throw new Error(`ERR (${t})/"${u}": ${m}`)}let t=Dn.Static,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,u="",d="";function f(){u&&(t===Dn.Static?i.push({type:jo.Static,value:u}):t===Dn.Param||t===Dn.ParamRegExp||t===Dn.ParamRegExpEnd?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:jo.Param,value:u,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function p(){u+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==Dn.ParamRegExp){r=t,t=Dn.EscapeNext;continue}switch(t){case Dn.Static:l==="/"?(u&&f(),o()):l===":"?(f(),t=Dn.Param):p();break;case Dn.EscapeNext:p(),t=r;break;case Dn.Param:l==="("?t=Dn.ParamRegExp:$5.test(l)?p():(f(),t=Dn.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case Dn.ParamRegExp:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:t=Dn.ParamRegExpEnd:d+=l;break;case Dn.ParamRegExpEnd:f(),t=Dn.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===Dn.ParamRegExp&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),s}const wE="[^/]+?",j5={sensitive:!1,strict:!1,start:!0,end:!0};var Tr=function(n){return n[n._multiplier=10]="_multiplier",n[n.Root=90]="Root",n[n.Segment=40]="Segment",n[n.SubSegment=30]="SubSegment",n[n.Static=40]="Static",n[n.Dynamic=20]="Dynamic",n[n.BonusCustomRegExp=10]="BonusCustomRegExp",n[n.BonusWildcard=-50]="BonusWildcard",n[n.BonusRepeatable=-20]="BonusRepeatable",n[n.BonusOptional=-8]="BonusOptional",n[n.BonusStrict=.7000000000000001]="BonusStrict",n[n.BonusCaseSensitive=.25]="BonusCaseSensitive",n}(Tr||{});const W5=/[.+*?^${}()[\]/\\]/g;function K5(n,e){const t=Dt({},j5,e),r=[];let s=t.start?"^":"";const i=[];for(const u of n){const d=u.length?[]:[Tr.Root];t.strict&&!u.length&&(s+="/");for(let f=0;f<u.length;f++){const p=u[f];let m=Tr.Segment+(t.sensitive?Tr.BonusCaseSensitive:0);if(p.type===jo.Static)f||(s+="/"),s+=p.value.replace(W5,"\\$&"),m+=Tr.Static;else if(p.type===jo.Param){const{value:g,repeatable:v,optional:y,regexp:L}=p;i.push({name:g,repeatable:v,optional:y});const D=L||wE;if(D!==wE){m+=Tr.BonusCustomRegExp;try{`${D}`}catch(C){throw new Error(`Invalid custom RegExp for param "${g}" (${D}): `+C.message)}}let A=v?`((?:${D})(?:/(?:${D}))*)`:`(${D})`;f||(A=y&&u.length<2?`(?:/${A})`:"/"+A),y&&(A+="?"),s+=A,m+=Tr.Dynamic,y&&(m+=Tr.BonusOptional),v&&(m+=Tr.BonusRepeatable),D===".*"&&(m+=Tr.BonusWildcard)}d.push(m)}r.push(d)}if(t.strict&&t.end){const u=r.length-1;r[u][r[u].length-1]+=Tr.BonusStrict}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(u){const d=u.match(o),f={};if(!d)return null;for(let p=1;p<d.length;p++){const m=d[p]||"",g=i[p-1];f[g.name]=m&&g.repeatable?m.split("/"):m}return f}function l(u){let d="",f=!1;for(const p of n){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const m of p)if(m.type===jo.Static)d+=m.value;else if(m.type===jo.Param){const{value:g,repeatable:v,optional:y}=m,L=g in u?u[g]:"";if(ws(L)&&!v)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const D=ws(L)?L.join("/"):L;if(!D)if(y)p.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);d+=D}}return d||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function q5(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===Tr.Static+Tr.Segment?-1:1:n.length>e.length?e.length===1&&e[0]===Tr.Static+Tr.Segment?1:-1:0}function cx(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=q5(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(CE(r))return 1;if(CE(s))return-1}return s.length-r.length}function CE(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const G5={strict:!1,end:!0,sensitive:!1};function z5(n,e,t){const r=K5(H5(n.path),t),s=Dt(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function Y5(n,e){const t=[],r=new Map;e=mE(G5,e);function s(f){return r.get(f)}function i(f,p,m){const g=!m,v=IE(f);v.aliasOf=m&&m.record;const y=mE(e,f),L=[v];if("alias"in f){const C=typeof f.alias=="string"?[f.alias]:f.alias;for(const j of C)L.push(IE(Dt({},v,{components:m?m.record.components:v.components,path:j,aliasOf:m?m.record:v})))}let D,A;for(const C of L){const{path:j}=C;if(p&&j[0]!=="/"){const z=p.record.path,w=z[z.length-1]==="/"?"":"/";C.path=p.record.path+(j&&w+j)}if(D=z5(C,p,y),m?m.alias.push(D):(A=A||D,A!==D&&A.alias.push(D),g&&f.name&&!SE(D)&&o(f.name)),ux(D)&&l(D),v.children){const z=v.children;for(let w=0;w<z.length;w++)i(z[w],D,m&&m.children[w])}m=m||D}return A?()=>{o(A)}:Mc}function o(f){if(ix(f)){const p=r.get(f);p&&(r.delete(f),t.splice(t.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=t.indexOf(f);p>-1&&(t.splice(p,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const p=J5(f,t);t.splice(p,0,f),f.record.name&&!SE(f)&&r.set(f.record.name,f)}function u(f,p){let m,g={},v,y;if("name"in f&&f.name){if(m=r.get(f.name),!m)throw Rl(dn.MATCHER_NOT_FOUND,{location:f});y=m.record.name,g=Dt(AE(p.params,m.keys.filter(A=>!A.optional).concat(m.parent?m.parent.keys.filter(A=>A.optional):[]).map(A=>A.name)),f.params&&AE(f.params,m.keys.map(A=>A.name))),v=m.stringify(g)}else if(f.path!=null)v=f.path,m=t.find(A=>A.re.test(v)),m&&(g=m.parse(v),y=m.record.name);else{if(m=p.name?r.get(p.name):t.find(A=>A.re.test(p.path)),!m)throw Rl(dn.MATCHER_NOT_FOUND,{location:f,currentLocation:p});y=m.record.name,g=Dt({},p.params,f.params),v=m.stringify(g)}const L=[];let D=m;for(;D;)L.unshift(D.record),D=D.parent;return{name:y,path:v,params:g,matched:L,meta:X5(L)}}n.forEach(f=>i(f));function d(){t.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:s}}function AE(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function IE(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:Q5(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function Q5(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function SE(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function X5(n){return n.reduce((e,t)=>Dt(e,t.meta),{})}function J5(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;cx(n,e[i])<0?r=i:t=i+1}const s=Z5(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function Z5(n){let e=n;for(;e=e.parent;)if(ux(e)&&cx(n,e)===0)return e}function ux({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function xE(n){const e=fs(Xf),t=fs(ax),r=Be(()=>{const l=Ut(n.to);return e.resolve(l)}),s=Be(()=>{const{matched:l}=r.value,{length:u}=l,d=l[u-1],f=t.matched;if(!d||!f.length)return-1;const p=f.findIndex(bl.bind(null,d));if(p>-1)return p;const m=bE(l[u-2]);return u>1&&bE(d)===m&&f[f.length-1].path!==m?f.findIndex(bl.bind(null,l[u-2])):p}),i=Be(()=>s.value>-1&&s8(t.params,r.value.params)),o=Be(()=>s.value>-1&&s.value===t.matched.length-1&&sx(t.params,r.value.params));function a(l={}){if(r8(l)){const u=e[Ut(n.replace)?"replace":"push"](Ut(n.to)).catch(Mc);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:Be(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function e8(n){return n.length===1?n[0]:n}const t8=Ew({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:xE,setup(n,{slots:e}){const t=hu(xE(n)),{options:r}=fs(Xf),s=Be(()=>({[RE(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[RE(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&e8(e.default(t));return n.custom?i:Kw("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),n8=t8;function r8(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function s8(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!ws(s)||s.length!==r.length||r.some((i,o)=>i.valueOf()!==s[o].valueOf()))return!1}return!0}function bE(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const RE=(n,e,t)=>n??e??t,i8=Ew({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=fs(d0),s=Be(()=>n.route||r.value),i=fs(EE,0),o=Be(()=>{let u=Ut(i);const{matched:d}=s.value;let f;for(;(f=d[u])&&!f.components;)u++;return u}),a=Be(()=>s.value.matched[o.value]);Od(EE,Be(()=>o.value+1)),Od(D5,a),Od(d0,s);const l=ae();return Ti(()=>[l.value,a.value,n.name],([u,d,f],[p,m,g])=>{d&&(d.instances[f]=u,m&&m!==d&&u&&u===p&&(d.leaveGuards.size||(d.leaveGuards=m.leaveGuards),d.updateGuards.size||(d.updateGuards=m.updateGuards))),u&&d&&(!m||!bl(d,m)||!p)&&(d.enterCallbacks[f]||[]).forEach(v=>v(u))},{flush:"post"}),()=>{const u=s.value,d=n.name,f=a.value,p=f&&f.components[d];if(!p)return kE(t.default,{Component:p,route:u});const m=f.props[d],g=m?m===!0?u.params:typeof m=="function"?m(u):m:null,y=Kw(p,Dt({},g,e,{onVnodeUnmounted:L=>{L.component.isUnmounted&&(f.instances[d]=null)},ref:l}));return kE(t.default,{Component:y,route:u})||y}}});function kE(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const o8=i8;function a8(n){const e=Y5(n.routes,n),t=n.parseQuery||N5,r=n.stringifyQuery||_E,s=n.history,i=oc(),o=oc(),a=oc(),l=b2(Gi);let u=Gi;Ka&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=qp.bind(null,se=>""+se),f=qp.bind(null,m5),p=qp.bind(null,nu);function m(se,ve){let te,O;return ix(se)?(te=e.getRecordMatcher(se),O=ve):O=se,e.addRoute(O,te)}function g(se){const ve=e.getRecordMatcher(se);ve&&e.removeRoute(ve)}function v(){return e.getRoutes().map(se=>se.record)}function y(se){return!!e.getRecordMatcher(se)}function L(se,ve){if(ve=Dt({},ve||l.value),typeof se=="string"){const B=Gp(t,se,ve.path),ie=e.resolve({path:B.path},ve),ue=s.createHref(B.fullPath);return Dt(B,ie,{params:p(ie.params),hash:nu(B.hash),redirectedFrom:void 0,href:ue})}let te;if(se.path!=null)te=Dt({},se,{path:Gp(t,se.path,ve.path).path});else{const B=Dt({},se.params);for(const ie in B)B[ie]==null&&delete B[ie];te=Dt({},se,{params:f(B)}),ve.params=f(ve.params)}const O=e.resolve(te,ve),H=se.hash||"";O.params=d(p(O.params));const I=y5(r,Dt({},se,{hash:h5(H),path:O.path})),S=s.createHref(I);return Dt({fullPath:I,hash:H,query:r===_E?O5(se.query):se.query||{}},O,{redirectedFrom:void 0,href:S})}function D(se){return typeof se=="string"?Gp(t,se,l.value.path):Dt({},se)}function A(se,ve){if(u!==se)return Rl(dn.NAVIGATION_CANCELLED,{from:ve,to:se})}function C(se){return w(se)}function j(se){return C(Dt(D(se),{replace:!0}))}function z(se,ve){const te=se.matched[se.matched.length-1];if(te&&te.redirect){const{redirect:O}=te;let H=typeof O=="function"?O(se,ve):O;return typeof H=="string"&&(H=H.includes("?")||H.includes("#")?H=D(H):{path:H},H.params={}),Dt({query:se.query,hash:se.hash,params:H.path!=null?{}:se.params},H)}}function w(se,ve){const te=u=L(se),O=l.value,H=se.state,I=se.force,S=se.replace===!0,B=z(te,O);if(B)return w(Dt(D(B),{state:typeof B=="object"?Dt({},H,B.state):H,force:I,replace:S}),ve||te);const ie=te;ie.redirectedFrom=ve;let ue;return!I&&_5(r,O,te)&&(ue=Rl(dn.NAVIGATION_DUPLICATED,{to:ie,from:O}),he(O,O,!0,!1)),(ue?Promise.resolve(ue):b(ie,O)).catch(re=>ai(re)?ai(re,dn.NAVIGATION_GUARD_REDIRECT)?re:Pe(re):xe(re,ie,O)).then(re=>{if(re){if(ai(re,dn.NAVIGATION_GUARD_REDIRECT))return w(Dt({replace:S},D(re.to),{state:typeof re.to=="object"?Dt({},H,re.to.state):H,force:I}),ve||ie)}else re=M(ie,O,!0,S,H);return N(ie,O,re),re})}function R(se,ve){const te=A(se,ve);return te?Promise.reject(te):Promise.resolve()}function x(se){const ve=U.values().next().value;return ve&&typeof ve.runWithContext=="function"?ve.runWithContext(se):se()}function b(se,ve){let te;const[O,H,I]=M5(se,ve);te=Yp(O.reverse(),"beforeRouteLeave",se,ve);for(const B of O)B.leaveGuards.forEach(ie=>{te.push(eo(ie,se,ve))});const S=R.bind(null,se,ve);return te.push(S),le(te).then(()=>{te=[];for(const B of i.list())te.push(eo(B,se,ve));return te.push(S),le(te)}).then(()=>{te=Yp(H,"beforeRouteUpdate",se,ve);for(const B of H)B.updateGuards.forEach(ie=>{te.push(eo(ie,se,ve))});return te.push(S),le(te)}).then(()=>{te=[];for(const B of I)if(B.beforeEnter)if(ws(B.beforeEnter))for(const ie of B.beforeEnter)te.push(eo(ie,se,ve));else te.push(eo(B.beforeEnter,se,ve));return te.push(S),le(te)}).then(()=>(se.matched.forEach(B=>B.enterCallbacks={}),te=Yp(I,"beforeRouteEnter",se,ve,x),te.push(S),le(te))).then(()=>{te=[];for(const B of o.list())te.push(eo(B,se,ve));return te.push(S),le(te)}).catch(B=>ai(B,dn.NAVIGATION_CANCELLED)?B:Promise.reject(B))}function N(se,ve,te){a.list().forEach(O=>x(()=>O(se,ve,te)))}function M(se,ve,te,O,H){const I=A(se,ve);if(I)return I;const S=ve===Gi,B=Ka?history.state:{};te&&(O||S?s.replace(se.fullPath,Dt({scroll:S&&B&&B.scroll},H)):s.push(se.fullPath,H)),l.value=se,he(se,ve,te,S),Pe()}let F;function oe(){F||(F=s.listen((se,ve,te)=>{if(!ee.listening)return;const O=L(se),H=z(O,ee.currentRoute.value);if(H){w(Dt(H,{replace:!0,force:!0}),O).catch(Mc);return}u=O;const I=l.value;Ka&&x5(yE(I.fullPath,te.delta),Qf()),b(O,I).catch(S=>ai(S,dn.NAVIGATION_ABORTED|dn.NAVIGATION_CANCELLED)?S:ai(S,dn.NAVIGATION_GUARD_REDIRECT)?(w(Dt(D(S.to),{force:!0}),O).then(B=>{ai(B,dn.NAVIGATION_ABORTED|dn.NAVIGATION_DUPLICATED)&&!te.delta&&te.type===c0.pop&&s.go(-1,!1)}).catch(Mc),Promise.reject()):(te.delta&&s.go(-te.delta,!1),xe(S,O,I))).then(S=>{S=S||M(O,I,!1),S&&(te.delta&&!ai(S,dn.NAVIGATION_CANCELLED)?s.go(-te.delta,!1):te.type===c0.pop&&ai(S,dn.NAVIGATION_ABORTED|dn.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),N(O,I,S)}).catch(Mc)}))}let Q=oc(),ne=oc(),ge;function xe(se,ve,te){Pe(se);const O=ne.list();return O.length?O.forEach(H=>H(se,ve,te)):console.error(se),Promise.reject(se)}function Ee(){return ge&&l.value!==Gi?Promise.resolve():new Promise((se,ve)=>{Q.add([se,ve])})}function Pe(se){return ge||(ge=!se,oe(),Q.list().forEach(([ve,te])=>se?te(se):ve()),Q.reset()),se}function he(se,ve,te,O){const{scrollBehavior:H}=n;if(!Ka||!H)return Promise.resolve();const I=!te&&b5(yE(se.fullPath,0))||(O||!te)&&history.state&&history.state.scroll||null;return sf().then(()=>H(se,ve,I)).then(S=>S&&S5(S)).catch(S=>xe(S,se,ve))}const E=se=>s.go(se);let T;const U=new Set,ee={currentRoute:l,listening:!0,addRoute:m,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:y,getRoutes:v,resolve:L,options:n,push:C,replace:j,go:E,back:()=>E(-1),forward:()=>E(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:ne.add,isReady:Ee,install(se){se.component("RouterLink",n8),se.component("RouterView",o8),se.config.globalProperties.$router=ee,Object.defineProperty(se.config.globalProperties,"$route",{enumerable:!0,get:()=>Ut(l)}),Ka&&!T&&l.value===Gi&&(T=!0,C(s.location).catch(O=>{}));const ve={};for(const O in Gi)Object.defineProperty(ve,O,{get:()=>l.value[O],enumerable:!0});se.provide(Xf,ee),se.provide(ax,aw(ve)),se.provide(d0,l);const te=se.unmount;U.add(se),se.unmount=function(){U.delete(se),U.size<1&&(u=Gi,F&&F(),F=null,l.value=Gi,T=!1,ge=!1),te()}}};function le(se){return se.reduce((ve,te)=>ve.then(()=>x(te)),Promise.resolve())}return ee}function Du(){return fs(Xf)}const gn=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},l8={class:"login-container"},c8={class:"login-card"},u8={class:"login-content"},d8={class:"login-section"},h8=["disabled"],f8={key:0,class:"error"},p8={__name:"Login",setup(n){const e=Du(),t=Js(),r=ae(!1),s=ae("");kn(async()=>{var a,l;console.log("Login page mounted"),await new Promise(u=>setTimeout(u,1500)),console.log("Checking for Microsoft account...",t.msalAccount),console.log("All MSAL accounts:",(a=t.msalInstance)==null?void 0:a.getAllAccounts());const o=((l=t.msalInstance)==null?void 0:l.getAllAccounts())||[];t.msalAccount||o.length>0?(console.log("Microsoft login detected, redirecting to supervisor registration"),await new Promise(u=>setTimeout(u,100)),e.push("/supervisor-register")):console.log("No Microsoft account found")});async function i(){r.value=!0,s.value="";try{await t.signInWithGoogle(),t.userData?e.push("/dashboard"):e.push("/register")}catch(o){s.value=o.message||"Failed to sign in",console.error("Sign in error:",o)}finally{r.value=!1}}return(o,a)=>(K(),q("div",l8,[c("div",c8,[a[3]||(a[3]=c("h1",null,"MunkhZaisan",-1)),a[4]||(a[4]=c("h2",null,"Attendance Management System",-1)),c("div",u8,[c("div",d8,[a[1]||(a[1]=c("h3",null,"Sign In",-1)),a[2]||(a[2]=c("p",null,"All employees and supervisors sign in with Google account",-1)),c("button",{onClick:i,class:"google-btn",disabled:r.value},[a[0]||(a[0]=c("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google"},null,-1)),c("span",null,P(r.value?"Signing in...":"Sign in with Google"),1)],8,h8)]),s.value?(K(),q("p",f8,P(s.value),1)):be("",!0)])])]))}},m8=gn(p8,[["__scopeId","data-v-9cd2ff68"]]),_a=pa("employees",()=>{const n=ae([]),e=ae(!1);async function t(){e.value=!0;try{const s=await Zt(Yt(Ct,"employees"));return n.value=s.docs.map(i=>{const o=i.data();return{id:i.id,...o,EmployeeLastName:o.LastName||o.EmployeeLastName,Role:o.Role||"Employee",FirstName:o.FirstName}}),n.value}catch(s){throw console.error("Error fetching employees:",s),s}finally{e.value=!1}}async function r(s,i){try{await Ff(Hs(Ct,"employees",s),{Email:i,updatedAt:new Date().toISOString()});const o=n.value.find(a=>a.id===s);o&&(o.Email=i)}catch(o){throw console.error("Error updating employee email:",o),o}}return{employees:n,loading:e,fetchEmployees:t,updateEmployeeEmail:r}}),g8={class:"register-container"},v8={class:"register-card"},y8={class:"subtitle"},_8={class:"form-group"},E8=["value"],T8={key:0,class:"employee-details"},w8={key:0,class:"supervisor-notice"},C8=["disabled"],A8={key:1,class:"error"},I8={__name:"Register",setup(n){const e=Du(),t=Js(),r=_a(),s=ae(""),i=ae(null),o=ae(!1),a=ae(""),l=Be(()=>r.employees.filter(f=>f.State===" "));kn(async()=>{if(!t.user){e.push("/login");return}if(t.userData){e.push("/dashboard");return}await r.fetchEmployees()});function u(){i.value=r.employees.find(f=>f.id===s.value)}async function d(){var f;o.value=!0,a.value="";try{const p=((f=i.value)==null?void 0:f.Role)==="Supervisor";await t.registerUser(i.value,p),await r.updateEmployeeEmail(s.value,t.user.email),e.push("/dashboard")}catch(p){a.value=p.message||"Failed to complete registration",console.error("Registration error:",p)}finally{o.value=!1}}return(f,p)=>{var m;return K(),q("div",g8,[c("div",v8,[p[8]||(p[8]=c("h1",null,"Complete Registration",-1)),c("p",y8,"Welcome, "+P((m=Ut(t).user)==null?void 0:m.displayName)+"!",1),c("form",{onSubmit:nn(d,["prevent"]),class:"register-form"},[c("div",_8,[p[2]||(p[2]=c("label",{for:"employee"},"Select Your Name",-1)),ce(c("select",{id:"employee","onUpdate:modelValue":p[0]||(p[0]=g=>s.value=g),required:"",onChange:u},[p[1]||(p[1]=c("option",{value:""},"-- Choose your name --",-1)),(K(!0),q(Xe,null,ft(l.value,g=>(K(),q("option",{key:g.id,value:g.id},P(g.LastName||g.EmployeeLastName)+" "+P(g.FirstName||"")+" - "+P(g.Position||g.Role),9,E8))),128))],544),[[st,s.value]])]),i.value?(K(),q("div",T8,[p[7]||(p[7]=c("h3",null,"Employee Information",-1)),c("p",null,[p[3]||(p[3]=c("strong",null,"Name:",-1)),bt(" "+P(i.value.LastName||i.value.EmployeeLastName)+" "+P(i.value.FirstName||""),1)]),c("p",null,[p[4]||(p[4]=c("strong",null,"Position:",-1)),bt(" "+P(i.value.Position),1)]),c("p",null,[p[5]||(p[5]=c("strong",null,"Role:",-1)),bt(" "+P(i.value.Role||"Employee"),1)]),i.value.Role==="Supervisor"?(K(),q("p",w8,"  You will be registered as a Supervisor with full access ")):be("",!0),c("p",null,[p[6]||(p[6]=c("strong",null,"Current Email:",-1)),bt(" "+P(i.value.Email||"Not set"),1)])])):be("",!0),c("button",{type:"submit",class:"submit-btn",disabled:!s.value||o.value},P(o.value?"Registering...":"Complete Registration"),9,C8),a.value?(K(),q("p",A8,P(a.value),1)):be("",!0)],32)])])}}},S8=gn(I8,[["__scopeId","data-v-7dc466f4"]]),x8={class:"register-container"},b8={class:"register-card"},R8={class:"form-group"},k8={class:"account-info"},P8={class:"form-group"},N8=["disabled"],O8={value:""},D8=["value"],M8=["disabled"],F8={key:0,class:"error"},L8={__name:"SupervisorRegister",setup(n){const e=Du(),t=Js(),r=ae(!1),s=ae(""),i=ae([]),o=ae(""),a=ae(null),l=Be(()=>{console.log("Total employees:",i.value.length);const p=i.value.filter(g=>{const v=g.Status||g.status||g.EmployeeStatus;return console.log("Employee:",g.FirstName,g.LastName||g.EmployeeLastName,"Status:",v),v===""||v==="Active"||v==="active"});console.log("Active employees after filter:",p.length);let m=p.length===0?i.value:p;return m=m.sort((g,v)=>{const y=(g.FirstName||"").toLowerCase(),L=(v.FirstName||"").toLowerCase();return y.localeCompare(L)}),console.log("Sorted employees:",m.length),m});kn(async()=>{var p;if(r.value=!0,!t.msalAccount){s.value="No Microsoft account found. Please sign in first.",r.value=!1;return}if(!t.user)try{console.log("Creating anonymous Firebase user for reading data..."),await t.createAnonymousUser(),console.log("Anonymous user created successfully:",(p=t.user)==null?void 0:p.uid),await new Promise(m=>setTimeout(m,500))}catch(m){console.error("Error creating anonymous user:",m),s.value="Failed to initialize. Please enable Anonymous Authentication in Firebase Console.",r.value=!1;return}await u(),r.value=!1});async function u(){var p;try{console.log("Loading employees... Current user:",(p=t.user)==null?void 0:p.uid);const m=await Zt(Yt(Ct,"employees"));i.value=m.docs.map(g=>({id:g.id,...g.data()})),console.log("Loaded employees:",i.value.length)}catch(m){console.error("Error loading employees:",m),s.value="Failed to load employee list: "+m.message}}function d(){const p=i.value.find(m=>m.id===o.value);a.value=p,console.log("Selected employee:",p)}async function f(){var p;if(!a.value){s.value="Please select your name";return}r.value=!0,s.value="";try{console.log("Starting supervisor registration..."),console.log("Microsoft account:",(p=t.msalAccount)==null?void 0:p.username);const m={FirstName:a.value.FirstName,EmployeeLastName:a.value.LastName||a.value.EmployeeLastName,Position:a.value.Position};console.log("Employee data:",m),await t.registerUser(m,!0),console.log("Registration successful, redirecting to dashboard..."),e.push("/dashboard")}catch(m){s.value=m.message||"Failed to register",console.error("Registration error:",m)}finally{r.value=!1}}return(p,m)=>{var g;return K(),q("div",x8,[c("div",b8,[m[3]||(m[3]=c("h1",null,"Supervisor Registration",-1)),m[4]||(m[4]=c("p",{class:"subtitle"},"Complete your profile as a supervisor",-1)),c("form",{onSubmit:nn(f,["prevent"]),class:"register-form"},[c("div",R8,[m[1]||(m[1]=c("label",null,"Microsoft Account",-1)),c("p",k8,P((g=Ut(t).msalAccount)==null?void 0:g.username),1)]),c("div",P8,[m[2]||(m[2]=c("label",{for:"employee"},"Select Your Name",-1)),ce(c("select",{id:"employee","onUpdate:modelValue":m[0]||(m[0]=v=>o.value=v),required:"",disabled:r.value,onChange:d},[c("option",O8,P(r.value?"Loading...":"-- Select Your Name --"),1),(K(!0),q(Xe,null,ft(l.value,v=>(K(),q("option",{key:v.id,value:v.id},P(v.FirstName)+" "+P(v.LastName||v.EmployeeLastName),9,D8))),128))],40,N8),[[st,o.value]])]),c("button",{type:"submit",class:"register-btn",disabled:r.value||!a.value},P(r.value?"Registering...":"Complete Registration"),9,M8),s.value?(K(),q("p",F8,P(s.value),1)):be("",!0)],32)])])}}},U8=gn(L8,[["__scopeId","data-v-57a28946"]]),bv=pa("customers",{state:()=>({customers:[],loading:!1,error:null}),actions:{async fetchCustomers(){this.loading=!0,this.error=null;try{const n=await Zt(Yt(Ct,"customers"));this.customers=n.docs.map(e=>({id:e.id,...e.data()}))}catch(n){console.error("Error fetching customers:",n),this.error=n.message}finally{this.loading=!1}}}}),xo=pa("projects",{state:()=>({projects:[],loading:!1,error:null}),actions:{async fetchProjects(){this.loading=!0,this.error=null;try{const n=await Zt(Yt(Ct,"projects"));this.projects=n.docs.map(e=>({docId:e.id,...e.data()}))}catch(n){console.error("Error fetching projects:",n),this.error=n.message}finally{this.loading=!1}}}});function dx(n,e){return function(){return n.apply(e,arguments)}}const{toString:B8}=Object.prototype,{getPrototypeOf:Rv}=Object,{iterator:Jf,toStringTag:hx}=Symbol,Zf=(n=>e=>{const t=B8.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Cs=n=>(n=n.toLowerCase(),e=>Zf(e)===n),ep=n=>e=>typeof e===n,{isArray:$l}=Array,kl=ep("undefined");function Mu(n){return n!==null&&!kl(n)&&n.constructor!==null&&!kl(n.constructor)&&Or(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const fx=Cs("ArrayBuffer");function V8(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&fx(n.buffer),e}const $8=ep("string"),Or=ep("function"),px=ep("number"),Fu=n=>n!==null&&typeof n=="object",H8=n=>n===!0||n===!1,qd=n=>{if(Zf(n)!=="object")return!1;const e=Rv(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(hx in n)&&!(Jf in n)},j8=n=>{if(!Fu(n)||Mu(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},W8=Cs("Date"),K8=Cs("File"),q8=Cs("Blob"),G8=Cs("FileList"),z8=n=>Fu(n)&&Or(n.pipe),Y8=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Or(n.append)&&((e=Zf(n))==="formdata"||e==="object"&&Or(n.toString)&&n.toString()==="[object FormData]"))},Q8=Cs("URLSearchParams"),[X8,J8,Z8,eB]=["ReadableStream","Request","Response","Headers"].map(Cs),tB=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Lu(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),$l(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{if(Mu(n))return;const i=t?Object.getOwnPropertyNames(n):Object.keys(n),o=i.length;let a;for(r=0;r<o;r++)a=i[r],e.call(null,n[a],a,n)}}function mx(n,e){if(Mu(n))return null;e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const Wo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gx=n=>!kl(n)&&n!==Wo;function h0(){const{caseless:n,skipUndefined:e}=gx(this)&&this||{},t={},r=(s,i)=>{const o=n&&mx(t,i)||i;qd(t[o])&&qd(s)?t[o]=h0(t[o],s):qd(s)?t[o]=h0({},s):$l(s)?t[o]=s.slice():(!e||!kl(s))&&(t[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Lu(arguments[s],r);return t}const nB=(n,e,t,{allOwnKeys:r}={})=>(Lu(e,(s,i)=>{t&&Or(s)?n[i]=dx(s,t):n[i]=s},{allOwnKeys:r}),n),rB=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),sB=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},iB=(n,e,t,r)=>{let s,i,o;const a={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),i=s.length;i-- >0;)o=s[i],(!r||r(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&Rv(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},oB=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},aB=n=>{if(!n)return null;if($l(n))return n;let e=n.length;if(!px(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},lB=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Rv(Uint8Array)),cB=(n,e)=>{const r=(n&&n[Jf]).call(n);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(n,i[0],i[1])}},uB=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},dB=Cs("HTMLFormElement"),hB=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),PE=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),fB=Cs("RegExp"),vx=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Lu(t,(s,i)=>{let o;(o=e(s,i,n))!==!1&&(r[i]=o||s)}),Object.defineProperties(n,r)},pB=n=>{vx(n,(e,t)=>{if(Or(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(Or(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},mB=(n,e)=>{const t={},r=s=>{s.forEach(i=>{t[i]=!0})};return $l(n)?r(n):r(String(n).split(e)),t},gB=()=>{},vB=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function yB(n){return!!(n&&Or(n.append)&&n[hx]==="FormData"&&n[Jf])}const _B=n=>{const e=new Array(10),t=(r,s)=>{if(Fu(r)){if(e.indexOf(r)>=0)return;if(Mu(r))return r;if(!("toJSON"in r)){e[s]=r;const i=$l(r)?[]:{};return Lu(r,(o,a)=>{const l=t(o,s+1);!kl(l)&&(i[a]=l)}),e[s]=void 0,i}}return r};return t(n,0)},EB=Cs("AsyncFunction"),TB=n=>n&&(Fu(n)||Or(n))&&Or(n.then)&&Or(n.catch),yx=((n,e)=>n?setImmediate:e?((t,r)=>(Wo.addEventListener("message",({source:s,data:i})=>{s===Wo&&i===t&&r.length&&r.shift()()},!1),s=>{r.push(s),Wo.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Or(Wo.postMessage)),wB=typeof queueMicrotask<"u"?queueMicrotask.bind(Wo):typeof process<"u"&&process.nextTick||yx,CB=n=>n!=null&&Or(n[Jf]),Te={isArray:$l,isArrayBuffer:fx,isBuffer:Mu,isFormData:Y8,isArrayBufferView:V8,isString:$8,isNumber:px,isBoolean:H8,isObject:Fu,isPlainObject:qd,isEmptyObject:j8,isReadableStream:X8,isRequest:J8,isResponse:Z8,isHeaders:eB,isUndefined:kl,isDate:W8,isFile:K8,isBlob:q8,isRegExp:fB,isFunction:Or,isStream:z8,isURLSearchParams:Q8,isTypedArray:lB,isFileList:G8,forEach:Lu,merge:h0,extend:nB,trim:tB,stripBOM:rB,inherits:sB,toFlatObject:iB,kindOf:Zf,kindOfTest:Cs,endsWith:oB,toArray:aB,forEachEntry:cB,matchAll:uB,isHTMLForm:dB,hasOwnProperty:PE,hasOwnProp:PE,reduceDescriptors:vx,freezeMethods:pB,toObjectSet:mB,toCamelCase:hB,noop:gB,toFiniteNumber:vB,findKey:mx,global:Wo,isContextDefined:gx,isSpecCompliantForm:yB,toJSONObject:_B,isAsyncFn:EB,isThenable:TB,setImmediate:yx,asap:wB,isIterable:CB};function _t(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}Te.inherits(_t,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Te.toJSONObject(this.config),code:this.code,status:this.status}}});const _x=_t.prototype,Ex={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Ex[n]={value:n}});Object.defineProperties(_t,Ex);Object.defineProperty(_x,"isAxiosError",{value:!0});_t.from=(n,e,t,r,s,i)=>{const o=Object.create(_x);Te.toFlatObject(n,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const a=n&&n.message?n.message:"Error",l=e==null&&n?n.code:e;return _t.call(o,a,l,t,r,s),n&&o.cause==null&&Object.defineProperty(o,"cause",{value:n,configurable:!0}),o.name=n&&n.name||"Error",i&&Object.assign(o,i),o};const AB=null;function f0(n){return Te.isPlainObject(n)||Te.isArray(n)}function Tx(n){return Te.endsWith(n,"[]")?n.slice(0,-2):n}function NE(n,e,t){return n?n.concat(e).map(function(s,i){return s=Tx(s),!t&&i?"["+s+"]":s}).join(t?".":""):e}function IB(n){return Te.isArray(n)&&!n.some(f0)}const SB=Te.toFlatObject(Te,{},null,function(e){return/^is[A-Z]/.test(e)});function tp(n,e,t){if(!Te.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=Te.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,y){return!Te.isUndefined(y[v])});const r=t.metaTokens,s=t.visitor||d,i=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&Te.isSpecCompliantForm(e);if(!Te.isFunction(s))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(Te.isDate(g))return g.toISOString();if(Te.isBoolean(g))return g.toString();if(!l&&Te.isBlob(g))throw new _t("Blob is not supported. Use a Buffer instead.");return Te.isArrayBuffer(g)||Te.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function d(g,v,y){let L=g;if(g&&!y&&typeof g=="object"){if(Te.endsWith(v,"{}"))v=r?v:v.slice(0,-2),g=JSON.stringify(g);else if(Te.isArray(g)&&IB(g)||(Te.isFileList(g)||Te.endsWith(v,"[]"))&&(L=Te.toArray(g)))return v=Tx(v),L.forEach(function(A,C){!(Te.isUndefined(A)||A===null)&&e.append(o===!0?NE([v],C,i):o===null?v:v+"[]",u(A))}),!1}return f0(g)?!0:(e.append(NE(y,v,i),u(g)),!1)}const f=[],p=Object.assign(SB,{defaultVisitor:d,convertValue:u,isVisitable:f0});function m(g,v){if(!Te.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+v.join("."));f.push(g),Te.forEach(g,function(L,D){(!(Te.isUndefined(L)||L===null)&&s.call(e,L,Te.isString(D)?D.trim():D,v,p))===!0&&m(L,v?v.concat(D):[D])}),f.pop()}}if(!Te.isObject(n))throw new TypeError("data must be an object");return m(n),e}function OE(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function kv(n,e){this._pairs=[],n&&tp(n,this,e)}const wx=kv.prototype;wx.append=function(e,t){this._pairs.push([e,t])};wx.toString=function(e){const t=e?function(r){return e.call(this,r,OE)}:OE;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function xB(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Cx(n,e,t){if(!e)return n;const r=t&&t.encode||xB;Te.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let i;if(s?i=s(e,t):i=Te.isURLSearchParams(e)?e.toString():new kv(e,t).toString(r),i){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+i}return n}class DE{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Te.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Ax={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bB=typeof URLSearchParams<"u"?URLSearchParams:kv,RB=typeof FormData<"u"?FormData:null,kB=typeof Blob<"u"?Blob:null,PB={isBrowser:!0,classes:{URLSearchParams:bB,FormData:RB,Blob:kB},protocols:["http","https","file","blob","url","data"]},Pv=typeof window<"u"&&typeof document<"u",p0=typeof navigator=="object"&&navigator||void 0,NB=Pv&&(!p0||["ReactNative","NativeScript","NS"].indexOf(p0.product)<0),OB=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",DB=Pv&&window.location.href||"http://localhost",MB=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Pv,hasStandardBrowserEnv:NB,hasStandardBrowserWebWorkerEnv:OB,navigator:p0,origin:DB},Symbol.toStringTag,{value:"Module"})),fr={...MB,...PB};function FB(n,e){return tp(n,new fr.classes.URLSearchParams,{visitor:function(t,r,s,i){return fr.isNode&&Te.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function LB(n){return Te.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function UB(n){const e={},t=Object.keys(n);let r;const s=t.length;let i;for(r=0;r<s;r++)i=t[r],e[i]=n[i];return e}function Ix(n){function e(t,r,s,i){let o=t[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=t.length;return o=!o&&Te.isArray(s)?s.length:o,l?(Te.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!a):((!s[o]||!Te.isObject(s[o]))&&(s[o]=[]),e(t,r,s[o],i)&&Te.isArray(s[o])&&(s[o]=UB(s[o])),!a)}if(Te.isFormData(n)&&Te.isFunction(n.entries)){const t={};return Te.forEachEntry(n,(r,s)=>{e(LB(r),s,t,0)}),t}return null}function BB(n,e,t){if(Te.isString(n))try{return(e||JSON.parse)(n),Te.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Uu={transitional:Ax,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,i=Te.isObject(e);if(i&&Te.isHTMLForm(e)&&(e=new FormData(e)),Te.isFormData(e))return s?JSON.stringify(Ix(e)):e;if(Te.isArrayBuffer(e)||Te.isBuffer(e)||Te.isStream(e)||Te.isFile(e)||Te.isBlob(e)||Te.isReadableStream(e))return e;if(Te.isArrayBufferView(e))return e.buffer;if(Te.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return FB(e,this.formSerializer).toString();if((a=Te.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return tp(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),BB(e)):e}],transformResponse:[function(e){const t=this.transitional||Uu.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(Te.isResponse(e)||Te.isReadableStream(e))return e;if(e&&Te.isString(e)&&(r&&!this.responseType||s)){const o=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?_t.from(a,_t.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:fr.classes.FormData,Blob:fr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Te.forEach(["delete","get","head","post","put","patch"],n=>{Uu.headers[n]={}});const VB=Te.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$B=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(o){s=o.indexOf(":"),t=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!t||e[t]&&VB[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},ME=Symbol("internals");function ac(n){return n&&String(n).trim().toLowerCase()}function Gd(n){return n===!1||n==null?n:Te.isArray(n)?n.map(Gd):String(n)}function HB(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const jB=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Qp(n,e,t,r,s){if(Te.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!Te.isString(e)){if(Te.isString(r))return e.indexOf(r)!==-1;if(Te.isRegExp(r))return r.test(e)}}function WB(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function KB(n,e){const t=Te.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}let Dr=class{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function i(a,l,u){const d=ac(l);if(!d)throw new Error("header name must be a non-empty string");const f=Te.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||l]=Gd(a))}const o=(a,l)=>Te.forEach(a,(u,d)=>i(u,d,l));if(Te.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(Te.isString(e)&&(e=e.trim())&&!jB(e))o($B(e),t);else if(Te.isObject(e)&&Te.isIterable(e)){let a={},l,u;for(const d of e){if(!Te.isArray(d))throw TypeError("Object iterator must return a key-value pair");a[u=d[0]]=(l=a[u])?Te.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}o(a,t)}else e!=null&&i(t,e,r);return this}get(e,t){if(e=ac(e),e){const r=Te.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return HB(s);if(Te.isFunction(t))return t.call(this,s,r);if(Te.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ac(e),e){const r=Te.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Qp(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function i(o){if(o=ac(o),o){const a=Te.findKey(r,o);a&&(!t||Qp(r,r[a],a,t))&&(delete r[a],s=!0)}}return Te.isArray(e)?e.forEach(i):i(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const i=t[r];(!e||Qp(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const t=this,r={};return Te.forEach(this,(s,i)=>{const o=Te.findKey(r,i);if(o){t[o]=Gd(s),delete t[i];return}const a=e?WB(i):String(i).trim();a!==i&&delete t[i],t[a]=Gd(s),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Te.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&Te.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[ME]=this[ME]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=ac(o);r[a]||(KB(s,o),r[a]=!0)}return Te.isArray(e)?e.forEach(i):i(e),this}};Dr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Te.reduceDescriptors(Dr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});Te.freezeMethods(Dr);function Xp(n,e){const t=this||Uu,r=e||t,s=Dr.from(r.headers);let i=r.data;return Te.forEach(n,function(a){i=a.call(t,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Sx(n){return!!(n&&n.__CANCEL__)}function Hl(n,e,t){_t.call(this,n??"canceled",_t.ERR_CANCELED,e,t),this.name="CanceledError"}Te.inherits(Hl,_t,{__CANCEL__:!0});function xx(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new _t("Request failed with status code "+t.status,[_t.ERR_BAD_REQUEST,_t.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function qB(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function GB(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),d=r[i];o||(o=u),t[s]=l,r[s]=u;let f=i,p=0;for(;f!==s;)p+=t[f++],f=f%n;if(s=(s+1)%n,s===i&&(i=(i+1)%n),u-o<e)return;const m=d&&u-d;return m?Math.round(p*1e3/m):void 0}}function zB(n,e){let t=0,r=1e3/e,s,i;const o=(u,d=Date.now())=>{t=d,s=null,i&&(clearTimeout(i),i=null),n(...u)};return[(...u)=>{const d=Date.now(),f=d-t;f>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-f)))},()=>s&&o(s)]}const Oh=(n,e,t=3)=>{let r=0;const s=GB(50,250);return zB(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-r,u=s(l),d=o<=a;r=o;const f={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&d?(a-o)/u:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(f)},t)},FE=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},LE=n=>(...e)=>Te.asap(()=>n(...e)),YB=fr.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,fr.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(fr.origin),fr.navigator&&/(msie|trident)/i.test(fr.navigator.userAgent)):()=>!0,QB=fr.hasStandardBrowserEnv?{write(n,e,t,r,s,i,o){if(typeof document>"u")return;const a=[`${n}=${encodeURIComponent(e)}`];Te.isNumber(t)&&a.push(`expires=${new Date(t).toUTCString()}`),Te.isString(r)&&a.push(`path=${r}`),Te.isString(s)&&a.push(`domain=${s}`),i===!0&&a.push("secure"),Te.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function XB(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function JB(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function bx(n,e,t){let r=!XB(e);return n&&(r||t==!1)?JB(n,e):e}const UE=n=>n instanceof Dr?{...n}:n;function ua(n,e){e=e||{};const t={};function r(u,d,f,p){return Te.isPlainObject(u)&&Te.isPlainObject(d)?Te.merge.call({caseless:p},u,d):Te.isPlainObject(d)?Te.merge({},d):Te.isArray(d)?d.slice():d}function s(u,d,f,p){if(Te.isUndefined(d)){if(!Te.isUndefined(u))return r(void 0,u,f,p)}else return r(u,d,f,p)}function i(u,d){if(!Te.isUndefined(d))return r(void 0,d)}function o(u,d){if(Te.isUndefined(d)){if(!Te.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function a(u,d,f){if(f in e)return r(u,d);if(f in n)return r(void 0,u)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,d,f)=>s(UE(u),UE(d),f,!0)};return Te.forEach(Object.keys({...n,...e}),function(d){const f=l[d]||s,p=f(n[d],e[d],d);Te.isUndefined(p)&&f!==a||(t[d]=p)}),t}const Rx=n=>{const e=ua({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=e;if(e.headers=o=Dr.from(o),e.url=Cx(bx(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),Te.isFormData(t)){if(fr.hasStandardBrowserEnv||fr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Te.isFunction(t.getHeaders)){const l=t.getHeaders(),u=["content-type","content-length"];Object.entries(l).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(fr.hasStandardBrowserEnv&&(r&&Te.isFunction(r)&&(r=r(e)),r||r!==!1&&YB(e.url))){const l=s&&i&&QB.read(i);l&&o.set(s,l)}return e},ZB=typeof XMLHttpRequest<"u",eV=ZB&&function(n){return new Promise(function(t,r){const s=Rx(n);let i=s.data;const o=Dr.from(s.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=s,d,f,p,m,g;function v(){m&&m(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function L(){if(!y)return;const A=Dr.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),j={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:A,config:n,request:y};xx(function(w){t(w),v()},function(w){r(w),v()},j),y=null}"onloadend"in y?y.onloadend=L:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(L)},y.onabort=function(){y&&(r(new _t("Request aborted",_t.ECONNABORTED,n,y)),y=null)},y.onerror=function(C){const j=C&&C.message?C.message:"Network Error",z=new _t(j,_t.ERR_NETWORK,n,y);z.event=C||null,r(z),y=null},y.ontimeout=function(){let C=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const j=s.transitional||Ax;s.timeoutErrorMessage&&(C=s.timeoutErrorMessage),r(new _t(C,j.clarifyTimeoutError?_t.ETIMEDOUT:_t.ECONNABORTED,n,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&Te.forEach(o.toJSON(),function(C,j){y.setRequestHeader(j,C)}),Te.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),a&&a!=="json"&&(y.responseType=s.responseType),u&&([p,g]=Oh(u,!0),y.addEventListener("progress",p)),l&&y.upload&&([f,m]=Oh(l),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(d=A=>{y&&(r(!A||A.type?new Hl(null,n,y):A),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const D=qB(s.url);if(D&&fr.protocols.indexOf(D)===-1){r(new _t("Unsupported protocol "+D+":",_t.ERR_BAD_REQUEST,n));return}y.send(i||null)})},tV=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const i=function(u){if(!s){s=!0,a();const d=u instanceof Error?u:this.reason;r.abort(d instanceof _t?d:new Hl(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,i(new _t(`timeout ${e} of ms exceeded`,_t.ETIMEDOUT))},e);const a=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),n=null)};n.forEach(u=>u.addEventListener("abort",i));const{signal:l}=r;return l.unsubscribe=()=>Te.asap(a),l}},nV=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},rV=async function*(n,e){for await(const t of sV(n))yield*nV(t,e)},sV=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},BE=(n,e,t,r)=>{const s=rV(n,e);let i=0,o,a=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:u,value:d}=await s.next();if(u){a(),l.close();return}let f=d.byteLength;if(t){let p=i+=f;t(p)}l.enqueue(new Uint8Array(d))}catch(u){throw a(u),u}},cancel(l){return a(l),s.return()}},{highWaterMark:2})},VE=64*1024,{isFunction:Cd}=Te,iV=(({Request:n,Response:e})=>({Request:n,Response:e}))(Te.global),{ReadableStream:$E,TextEncoder:HE}=Te.global,jE=(n,...e)=>{try{return!!n(...e)}catch{return!1}},oV=n=>{n=Te.merge.call({skipUndefined:!0},iV,n);const{fetch:e,Request:t,Response:r}=n,s=e?Cd(e):typeof fetch=="function",i=Cd(t),o=Cd(r);if(!s)return!1;const a=s&&Cd($E),l=s&&(typeof HE=="function"?(g=>v=>g.encode(v))(new HE):async g=>new Uint8Array(await new t(g).arrayBuffer())),u=i&&a&&jE(()=>{let g=!1;const v=new t(fr.origin,{body:new $E,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!v}),d=o&&a&&jE(()=>Te.isReadableStream(new r("").body)),f={stream:d&&(g=>g.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(v,y)=>{let L=v&&v[g];if(L)return L.call(v);throw new _t(`Response type '${g}' is not supported`,_t.ERR_NOT_SUPPORT,y)})});const p=async g=>{if(g==null)return 0;if(Te.isBlob(g))return g.size;if(Te.isSpecCompliantForm(g))return(await new t(fr.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(Te.isArrayBufferView(g)||Te.isArrayBuffer(g))return g.byteLength;if(Te.isURLSearchParams(g)&&(g=g+""),Te.isString(g))return(await l(g)).byteLength},m=async(g,v)=>{const y=Te.toFiniteNumber(g.getContentLength());return y??p(v)};return async g=>{let{url:v,method:y,data:L,signal:D,cancelToken:A,timeout:C,onDownloadProgress:j,onUploadProgress:z,responseType:w,headers:R,withCredentials:x="same-origin",fetchOptions:b}=Rx(g),N=e||fetch;w=w?(w+"").toLowerCase():"text";let M=tV([D,A&&A.toAbortSignal()],C),F=null;const oe=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let Q;try{if(z&&u&&y!=="get"&&y!=="head"&&(Q=await m(R,L))!==0){let he=new t(v,{method:"POST",body:L,duplex:"half"}),E;if(Te.isFormData(L)&&(E=he.headers.get("content-type"))&&R.setContentType(E),he.body){const[T,U]=FE(Q,Oh(LE(z)));L=BE(he.body,VE,T,U)}}Te.isString(x)||(x=x?"include":"omit");const ne=i&&"credentials"in t.prototype,ge={...b,signal:M,method:y.toUpperCase(),headers:R.normalize().toJSON(),body:L,duplex:"half",credentials:ne?x:void 0};F=i&&new t(v,ge);let xe=await(i?N(F,b):N(v,ge));const Ee=d&&(w==="stream"||w==="response");if(d&&(j||Ee&&oe)){const he={};["status","statusText","headers"].forEach(ee=>{he[ee]=xe[ee]});const E=Te.toFiniteNumber(xe.headers.get("content-length")),[T,U]=j&&FE(E,Oh(LE(j),!0))||[];xe=new r(BE(xe.body,VE,T,()=>{U&&U(),oe&&oe()}),he)}w=w||"text";let Pe=await f[Te.findKey(f,w)||"text"](xe,g);return!Ee&&oe&&oe(),await new Promise((he,E)=>{xx(he,E,{data:Pe,headers:Dr.from(xe.headers),status:xe.status,statusText:xe.statusText,config:g,request:F})})}catch(ne){throw oe&&oe(),ne&&ne.name==="TypeError"&&/Load failed|fetch/i.test(ne.message)?Object.assign(new _t("Network Error",_t.ERR_NETWORK,g,F),{cause:ne.cause||ne}):_t.from(ne,ne&&ne.code,g,F)}}},aV=new Map,kx=n=>{let e=n&&n.env||{};const{fetch:t,Request:r,Response:s}=e,i=[r,s,t];let o=i.length,a=o,l,u,d=aV;for(;a--;)l=i[a],u=d.get(l),u===void 0&&d.set(l,u=a?new Map:oV(e)),d=u;return u};kx();const Nv={http:AB,xhr:eV,fetch:{get:kx}};Te.forEach(Nv,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const WE=n=>`- ${n}`,lV=n=>Te.isFunction(n)||n===null||n===!1;function cV(n,e){n=Te.isArray(n)?n:[n];const{length:t}=n;let r,s;const i={};for(let o=0;o<t;o++){r=n[o];let a;if(s=r,!lV(r)&&(s=Nv[(a=String(r)).toLowerCase()],s===void 0))throw new _t(`Unknown adapter '${a}'`);if(s&&(Te.isFunction(s)||(s=s.get(e))))break;i[a||"#"+o]=s}if(!s){const o=Object.entries(i).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=t?o.length>1?`since :
`+o.map(WE).join(`
`):" "+WE(o[0]):"as no adapter specified";throw new _t("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return s}const Px={getAdapter:cV,adapters:Nv};function Jp(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Hl(null,n)}function KE(n){return Jp(n),n.headers=Dr.from(n.headers),n.data=Xp.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Px.getAdapter(n.adapter||Uu.adapter,n)(n).then(function(r){return Jp(n),r.data=Xp.call(n,n.transformResponse,r),r.headers=Dr.from(r.headers),r},function(r){return Sx(r)||(Jp(n),r&&r.response&&(r.response.data=Xp.call(n,n.transformResponse,r.response),r.response.headers=Dr.from(r.response.headers))),Promise.reject(r)})}const Nx="1.13.2",np={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{np[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const qE={};np.transitional=function(e,t,r){function s(i,o){return"[Axios v"+Nx+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,a)=>{if(e===!1)throw new _t(s(o," has been removed"+(t?" in "+t:"")),_t.ERR_DEPRECATED);return t&&!qE[o]&&(qE[o]=!0,console.warn(s(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,o,a):!0}};np.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function uV(n,e,t){if(typeof n!="object")throw new _t("options must be an object",_t.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const a=n[i],l=a===void 0||o(a,i,n);if(l!==!0)throw new _t("option "+i+" must be "+l,_t.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new _t("Unknown option "+i,_t.ERR_BAD_OPTION)}}const zd={assertOptions:uV,validators:np},xs=zd.validators;let Yo=class{constructor(e){this.defaults=e||{},this.interceptors={request:new DE,response:new DE}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ua(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:i}=t;r!==void 0&&zd.assertOptions(r,{silentJSONParsing:xs.transitional(xs.boolean),forcedJSONParsing:xs.transitional(xs.boolean),clarifyTimeoutError:xs.transitional(xs.boolean)},!1),s!=null&&(Te.isFunction(s)?t.paramsSerializer={serialize:s}:zd.assertOptions(s,{encode:xs.function,serialize:xs.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),zd.assertOptions(t,{baseUrl:xs.spelling("baseURL"),withXsrfToken:xs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&Te.merge(i.common,i[t.method]);i&&Te.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),t.headers=Dr.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(t)===!1||(l=l&&v.synchronous,a.unshift(v.fulfilled,v.rejected))});const u=[];this.interceptors.response.forEach(function(v){u.push(v.fulfilled,v.rejected)});let d,f=0,p;if(!l){const g=[KE.bind(this),void 0];for(g.unshift(...a),g.push(...u),p=g.length,d=Promise.resolve(t);f<p;)d=d.then(g[f++],g[f++]);return d}p=a.length;let m=t;for(;f<p;){const g=a[f++],v=a[f++];try{m=g(m)}catch(y){v.call(this,y);break}}try{d=KE.call(this,m)}catch(g){return Promise.reject(g)}for(f=0,p=u.length;f<p;)d=d.then(u[f++],u[f++]);return d}getUri(e){e=ua(this.defaults,e);const t=bx(e.baseURL,e.url,e.allowAbsoluteUrls);return Cx(t,e.params,e.paramsSerializer)}};Te.forEach(["delete","get","head","options"],function(e){Yo.prototype[e]=function(t,r){return this.request(ua(r||{},{method:e,url:t,data:(r||{}).data}))}});Te.forEach(["post","put","patch"],function(e){function t(r){return function(i,o,a){return this.request(ua(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Yo.prototype[e]=t(),Yo.prototype[e+"Form"]=t(!0)});let dV=class Ox{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{r.subscribe(a),i=a}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,a){r.reason||(r.reason=new Hl(i,o,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Ox(function(s){e=s}),cancel:e}}};function hV(n){return function(t){return n.apply(null,t)}}function fV(n){return Te.isObject(n)&&n.isAxiosError===!0}const m0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(m0).forEach(([n,e])=>{m0[e]=n});function Dx(n){const e=new Yo(n),t=dx(Yo.prototype.request,e);return Te.extend(t,Yo.prototype,e,{allOwnKeys:!0}),Te.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return Dx(ua(n,s))},t}const Tn=Dx(Uu);Tn.Axios=Yo;Tn.CanceledError=Hl;Tn.CancelToken=dV;Tn.isCancel=Sx;Tn.VERSION=Nx;Tn.toFormData=tp;Tn.AxiosError=_t;Tn.Cancel=Tn.CanceledError;Tn.all=function(e){return Promise.all(e)};Tn.spread=hV;Tn.isAxiosError=fV;Tn.mergeConfig=ua;Tn.AxiosHeaders=Dr;Tn.formToJSON=n=>Ix(Te.isHTMLForm(n)?new FormData(n):n);Tn.getAdapter=Px.getAdapter;Tn.HttpStatusCode=m0;Tn.default=Tn;const{Axios:Jae,AxiosError:Zae,CanceledError:ele,isCancel:tle,CancelToken:nle,VERSION:rle,all:sle,Cancel:ile,isAxiosError:ole,spread:ale,toFormData:lle,AxiosHeaders:cle,HttpStatusCode:ule,formToJSON:dle,getAdapter:hle,mergeConfig:fle}=Tn,pV="https://asia-east2-munkh-zaisan.cloudfunctions.net",wn=Tn.create({baseURL:pV,headers:{"Content-Type":"application/json"},timeout:12e4});async function Mx(n){try{return(await wn.post("/syncEmployeesToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing employees to Excel:",e),e}}async function Fx(n){try{return(await wn.post("/syncFromExcelToFirestore",{accessToken:n})).data}catch(e){throw console.error("Error syncing from Excel to Firestore:",e),e}}async function Lx(n,e,t=null){try{return(await wn.post("/manageEmployee",{action:n,employeeData:e,employeeId:t})).data}catch(r){throw console.error("Error managing employee:",r),r}}async function Ux(n){try{return(await wn.post("/syncCustomersToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing customers to Excel:",e),e}}async function Bx(n){try{return(await wn.post("/syncFromExcelToCustomers",{accessToken:n})).data}catch(e){throw console.error("Error syncing from Excel to customers:",e),e}}async function Vx(n,e,t=null){try{return(await wn.post("/manageCustomer",{action:n,customerData:e,customerId:t})).data}catch(r){throw console.error("Error managing customer:",r),r}}async function $x(n){try{return(await wn.post("/syncProjectsToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing projects to Excel:",e),e}}async function Hx(n){try{return(await wn.post("/syncFromExcelToProjects",{accessToken:n})).data}catch(e){throw console.error("Error syncing from Excel to projects:",e),e}}async function jx(n,e,t=null){try{return(await wn.post("/manageProject",{action:n,projectData:e,projectId:t})).data}catch(r){throw console.error("Error managing project:",r),r}}async function cl(n,e,t=null){try{return(await wn.post("/manageTimeAttendanceRequest",{action:n,requestData:e,requestId:t})).data}catch(r){throw console.error("Error managing time attendance request:",r),r}}async function pc(n,e){try{return(await wn.post("/approveTimeAttendanceRequest",{requestId:n,action:e})).data}catch(t){throw console.error("Error approving time attendance request:",t),t}}async function Wx(n){try{return(await wn.post("/syncTimeAttendanceToExcel",{accessToken:n})).data}catch(e){throw console.error("Error syncing time attendance to Excel:",e),e}}async function Kx(){try{return(await wn.get("/updateProjectRealHours")).data}catch(n){throw console.error("Error updating project real hours:",n),n}}async function qa(n,e){try{return(await wn.post("/manageFinancialTransaction",{action:n,transaction:e})).data}catch(t){if(console.error("Error managing financial transaction:",t),t.response&&t.response.status===400&&t.response.data)return t.response.data;throw t}}async function qx(n){try{return(await wn.post("/syncFinancialTransToExcel",{token:n})).data}catch(e){throw console.error("Error syncing financial transactions to Excel:",e),e}}async function Gx(n){try{return(await wn.post("/syncFromExcelToFinancialTrans",{token:n})).data}catch(e){throw console.error("Error syncing from Excel to financial transactions:",e),e}}async function mc(n,e){try{return(await wn.post("/manageWarehouse",{action:n,item:e})).data}catch(t){throw console.error("Error managing warehouse item:",t),t}}async function zx(n){try{return(await wn.post("/syncWarehouseToExcel",{token:n})).data}catch(e){throw console.error("Error syncing warehouse to Excel:",e),e}}async function Yx(n){try{return(await wn.post("/syncFromExcelToWarehouse",{token:n})).data}catch(e){throw console.error("Error syncing from Excel to warehouse:",e),e}}async function g0(n){try{return(await wn.post("/manageWarehouseTransaction",n)).data}catch(e){throw console.error("Error managing warehouse transaction:",e),e}}async function mV(n){try{return(await wn.post("/manageWarehouseRequest",n)).data}catch(e){throw console.error("Error managing warehouse request:",e),e}}const ru=Object.freeze(Object.defineProperty({__proto__:null,approveTimeAttendanceRequest:pc,manageCustomer:Vx,manageEmployee:Lx,manageFinancialTransaction:qa,manageProject:jx,manageTimeAttendanceRequest:cl,manageWarehouse:mc,manageWarehouseRequest:mV,manageWarehouseTransaction:g0,syncCustomersToExcel:Ux,syncEmployeesToExcel:Mx,syncFinancialTransToExcel:qx,syncFromExcelToCustomers:Bx,syncFromExcelToFinancialTrans:Gx,syncFromExcelToFirestore:Fx,syncFromExcelToProjects:Hx,syncFromExcelToWarehouse:Yx,syncProjectsToExcel:$x,syncTimeAttendanceToExcel:Wx,syncWarehouseToExcel:zx,updateProjectRealHours:Kx},Symbol.toStringTag,{value:"Module"})),gV={class:"management-section"},vV={class:"management-buttons"},yV={key:0,class:"item-list"},_V={class:"list-controls"},EV={class:"item-grid"},TV=["onClick"],wV={class:"item-badge"},CV={class:"employee-name"},AV={class:"employee-info"},IV={class:"employee-info"},SV={class:"modal-content"},xV={key:0,class:"error"},bV={class:"form-row"},RV={class:"form-group"},kV={class:"form-group"},PV={class:"form-row"},NV={class:"form-group"},OV={class:"form-group"},DV={class:"form-row"},MV={class:"form-group"},FV={class:"form-group"},LV={class:"form-row"},UV={class:"form-group"},BV={class:"form-group"},VV={class:"form-row"},$V={class:"form-group"},HV={class:"form-group"},jV={class:"form-row"},WV={class:"form-group"},KV={class:"form-group"},qV={class:"form-row"},GV={class:"form-group"},zV={class:"form-group"},YV={class:"form-row"},QV={class:"form-group"},XV={class:"form-group"},JV={class:"form-row"},ZV={class:"form-group"},e$={class:"form-group"},t$={class:"form-actions"},n$=["disabled"],r$={__name:"EmployeeManagement",emits:["saved"],setup(n,{emit:e}){const t=_a(),r=ae(!1),s=ae(!1),i=ae(null),o=ae(""),a=ae("state"),l=ae(!1),u=ae(""),d=ae({Id:"",LastName:"",FirstName:"",Department:"",Position:"",NumID:"",Phone:"",Mobile:"",DateApplied:"",DateJoined:"","Date-Leave":"",DateBirth:"",Type:"",State:" ",Gender:"",DoorNum:"",Role:"Employee",Email:""}),f=e,p=Be(()=>{let D=[...t.employees];if(o.value.trim()){const A=o.value.toLowerCase();D=D.filter(C=>{const j=(C.LastName||"").toLowerCase(),z=(C.FirstName||"").toLowerCase(),w=(C.Position||"").toLowerCase(),R=(C.NumID||"").toLowerCase();return j.includes(A)||z.includes(A)||w.includes(A)||R.includes(A)})}return D.sort((A,C)=>{const j=(A.State||"").toLowerCase(),z=(C.State||"").toLowerCase();if(j!==z)return j<z?-1:1;const w=(A.FirstName||"").toLowerCase(),R=(C.FirstName||"").toLowerCase();return w<R?-1:w>R?1:0}),D});function m(D){if(!D||typeof D!="number")return"";const C=Math.floor(D-25569)*86400,j=new Date(C*1e3),z=j.getUTCFullYear(),w=String(j.getUTCMonth()+1).padStart(2,"0"),R=String(j.getUTCDate()).padStart(2,"0");return`${z}-${w}-${R}`}function g(){const D=t.employees.reduce((A,C)=>{const j=parseInt(C.Id);return!isNaN(j)&&j>A?j:A},0);d.value.Id=D+1,s.value=!0}function v(D){i.value=D;const A=["Employee","Supervisor","nonEmployee","Financial"];let C=D.Role||"Employee";A.includes(C)||(C="Employee"),d.value={Id:D.Id||"",LastName:D.LastName||"",FirstName:D.FirstName||"",Department:D.Department||"",Position:D.Position||"",NumID:D.NumID||"",Phone:D.Phone||"",Mobile:D.Mobile1||D.Mobile||"",DateApplied:m(D.DateApplied),DateJoined:m(D.DateJoined),"Date-Leave":m(D["Date-Leave"]),DateBirth:m(D.DateBirth),Type:D.Type||"",State:D.State||"",Gender:D.Gender||"",DoorNum:D.DoorNum||"",Role:C,Email:D.Email||""}}function y(){s.value=!1,i.value=null,u.value="",d.value={Id:"",LastName:"",FirstName:"",Department:"",Position:"",NumID:"",Phone:"",Mobile:"",DateApplied:"",DateJoined:"","Date-Leave":"",DateBirth:"",Type:"",State:" ",Gender:"",DoorNum:"",Role:"Employee",Email:""}}async function L(){var D;l.value=!0,u.value="";try{const A=i.value?"update":"add",C=((D=i.value)==null?void 0:D.id)||null;await Lx(A,d.value,C),await t.fetchEmployees(),f("saved",{success:!0,action:A,type:"employee"}),y()}catch(A){u.value=A.message}finally{l.value=!1}}return(D,A)=>(K(),q("div",gV,[A[48]||(A[48]=c("h4",null,"Employee Management",-1)),c("div",vV,[c("button",{onClick:g,class:"action-btn add-btn"}," + Add Employee "),c("button",{onClick:A[0]||(A[0]=C=>r.value=!r.value),class:"action-btn"},P(r.value?"Hide":"Edit")+" Employees ",1)]),r.value?(K(),q("div",yV,[A[23]||(A[23]=c("h5",null,"Select Employee to Edit:",-1)),c("div",_V,[ce(c("input",{"onUpdate:modelValue":A[1]||(A[1]=C=>o.value=C),type:"text",placeholder:"Search by name, position, or NumID...",class:"search-input"},null,512),[[Ne,o.value]]),ce(c("select",{"onUpdate:modelValue":A[2]||(A[2]=C=>a.value=C),class:"sort-select"},[...A[22]||(A[22]=[c("option",{value:"lastName"},"Sort by Last Name",-1),c("option",{value:"firstName"},"Sort by First Name",-1),c("option",{value:"position"},"Sort by Position",-1),c("option",{value:"state"},"Sort by State",-1)])],512),[[st,a.value]])]),c("div",EV,[(K(!0),q(Xe,null,ft(p.value,C=>(K(),q("div",{key:C.id,class:"item-card",onClick:j=>v(C)},[c("div",wV,P(C.NumID),1),c("div",CV,P(C.FirstName),1),c("div",AV,P(C.Position),1),c("div",IV," "+P(C.Phone||C.Mobile||"N/A"),1),c("div",{class:mt(["state-badge",C.State===" "?"active":"inactive"])},P(C.State),3)],8,TV))),128))])])):be("",!0),s.value||i.value?(K(),q("div",{key:1,class:"modal-overlay",onClick:nn(y,["self"])},[c("div",SV,[c("h3",null,P(i.value?"Edit Employee":"Add New Employee"),1),c("form",{onSubmit:nn(L,["prevent"]),class:"item-form"},[u.value?(K(),q("p",xV,P(u.value),1)):be("",!0),c("div",bV,[c("div",RV,[A[24]||(A[24]=c("label",null,"Id *",-1)),ce(c("input",{"onUpdate:modelValue":A[3]||(A[3]=C=>d.value.Id=C),type:"number",required:"",readonly:"",style:{"background-color":"#f5f5f5",cursor:"not-allowed"},placeholder:"Auto-generated"},null,512),[[Ne,d.value.Id]])]),c("div",kV,[A[25]||(A[25]=c("label",null,"NumID *",-1)),ce(c("input",{"onUpdate:modelValue":A[4]||(A[4]=C=>d.value.NumID=C),type:"text",required:"",placeholder:"01261770",maxlength:"10"},null,512),[[Ne,d.value.NumID]])])]),c("div",PV,[c("div",NV,[A[26]||(A[26]=c("label",null," *",-1)),ce(c("input",{"onUpdate:modelValue":A[5]||(A[5]=C=>d.value.LastName=C),type:"text",required:""},null,512),[[Ne,d.value.LastName]])]),c("div",OV,[A[27]||(A[27]=c("label",null," *",-1)),ce(c("input",{"onUpdate:modelValue":A[6]||(A[6]=C=>d.value.FirstName=C),type:"text",required:""},null,512),[[Ne,d.value.FirstName]])])]),c("div",DV,[c("div",MV,[A[29]||(A[29]=c("label",null,"Department",-1)),ce(c("select",{"onUpdate:modelValue":A[7]||(A[7]=C=>d.value.Department=C)},[...A[28]||(A[28]=[c("option",{value:""},"Select",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1)])],512),[[st,d.value.Department]])]),c("div",FV,[A[31]||(A[31]=c("label",null,"Position *",-1)),d.value.Department===""?ce((K(),q("select",{key:0,"onUpdate:modelValue":A[8]||(A[8]=C=>d.value.Position=C),required:""},[...A[30]||(A[30]=[c("option",{value:""},"Select position",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1)])],512)),[[st,d.value.Position]]):ce((K(),q("input",{key:1,"onUpdate:modelValue":A[9]||(A[9]=C=>d.value.Position=C),type:"text",required:"",placeholder:"Position"},null,512)),[[Ne,d.value.Position]])])]),c("div",LV,[c("div",UV,[A[32]||(A[32]=c("label",null,"Phone",-1)),ce(c("input",{"onUpdate:modelValue":A[10]||(A[10]=C=>d.value.Phone=C),type:"tel",placeholder:"94242515",style:{"background-color":"white"}},null,512),[[Ne,d.value.Phone]])]),c("div",BV,[A[33]||(A[33]=c("label",null,"Mobile",-1)),ce(c("input",{"onUpdate:modelValue":A[11]||(A[11]=C=>d.value.Mobile=C),type:"tel",placeholder:"80097829",style:{"background-color":"white"}},null,512),[[Ne,d.value.Mobile]])])]),c("div",VV,[c("div",$V,[A[34]||(A[34]=c("label",null,"Email",-1)),ce(c("input",{"onUpdate:modelValue":A[12]||(A[12]=C=>d.value.Email=C),type:"email",placeholder:"employee@example.com"},null,512),[[Ne,d.value.Email]])]),c("div",HV,[A[36]||(A[36]=c("label",null,"Gender",-1)),ce(c("select",{"onUpdate:modelValue":A[13]||(A[13]=C=>d.value.Gender=C)},[...A[35]||(A[35]=[c("option",{value:""},"Select",-1),c("option",{value:"Male"},"Male",-1),c("option",{value:"Female"},"Female",-1)])],512),[[st,d.value.Gender]])])]),c("div",jV,[c("div",WV,[A[37]||(A[37]=c("label",null,"Date Applied",-1)),ce(c("input",{"onUpdate:modelValue":A[14]||(A[14]=C=>d.value.DateApplied=C),type:"date"},null,512),[[Ne,d.value.DateApplied]])]),c("div",KV,[A[38]||(A[38]=c("label",null,"Date Joined",-1)),ce(c("input",{"onUpdate:modelValue":A[15]||(A[15]=C=>d.value.DateJoined=C),type:"date"},null,512),[[Ne,d.value.DateJoined]])])]),c("div",qV,[c("div",GV,[A[39]||(A[39]=c("label",null,"Date Birth",-1)),ce(c("input",{"onUpdate:modelValue":A[16]||(A[16]=C=>d.value.DateBirth=C),type:"date"},null,512),[[Ne,d.value.DateBirth]])]),c("div",zV,[A[40]||(A[40]=c("label",null,"Date Leave",-1)),ce(c("input",{"onUpdate:modelValue":A[17]||(A[17]=C=>d.value["Date-Leave"]=C),type:"date"},null,512),[[Ne,d.value["Date-Leave"]]])])]),c("div",YV,[c("div",QV,[A[42]||(A[42]=c("label",null,"Type",-1)),ce(c("select",{"onUpdate:modelValue":A[18]||(A[18]=C=>d.value.Type=C)},[...A[41]||(A[41]=[c("option",{value:""},"Select type",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1)])],512),[[st,d.value.Type]])]),c("div",XV,[A[44]||(A[44]=c("label",null,"State *",-1)),ce(c("select",{"onUpdate:modelValue":A[19]||(A[19]=C=>d.value.State=C),required:""},[...A[43]||(A[43]=[c("option",{value:" "}," ",-1),c("option",{value:""},"",-1),c("option",{value:"/"},"/",-1)])],512),[[st,d.value.State]])])]),c("div",JV,[c("div",ZV,[A[45]||(A[45]=c("label",null,"Door Number",-1)),ce(c("input",{"onUpdate:modelValue":A[20]||(A[20]=C=>d.value.DoorNum=C),type:"text"},null,512),[[Ne,d.value.DoorNum]])]),c("div",e$,[A[47]||(A[47]=c("label",null,"Role *",-1)),ce(c("select",{"onUpdate:modelValue":A[21]||(A[21]=C=>d.value.Role=C),required:""},[...A[46]||(A[46]=[Ls('<option value="" data-v-b505f998>Select Role</option><option value="Employee" data-v-b505f998>Employee</option><option value="Supervisor" data-v-b505f998>Supervisor</option><option value="nonEmployee" data-v-b505f998>nonEmployee</option><option value="Financial" data-v-b505f998>Financial</option>',5)])],512),[[st,d.value.Role]])])]),c("div",t$,[c("button",{type:"submit",class:"save-btn",disabled:l.value},P(l.value?"Saving...":"Save"),9,n$),c("button",{type:"button",onClick:y,class:"cancel-btn"},"Cancel")])],32)])])):be("",!0)]))}},s$=gn(r$,[["__scopeId","data-v-b505f998"]]),i$={class:"management-section"},o$={class:"management-buttons"},a$={key:0,class:"item-list"},l$={class:"list-controls"},c$={class:"item-grid"},u$=["onClick"],d$={class:"item-badge"},h$={class:"customer-name"},f$={class:"customer-info"},p$={class:"customer-info contract"},m$={key:0,class:"customer-info date"},g$={class:"modal-content"},v$={key:0,class:"error"},y$={class:"form-row"},_$={class:"form-group"},E$={class:"form-group"},T$={class:"form-row"},w$={class:"form-group"},C$={class:"form-group"},A$={class:"form-row"},I$={class:"form-group"},S$={class:"form-group"},x$={class:"form-row"},b$={class:"form-group"},R$={class:"form-group"},k$={class:"form-actions"},P$=["disabled"],N$={__name:"CustomerManagement",emits:["saved"],setup(n,{emit:e}){const t=bv(),r=ae(!1),s=ae(!1),i=ae(null),o=ae(""),a=ae("name"),l=ae(!1),u=ae(""),d=ae({ID:"",Name:"",ContractType:"",Initial_StartDate:"",Contract_Num:"",ContractStartDate:"",ContractDueDate:"",Descrption:""}),f=e,p=Be(()=>{let A=[...t.customers];if(o.value.trim()){const C=o.value.toLowerCase();A=A.filter(j=>{const z=(j.Name||"").toLowerCase(),w=(j.Contract_Num||"").toLowerCase();return z.includes(C)||w.includes(C)})}return A.sort((C,j)=>{if(a.value==="name"){const z=(C.Name||"").toLowerCase(),w=(j.Name||"").toLowerCase();return z<w?-1:z>w?1:0}else{if(a.value==="contract")return(C.ContractType||"").localeCompare(j.ContractType||"");if(a.value==="date")return(j.ContractStartDate||"").localeCompare(C.ContractStartDate||"")}return 0}),A});function m(A){if(!A)return"";try{return new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return A}}function g(A){if(!A||typeof A!="number")return"";const C=Math.floor(A-25569),j=new Date(C*86400*1e3),z=j.getUTCFullYear(),w=String(j.getUTCMonth()+1).padStart(2,"0"),R=String(j.getUTCDate()).padStart(2,"0");return`${z}-${w}-${R}`}function v(){const A=t.customers.reduce((C,j)=>{const z=parseInt(j.ID);return!isNaN(z)&&z>C?z:C},0);d.value.ID=A+1,s.value=!0}function y(A){i.value=A,d.value={ID:A.ID||"",Name:A.Name||"",ContractType:A.ContractType||"",Initial_StartDate:g(A.Initial_StartDate),Contract_Num:A.Contract_Num||"",ContractStartDate:g(A.ContractStartDate),ContractDueDate:g(A.ContractDueDate),Descrption:A.Descrption||""}}function L(){s.value=!1,i.value=null,u.value="",d.value={ID:"",Name:"",ContractType:"",Initial_StartDate:"",Contract_Num:"",ContractStartDate:"",ContractDueDate:"",Descrption:""}}async function D(){var A;l.value=!0,u.value="";try{const C=i.value?"update":"add",j=((A=i.value)==null?void 0:A.id)||null;await Vx(C,d.value,j),await t.fetchCustomers(),f("saved",{success:!0,action:C,type:"customer"}),L()}catch(C){u.value=C.message}finally{l.value=!1}}return(A,C)=>(K(),q("div",i$,[C[22]||(C[22]=c("h4",null,"Customer Management",-1)),c("div",o$,[c("button",{onClick:v,class:"action-btn add-btn"}," + Add Customer "),c("button",{onClick:C[0]||(C[0]=j=>r.value=!r.value),class:"action-btn"},P(r.value?"Hide":"Edit")+" Customers ",1)]),r.value?(K(),q("div",a$,[C[12]||(C[12]=c("h5",null,"Select Customer to Edit:",-1)),c("div",l$,[ce(c("input",{"onUpdate:modelValue":C[1]||(C[1]=j=>o.value=j),type:"text",placeholder:"Search by name or contract...",class:"search-input"},null,512),[[Ne,o.value]]),ce(c("select",{"onUpdate:modelValue":C[2]||(C[2]=j=>a.value=j),class:"sort-select"},[...C[11]||(C[11]=[c("option",{value:"name"},"Sort by Name",-1),c("option",{value:"contract"},"Sort by Contract Type",-1),c("option",{value:"date"},"Sort by Start Date",-1)])],512),[[st,a.value]])]),c("div",c$,[(K(!0),q(Xe,null,ft(p.value,j=>(K(),q("div",{key:j.id,class:"item-card customer-card-item",onClick:z=>y(j)},[c("div",d$,P(j.ID),1),c("div",h$,P(j.Name),1),c("div",f$," "+P(j.ContractType),1),c("div",p$," "+P(j.Contract_Num),1),j.ContractStartDate?(K(),q("div",m$,"  "+P(m(j.ContractStartDate)),1)):be("",!0)],8,u$))),128))])])):be("",!0),s.value||i.value?(K(),q("div",{key:1,class:"modal-overlay",onClick:nn(L,["self"])},[c("div",g$,[c("h3",null,P(i.value?"Edit Customer":"Add New Customer"),1),c("form",{onSubmit:nn(D,["prevent"]),class:"item-form"},[u.value?(K(),q("p",v$,P(u.value),1)):be("",!0),c("div",y$,[c("div",_$,[C[13]||(C[13]=c("label",null,"ID *",-1)),ce(c("input",{"onUpdate:modelValue":C[3]||(C[3]=j=>d.value.ID=j),type:"number",required:"",readonly:"",style:{"background-color":"#f5f5f5"},placeholder:"Auto-generated"},null,512),[[Ne,d.value.ID]])]),c("div",E$,[C[14]||(C[14]=c("label",null,"Name *",-1)),ce(c("input",{"onUpdate:modelValue":C[4]||(C[4]=j=>d.value.Name=j),type:"text",required:""},null,512),[[Ne,d.value.Name]])])]),c("div",T$,[c("div",w$,[C[16]||(C[16]=c("label",null,"Contract Type",-1)),ce(c("select",{"onUpdate:modelValue":C[5]||(C[5]=j=>d.value.ContractType=j)},[...C[15]||(C[15]=[Ls('<option value="" data-v-bbe4d2b7>Select type...</option><option value=" " data-v-bbe4d2b7> </option><option value=" " data-v-bbe4d2b7> </option><option value=" " data-v-bbe4d2b7> </option><option value="" data-v-bbe4d2b7></option>',5)])],512),[[st,d.value.ContractType]])]),c("div",C$,[C[17]||(C[17]=c("label",null,"Contract Number",-1)),ce(c("input",{"onUpdate:modelValue":C[6]||(C[6]=j=>d.value.Contract_Num=j),type:"text"},null,512),[[Ne,d.value.Contract_Num]])])]),c("div",A$,[c("div",I$,[C[18]||(C[18]=c("label",null,"Initial Start Date",-1)),ce(c("input",{"onUpdate:modelValue":C[7]||(C[7]=j=>d.value.Initial_StartDate=j),type:"date"},null,512),[[Ne,d.value.Initial_StartDate]])]),c("div",S$,[C[19]||(C[19]=c("label",null,"Contract Start Date",-1)),ce(c("input",{"onUpdate:modelValue":C[8]||(C[8]=j=>d.value.ContractStartDate=j),type:"date"},null,512),[[Ne,d.value.ContractStartDate]])])]),c("div",x$,[c("div",b$,[C[20]||(C[20]=c("label",null,"Contract Due Date",-1)),ce(c("input",{"onUpdate:modelValue":C[9]||(C[9]=j=>d.value.ContractDueDate=j),type:"date"},null,512),[[Ne,d.value.ContractDueDate]])]),c("div",R$,[C[21]||(C[21]=c("label",null,"Description",-1)),ce(c("input",{"onUpdate:modelValue":C[10]||(C[10]=j=>d.value.Descrption=j),type:"text"},null,512),[[Ne,d.value.Descrption]])])]),c("div",k$,[c("button",{type:"submit",class:"save-btn",disabled:l.value},P(l.value?"Saving...":"Save"),9,P$),c("button",{type:"button",onClick:L,class:"cancel-btn"},"Cancel")])],32)])])):be("",!0)]))}},O$=gn(N$,[["__scopeId","data-v-bbe4d2b7"]]),D$={class:"management-section"},M$={class:"management-buttons"},F$={key:0,class:"item-list"},L$={class:"list-controls"},U$={class:"item-grid"},B$=["onClick"],V$={class:"card-header"},$$={class:"item-badge"},H$={class:"project-location"},j$={class:"project-customer"},W$={class:"project-info"},K$={class:"project-stats"},q$={class:"stat-item"},G$={class:"stat-value"},z$={class:"stat-item"},Y$={class:"stat-value real"},Q$={key:0,class:"stat-item"},X$={class:"stat-value engineer"},J$={key:1,class:"stat-item"},Z$={class:"stat-value non-engineer"},eH={class:"progress-section"},tH={class:"progress-bar"},nH={class:"progress-text"},rH={key:0,class:"time-performance"},sH={key:1,class:"engineer-bounty"},iH={class:"bounty-value"},oH={key:2,class:"team-bounty"},aH={class:"team-bounty-value"},lH={key:3,class:"non-engineer-bounty"},cH={class:"non-engineer-bounty-value"},uH={class:"profit-value"},dH={class:"modal-content"},hH={key:0,class:"error"},fH={class:"form-row"},pH={class:"form-group"},mH={class:"form-group"},gH=["disabled"],vH=["value"],yH={class:"form-row"},_H={class:"form-group"},EH=["disabled"],TH={class:"form-group"},wH=["disabled"],CH=["readonly"],AH={class:"form-row"},IH={class:"form-group"},SH=["readonly"],xH={class:"form-group"},bH=["disabled"],RH=["value"],kH={class:"form-row"},PH={class:"form-group"},NH=["readonly"],OH={class:"form-group"},DH=["readonly"],MH={class:"form-row"},FH={class:"form-group"},LH=["disabled"],UH={class:"form-group"},BH=["readonly"],VH={class:"form-group",style:{"grid-column":"1 / -1","margin-top":"15px"}},$H=["readonly"],HH={class:"form-group",style:{"grid-column":"1 / -1"}},jH=["readonly"],WH={class:"form-row"},KH={class:"form-group"},qH=["readonly"],GH={class:"form-group"},zH=["readonly"],YH={class:"form-row"},QH={class:"form-group"},XH=["value"],JH={class:"form-group"},ZH=["value"],e9={class:"form-row"},t9={class:"form-group"},n9=["value"],r9={class:"form-group"},s9=["value"],i9={class:"form-row"},o9={class:"form-group"},a9=["value"],l9={class:"form-group"},c9=["value"],u9={key:1,class:"form-row"},d9={class:"form-group"},h9=["value"],f9={class:"form-row"},p9={class:"form-group"},m9=["value"],g9={class:"form-group"},v9=["value"],y9={class:"form-row"},_9={class:"form-group"},E9=["value"],T9={class:"form-group"},w9=["readonly"],C9={class:"form-row"},A9={class:"form-group"},I9=["readonly"],S9={class:"form-row"},x9={class:"form-group"},b9=["readonly"],R9={class:"form-group"},k9=["readonly"],P9={class:"form-row"},N9={class:"form-group"},O9=["value"],D9={class:"form-row"},M9={class:"form-group"},F9=["readonly"],L9={class:"form-group"},U9=["readonly"],B9={class:"form-row"},V9={class:"form-group"},$9=["readonly"],H9={class:"form-group"},j9=["readonly"],W9={class:"form-row"},K9={class:"form-group"},q9=["value"],G9={class:"form-group"},z9=["value"],Y9={class:"form-row"},Q9={class:"form-group"},X9=["value"],J9={class:"form-group"},Z9=["value"],e7={class:"form-actions"},t7=["disabled"],n7={__name:"ProjectManagement",emits:["saved"],setup(n,{expose:e,emit:t}){const r=xo(),s=bv(),i=_a();kn(async()=>{s.customers.length===0&&await s.fetchCustomers(),i.employees.length===0&&await i.fetchEmployees()});const o=ae(!1),a=ae(!1),l=ae(null),u=ae(null),d=ae(!1),f=ae(""),p=ae(""),m=ae("customer"),g=ae(!1),v=ae(""),y=ae({id:"",customer:"",type:"",subtype:"",siteLocation:"",StartDate:"",EndDate:"",ResponsibleEmp:"",Detail:"",Comment:"",referenceIdfromCustomer:"",Status:"Active",WosHour:0,BaseAmount:0,EngineerHand:0,TeamBounty:0,PlannedHour:0,RealHour:0,EngineerWorkHour:0,NonEngineerWorkHour:0,NonEngineerBounty:0,HourPerformance:0,additionalHour:0,additionalValue:0,AdditionalOwner:"",IncomeHR:0,ExpenceHR:0,IncomeCar:0,ExpenceCar:0,IncomeMaterial:0,ExpenceMaterial:0,ExpenceHSE:0,ProfitHR:0,ProfitCar:0,ProfitMaterial:0,TotalProfit:0}),L=t,D=Be(()=>i.employees.filter(he=>he.State===" ")),A=Be(()=>{let he=[...r.projects];if(f.value.trim()){const E=f.value.toLowerCase();he=he.filter(T=>{const U=(T.customer||"").toLowerCase(),ee=(T.type||"").toLowerCase(),le=(T.siteLocation||"").toLowerCase();return U.includes(E)||ee.includes(E)||le.includes(E)})}return p.value&&(he=he.filter(E=>E.Status===p.value)),he.sort((E,T)=>{if(m.value==="customer"){const U=(E.customer||"").toLowerCase(),ee=(T.customer||"").toLowerCase();return U<ee?-1:U>ee?1:0}else{if(m.value==="status")return(E.Status||"").localeCompare(T.Status||"");if(m.value==="profit")return(T.TotalProfit||0)-(E.TotalProfit||0);if(m.value==="date")return(T.StartDate||"").localeCompare(E.StartDate||"")}return 0}),he});function C(he){if(!he||typeof he!="number")return"";const E=Math.floor(he-25569),T=new Date(E*86400*1e3),U=T.getUTCFullYear(),ee=String(T.getUTCMonth()+1).padStart(2,"0"),le=String(T.getUTCDate()).padStart(2,"0");return`${U}-${ee}-${le}`}function j(he){return!he&&he!==0?"":new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}).format(he)}function z(he,E){return!E||E===0?0:he/E*100}function w(he,E,T){if(!E||E===0||!T)return 0;const ee=200-he/E*100;return T*ee/100}function R(he,E){const T=z(he,E);return T<100?"perf-good":T===100?"perf-perfect":"perf-bad"}function x(he){return{:17," ":33,"  ":50,"   ":67," ":83,:100}[he]||0}function b(he){return{:"#3b82f6"," ":"#f59e0b","  ":"#8b5cf6","   ":"#ec4899"," ":"#10b981",:"#22c55e"}[he]||"#6b7280"}function N(){y.value.IncomeHR=((y.value.WosHour||0)+(y.value.additionalHour||0))*11e4,oe()}function M(){const he=y.value.additionalHour||0;y.value.WosHour=y.value.IncomeHR?y.value.IncomeHR/11e4-he:0,oe()}function F(){y.value.additionalValue=(y.value.additionalHour||0)*65e3,y.value.IncomeHR=((y.value.WosHour||0)+(y.value.additionalHour||0))*11e4,oe()}function oe(){y.value.BaseAmount=(y.value.WosHour||0)*12500,y.value.TeamBounty=(y.value.WosHour||0)*22500,y.value.PlannedHour=(y.value.WosHour||0)*3,y.value.NonEngineerBounty=(y.value.NonEngineerWorkHour||0)*5e3,y.value.HourPerformance=z(y.value.RealHour,y.value.PlannedHour),y.value.EngineerHand=w(y.value.RealHour,y.value.PlannedHour,y.value.BaseAmount);const he=(y.value.EngineerHand||0)+(y.value.NonEngineerBounty||0)+(y.value.additionalValue||0)+(y.value.ExpenceHR||0);y.value.ProfitHR=(y.value.IncomeHR||0)-he,y.value.ProfitCar=(y.value.IncomeCar||0)-(y.value.ExpenceCar||0),y.value.ProfitMaterial=(y.value.IncomeMaterial||0)-(y.value.ExpenceMaterial||0),y.value.TotalProfit=(y.value.ProfitHR||0)+(y.value.ProfitCar||0)+(y.value.ProfitMaterial||0)-(y.value.ExpenceHSE||0)}function Q(){const he=r.projects.reduce((E,T)=>{const U=parseInt(T.id);return!isNaN(U)&&U>E?U:E},0);d.value=!0,y.value.id=he+1,a.value=!0}function ne(he){l.value=he,u.value=he.docId,console.log("Editing project:",{project:he,docId:he.docId,id:he.id}),d.value=!1,y.value={id:he.id||"",customer:he.customer||"",type:he.type||"",subtype:he.subtype||"",siteLocation:he.siteLocation||"",StartDate:C(he.StartDate),EndDate:C(he.EndDate),ResponsibleEmp:he.ResponsibleEmp||"",Detail:he.Detail||"",Comment:he.Comment||"",referenceIdfromCustomer:he.referenceIdfromCustomer||"",Status:he.Status||"",WosHour:he.WosHour||0,BaseAmount:he.BaseAmount||(he.WosHour||0)*12500,EngineerHand:he.EngineerHand||0,TeamBounty:he.TeamBounty||0,PlannedHour:he.PlannedHour||0,RealHour:he.RealHour||0,EngineerWorkHour:he.EngineerWorkHour||0,NonEngineerWorkHour:he.NonEngineerWorkHour||0,NonEngineerBounty:he.NonEngineerBounty||0,HourPerformance:he.HourPerformance||0,additionalHour:he.additionalHour||0,additionalValue:he.additionalValue||0,AdditionalOwner:he.AdditionalOwner||"",IncomeHR:he.IncomeHR||0,ExpenceHR:he.ExpenceHR||0,IncomeCar:he.IncomeCar||0,ExpenceCar:he.ExpenceCar||0,IncomeMaterial:he.IncomeMaterial||0,ExpenceMaterial:he.ExpenceMaterial||0,ExpenceHSE:he.ExpenceHSE||0,ProfitHR:he.ProfitHR||0,ProfitCar:he.ProfitCar||0,ProfitMaterial:he.ProfitMaterial||0,TotalProfit:he.TotalProfit||0}}function ge(){d.value||xe()}function xe(){a.value=!1,l.value=null,u.value=null,d.value=!1,v.value="",y.value={id:"",customer:"",type:"",subtype:"",siteLocation:"",StartDate:"",EndDate:"",ResponsibleEmp:"",Detail:"",Comment:"",referenceIdfromCustomer:"",Status:"Active",WosHour:0,EngineerHand:0,TeamBounty:0,EngineerBounty:0,PlannedHour:0,RealHour:0,EngineerWorkHour:0,NonEngineerWorkHour:0,NonEngineerBounty:0,HourPerformance:0,additionalHour:0,additionalValue:0,AdditionalOwner:"",IncomeHR:0,ExpenceHR:0,IncomeCar:0,ExpenceCar:0,IncomeMaterial:0,ExpenceMaterial:0,ExpenceHSE:0,ProfitHR:0,ProfitCar:0,ProfitMaterial:0,TotalProfit:0}}async function Ee(){g.value=!0,v.value="";try{oe();const he=l.value?"update":"add",E=u.value||null;console.log("Saving project:",{action:he,itemId:E,formData:y.value}),await jx(he,y.value,E),await r.fetchProjects(),L("saved",{success:!0,action:he,type:"project"}),xe()}catch(he){console.error("Error saving project:",he),v.value=he.message}finally{g.value=!1}}function Pe(he){const E=r.projects.find(T=>T.id===he);E&&ne(E)}return e({openProjectById:Pe}),(he,E)=>(K(),q("div",D$,[E[107]||(E[107]=c("h4",null,"Project Management",-1)),c("div",M$,[c("button",{onClick:Q,class:"action-btn add-btn"}," + Add Project "),c("button",{onClick:E[0]||(E[0]=T=>o.value=!o.value),class:"action-btn"},P(o.value?"Hide Projects":"List Projects"),1)]),o.value?(K(),q("div",F$,[E[40]||(E[40]=c("h5",null,"Select Project to Edit:",-1)),c("div",L$,[ce(c("input",{"onUpdate:modelValue":E[1]||(E[1]=T=>f.value=T),type:"text",placeholder:"Search by customer, type, or location...",class:"search-input"},null,512),[[Ne,f.value]]),ce(c("select",{"onUpdate:modelValue":E[2]||(E[2]=T=>p.value=T),class:"filter-select"},[...E[29]||(E[29]=[Ls('<option value="" data-v-1161133e>All Status</option><option value="" data-v-1161133e></option><option value=" " data-v-1161133e> </option><option value="  " data-v-1161133e>  </option><option value="   " data-v-1161133e>   </option><option value=" " data-v-1161133e> </option><option value="" data-v-1161133e></option>',7)])],512),[[st,p.value]]),ce(c("select",{"onUpdate:modelValue":E[3]||(E[3]=T=>m.value=T),class:"sort-select"},[...E[30]||(E[30]=[c("option",{value:"customer"},"Sort by Customer",-1),c("option",{value:"status"},"Sort by Status",-1),c("option",{value:"profit"},"Sort by Profit",-1),c("option",{value:"date"},"Sort by Date",-1)])],512),[[st,m.value]])]),c("div",U$,[(K(!0),q(Xe,null,ft(A.value,T=>(K(),q("div",{key:T.id,class:"item-card project-card-item",onClick:U=>ne(T)},[c("div",V$,[c("div",$$,P(T.id),1),c("span",{class:mt(["status-badge",T.Status])},P(T.Status),3)]),c("div",H$," "+P(T.siteLocation),1),c("div",j$,P(T.customer),1),c("div",W$,P(T.type)+" - "+P(T.subtype),1),c("div",K$,[c("div",q$,[E[31]||(E[31]=c("span",{class:"stat-label"},"Planned:",-1)),c("span",G$,P(j(T.PlannedHour))+"",1)]),c("div",z$,[E[32]||(E[32]=c("span",{class:"stat-label"},"Real:",-1)),c("span",Y$,P(j(T.RealHour))+"",1)]),T.EngineerWorkHour>0?(K(),q("div",Q$,[E[33]||(E[33]=c("span",{class:"stat-label"},"Engineer:",-1)),c("span",X$,P(j(T.EngineerWorkHour))+"",1)])):be("",!0),T.NonEngineerWorkHour>0?(K(),q("div",J$,[E[34]||(E[34]=c("span",{class:"stat-label"},"Non-Engineer:",-1)),c("span",Z$,P(j(T.NonEngineerWorkHour))+"",1)])):be("",!0)]),c("div",eH,[c("div",tH,[c("div",{class:"progress-fill",style:wt({width:x(T.Status)+"%",backgroundColor:b(T.Status)})},null,4),c("span",nH,P(x(T.Status))+"%",1)])]),T.PlannedHour>0?(K(),q("div",rH,[E[35]||(E[35]=c("span",{class:"perf-label"}," :",-1)),c("span",{class:mt(["perf-value",R(T.RealHour,T.PlannedHour)])},P(j(z(T.RealHour,T.PlannedHour)))+"%",3)])):be("",!0),T.EngineerHand&&T.EngineerHand>0?(K(),q("div",sH,[E[36]||(E[36]=c("span",{class:"bounty-label"}," :",-1)),c("span",iH,P(j(T.EngineerHand))+"",1)])):be("",!0),T.TeamBounty&&T.TeamBounty>0?(K(),q("div",oH,[E[37]||(E[37]=c("span",{class:"team-bounty-label"}," :",-1)),c("span",aH,P(j(T.TeamBounty))+"",1)])):be("",!0),T.NonEngineerBounty&&T.NonEngineerBounty>0?(K(),q("div",lH,[E[38]||(E[38]=c("span",{class:"non-engineer-bounty-label"},"  :",-1)),c("span",cH,P(j(T.NonEngineerBounty))+"",1)])):be("",!0),c("div",{class:mt(["profit-display",{"profit-positive":(T.TotalProfit||0)>0,"profit-negative":(T.TotalProfit||0)<0}])},[E[39]||(E[39]=c("span",{class:"profit-label"},"Total Profit:",-1)),c("span",uH,P(j(T.TotalProfit||0))+"",1)],2)],8,B$))),128))])])):be("",!0),(K(),nh(z2,{to:"body"},[a.value||l.value?(K(),q("div",{key:0,class:"modal-overlay",onClick:nn(ge,["self"])},[c("div",dH,[c("h3",null,P(l.value&&!d.value?"View Project":l.value?"Edit Project":"Add New Project"),1),c("form",{onSubmit:nn(Ee,["prevent"]),class:"item-form"},[v.value?(K(),q("p",hH,P(v.value),1)):be("",!0),c("div",fH,[c("div",pH,[E[41]||(E[41]=c("label",null,"ID *",-1)),ce(c("input",{"onUpdate:modelValue":E[4]||(E[4]=T=>y.value.id=T),type:"number",required:"",readonly:"",style:{"background-color":"#f5f5f5"},placeholder:"Auto"},null,512),[[Ne,y.value.id]])]),c("div",mH,[E[43]||(E[43]=c("label",null,"Customer *",-1)),ce(c("select",{"onUpdate:modelValue":E[5]||(E[5]=T=>y.value.customer=T),required:"",disabled:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},[E[42]||(E[42]=c("option",{value:""},"Select customer...",-1)),(K(!0),q(Xe,null,ft(Ut(s).customers,T=>(K(),q("option",{key:T.ID,value:T.Name},P(T.Name),9,vH))),128))],12,gH),[[st,y.value.customer]])])]),c("div",yH,[c("div",_H,[E[45]||(E[45]=c("label",null,"Type *",-1)),ce(c("select",{"onUpdate:modelValue":E[6]||(E[6]=T=>y.value.type=T),required:"",disabled:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onChange:E[7]||(E[7]=T=>y.value.subtype="")},[...E[44]||(E[44]=[c("option",{value:""},"Select type...",-1),c("option",{value:" "}," ",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1)])],44,EH),[[st,y.value.type]])]),c("div",TH,[E[47]||(E[47]=c("label",null,"Subtype",-1)),y.value.type===" "?ce((K(),q("select",{key:0,"onUpdate:modelValue":E[8]||(E[8]=T=>y.value.subtype=T),disabled:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},[...E[46]||(E[46]=[c("option",{value:""},"Select subtype...",-1),c("option",{value:" "}," ",-1),c("option",{value:" "}," ",-1),c("option",{value:" "}," ",-1),c("option",{value:"5G "},"5G ",-1),c("option",{value:"  "},"  ",-1),c("option",{value:""},"",-1)])],12,wH)),[[st,y.value.subtype]]):ce((K(),q("input",{key:1,"onUpdate:modelValue":E[9]||(E[9]=T=>y.value.subtype=T),type:"text",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),placeholder:"Enter subtype..."},null,12,CH)),[[Ne,y.value.subtype]])])]),c("div",AH,[c("div",IH,[E[48]||(E[48]=c("label",null,"Site Location",-1)),ce(c("input",{"onUpdate:modelValue":E[10]||(E[10]=T=>y.value.siteLocation=T),type:"text",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},null,12,SH),[[Ne,y.value.siteLocation]])]),c("div",xH,[E[50]||(E[50]=c("label",null,"Responsible Employee",-1)),ce(c("select",{"onUpdate:modelValue":E[11]||(E[11]=T=>y.value.ResponsibleEmp=T),disabled:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},[E[49]||(E[49]=c("option",{value:""},"Select employee...",-1)),(K(!0),q(Xe,null,ft(D.value,T=>(K(),q("option",{key:T.NumID,value:T.FirstName},P(T.FirstName)+" "+P(T.LastName),9,RH))),128))],12,bH),[[st,y.value.ResponsibleEmp]])])]),c("div",kH,[c("div",PH,[E[51]||(E[51]=c("label",null,"Start Date",-1)),ce(c("input",{"onUpdate:modelValue":E[12]||(E[12]=T=>y.value.StartDate=T),type:"date",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},null,12,NH),[[Ne,y.value.StartDate]])]),c("div",OH,[E[52]||(E[52]=c("label",null,"End Date",-1)),ce(c("input",{"onUpdate:modelValue":E[13]||(E[13]=T=>y.value.EndDate=T),type:"date",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},null,12,DH),[[Ne,y.value.EndDate]])])]),c("div",MH,[c("div",FH,[E[54]||(E[54]=c("label",null,"Status",-1)),ce(c("select",{"onUpdate:modelValue":E[14]||(E[14]=T=>y.value.Status=T),disabled:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},[...E[53]||(E[53]=[c("option",{value:""},"",-1),c("option",{value:" "}," ",-1),c("option",{value:"  "},"  ",-1),c("option",{value:"   "},"   ",-1),c("option",{value:" "}," ",-1),c("option",{value:""},"",-1)])],12,LH),[[st,y.value.Status]])]),c("div",UH,[E[55]||(E[55]=c("label",null,"Reference ID",-1)),ce(c("input",{"onUpdate:modelValue":E[15]||(E[15]=T=>y.value.referenceIdfromCustomer=T),type:"text",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},null,12,BH),[[Ne,y.value.referenceIdfromCustomer]])])]),c("div",VH,[E[56]||(E[56]=c("label",null,"Detail",-1)),ce(c("textarea",{"onUpdate:modelValue":E[16]||(E[16]=T=>y.value.Detail=T),rows:"3",style:wt([{width:"100%",padding:"8px",border:"1px solid #ddd","border-radius":"4px"},d.value?"":"background-color: #f9fafb;"]),readonly:!d.value},null,12,$H),[[Ne,y.value.Detail]])]),c("div",HH,[E[57]||(E[57]=c("label",null,"Comment",-1)),ce(c("textarea",{"onUpdate:modelValue":E[17]||(E[17]=T=>y.value.Comment=T),rows:"2",style:wt([{width:"100%",padding:"8px",border:"1px solid #ddd","border-radius":"4px"},d.value?"":"background-color: #f9fafb;"]),readonly:!d.value},null,12,jH),[[Ne,y.value.Comment]])]),E[101]||(E[101]=c("h5",{style:{"grid-column":"1 / -1","margin-top":"20px",color:"#f59e0b","border-bottom":"2px solid #f59e0b","padding-bottom":"5px"}},"Financial Information",-1)),E[102]||(E[102]=c("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#3b82f6","font-weight":"600","border-bottom":"1px solid #3b82f6","padding-bottom":"3px"}},"HR Information",-1)),c("div",WH,[c("div",KH,[E[58]||(E[58]=c("label",null,"WosHour",-1)),ce(c("input",{"onUpdate:modelValue":E[18]||(E[18]=T=>y.value.WosHour=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:N},null,44,qH),[[Ne,y.value.WosHour,void 0,{number:!0}]]),E[59]||(E[59]=c("small",{style:{color:"#6b7280"}},"Will calculate Income HR",-1))]),c("div",GH,[E[60]||(E[60]=c("label",null,"OR Income HR (manual)",-1)),ce(c("input",{"onUpdate:modelValue":E[19]||(E[19]=T=>y.value.IncomeHR=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:M},null,44,zH),[[Ne,y.value.IncomeHR,void 0,{number:!0}]]),E[61]||(E[61]=c("small",{style:{color:"#6b7280"}},"Will calculate WosHour",-1))])]),c("div",YH,[c("div",QH,[E[62]||(E[62]=c("label",null,"  (WosHour  12,500)",-1)),c("input",{value:j(y.value.BaseAmount||0),type:"text",readonly:"",style:{"background-color":"#fef3c7","font-weight":"600"}},null,8,XH),E[63]||(E[63]=c("small",{style:{color:"#6b7280"}},"Base for performance calculation",-1))]),c("div",JH,[E[64]||(E[64]=c("label",null," ",-1)),c("input",{value:j(y.value.TeamBounty||0),type:"text",readonly:"",style:{"background-color":"#fef3c7","font-weight":"600"}},null,8,ZH),E[65]||(E[65]=c("small",{style:{color:"#6b7280"}},"WosHour  22,500 MNT",-1))])]),c("div",e9,[c("div",t9,[E[66]||(E[66]=c("label",null,"Planned Hour (calculated)",-1)),c("input",{value:j(y.value.PlannedHour||0),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,n9),E[67]||(E[67]=c("small",{style:{color:"#6b7280"}},"WosHour  3",-1))]),c("div",r9,[E[68]||(E[68]=c("label",null,"Real Hour",-1)),c("input",{value:j(y.value.RealHour||0),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,s9),E[69]||(E[69]=c("small",{style:{color:"#6b7280"}},"Sum from TimeAttendance",-1))])]),c("div",i9,[c("div",o9,[E[70]||(E[70]=c("label",null,"Engineer Work Hour",-1)),c("input",{value:j(y.value.EngineerWorkHour||0),type:"text",readonly:"",style:{"background-color":"#dbeafe"}},null,8,a9),E[71]||(E[71]=c("small",{style:{color:"#6b7280"}},"Hours by Engineers",-1))]),c("div",l9,[E[72]||(E[72]=c("label",null,"Non-Engineer Work Hour",-1)),c("input",{value:j(y.value.NonEngineerWorkHour||0),type:"text",readonly:"",style:{"background-color":"#dbeafe"}},null,8,c9),E[73]||(E[73]=c("small",{style:{color:"#6b7280"}},"Hours by Non-Engineers",-1))])]),y.value.PlannedHour>0?(K(),q("div",u9,[c("div",d9,[E[74]||(E[74]=c("label",null," ",-1)),c("input",{value:j(z(y.value.RealHour,y.value.PlannedHour))+"%",type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,h9),E[75]||(E[75]=c("small",{style:{color:"#6b7280"}},"RealHour / PlannedHour  100",-1))])])):be("",!0),c("div",f9,[c("div",p9,[E[76]||(E[76]=c("label",null,"  ( )",-1)),c("input",{value:j(y.value.EngineerHand||0),type:"text",readonly:"",style:{"background-color":"#d1fae5","font-weight":"600"}},null,8,m9),E[77]||(E[77]=c("small",{style:{color:"#6b7280"}},"Performance-adjusted bounty",-1))]),c("div",g9,[E[78]||(E[78]=c("label",null,"  ",-1)),c("input",{value:j(y.value.NonEngineerBounty||0),type:"text",readonly:"",style:{"background-color":"#d1fae5","font-weight":"600"}},null,8,v9),E[79]||(E[79]=c("small",{style:{color:"#6b7280"}},"NonEngineerWorkHour  5,000 MNT",-1))])]),E[103]||(E[103]=c("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#10b981","font-weight":"600","border-bottom":"1px solid #10b981","padding-bottom":"3px"}},"Income Information",-1)),c("div",y9,[c("div",_9,[E[80]||(E[80]=c("label",null,"Income HR (calculated)",-1)),c("input",{value:j(y.value.IncomeHR),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,E9),E[81]||(E[81]=c("small",{style:{color:"#6b7280"}},"(WosHour + additionalHour)  110,000",-1))]),c("div",T9,[E[82]||(E[82]=c("label",null,"Income Car",-1)),ce(c("input",{"onUpdate:modelValue":E[20]||(E[20]=T=>y.value.IncomeCar=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:oe},null,44,w9),[[Ne,y.value.IncomeCar,void 0,{number:!0}]])])]),c("div",C9,[c("div",A9,[E[83]||(E[83]=c("label",null,"Income Material",-1)),ce(c("input",{"onUpdate:modelValue":E[21]||(E[21]=T=>y.value.IncomeMaterial=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:oe},null,44,I9),[[Ne,y.value.IncomeMaterial,void 0,{number:!0}]])])]),E[104]||(E[104]=c("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#f59e0b","font-weight":"600","border-bottom":"1px solid #f59e0b","padding-bottom":"3px"}},"Additional ()",-1)),c("div",S9,[c("div",x9,[E[84]||(E[84]=c("label",null,"Additional Hour (  )",-1)),ce(c("input",{"onUpdate:modelValue":E[22]||(E[22]=T=>y.value.additionalHour=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:F},null,44,b9),[[Ne,y.value.additionalHour,void 0,{number:!0}]])]),c("div",R9,[E[85]||(E[85]=c("label",null,"Additional Owner",-1)),ce(c("input",{"onUpdate:modelValue":E[23]||(E[23]=T=>y.value.AdditionalOwner=T),type:"text",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;")},null,12,k9),[[Ne,y.value.AdditionalOwner]])])]),c("div",P9,[c("div",N9,[E[86]||(E[86]=c("label",null,"Additional Value (calculated)",-1)),c("input",{value:j(y.value.additionalValue),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,O9),E[87]||(E[87]=c("small",{style:{color:"#6b7280"}},"additionalHour  65,000",-1))])]),E[105]||(E[105]=c("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#ef4444","font-weight":"600","border-bottom":"1px solid #ef4444","padding-bottom":"3px"}},"Expense Information",-1)),c("div",D9,[c("div",M9,[E[88]||(E[88]=c("label",null,"Expense HR",-1)),ce(c("input",{"onUpdate:modelValue":E[24]||(E[24]=T=>y.value.ExpenceHR=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:oe},null,44,F9),[[Ne,y.value.ExpenceHR,void 0,{number:!0}]]),E[89]||(E[89]=c("small",{style:{color:"#6b7280"}},"Includes additionalValue",-1))]),c("div",L9,[E[90]||(E[90]=c("label",null,"Expense Car",-1)),ce(c("input",{"onUpdate:modelValue":E[25]||(E[25]=T=>y.value.ExpenceCar=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:oe},null,44,U9),[[Ne,y.value.ExpenceCar,void 0,{number:!0}]])])]),c("div",B9,[c("div",V9,[E[91]||(E[91]=c("label",null,"Expense Material",-1)),ce(c("input",{"onUpdate:modelValue":E[26]||(E[26]=T=>y.value.ExpenceMaterial=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:oe},null,44,$9),[[Ne,y.value.ExpenceMaterial,void 0,{number:!0}]])]),c("div",H9,[E[92]||(E[92]=c("label",null,"Expense HSE",-1)),ce(c("input",{"onUpdate:modelValue":E[27]||(E[27]=T=>y.value.ExpenceHSE=T),type:"number",step:"0.01",readonly:!d.value,style:wt(d.value?"":"background-color: #f9fafb;"),onInput:oe},null,44,j9),[[Ne,y.value.ExpenceHSE,void 0,{number:!0}]])])]),E[106]||(E[106]=c("h6",{style:{"grid-column":"1 / -1","margin-top":"15px",color:"#8b5cf6","font-weight":"600","border-bottom":"1px solid #8b5cf6","padding-bottom":"3px"}},"Profit Summary",-1)),c("div",W9,[c("div",K9,[E[93]||(E[93]=c("label",null,"Profit HR (calculated)",-1)),c("input",{value:j(y.value.ProfitHR),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,q9),E[94]||(E[94]=c("small",{style:{color:"#6b7280"}},"IncomeHR - (EngineerHand + NonEngineerBounty + additionalValue + ExpenceHR)",-1))]),c("div",G9,[E[95]||(E[95]=c("label",null,"Profit Car (calculated)",-1)),c("input",{value:j(y.value.ProfitCar),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,z9),E[96]||(E[96]=c("small",{style:{color:"#6b7280"}},"IncomeCar - ExpenseCar",-1))])]),c("div",Y9,[c("div",Q9,[E[97]||(E[97]=c("label",null,"Profit Material (calculated)",-1)),c("input",{value:j(y.value.ProfitMaterial),type:"text",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,X9),E[98]||(E[98]=c("small",{style:{color:"#6b7280"}},"IncomeMaterial - ExpenseMaterial",-1))]),c("div",J9,[E[99]||(E[99]=c("label",null,"Total Profit (calculated)",-1)),c("input",{value:j(y.value.TotalProfit),type:"text",readonly:"",style:{"background-color":"#f5f5f5","font-weight":"bold","font-size":"16px",color:"#8b5cf6"}},null,8,Z9),E[100]||(E[100]=c("small",{style:{color:"#6b7280"}},"ProfitHR + ProfitCar + ProfitMaterial - ExpenseHSE",-1))])]),c("div",e7,[l.value&&!d.value?(K(),q("button",{key:0,type:"button",onClick:E[28]||(E[28]=T=>d.value=!0),class:"edit-btn"}," Edit ")):be("",!0),d.value?(K(),q("button",{key:1,type:"submit",class:"save-btn",disabled:g.value},P(g.value?"Saving...":"Save"),9,t7)):be("",!0),c("button",{type:"button",onClick:xe,class:"cancel-btn"},P(d.value?"Cancel":"Close"),1)])],32)])])):be("",!0)]))]))}},Qx=gn(n7,[["__scopeId","data-v-1161133e"]]),Xx=pa("timeAttendanceRequests",{state:()=>({requests:[],loading:!1,error:null}),actions:{async fetchRequests(n=null){this.loading=!0,this.error=null;try{let e=Yt(Ct,"timeAttendanceRequests");n&&(e=xr(e,Ir("status","==",n)));const t=await Zt(e);this.requests=t.docs.map(r=>({docId:r.id,...r.data()}))}catch(e){console.error("Error fetching time attendance requests:",e),this.error=e.message}finally{this.loading=!1}}}}),Jx=pa("timeAttendance",{state:()=>({records:[],allRecords:[],loading:!1,error:null}),actions:{async fetchRecords(n=!1){this.loading=!0,this.error=null;try{const t=(await Zt(Yt(Ct,"timeAttendance"))).docs.map(r=>({docId:r.id,...r.data()}));this.allRecords=t,n?this.records=t:this.records=t.filter(r=>!r.dataStatus||r.dataStatus==="valid")}catch(e){console.error("Error fetching time attendance records:",e),this.error=e.message}finally{this.loading=!1}}}}),r7={class:"attendance-approval"},s7={class:"approval-header"},i7=["disabled"],o7={class:"tabs"},a7={key:1,class:"edit-mode-section"},l7={key:0,class:"edit-warning"},c7={key:2,class:"filters-section"},u7={class:"filter-group"},d7={class:"filter-group"},h7=["value"],f7={class:"filter-group"},p7=["value"],m7={class:"filter-group"},g7={class:"filter-group"},v7={key:3,class:"total-hours-label"},y7={key:4,class:"loading"},_7={key:5,class:"empty-state"},E7={key:6,class:"empty-state"},T7={key:7,class:"empty-state"},w7={key:8,class:"empty-state"},C7={key:9,class:"requests-table-wrapper"},A7={key:0,class:"bulk-actions"},I7=["disabled"],S7=["disabled"],x7={key:1,class:"info-message"},b7={class:"requests-table"},R7={key:0,class:"checkbox-col"},k7={key:1},P7={key:2},N7={key:0,class:"checkbox-col"},O7=["value"],D7=["onUpdate:modelValue"],M7={key:1},F7=["onUpdate:modelValue"],L7={key:1},U7=["onUpdate:modelValue"],B7=["value"],V7={key:1},$7=["onUpdate:modelValue"],H7={key:1},j7=["onUpdate:modelValue","onChange"],W7={key:1},K7=["onUpdate:modelValue","onChange"],q7={key:1},G7=["onUpdate:modelValue","onChange"],z7=["onUpdate:modelValue"],Y7={key:1},Q7={key:0,class:"validation-issues"},X7=["onUpdate:modelValue"],J7={key:1},Z7={key:2,class:"action-buttons"},ej=["onClick","disabled"],tj=["onClick","disabled"],nj={key:3,class:"action-buttons"},rj=["onClick","disabled"],sj={key:10,class:"sync-section"},ij=["disabled"],oj={key:11,class:"sync-section"},aj=["disabled"],lj=["disabled"],cj={__name:"TimeAttendanceApproval",setup(n){const e=Xx(),t=Jx(),r=Js(),s=xo(),i=ae("pending"),o=ae(!1),a=ae(!1),l=ae(!1),u=ae(""),d=ae(""),f=ae([]),p=ae(!1),m=ae(!1),g=ae({date:"",employee:"",project:"",status:""}),v=ae("date-asc"),y=Be(()=>e.requests.filter(O=>O.status==="pending"));Be(()=>e.requests.filter(O=>O.status==="approved"));const L=Be(()=>e.requests.filter(O=>O.status==="rejected")),D=Be(()=>t.records.filter(O=>!O.dataStatus||O.dataStatus==="valid").length),A=Be(()=>t.allRecords.filter(O=>(!O.dataStatus||O.dataStatus==="valid")&&O.syncedToExcel===!1)),C=Be(()=>A.value.length),j=Be(()=>t.allRecords.filter(O=>O.dataStatus==="invalid"||O.dataStatus==="retired")),z=Be(()=>j.value.length),w=Be(()=>{let O=[];i.value==="pending"?O=y.value:i.value==="approved"?O=t.records:i.value==="notSynced"&&(O=A.value);const H=O.map(I=>I.EmployeeFirstName||I.EmployeeLastName||I.FirstName||I.LastName).filter(Boolean);return[...new Set(H)].sort()}),R=Be(()=>{let O=[];i.value==="pending"?O=y.value:i.value==="approved"?O=t.records:i.value==="notSynced"&&(O=A.value);const H=new Set;O.forEach(S=>{S.ProjectID&&H.add(S.ProjectID)});const I=[];return H.forEach(S=>{const B=s.projects.find(ie=>ie.id===S);B?I.push({id:S,name:`${S} - ${B.siteLocation||""}`}):I.push({id:S,name:S})}),I.sort((S,B)=>S.name.localeCompare(B.name))}),x=Be(()=>{let O=[];if(i.value==="pending")O=[...y.value];else if(i.value==="approved")O=[...t.records];else if(i.value==="notSynced")O=[...A.value];else return[];return g.value.date&&(O=O.filter(H=>(H.Day||H.Date)===g.value.date)),g.value.employee&&(O=O.filter(H=>(H.EmployeeFirstName||H.EmployeeLastName||H.FirstName||H.LastName)===g.value.employee)),g.value.project&&(O=O.filter(H=>H.ProjectID===g.value.project)),g.value.status&&(O=O.filter(H=>H.Status===g.value.status)),O.sort((H,I)=>{switch(v.value){case"date-asc":{const S=H.Day||H.Date,B=I.Day||I.Date;if(!S||!B)return 0;const[ie,ue,re]=S.split("-").map(Number),[Re,Oe,Me]=B.split("-").map(Number),Se=new Date(ie,ue-1,re),et=new Date(Re,Oe-1,Me);return Se-et}case"date-desc":{const S=H.Day||H.Date,B=I.Day||I.Date;if(!S||!B)return 0;const[ie,ue,re]=S.split("-").map(Number),[Re,Oe,Me]=B.split("-").map(Number),Se=new Date(ie,ue-1,re);return new Date(Re,Oe-1,Me)-Se}case"employee":return(H.EmployeeFirstName||H.EmployeeLastName||H.FirstName||H.LastName||"").localeCompare(I.EmployeeFirstName||I.EmployeeLastName||I.FirstName||I.LastName||"");case"project":return(H.ProjectID||"").localeCompare(I.ProjectID||"");default:return 0}}),O}),b=Be(()=>i.value!=="approved"?0:N.value.reduce((O,H)=>O+(parseFloat(H.WorkingHour)||0),0)),N=Be(()=>i.value==="pending"||i.value==="approved"||i.value==="notSynced"?x.value:i.value==="invalid"?j.value:i.value==="rejected"?L.value:[]);kn(async()=>{await M()}),Ti(i,O=>{O==="approved"?g.value.status="":g.value.status=""});async function M(){o.value=!0;try{await e.fetchRequests(),await t.fetchRecords(!0),await s.fetchProjects(),f.value=[],p.value=!1}catch(O){console.error("Error fetching requests:",O)}finally{o.value=!1}}function F(){p.value?f.value=x.value.map(O=>O.docId):f.value=[]}function oe(){g.value.date="",g.value.employee="",g.value.project="",v.value="date-asc"}function Q(O){if(!O.startTime||!O.endTime)return;const H=ne(O.startTime);let S=ne(O.endTime)-H;S<0&&(S+=24);const B=Math.max(0,Math.round((S-1)*10)/10);O.isOvertimeRequest?(O.WorkingHour=0,O.overtimeHour=B):(O.WorkingHour=Math.min(B,8),O.overtimeHour=0)}function ne(O){const[H,I]=O.split(":").map(Number);return H+I/60}async function ge(){if(f.value.length!==0&&confirm(`${f.value.length}   ?`)){a.value=!0;try{let O=0;for(const H of f.value){const I=N.value.find(S=>S.docId===H);I&&await cl("update",I,H),await pc(H,"approve"),O++}te(`${O}   `,"success"),await M()}catch(O){te(" : "+O.message,"error")}finally{a.value=!1}}}async function xe(){if(f.value.length!==0&&confirm(`${f.value.length}   ?`)){a.value=!0;try{let O=0;for(const H of f.value)await pc(H,"reject"),O++;te(`${O}   `,"success"),f.value=[],await M()}catch(O){te(" : "+O.message,"error")}finally{a.value=!1}}}async function Ee(O){if(confirm("   ?")){a.value=!0;try{const H=N.value.find(I=>I.docId===O);H&&await cl("update",H,O),await pc(O,"approve"),te("  ","success"),await M()}catch(H){te(" : "+H.message,"error")}finally{a.value=!1}}}async function Pe(O){if(confirm("   ?")){a.value=!0;try{await pc(O,"reject"),te(" ","success"),await M()}catch(H){te(" : "+H.message,"error")}finally{a.value=!1}}}async function he(O){if(confirm("   ?")){a.value=!0;try{if(O.startTime&&O.endTime&&O.Day&&O.Email){const S=t.allRecords.filter(B=>B.docId!==O.docId&&B.Email===O.Email&&B.Day===O.Day&&B.startTime&&B.endTime&&(B.startTime<=O.startTime&&O.startTime<B.endTime||B.startTime<O.endTime&&O.endTime<=B.endTime||O.startTime<=B.startTime&&B.endTime<=O.endTime));if(S.length>0){te("   !       "+S[0].startTime+" - "+S[0].endTime+"  .","error"),a.value=!1;return}}const{docId:H,...I}=O;if(!H){te(": Document ID ","error"),a.value=!1;return}I.syncedToExcel=!1,I.lastEditedAt=new Date().toISOString();try{let S=H;const B=Hs(Ct,"timeAttendance",H);if(!(await Mf(B)).exists())if(console.log("Document not found with docId:",H),console.log("Trying to find by ID field:",O.ID),O.ID){const re=xr(Yt(Ct,"timeAttendance"),Ir("ID","==",O.ID)),Re=await Zt(re);if(!Re.empty)S=Re.docs[0].id,console.log("Found document with different docId:",S);else{te(":   Firestore- .   .","error"),a.value=!1;return}}else{te(":   Firestore-  (ID: "+H+")","error"),a.value=!1;return}const ue=Hs(Ct,"timeAttendance",S);await Ff(ue,I);try{await Kx(),await s.fetchProjects(),te("  .   .","success")}catch(re){console.error("Project calculation error:",re),te("     .   .","warning")}await M()}catch(S){console.error("Document update error:",S),console.log("Trying to update docId:",H),console.log("Update data:",I),te(": "+S.message+" (docId: "+H+")","error")}}catch(H){te(" : "+H.message,"error")}finally{a.value=!1}}}async function E(){l.value=!0,u.value="";try{const O=await r.getMicrosoftToken();if(!O)throw new Error("Please login with Microsoft account");await Wx(O),te(" Excel-   ","success"),await new Promise(H=>setTimeout(H,1e3)),await M()}catch(O){console.error("Sync error:",O),te("  : "+O.message,"error")}finally{l.value=!1}}async function T(){l.value=!0,u.value="";try{const O=await r.getMicrosoftToken();if(!O)throw new Error("Please login with Microsoft account");const H=await fetch("https://asia-east2-munkh-zaisan.cloudfunctions.net/fullSyncExcelToFirestore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:O,dryRun:!0})});if(!H.ok){const B=await H.json();throw new Error(B.message||"Sync failed")}const I=await H.json(),S=`
 Dry Run  :
 Excel  (): ${I.firestoreRecordsBefore}
 Excel  (): ${I.excelRecords}
 : ${I.deleted}
  : ${I.created}
${I.errors>0?" : "+I.errors:""}

${I.message}
    `.trim();te(S,"success"),console.log("Full sync dry run results:",I)}catch(O){console.error("Full sync error:",O),te("  : "+O.message,"error")}finally{l.value=!1}}async function U(){if(confirm(" Excel-   Firestore-    ?     Excel-  .")){l.value=!0,u.value="";try{const O=await r.getMicrosoftToken();if(!O)throw new Error("Please login with Microsoft account");const H=await fetch("https://asia-east2-munkh-zaisan.cloudfunctions.net/fullSyncExcelToFirestore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:O,dryRun:!1})});if(!H.ok){const B=await H.json();throw new Error(B.message||"Sync failed")}const I=await H.json(),S=`
   !
 : ${I.deleted}
  : ${I.created}
${I.errors>0?" : "+I.errors:""}
    `.trim();te(S,"success"),console.log("Full sync results:",I),await M()}catch(O){console.error("Full sync error:",O),te("  : "+O.message,"error")}finally{l.value=!1}}}function ee(O){return O?new Date(O).toLocaleDateString("mn-MN",{year:"numeric",month:"2-digit",day:"2-digit"}):""}function le(O){return O===""?"status-attended":O===""?"status-business-trip":O==="/"?"status-off":O===""?"status-missed":O!=null&&O.includes("")?"status-overtime":O!=null&&O.includes("")?"status-off":"status-attended"}function se(O){return O==="invalid"?"status-invalid":O==="retired"?"status-retired":"status-valid"}function ve(O){return O==="invalid"?" ":O==="retired"?" ":" "}function te(O,H){u.value=O,d.value=H,setTimeout(()=>{u.value=""},5e3)}return(O,H)=>(K(),q("div",r7,[c("div",s7,[H[13]||(H[13]=c("h3",null,"  ",-1)),c("button",{onClick:M,class:"btn-refresh",disabled:o.value},"   ",8,i7)]),u.value?(K(),q("div",{key:0,class:mt(["sync-message",d.value])},P(u.value),3)):be("",!0),c("div",o7,[c("button",{class:mt(["tab",{active:i.value==="pending"}]),onClick:H[0]||(H[0]=I=>i.value="pending")},"   ("+P(y.value.length)+") ",3),c("button",{class:mt(["tab",{active:i.value==="approved"}]),onClick:H[1]||(H[1]=I=>i.value="approved")},"  ("+P(D.value)+") ",3),c("button",{class:mt(["tab",{active:i.value==="notSynced"}]),onClick:H[2]||(H[2]=I=>i.value="notSynced")}," Excel -  ("+P(C.value)+") ",3),c("button",{class:mt(["tab",{active:i.value==="invalid"}]),onClick:H[3]||(H[3]=I=>i.value="invalid")},"   ("+P(z.value)+") ",3),c("button",{class:mt(["tab",{active:i.value==="rejected"}]),onClick:H[4]||(H[4]=I=>i.value="rejected")},"  ("+P(L.value.length)+") ",3)]),i.value==="approved"?(K(),q("div",a7,[c("button",{onClick:H[5]||(H[5]=I=>m.value=!m.value),class:mt(["btn-toggle-edit",{active:m.value}])},P(m.value?"  ":"  "),3),m.value?(K(),q("span",l7,"   ")):be("",!0)])):be("",!0),i.value==="pending"||i.value==="approved"||i.value==="notSynced"?(K(),q("div",c7,[c("div",u7,[H[14]||(H[14]=c("label",null,":",-1)),ce(c("input",{type:"date","onUpdate:modelValue":H[6]||(H[6]=I=>g.value.date=I),class:"filter-input"},null,512),[[Ne,g.value.date]])]),c("div",d7,[H[16]||(H[16]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":H[7]||(H[7]=I=>g.value.employee=I),class:"filter-input"},[H[15]||(H[15]=c("option",{value:""},"",-1)),(K(!0),q(Xe,null,ft(w.value,I=>(K(),q("option",{key:I,value:I},P(I),9,h7))),128))],512),[[st,g.value.employee]])]),c("div",f7,[H[18]||(H[18]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":H[8]||(H[8]=I=>g.value.project=I),class:"filter-input"},[H[17]||(H[17]=c("option",{value:""},"",-1)),(K(!0),q(Xe,null,ft(R.value,I=>(K(),q("option",{key:I.id,value:I.id},P(I.name),9,p7))),128))],512),[[st,g.value.project]])]),c("div",m7,[H[20]||(H[20]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":H[9]||(H[9]=I=>g.value.status=I),class:"filter-input"},[...H[19]||(H[19]=[Ls('<option value="" data-v-aa54a911></option><option value="" data-v-aa54a911></option><option value="" data-v-aa54a911></option><option value="/" data-v-aa54a911>/</option><option value="" data-v-aa54a911></option>',5)])],512),[[st,g.value.status]])]),c("div",g7,[H[22]||(H[22]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":H[10]||(H[10]=I=>v.value=I),class:"filter-input"},[...H[21]||(H[21]=[c("option",{value:"date-asc"}," ()",-1),c("option",{value:"date-desc"}," ()",-1),c("option",{value:"employee"},"",-1),c("option",{value:"project"},"",-1)])],512),[[st,v.value]])]),c("button",{onClick:oe,class:"btn-clear-filters"},"")])):be("",!0),i.value==="approved"&&N.value.length>0?(K(),q("div",v7,[H[23]||(H[23]=c("strong",null,"  :",-1)),bt(" "+P(b.value.toFixed(1))+" ",1)])):be("",!0),o.value?(K(),q("div",y7," ...")):N.value.length===0&&i.value==="pending"?(K(),q("div",_7,"      ")):N.value.length===0&&i.value==="notSynced"?(K(),q("div",E7,"      ")):N.value.length===0&&i.value==="invalid"?(K(),q("div",T7,"     ")):N.value.length===0&&i.value==="rejected"?(K(),q("div",w7,"     ")):(K(),q("div",C7,[i.value==="pending"?(K(),q("div",A7,[c("button",{onClick:F,class:"btn-select-all"},P(p.value?" ":" "),1),c("button",{onClick:ge,class:"btn-bulk-approve",disabled:f.value.length===0||a.value},"    ("+P(f.value.length)+") ",9,I7),c("button",{onClick:xe,class:"btn-bulk-reject",disabled:f.value.length===0||a.value},"    ("+P(f.value.length)+") ",9,S7)])):be("",!0),i.value==="approved"&&m.value?(K(),q("div",x7,'     .   ""  . ')):be("",!0),c("table",b7,[c("thead",null,[c("tr",null,[i.value==="pending"?(K(),q("th",R7,[ce(c("input",{type:"checkbox","onUpdate:modelValue":H[11]||(H[11]=I=>p.value=I),onChange:F},null,544),[[Go,p.value]])])):be("",!0),H[24]||(H[24]=c("th",null,"",-1)),H[25]||(H[25]=c("th",null,"",-1)),H[26]||(H[26]=c("th",null,"",-1)),H[27]||(H[27]=c("th",null,"",-1)),H[28]||(H[28]=c("th",null," ID",-1)),H[29]||(H[29]=c("th",null," ",-1)),H[30]||(H[30]=c("th",null,"",-1)),H[31]||(H[31]=c("th",null,"",-1)),H[32]||(H[32]=c("th",null,"",-1)),H[33]||(H[33]=c("th",null,"",-1)),H[34]||(H[34]=c("th",null,"",-1)),i.value==="invalid"||i.value==="notSynced"?(K(),q("th",k7,"")):be("",!0),H[35]||(H[35]=c("th",null,"",-1)),i.value==="pending"?(K(),q("th",P7,"")):be("",!0)])]),c("tbody",null,[(K(!0),q(Xe,null,ft(N.value,I=>(K(),q("tr",{key:I.docId},[i.value==="pending"?(K(),q("td",N7,[ce(c("input",{type:"checkbox",value:I.docId,"onUpdate:modelValue":H[12]||(H[12]=S=>f.value=S)},null,8,O7),[[Go,f.value]])])):be("",!0),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("input",{key:0,type:"date","onUpdate:modelValue":S=>I.Day=S,class:"edit-input"},null,8,D7)),[[Ne,I.Day]]):(K(),q("span",M7,P(ee(I.Day)),1))]),c("td",null,P(I.WeekDay),1),c("td",null,P(I.EmployeeFirstName||I.EmployeeLastName||I.FirstName||I.LastName),1),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("select",{key:0,"onUpdate:modelValue":S=>I.Role=S,class:"edit-input"},[...H[36]||(H[36]=[c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1)])],8,F7)),[[st,I.Role]]):(K(),q("span",L7,P(I.Role),1))]),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("select",{key:0,"onUpdate:modelValue":S=>I.ProjectID=S,class:"edit-input"},[H[37]||(H[37]=c("option",{value:""},"Select project...",-1)),(K(!0),q(Xe,null,ft(Ut(s).projects,S=>(K(),q("option",{key:S.id,value:S.id},P(S.id)+" - "+P(S.siteLocation),9,B7))),128))],8,U7)),[[st,I.ProjectID]]):(K(),q("span",V7,P(I.ProjectID),1))]),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("input",{key:0,type:"text","onUpdate:modelValue":S=>I.ProjectName=S,class:"edit-input"},null,8,$7)),[[Ne,I.ProjectName]]):(K(),q("span",H7,P(I.ProjectName),1))]),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("input",{key:0,type:"time","onUpdate:modelValue":S=>I.startTime=S,onChange:S=>Q(I),class:"edit-input",step:"60"},null,40,j7)),[[Ne,I.startTime]]):(K(),q("span",W7,P(I.startTime),1))]),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("input",{key:0,type:"time","onUpdate:modelValue":S=>I.endTime=S,onChange:S=>Q(I),class:"edit-input",step:"60"},null,40,K7)),[[Ne,I.endTime]]):(K(),q("span",q7,P(I.endTime),1))]),c("td",null,P(I.WorkingHour)+"",1),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("input",{key:0,type:"checkbox","onUpdate:modelValue":S=>I.isOvertimeRequest=S,onChange:S=>Q(I)},null,40,G7)),[[Go,I.isOvertimeRequest]]):be("",!0),bt(" "+P(I.overtimeHour)+" ",1)]),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("select",{key:0,"onUpdate:modelValue":S=>I.Status=S,class:"edit-input"},[...H[38]||(H[38]=[c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:"/"},"/",-1),c("option",{value:""},"",-1)])],8,z7)),[[st,I.Status]]):(K(),q("span",{key:1,class:mt(["status-badge",le(I.Status)])},P(I.Status),3))]),i.value==="invalid"||i.value==="notSynced"?(K(),q("td",Y7,[c("span",{class:mt(["data-status-badge",se(I.dataStatus)])},P(ve(I.dataStatus)),3),I.validationIssues?(K(),q("small",Q7,P(I.validationIssues),1)):be("",!0)])):be("",!0),c("td",null,[i.value==="pending"||i.value==="approved"&&m.value?ce((K(),q("textarea",{key:0,"onUpdate:modelValue":S=>I.comment=S,class:"edit-textarea",rows:"2"},null,8,X7)),[[Ne,I.comment]]):(K(),q("span",J7,P(I.comment),1))]),i.value==="pending"?(K(),q("td",Z7,[c("button",{onClick:S=>Ee(I.docId),class:"btn-approve",disabled:a.value},"  ",8,ej),c("button",{onClick:S=>Pe(I.docId),class:"btn-reject",disabled:a.value},"  ",8,tj)])):be("",!0),i.value==="approved"&&m.value?(K(),q("td",nj,[c("button",{onClick:S=>he(I),class:"btn-save",disabled:a.value},"   ",8,rj)])):be("",!0)]))),128))])])])),i.value==="notSynced"&&C.value>0?(K(),q("div",sj,[c("button",{onClick:E,class:"btn-sync",disabled:l.value},P(l.value?"  ...":" Excel-  "),9,ij)])):be("",!0),i.value==="notSynced"?(K(),q("div",oj,[c("button",{onClick:T,class:"btn-sync",disabled:l.value,style:{background:"#ff9800"}},P(l.value?" ...":" Excel-   (Dry Run)"),9,aj),c("button",{onClick:U,class:"btn-sync",disabled:l.value,style:{"margin-left":"10px",background:"#4caf50"}},P(l.value?"  ...":"   (Step 2)"),9,lj)])):be("",!0)]))}},uj=gn(cj,[["__scopeId","data-v-aa54a911"]]),dj={name:"WarehouseRequestApproval",setup(){const n=ae([]),e=ae("pending"),t=ae(!1),r=ae(null),s=ae(""),i=Be(()=>e.value==="pending"?n.value.filter(m=>m.status==="pending"):n.value),o=Be(()=>n.value.filter(m=>m.status==="pending").length),a=async()=>{try{const m=xr(Yt(Ct,"warehouseRequests"),Ng("requestedAt","desc")),g=await Zt(m);n.value=g.docs.map(v=>({id:v.id,...v.data()}))}catch(m){console.error("Error loading requests:",m),alert("Failed to load requests")}},l=async m=>{if(confirm(`Approve request for ${m.quantity} ${m.WarehouseName}?`))try{const{manageWarehouseRequest:g}=await Jo(async()=>{const{manageWarehouseRequest:y}=await Promise.resolve().then(()=>ru);return{manageWarehouseRequest:y}},void 0),v=await g({action:"approve",requestId:m.id});v.success?(alert("Request approved! Transaction created."),await a()):alert("Failed to approve: "+v.error)}catch(g){console.error("Error approving request:",g),alert("Error: "+g.message)}},u=m=>{r.value=m,s.value="",t.value=!0},d=()=>{t.value=!1,r.value=null,s.value=""},f=async()=>{if(!s.value.trim()){alert("Please provide a reason for rejection");return}try{const{manageWarehouseRequest:m}=await Jo(async()=>{const{manageWarehouseRequest:v}=await Promise.resolve().then(()=>ru);return{manageWarehouseRequest:v}},void 0),g=await m({action:"reject",requestId:r.value.id,request:{reason:s.value}});g.success?(alert("Request rejected"),await a(),d()):alert("Failed to reject: "+g.error)}catch(m){console.error("Error rejecting request:",m),alert("Error: "+m.message)}},p=m=>{if(!m)return"";try{return(m.toDate?m.toDate():new Date(m)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}};return kn(a),{requests:n,filteredRequests:i,filterStatus:e,pendingCount:o,showRejectDialog:t,selectedRequest:r,rejectionReason:s,approveRequest:l,openRejectDialog:u,closeRejectDialog:d,confirmReject:f,formatDate:p}}},hj={class:"warehouse-approval"},fj={class:"filter-tabs"},pj={key:0,class:"no-requests"},mj={key:1,class:"requests-grid"},gj={class:"request-header"},vj={class:"request-category"},yj={class:"request-body"},_j={class:"info-grid"},Ej={class:"info-item"},Tj={class:"info-item"},wj={class:"quantity"},Cj={class:"info-item"},Aj={class:"info-item"},Ij={class:"purpose-section"},Sj={key:0,class:"approval-info"},xj={key:0},bj={key:1,class:"rejection-info"},Rj={key:0},kj={key:0,class:"request-actions"},Pj=["onClick"],Nj=["onClick"],Oj={class:"modal-content"},Dj={class:"modal-header"},Mj={class:"form-group"},Fj={class:"modal-actions"};function Lj(n,e,t,r,s,i){var o;return K(),q("div",hj,[e[16]||(e[16]=c("h4",null,"Warehouse Material Requests",-1)),c("div",fj,[c("button",{onClick:e[0]||(e[0]=a=>r.filterStatus="pending"),class:mt(["tab-btn",{active:r.filterStatus==="pending"}])}," Pending ("+P(r.pendingCount)+") ",3),c("button",{onClick:e[1]||(e[1]=a=>r.filterStatus="all"),class:mt(["tab-btn",{active:r.filterStatus==="all"}])}," All Requests ",2)]),r.filteredRequests.length===0?(K(),q("div",pj," No requests found ")):(K(),q("div",mj,[(K(!0),q(Xe,null,ft(r.filteredRequests,a=>(K(),q("div",{key:a.id,class:mt(["request-card","status-"+a.status])},[c("div",gj,[c("div",null,[c("h5",null,P(a.WarehouseName),1),c("span",vj,P(a.Category||"Warehouse Item"),1)]),c("span",{class:mt(["status-badge","badge-"+a.status])},P(a.status),3)]),c("div",yj,[c("div",_j,[c("div",Ej,[e[7]||(e[7]=c("label",null,"Requested By:",-1)),c("span",null,P(a.requestedEmpName),1)]),c("div",Tj,[e[8]||(e[8]=c("label",null,"Quantity:",-1)),c("span",wj,P(a.quantity),1)]),c("div",Cj,[e[9]||(e[9]=c("label",null,"Project:",-1)),c("span",null,P(a.ProjectName||a.projectID||"N/A"),1)]),c("div",Aj,[e[10]||(e[10]=c("label",null,"Requested:",-1)),c("span",null,P(r.formatDate(a.requestedAt)),1)])]),c("div",Ij,[e[11]||(e[11]=c("label",null,"Purpose:",-1)),c("p",null,P(a.purpose),1)]),a.status==="approved"?(K(),q("div",Sj,[c("small",null," Approved on "+P(r.formatDate(a.approvedAt)),1),a.transactionId?(K(),q("small",xj,"Transaction ID: "+P(a.transactionId),1)):be("",!0)])):be("",!0),a.status==="rejected"?(K(),q("div",bj,[c("small",null," Rejected on "+P(r.formatDate(a.rejectedAt)),1),a.rejectionReason?(K(),q("small",Rj,[e[12]||(e[12]=c("strong",null,"Reason:",-1)),bt(" "+P(a.rejectionReason),1)])):be("",!0)])):be("",!0)]),a.status==="pending"?(K(),q("div",kj,[c("button",{onClick:l=>r.approveRequest(a),class:"btn-approve"},"  Approve ",8,Pj),c("button",{onClick:l=>r.openRejectDialog(a),class:"btn-reject"},"  Reject ",8,Nj)])):be("",!0)],2))),128))])),r.showRejectDialog?(K(),q("div",{key:2,class:"modal-overlay",onClick:e[6]||(e[6]=nn((...a)=>r.closeRejectDialog&&r.closeRejectDialog(...a),["self"]))},[c("div",Oj,[c("div",Dj,[e[13]||(e[13]=c("h4",null,"Reject Request",-1)),c("button",{class:"close-btn",onClick:e[2]||(e[2]=(...a)=>r.closeRejectDialog&&r.closeRejectDialog(...a))},"")]),c("p",null,[e[14]||(e[14]=bt("Rejecting request for ",-1)),c("strong",null,P((o=r.selectedRequest)==null?void 0:o.WarehouseName),1)]),c("div",Mj,[e[15]||(e[15]=c("label",null,"Reason for rejection:",-1)),ce(c("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>r.rejectionReason=a),rows:"3",placeholder:"Explain why this request is rejected...",required:""},null,512),[[Ne,r.rejectionReason]])]),c("div",Fj,[c("button",{onClick:e[4]||(e[4]=(...a)=>r.confirmReject&&r.confirmReject(...a)),class:"btn-confirm-reject"},"Confirm Reject"),c("button",{onClick:e[5]||(e[5]=(...a)=>r.closeRejectDialog&&r.closeRejectDialog(...a)),class:"btn-cancel"},"Cancel")])])])):be("",!0)])}const Uj=gn(dj,[["render",Lj],["__scopeId","data-v-f48ded97"]]),Bj={class:"ta-history-container"},Vj={class:"projects-summary-section"},$j={class:"project-controls"},Hj=["disabled"],jj={key:0,class:"loading"},Wj={key:1,class:"projects-grid"},Kj=["onClick"],qj={class:"project-header"},Gj={class:"project-details"},zj={class:"detail-row"},Yj={class:"detail-value"},Qj={key:0,class:"detail-row"},Xj={class:"detail-value"},Jj={key:1,class:"detail-row"},Zj={class:"detail-value"},eW={class:"project-stats"},tW={class:"stat-row"},nW={class:"stat-value planned"},rW={class:"stat-row"},sW={class:"stat-value real"},iW={class:"stat-row"},oW={class:"stat-value status"},aW={key:0,class:"stat-row"},lW={class:"stat-value bounty-adjusted"},cW={class:"stat-row"},uW={class:"progress-bar"},dW={class:"progress-text"},hW={key:1,class:"stat-row"},fW={class:"progress-bar"},pW={key:2,class:"no-records"},mW={class:"modal-content project-details-modal"},gW={class:"modal-header"},vW={class:"modal-body"},yW={key:0,class:"loading"},_W={key:1},EW={class:"ta-table"},TW={class:"ta-summary"},wW={key:2,class:"no-records"},CW={class:"month-picker-section"},AW={class:"month-input-group"},IW={key:0,class:"month-stats"},SW={class:"stat-card"},xW={class:"stat-value"},bW={class:"stat-card"},RW={class:"stat-value"},kW={class:"stat-card"},PW={class:"stat-value",style:{"font-weight":"bold",color:"#f59e0b"}},NW={class:"stat-card warning"},OW={class:"stat-value"},DW={class:"tabs-and-filters"},MW={class:"tabs"},FW={class:"record-filters"},LW={key:1,class:"loading"},UW={key:2,class:"table-container"},BW={class:"records-table"},VW={key:3,class:"no-records"},$W={__name:"EmployeeTimeAttendanceHistory",setup(n){const e=Js(),t=ae(!1),r=ae(v()),s=ae("approved"),i=ae(!1),o=ae(""),a=ae(null),l=ae(!1),u=ae([]),d=ae([]),f=ae([]),p=ae(null),m=ae([]),g=ae("");function v(){const oe=new Date;return`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`}const y=Be(()=>s.value==="approved"?d.value:f.value),L=Be(()=>{let oe=y.value;return g.value&&(oe=oe.filter(Q=>Q.Status===g.value)),oe.slice().sort((Q,ne)=>{const ge=Q.Day||Q.Date,xe=ne.Day||ne.Date;if(!ge||!xe)return 0;const[Ee,Pe,he]=ge.split("-").map(Number),[E,T,U]=xe.split("-").map(Number),ee=new Date(Ee,Pe-1,he);return new Date(E,T-1,U)-ee})}),D=Be(()=>o.value?m.value.filter(oe=>oe.status===o.value):m.value),A=Be(()=>u.value.reduce((oe,Q)=>oe+(parseFloat(Q.WorkingHour)||0),0));function C(oe){if(!oe)return"";const Q=new Date(oe);return`${Q.getMonth()+1}/${Q.getDate()}`}function j(oe){switch(oe){case"":return"status-present";case"":return"status-assignment";case"/":return"status-leave";case"":return"status-missed";default:return""}}async function z(){var oe,Q,ne,ge;t.value=!0;try{const xe=((oe=e.userData)==null?void 0:oe.LastName)||((Q=e.userData)==null?void 0:Q.employeeLastName),Ee=((ne=e.userData)==null?void 0:ne.FirstName)||((ge=e.userData)==null?void 0:ge.employeeFirstName);if(!xe){console.error("Employee LastName not found");return}if(Ee){const B=xr(Yt(Ct,"employees"),Ir("FirstName","==",Ee)),ie=await Zt(B);if(!ie.empty){const re=ie.docs[0].data().State;if(re!==" "){console.log(`Employee state is "${re}" - access restricted to current employees only`),d.value=[],f.value=[],p.value={approvedDays:0,totalHours:0,notRequestedDays:0},t.value=!1;return}}}const[Pe,he]=r.value.split("-"),E=`${Pe}-${he}-01`,T=new Date(parseInt(Pe),parseInt(he),0).getDate(),U=`${Pe}-${he}-${String(T).padStart(2,"0")}`,ee=xr(Yt(Ct,"timeAttendance"),Ir("EmployeeLastName","==",xe)),le=await Zt(ee);d.value=le.docs.map(B=>({docId:B.id,...B.data()})).filter(B=>{const ie=B.Day||B.Date;return ie>=E&&ie<=U});const se=xr(Yt(Ct,"timeAttendance"),Ir("LastName","==",xe)),te=(await Zt(se)).docs.map(B=>({docId:B.id,...B.data()})).filter(B=>{const ie=B.Day||B.Date;return ie>=E&&ie<=U}),O=[...d.value,...te],H=Array.from(new Map(O.map(B=>[B.docId,B])).values());d.value=H;const I=xr(Yt(Ct,"timeAttendanceRequests"),Ir("EmployeeLastName","==",xe),Ir("status","==","rejected")),S=await Zt(I);f.value=S.docs.map(B=>({docId:B.id,...B.data()})).filter(B=>{const ie=B.Day||B.Date;return ie>=E&&ie<=U}),w(Pe,he,T)}catch(xe){console.error("Error loading time attendance data:",xe)}finally{t.value=!1}}function w(oe,Q,ne){const ge=d.value.length,xe=d.value.reduce((E,T)=>E+(T.WorkingHour||0),0),Ee=d.value.reduce((E,T)=>{const U=(T.Status||"").toLowerCase().trim();return U===""||U===""||U===""?E+(T.WorkingHour||0):E},0);let Pe=0;for(let E=1;E<=ne;E++){const U=new Date(parseInt(oe),parseInt(Q)-1,E).getDay();U!==0&&U!==6&&Pe++}const he=Pe-ge;p.value={approvedDays:ge,totalHours:Math.round(xe*10)/10,workingHours:Math.round(Ee*10)/10,notRequestedDays:Math.max(0,he)}}function R(oe){return{:"#3b82f6"," ":"#f59e0b","  ":"#8b5cf6","   ":"#ec4899"," ":"#10b981",:"#22c55e"}[oe]||"#6b7280"}function x(oe){return oe?oe.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"}function b(oe){return oe<100?"#10b981":oe===100?"#3b82f6":"#ef4444"}async function N(oe){a.value=oe,l.value=!0,u.value=[];try{const Q=xr(Yt(Ct,"timeAttendance"),Ir("ProjectID","==",oe.projectId)),ne=await Zt(Q);u.value=ne.docs.map(ge=>({docId:ge.id,...ge.data()})).sort((ge,xe)=>(xe.Day||"").localeCompare(ge.Day||""))}catch(Q){console.error("Error loading project TA records:",Q)}finally{l.value=!1}}function M(){a.value=null,u.value=[]}async function F(){var oe,Q;i.value=!0;try{const ne=((oe=e.userData)==null?void 0:oe.FirstName)||((Q=e.userData)==null?void 0:Q.employeeFirstName);if(!ne){console.error("Employee FirstName not found");return}const ge=xr(Yt(Ct,"employees"),Ir("FirstName","==",ne)),xe=await Zt(ge);if(xe.empty){console.error("Employee not found in employees collection");return}const Pe=xe.docs[0].data().State;if(Pe!==" "){console.log(`Employee state is "${Pe}" - access restricted to current employees only`),m.value=[];return}const he=await Zt(Yt(Ct,"projects")),E=[],T={:17," ":33,"  ":50,"   ":67," ":83,:100};he.docs.forEach(ee=>{const le=ee.data();if(le.ResponsibleEmp===ne){const se=parseFloat(le["Planned Hour"])||parseFloat(le.PlannedHour)||0,ve=parseFloat(le.RealHour)||0,te=parseFloat(le.WosHour)||0,O=le.EngineerHand!=null?parseFloat(le.EngineerHand):te*7500,H=T[le.Status]||0;E.push({projectId:le.id,status:le.Status||"N/A",siteLocation:le.siteLocation||le.SiteLocation||"N/A",referenceId:le.referenceIdfromCustomer||"",startDate:le.StartDate||"",plannedHour:Math.round(se*10)/10,realHour:Math.round(ve*10)/10,engineerHand:le.EngineerHand||Math.round(O),progress:H,HourPerformance:le.HourPerformance})}});const U={" ":1,:2,"  ":3,"   ":4," ":5,:6};m.value=E.sort((ee,le)=>{const se=U[ee.status]||999,ve=U[le.status]||999;return se!==ve?se-ve:le.realHour-ee.realHour})}catch(ne){console.error("Error loading project summary:",ne)}finally{i.value=!1}}return kn(()=>{z(),F()}),(oe,Q)=>(K(),q("div",Bj,[Q[27]||(Q[27]=c("h3",null,"  ",-1)),c("div",Vj,[Q[18]||(Q[18]=c("h4",null,"  ",-1)),c("div",$j,[ce(c("select",{"onUpdate:modelValue":Q[0]||(Q[0]=ne=>o.value=ne),class:"status-filter"},[...Q[5]||(Q[5]=[Ls('<option value="" data-v-2f794fdf> </option><option value="" data-v-2f794fdf></option><option value=" " data-v-2f794fdf> </option><option value="  " data-v-2f794fdf>  </option><option value="   " data-v-2f794fdf>   </option><option value=" " data-v-2f794fdf> </option><option value="" data-v-2f794fdf></option>',7)])],512),[[st,o.value]]),c("button",{onClick:F,class:"btn-refresh",disabled:i.value},P(i.value?" ...":" "),9,Hj)]),i.value?(K(),q("div",jj,"  ...")):D.value.length>0?(K(),q("div",Wj,[(K(!0),q(Xe,null,ft(D.value,ne=>(K(),q("div",{key:ne.projectId,class:"project-card",onClick:ge=>N(ne)},[c("div",qj,[c("h5",null,P(ne.projectId),1),c("span",{class:mt(["project-status","status-"+ne.status])},P(ne.status),3)]),c("div",Gj,[c("div",zj,[Q[6]||(Q[6]=c("span",{class:"detail-icon"},"",-1)),Q[7]||(Q[7]=c("span",{class:"detail-label"},":",-1)),c("span",Yj,P(ne.siteLocation),1)]),ne.referenceId?(K(),q("div",Qj,[Q[8]||(Q[8]=c("span",{class:"detail-icon"},"",-1)),Q[9]||(Q[9]=c("span",{class:"detail-label"}," :",-1)),c("span",Xj,P(ne.referenceId),1)])):be("",!0),ne.startDate?(K(),q("div",Jj,[Q[10]||(Q[10]=c("span",{class:"detail-icon"},"",-1)),Q[11]||(Q[11]=c("span",{class:"detail-label"},":",-1)),c("span",Zj,P(ne.startDate),1)])):be("",!0)]),c("div",eW,[c("div",tW,[Q[12]||(Q[12]=c("span",{class:"stat-label"}," :",-1)),c("span",nW,P(ne.plannedHour)+" /",1)]),c("div",rW,[Q[13]||(Q[13]=c("span",{class:"stat-label"}," :",-1)),c("span",sW,P(ne.realHour)+" /",1)]),c("div",iW,[Q[14]||(Q[14]=c("span",{class:"stat-label"},":",-1)),c("span",oW,P(ne.status),1)]),ne.engineerHand>0?(K(),q("div",aW,[Q[15]||(Q[15]=c("span",{class:"stat-label"}," :",-1)),c("span",lW,P(x(ne.engineerHand))+" ",1)])):be("",!0),c("div",cW,[Q[16]||(Q[16]=c("span",{class:"stat-label"}," :",-1)),c("div",uW,[c("div",{class:"progress-fill",style:wt({width:ne.progress+"%",backgroundColor:R(ne.status)})},null,4),c("span",dW,P(ne.progress)+"%",1)])]),ne.HourPerformance!=null?(K(),q("div",hW,[Q[17]||(Q[17]=c("span",{class:"stat-label"}," :",-1)),c("div",fW,[c("div",{class:"progress-fill",style:wt({width:Math.min(100,ne.HourPerformance)+"%",backgroundColor:b(ne.HourPerformance)})},null,4),c("span",{class:"progress-text",style:wt({color:b(ne.HourPerformance)})},P(ne.HourPerformance.toFixed(1))+"%",5)])])):be("",!0)])],8,Kj))),128))])):(K(),q("div",pW,"      "))]),a.value?(K(),q("div",{key:0,class:"modal-overlay",onClick:nn(M,["self"])},[c("div",mW,[c("div",gW,[c("h3",null,P(a.value.projectId)+" -   ",1),c("button",{onClick:M,class:"close-btn"},"")]),c("div",vW,[l.value?(K(),q("div",yW," ...")):u.value.length>0?(K(),q("div",_W,[c("table",EW,[Q[19]||(Q[19]=c("thead",null,[c("tr",null,[c("th",null,""),c("th",null,""),c("th",null," "),c("th",null,"")])],-1)),c("tbody",null,[(K(!0),q(Xe,null,ft(u.value,ne=>(K(),q("tr",{key:ne.docId},[c("td",null,P(ne.Day),1),c("td",null,P(ne.EmployeeFirstName),1),c("td",null,P(ne.WorkingHour)+" ",1),c("td",null,P(ne.comment||"-"),1)]))),128))])]),c("div",TW,[c("strong",null,"  : "+P(A.value)+" /",1)])])):(K(),q("div",wW,"       "))])])])):be("",!0),c("div",CW,[c("div",AW,[Q[20]||(Q[20]=c("label",null," :",-1)),ce(c("input",{type:"month","onUpdate:modelValue":Q[1]||(Q[1]=ne=>r.value=ne),onChange:z,class:"month-input"},null,544),[[Ne,r.value]])]),p.value?(K(),q("div",IW,[c("div",SW,[Q[21]||(Q[21]=c("span",{class:"stat-label"},"  :",-1)),c("span",xW,P(p.value.approvedDays)+" ",1)]),c("div",bW,[Q[22]||(Q[22]=c("span",{class:"stat-label"},"   :",-1)),c("span",RW,P(p.value.totalHours)+" ",1)]),c("div",kW,[Q[23]||(Q[23]=c("span",{class:"stat-label"},"/  :",-1)),c("span",PW,P(p.value.workingHours)+" ",1)]),c("div",NW,[Q[24]||(Q[24]=c("span",{class:"stat-label"}," :",-1)),c("span",OW,P(p.value.notRequestedDays)+" ",1)])])):be("",!0)]),c("div",DW,[c("div",MW,[c("button",{onClick:Q[2]||(Q[2]=ne=>s.value="approved"),class:mt(["tab-btn",{active:s.value==="approved"}])},"  ("+P(d.value.length)+") ",3),c("button",{onClick:Q[3]||(Q[3]=ne=>s.value="rejected"),class:mt(["tab-btn",{active:s.value==="rejected"}])},"  ("+P(f.value.length)+") ",3)]),c("div",FW,[ce(c("select",{"onUpdate:modelValue":Q[4]||(Q[4]=ne=>g.value=ne),class:"record-status-filter"},[...Q[25]||(Q[25]=[Ls('<option value="" data-v-2f794fdf> </option><option value="" data-v-2f794fdf></option><option value="" data-v-2f794fdf></option><option value="/" data-v-2f794fdf>/</option><option value="" data-v-2f794fdf></option>',5)])],512),[[st,g.value]])])]),t.value?(K(),q("div",LW," ...")):L.value.length>0?(K(),q("div",UW,[c("table",BW,[Q[26]||(Q[26]=c("thead",null,[c("tr",null,[c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null," "),c("th",null," "),c("th",null," "),c("th",null," "),c("th",null,""),c("th",null,"")])],-1)),c("tbody",null,[(K(!0),q(Xe,null,ft(L.value,ne=>(K(),q("tr",{key:ne.docId},[c("td",null,P(C(ne.Day)),1),c("td",null,P(ne.WeekDay),1),c("td",null,[c("span",{class:mt(["record-status-badge",j(ne.Status)])},P(ne.Status),3)]),c("td",null,P(ne.ProjectID),1),c("td",null,P(ne.ProjectName),1),c("td",null,P(ne.startTime),1),c("td",null,P(ne.endTime),1),c("td",null,P(ne.WorkingHour)+"",1),c("td",null,P(ne.overtimeHour)+"",1),c("td",null,P(ne.comment),1),c("td",null,[c("span",{class:mt(["status-badge",s.value==="approved"?"approved":"rejected"])},P(s.value==="approved"?"":""),3)])]))),128))])])])):(K(),q("div",VW,P(s.value==="approved"?"  ":"  "),1))]))}},HW=gn($W,[["__scopeId","data-v-2f794fdf"]]),jW={class:"dashboard-container"},WW={class:"dashboard-header"},KW={class:"user-info"},qW=["src"],GW={class:"dashboard-content"},zW={class:"welcome-card"},YW={key:0,class:"supervisor-badge"},QW={class:"quick-actions"},XW={key:0},JW={key:1,class:"supervisor-section"},ZW={key:0,class:"microsoft-signin"},eK=["disabled"],tK={key:1,class:"sync-section"},nK={class:"microsoft-status"},rK={class:"sync-buttons"},sK=["disabled"],iK=["disabled"],oK=["disabled"],aK=["disabled"],lK=["disabled"],cK={class:"result-icon"},uK={class:"result-message"},dK={key:2,class:"time-attendance-section"},hK={key:3,class:"warehouse-request-section"},fK={class:"modal-content sync-dialog"},pK={class:"sync-options"},mK=["disabled"],gK=["disabled"],vK={__name:"Dashboard",setup(n){const e=Du(),t=Js(),r=_a(),s=bv(),i=xo(),o=ae(!1),a=ae(null),l=ae(!1),u=ae(!1),d=ae("employee"),f=ae(!1),p=ae(!1);let m=null;Ti(a,A=>{m&&clearTimeout(m),A&&A.success&&(m=setTimeout(()=>{a.value=null},8e3))}),kn(async()=>{var C,j,z;const A=localStorage.getItem("msalRedirect");if(A&&(localStorage.removeItem("msalRedirect"),await new Promise(w=>setTimeout(w,500))),(C=t.userData)!=null&&C.isSupervisor&&!t.msalAccount){const w=(j=t.msalInstance)==null?void 0:j.getAllAccounts();w&&w.length>0&&(t.msalAccount=w[0],console.log("Restored Microsoft account on dashboard:",w[0].username),A&&(a.value={success:!0,message:" Microsoft account connected successfully"}))}(z=t.userData)!=null&&z.isSupervisor&&await Promise.all([r.fetchEmployees(),s.fetchCustomers(),i.fetchProjects()])});async function g(){var A;l.value=!0,a.value=null;try{const C=(A=t.msalInstance)==null?void 0:A.getAllAccounts();if(C&&C.length>0){t.msalAccount=C[0],console.log("Restored Microsoft account:",C[0].username),a.value={success:!0,message:" Microsoft account connected"},l.value=!1;return}localStorage.setItem("msalRedirect","true"),await t.signInWithMicrosoft()}catch(C){console.error("Microsoft sign-in error:",C),localStorage.removeItem("msalRedirect"),a.value={success:!1,message:` Failed to sign in: ${C.message}`},l.value=!1}}async function v(){try{await t.signOut(),e.push("/login")}catch(A){console.error("Sign out error:",A)}}function y(A){d.value=A,u.value=!0}async function L(A){var C,j,z,w,R,x;o.value=!0,a.value=null;try{let b;try{b=await t.getMicrosoftToken()}catch{a.value={success:!1,message:" Microsoft authentication expired. Please sign in with Microsoft again."},u.value=!1,o.value=!1;return}let N;if(d.value==="employee")if(A==="toExcel"){N=await Mx(b);const M=(N.created||0)+(N.updated||0);a.value={success:!0,message:` Synced ${M} employees to Excel (${N.created||0} created, ${N.updated||0} updated)`}}else{N=await Fx(b);const M=(N.created||0)+(N.updated||0);a.value={success:!0,message:` Synced ${M} employees from Excel (${N.created||0} created, ${N.updated||0} updated)`},await r.fetchEmployees()}else if(d.value==="customer")if(A==="toExcel"){N=await Ux(b);const M=(N.created||0)+(N.updated||0);a.value={success:!0,message:` Synced ${M} customers to Excel (${N.created||0} created, ${N.updated||0} updated)`}}else{N=await Bx(b);const M=(N.created||0)+(N.updated||0);a.value={success:!0,message:` Synced ${M} customers from Excel (${N.created||0} created, ${N.updated||0} updated)`},await s.fetchCustomers()}else if(d.value==="project")if(A==="toExcel"){N=await $x(b);const M=(N.created||0)+(N.updated||0);a.value={success:!0,message:` Synced ${M} projects to Excel (${N.created||0} created, ${N.updated||0} updated)`}}else{N=await Hx(b);const M=(N.created||0)+(N.updated||0);a.value={success:!0,message:` Synced ${M} projects from Excel (${N.created||0} created, ${N.updated||0} updated)`},await i.fetchProjects()}else d.value==="financial"?A==="toExcel"?(N=await qx(b),a.value={success:!0,message:" Synced financial transactions to Excel successfully"}):(N=await Gx(b),a.value={success:!0,message:" Synced financial transactions from Excel successfully"}):d.value==="warehouse"&&(A==="toExcel"?(N=await zx(b),a.value={success:!0,message:" Synced warehouse items to Excel successfully"}):(N=await Yx(b),a.value={success:!0,message:" Synced warehouse items from Excel successfully"}));u.value=!1}catch(b){console.error("Sync error:",b);let N="Unknown error";b.message==="Network Error"||b.code==="ERR_NETWORK"?N="Network error - Check your internet connection. Firebase functions may be unavailable. Your Microsoft session is still active.":((C=b.response)==null?void 0:C.status)===401||((j=b.response)==null?void 0:j.status)===403?N="Authentication failed - Please sign in with Microsoft again":((z=b.response)==null?void 0:z.status)===404?N="Excel file not found - Check if MainExcel.xlsx exists in OneDrive":((w=b.response)==null?void 0:w.status)===500?N=((R=b.response.data)==null?void 0:R.error)||"Server error - The sync function encountered an error":b.response?N=((x=b.response.data)==null?void 0:x.error)||b.response.statusText||"Server error":b.request?N="No response from server - The sync function may have timed out (>60 seconds)":N=b.message,a.value={success:!1,message:` Sync failed: ${N}`},u.value=!1}finally{o.value=!1}}function D(A){a.value={success:!0,message:` ${A.type.charAt(0).toUpperCase()+A.type.slice(1)} ${A.action==="add"?"added":"updated"} in system. Use Sync to update Excel.`}}return(A,C)=>{var j,z,w,R,x,b,N,M,F,oe,Q,ne,ge,xe,Ee;return K(),q("div",jW,[c("header",WW,[C[18]||(C[18]=c("h1",null,"MunkhZaisan Dashboard",-1)),c("div",KW,[(j=Ut(t).user)!=null&&j.photoURL?(K(),q("img",{key:0,src:Ut(t).user.photoURL,alt:"Profile"},null,8,qW)):be("",!0),c("span",null,P((z=Ut(t).user)==null?void 0:z.displayName),1),c("button",{onClick:v,class:"signout-btn"},"Sign Out")])]),c("main",GW,[c("div",zW,[c("h2",null,"Welcome, "+P((w=Ut(t).userData)==null?void 0:w.employeeFirstName)+"!",1),c("p",null,[C[19]||(C[19]=c("strong",null,"Position:",-1)),bt(" "+P(((R=Ut(t).userData)==null?void 0:R.position)||"N/A"),1)]),c("p",null,[C[20]||(C[20]=c("strong",null,"Role:",-1)),bt(" "+P(((x=Ut(t).userData)==null?void 0:x.role)||"Employee"),1)]),(b=Ut(t).userData)!=null&&b.isSupervisor?(K(),q("p",YW,"  Supervisor Account ")):be("",!0),c("div",QW,[c("button",{onClick:C[0]||(C[0]=Pe=>A.$router.push("/time-attendance-request")),class:"btn-action"},"     "),c("button",{onClick:C[1]||(C[1]=Pe=>A.$router.push("/warehouse-requests")),class:"btn-action warehouse-request"},"    "),(N=Ut(t).userData)!=null&&N.isSupervisor?be("",!0):(K(),q("button",{key:0,onClick:C[2]||(C[2]=Pe=>A.$router.push("/salary-report")),class:"btn-action salary"},"    ")),(M=Ut(t).userData)!=null&&M.isSupervisor?(K(),q("button",{key:1,onClick:C[3]||(C[3]=Pe=>A.$router.push("/supervisor-ta-summary")),class:"btn-action summary"},"    ")):be("",!0),(F=Ut(t).userData)!=null&&F.isSupervisor?(K(),q("button",{key:2,onClick:C[4]||(C[4]=Pe=>A.$router.push("/project-summary")),class:"btn-action project"},"    ")):be("",!0),(oe=Ut(t).userData)!=null&&oe.isSupervisor?(K(),q("button",{key:3,onClick:C[5]||(C[5]=Pe=>A.$router.push("/financial-transactions")),class:"btn-action finance"},"    ")):be("",!0),(Q=Ut(t).userData)!=null&&Q.isSupervisor?(K(),q("button",{key:4,onClick:C[6]||(C[6]=Pe=>A.$router.push("/warehouse")),class:"btn-action warehouse"},"   ")):be("",!0)])]),(ne=Ut(t).userData)!=null&&ne.isSupervisor?be("",!0):(K(),q("div",XW,[fn(HW)])),(ge=Ut(t).userData)!=null&&ge.isSupervisor?(K(),q("div",JW,[C[28]||(C[28]=c("h3",null,"Supervisor Actions",-1)),Ut(t).msalAccount?(K(),q("div",tK,[c("p",nK," Microsoft account: "+P(Ut(t).msalAccount.username),1),C[27]||(C[27]=c("p",null,"Sync data between system and Excel:",-1)),c("div",rK,[c("button",{onClick:C[7]||(C[7]=Pe=>y("employee")),class:"sync-btn employee",disabled:o.value},[C[22]||(C[22]=c("span",{class:"icon"},"",-1)),bt(" "+P(o.value&&d.value==="employee"?"Syncing...":"Sync Employees"),1)],8,sK),c("button",{onClick:C[8]||(C[8]=Pe=>y("customer")),class:"sync-btn customer",disabled:o.value},[C[23]||(C[23]=c("span",{class:"icon"},"",-1)),bt(" "+P(o.value&&d.value==="customer"?"Syncing...":"Sync Customers"),1)],8,iK),c("button",{onClick:C[9]||(C[9]=Pe=>y("project")),class:"sync-btn project",disabled:o.value},[C[24]||(C[24]=c("span",{class:"icon"},"",-1)),bt(" "+P(o.value&&d.value==="project"?"Syncing...":"Sync Projects"),1)],8,oK),c("button",{onClick:C[10]||(C[10]=Pe=>y("financial")),class:"sync-btn financial",disabled:o.value},[C[25]||(C[25]=c("span",{class:"icon"},"",-1)),bt(" "+P(o.value&&d.value==="financial"?"Syncing...":"Sync Financial Trans"),1)],8,aK),c("button",{onClick:C[11]||(C[11]=Pe=>y("warehouse")),class:"sync-btn warehouse",disabled:o.value},[C[26]||(C[26]=c("span",{class:"icon"},"",-1)),bt(" "+P(o.value&&d.value==="warehouse"?"Syncing...":"Sync Warehouse"),1)],8,lK)]),a.value?(K(),q("div",{key:0,class:mt(["sync-result",a.value.success?"success":"error"])},[c("span",cK,P(a.value.success?"":""),1),c("span",uK,P(a.value.message),1),c("button",{onClick:C[12]||(C[12]=Pe=>a.value=null),class:"close-result"},"")],2)):be("",!0)])):(K(),q("div",ZW,[C[21]||(C[21]=c("p",null,"Connect your Microsoft account to enable Excel sync features",-1)),c("button",{onClick:g,class:"microsoft-btn",disabled:l.value},P(l.value?"Connecting...":"Connect Microsoft Account"),9,eK)])),fn(s$,{onSaved:D}),fn(O$,{onSaved:D}),fn(Qx,{onSaved:D}),(xe=Ut(t).userData)!=null&&xe.isSupervisor?(K(),q("div",dK,[c("button",{onClick:C[13]||(C[13]=Pe=>f.value=!f.value),class:"expand-btn"},P(f.value?"":"")+"    ",1),f.value?(K(),nh(uj,{key:0})):be("",!0)])):be("",!0),(Ee=Ut(t).userData)!=null&&Ee.isSupervisor?(K(),q("div",hK,[c("button",{onClick:C[14]||(C[14]=Pe=>p.value=!p.value),class:"expand-btn"},P(p.value?"":"")+"   (Warehouse Requests) ",1),p.value?(K(),nh(Uj,{key:0})):be("",!0)])):be("",!0)])):be("",!0)]),u.value?(K(),q("div",{key:0,class:"modal-overlay",onClick:C[17]||(C[17]=nn(Pe=>u.value=!1,["self"]))},[c("div",fK,[c("h3",null,"Sync "+P(d.value==="financial"?"Financial Transactions":d.value==="warehouse"?"Warehouse Items":d.value.charAt(0).toUpperCase()+d.value.slice(1)+"s"),1),c("p",null," Select which direction to sync "+P(d.value==="financial"?"financial transaction":d.value==="warehouse"?"warehouse":d.value)+" data: ",1),c("div",pK,[c("button",{onClick:C[15]||(C[15]=Pe=>L("toExcel")),class:"sync-option-btn to-excel",disabled:o.value},[...C[29]||(C[29]=[c("span",{class:"arrow"},"",-1),c("span",{class:"label"},"System  Excel",-1),c("small",null,"Update Excel with system data",-1)])],8,mK),c("button",{onClick:C[16]||(C[16]=Pe=>L("toFirestore")),class:"sync-option-btn to-firestore",disabled:o.value},[...C[30]||(C[30]=[c("span",{class:"arrow"},"",-1),c("span",{class:"label"},"System  Excel",-1),c("small",null,"Load data from Excel",-1)])],8,gK)])])])):be("",!0)])}}},yK=gn(vK,[["__scopeId","data-v-8c43ce5f"]]),_K={class:"attendance-form-page"},EK={class:"form-header"},TK={key:0,class:"my-requests-section"},wK={class:"requests-header"},CK={class:"filter-controls"},AK={class:"requests-table-wrapper"},IK={class:"my-requests-table"},SK={class:"action-buttons"},xK=["onClick"],bK=["onClick"],RK={class:"form-container"},kK={class:"add-row-section"},PK=["disabled"],NK={class:"table-wrapper"},OK={class:"attendance-table"},DK=["onUpdate:modelValue","onChange"],MK=["onUpdate:modelValue"],FK=["onUpdate:modelValue","onChange"],LK=["onUpdate:modelValue","disabled"],UK=["onUpdate:modelValue","onChange","disabled"],BK=["value"],VK=["onUpdate:modelValue","disabled"],$K=["onUpdate:modelValue","onChange","disabled"],HK=["onUpdate:modelValue","onChange","disabled"],jK=["onUpdate:modelValue"],WK=["onUpdate:modelValue","onChange"],KK=["onUpdate:modelValue"],qK=["onUpdate:modelValue"],GK=["onClick"],zK={__name:"TimeAttendanceRequestForm",setup(n){Du();const e=xo(),t=_a(),r=Xx(),s=ae([]),i=ae([]),o=ae(null),a=ae(!1),l=ae(""),u=ae(""),d=ae([]),f=ae(""),p=["","","","","","",""],m=Be(()=>f.value?d.value.filter(N=>N.Status===f.value):d.value);function g(N){if(!N)return"";const M=new Date(N);return`${M.getFullYear()}.${String(M.getMonth()+1).padStart(2,"0")}.${String(M.getDate()).padStart(2,"0")}`}function v(N){switch(N){case"":return"status-present";case"":return"status-assignment";case"/":return"status-leave";case"":return"status-missed";default:return""}}kn(async()=>{await e.fetchProjects(),await t.fetchEmployees(),i.value=e.projects.filter(M=>M.Status===" ").sort((M,F)=>{const oe=parseInt(M.id)||0,Q=parseInt(F.id)||0;return oe-Q});const N=$a.currentUser;N&&(o.value=t.employees.find(M=>M.Email===N.email)),await L(),y()});function y(){var Ee,Pe,he,E,T,U,ee;const N=Date.now(),M=Math.random().toString(36).substring(2,8),F=`${N}-${M}`,oe=new Date,Q=oe.getFullYear(),ne=String(oe.getMonth()+1).padStart(2,"0"),ge=String(oe.getDate()).padStart(2,"0"),xe=`${Q}-${ne}-${ge}`;s.value.push({ID:F,Day:xe,WeekDay:p[oe.getDay()],EmployeeID:((Ee=o.value)==null?void 0:Ee.Id)||((Pe=o.value)==null?void 0:Pe.NumID)||null,FirstName:((he=o.value)==null?void 0:he.FirstName)||"",LastName:((E=o.value)==null?void 0:E.LastName)||"",EmployeeFirstName:((T=o.value)==null?void 0:T.FirstName)||"",EmployeeLastName:((U=o.value)==null?void 0:U.LastName)||"",Role:((ee=o.value)==null?void 0:ee.Position)||"",Status:"",ProjectID:"",ProjectName:"",startTime:"09:00",endTime:"18:00",WorkingHour:8,isOvertimeRequest:!1,overtimeHour:0,comment:"",Week:R(new Date)})}async function L(){await r.fetchRequests(),d.value=r.requests.filter(N=>{var M;return N.status==="pending"&&N.EmployeeLastName===((M=o.value)==null?void 0:M.LastName)})}function D(N){s.value=[{...N,isOvertimeRequest:N.overtimeHour>0,isEditing:!0,editingDocId:N.docId}],window.scrollTo({top:0,behavior:"smooth"}),b('  .    " "  ',"info")}async function A(N){if(confirm("   ?"))try{await cl("delete",{},N),b("  ","success"),await L()}catch(M){b(" : "+M.message,"error")}}function C(N){s.value.splice(N,1)}function j(N){const M=s.value[N],F=i.value.find(oe=>oe.id==M.ProjectID);F&&(M.ProjectName=F.siteLocation||"")}function z(N){const M=s.value[N];if(M.Day){const[F,oe,Q]=M.Day.split("-").map(Number),ne=new Date(F,oe-1,Q);M.WeekDay=p[ne.getDay()],M.Week=R(ne)}if(M.Status==="/"){M.WorkingHour=8,M.overtimeHour=0,M.isOvertimeRequest=!1,M.startTime="",M.endTime="";return}if(M.startTime&&M.endTime){const F=w(M.startTime);let Q=w(M.endTime)-F;Q<0&&(Q+=24);const ne=Math.max(0,Math.round((Q-1)*10)/10);M.isOvertimeRequest?(M.WorkingHour=0,M.overtimeHour=ne):(M.WorkingHour=Math.min(ne,8),M.overtimeHour=0)}}function w(N){const[M,F]=N.split(":").map(Number);return M+F/60}function R(N){const M=new Date(Date.UTC(N.getFullYear(),N.getMonth(),N.getDate())),F=M.getUTCDay()||7;M.setUTCDate(M.getUTCDate()+4-F);const oe=new Date(Date.UTC(M.getUTCFullYear(),0,1));return Math.ceil(((M-oe)/864e5+1)/7)}async function x(){var F;if(s.value.length===0){b("   ","error");return}if(a.value)return;const N=s.value.map(oe=>`${oe.Day}-${oe.ProjectID}`);if(N.filter((oe,Q)=>N.indexOf(oe)!==Q&&oe!=="-").length>0){b("     ","error");return}for(let oe=0;oe<s.value.length;oe++)for(let Q=oe+1;Q<s.value.length;Q++){const ne=s.value[oe],ge=s.value[Q];if(ne.Day===ge.Day&&ne.ProjectID!==ge.ProjectID){const xe=w(ne.startTime),Ee=w(ne.endTime),Pe=w(ge.startTime),he=w(ge.endTime);let E=Ee<xe?Ee+24:Ee,T=he<Pe?he+24:he,U=xe,ee=Pe;if(U<T&&E>ee||ee<E&&T>U){b(`${ne.Day}    :      `,"error");return}}}for(const oe of s.value){if(!oe.Day||!oe.Role||!oe.Status){b("    ","error");return}if(oe.Status!=="/"){if(!oe.ProjectID){b("  ","error");return}if(!oe.startTime||!oe.endTime){b("   ","error");return}}if(!oe.comment||oe.comment.trim()===""){b("     ","error");return}}a.value=!0,l.value="";try{let oe=0,Q=0;await r.fetchRequests();const ne=r.requests.filter(Ee=>Ee.status==="pending"),ge=Jx();await ge.fetchRecords(!0);const xe=ge.allRecords;for(const Ee of s.value){if(Ee.isEditing&&Ee.editingDocId){console.log("Updating request:",Ee.editingDocId),await cl("update",Ee,Ee.editingDocId),oe++;continue}if(ne.find(U=>U.Day===Ee.Day&&U.ProjectID===Ee.ProjectID&&U.EmployeeLastName===Ee.EmployeeLastName)){b(`${Ee.Day}  ${Ee.ProjectID}      `,"error");return}if(xe.find(U=>U.Day===Ee.Day&&U.ProjectID===Ee.ProjectID&&(U.EmployeeLastName===Ee.EmployeeLastName||U.LastName===Ee.EmployeeLastName))){b(`${Ee.Day}  ${Ee.ProjectID}      `,"error");return}const E=xe.find(U=>{if(U.Day===Ee.Day&&U.ProjectID===Ee.ProjectID&&(U.EmployeeLastName===Ee.EmployeeLastName||U.LastName===Ee.EmployeeLastName)||U.Day!==Ee.Day||U.EmployeeLastName!==Ee.EmployeeLastName&&U.LastName!==Ee.EmployeeLastName)return!1;const ee=w(Ee.startTime),le=w(Ee.endTime),se=w(U.startTime),ve=w(U.endTime);let te=le<ee?le+24:le,O=ve<se?ve+24:ve;return ee<O&&te>se});if(E){b(`${Ee.Day}  ${E.startTime}-${E.endTime}       (${E.ProjectID} )`,"error");return}const T=ne.find(U=>{if(U.Day!==Ee.Day||U.EmployeeLastName!==Ee.EmployeeLastName)return!1;const ee=w(Ee.startTime),le=w(Ee.endTime),se=w(U.startTime),ve=w(U.endTime);let te=le<ee?le+24:le,O=ve<se?ve+24:ve;return ee<O&&te>se});if(T){b(`${Ee.Day}    : ${T.ProjectID}    ${T.startTime}-${T.endTime}    `,"error");return}console.log("Submitting request:",Ee);try{const U=await cl("add",Ee);console.log("Response:",U),oe++}catch(U){if(console.error("Backend error:",(F=U.response)==null?void 0:F.data),U.response&&(U.response.status===400||U.response.status===409)){const ee=U.response.data.details||U.response.data.message||U.response.data.error;b(ee,"error"),a.value=!1;return}throw U}}oe>0&&Q>0||(oe>0?b(`${oe}   `,"success"):Q>0),setTimeout(()=>{s.value=[],y(),L()},2e3)}catch(oe){b(" : "+oe.message,"error")}finally{a.value=!1}}function b(N,M){l.value=N,u.value=M,setTimeout(()=>{l.value=""},5e3)}return(N,M)=>(K(),q("div",_K,[c("div",EK,[M[2]||(M[2]=c("h2",null,"  ",-1)),c("button",{onClick:M[0]||(M[0]=F=>N.$router.push("/dashboard")),class:"btn-back"},"")]),d.value.length>0?(K(),q("div",TK,[c("div",wK,[M[4]||(M[4]=c("h3",null,"  ",-1)),c("div",CK,[ce(c("select",{"onUpdate:modelValue":M[1]||(M[1]=F=>f.value=F),class:"status-filter"},[...M[3]||(M[3]=[Ls('<option value="" data-v-5f75ecd6> </option><option value="" data-v-5f75ecd6></option><option value="" data-v-5f75ecd6></option><option value="/" data-v-5f75ecd6>/</option><option value="" data-v-5f75ecd6></option>',5)])],512),[[st,f.value]])])]),c("div",AK,[c("table",IK,[M[5]||(M[5]=c("thead",null,[c("tr",null,[c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,"")])],-1)),c("tbody",null,[(K(!0),q(Xe,null,ft(m.value,F=>(K(),q("tr",{key:F.docId},[c("td",null,P(g(F.Day)),1),c("td",null,P(F.WeekDay),1),c("td",null,[c("span",{class:mt(["status-badge",v(F.Status)])},P(F.Status),3)]),c("td",null,P(F.ProjectID),1),c("td",null,P(F.ProjectName),1),c("td",null,P(F.startTime),1),c("td",null,P(F.endTime),1),c("td",null,P(F.WorkingHour)+"",1),c("td",SK,[c("button",{onClick:oe=>D(F),class:"btn-edit"}," ",8,xK),c("button",{onClick:oe=>A(F.docId),class:"btn-delete-req"}," ",8,bK)])]))),128))])])])])):be("",!0),c("div",RK,[c("div",kK,[c("button",{onClick:y,class:"btn-add"}," "),c("button",{onClick:x,class:"btn-submit",disabled:s.value.length===0||a.value},P(a.value?" ...":" "),9,PK)]),l.value?(K(),q("div",{key:0,class:mt(["message",u.value])},P(l.value),3)):be("",!0),c("div",NK,[c("table",OK,[M[9]||(M[9]=c("thead",null,[c("tr",null,[c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null,""),c("th",null," "),c("th",null," "),c("th",null," "),c("th",null," "),c("th",null,"  "),c("th")])],-1)),c("tbody",null,[(K(!0),q(Xe,null,ft(s.value,(F,oe)=>(K(),q("tr",{key:oe},[c("td",null,[ce(c("input",{type:"date","onUpdate:modelValue":Q=>F.Day=Q,onChange:Q=>z(oe),class:"input-field"},null,40,DK),[[Ne,F.Day]])]),c("td",null,[ce(c("input",{type:"text","onUpdate:modelValue":Q=>F.WeekDay=Q,readonly:"",class:"input-field"},null,8,MK),[[Ne,F.WeekDay]])]),c("td",null,[ce(c("select",{"onUpdate:modelValue":Q=>F.Status=Q,onChange:Q=>z(oe),class:"input-field"},[...M[6]||(M[6]=[c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:"/"},"/",-1)])],40,FK),[[st,F.Status]])]),c("td",null,[ce(c("select",{"onUpdate:modelValue":Q=>F.Role=Q,class:"input-field",disabled:F.Status==="/"},[...M[7]||(M[7]=[c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1),c("option",{value:""},"",-1)])],8,LK),[[st,F.Role]])]),c("td",null,[ce(c("select",{"onUpdate:modelValue":Q=>F.ProjectID=Q,onChange:Q=>j(oe),class:"input-field",disabled:F.Status==="/"},[M[8]||(M[8]=c("option",{value:""},"",-1)),(K(!0),q(Xe,null,ft(i.value,Q=>(K(),q("option",{key:Q.id,value:Q.id},P(Q.id)+" - "+P(Q.siteLocation),9,BK))),128))],40,UK),[[st,F.ProjectID]])]),c("td",null,[ce(c("input",{type:"text","onUpdate:modelValue":Q=>F.ProjectName=Q,class:"input-field",placeholder:"",disabled:F.Status==="/"},null,8,VK),[[Ne,F.ProjectName]])]),c("td",null,[ce(c("input",{type:"time","onUpdate:modelValue":Q=>F.startTime=Q,onChange:Q=>z(oe),class:"input-field",step:"60",disabled:F.Status==="/"},null,40,$K),[[Ne,F.startTime]])]),c("td",null,[ce(c("input",{type:"time","onUpdate:modelValue":Q=>F.endTime=Q,onChange:Q=>z(oe),class:"input-field",step:"60",disabled:F.Status==="/"},null,40,HK),[[Ne,F.endTime]])]),c("td",null,[ce(c("input",{type:"number","onUpdate:modelValue":Q=>F.WorkingHour=Q,readonly:"",class:"input-field",step:"0.5"},null,8,jK),[[Ne,F.WorkingHour]])]),c("td",null,[ce(c("input",{type:"checkbox","onUpdate:modelValue":Q=>F.isOvertimeRequest=Q,onChange:Q=>z(oe),class:"checkbox-field"},null,40,WK),[[Go,F.isOvertimeRequest]]),ce(c("input",{type:"number","onUpdate:modelValue":Q=>F.overtimeHour=Q,readonly:"",class:"input-field overtime-input",step:"0.5"},null,8,KK),[[Ne,F.overtimeHour]])]),c("td",null,[ce(c("textarea",{"onUpdate:modelValue":Q=>F.comment=Q,class:"textarea-field",placeholder:"  *",rows:"2",required:""},null,8,qK),[[Ne,F.comment]])]),c("td",null,[c("button",{onClick:Q=>C(oe),class:"btn-delete"},"x",8,GK)])]))),128))])])])])]))}},YK=gn(zK,[["__scopeId","data-v-5f75ecd6"]]),QK={class:"salary-report-section"},XK={class:"period-selector"},JK={class:"period-buttons"},ZK={class:"month-selector"},eq={key:0,class:"loading"},tq={key:1,class:"salary-summary"},nq={class:"summary-card"},rq={class:"card-header"},sq={class:"date-range"},iq={class:"hours-breakdown"},oq={class:"hour-item total"},aq={class:"value"},lq={key:0,class:"hour-item missed"},cq={class:"value penalty"},uq={key:1,class:"hour-item salary-total"},dq={class:"value salary"},hq={key:0,class:"projects-section"},fq={class:"project-list"},pq={class:"project-header"},mq={class:"project-name"},gq={class:"project-summary"},vq={class:"project-total"},yq={key:0,class:"project-salary"},_q={class:"role-breakdown"},Eq={class:"role-info"},Tq={class:"role-icon"},wq={class:"role-name"},Cq={class:"role-hours"},Aq={class:"hours-detail"},Iq={key:0,class:"role-salary"},Sq={class:"days-worked"},xq={class:"value"},bq={key:2,class:"no-data"},Rq={__name:"EmployeeSalaryReport",setup(n){const e=Js(),t=_a(),r=Ig(),s=ae(null),i={:5e3,:0,:0};function o(L,D){if(s.value==="")return 0;const A=i[L]||0;return D*A}const a=ae("first-half"),l=ae(""),u=ae(!1),d=ae(null),f=new Date;l.value=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}`;const p=Be(()=>{if(!l.value)return 31;const[L,D]=l.value.split("-");return new Date(L,D,0).getDate()}),m=Be(()=>a.value==="first-half"?"  ":"  "),g=Be(()=>{if(!l.value)return"";const[L,D]=l.value.split("-");return a.value==="first-half"?`${L}-${D}-01 - ${L}-${D}-15`:`${L}-${D}-16 - ${L}-${D}-${p.value}`});function v(L){a.value=L,y()}async function y(){var D;const L=(D=e.userData)==null?void 0:D.employeeId;if(!l.value||!L){console.log("Missing required data:",{month:l.value,employeeId:L});return}u.value=!0;try{await t.fetchEmployees();const A=t.employees.find(Ee=>Ee.Id===L);s.value=(A==null?void 0:A.Type)||null,console.log("Employee type:",s.value);const[C,j]=l.value.split("-");let z,w;a.value==="first-half"?(z=1,w=15):(z=16,w=p.value);const R=`${C}-${j}-${String(z).padStart(2,"0")}`,x=`${C}-${j}-${String(w).padStart(2,"0")}`;console.log("Querying timeAttendance:",{employeeId:L,startDate:R,endDate:x});const b=xr(Yt(r,"timeAttendance"),Ir("EmployeeID","==",L)),N=await Zt(b);console.log("Total records found:",N.size);const M=N.docs.map(Ee=>Ee.data()).filter(Ee=>{const Pe=Ee.Day||Ee.Date;return Pe>=R&&Pe<=x});console.log("Records in date range:",M.length);let F=0,oe=0;const Q=new Map,ne=new Set;M.forEach(Ee=>{const Pe=Ee.Status,he=parseFloat(Ee.WorkingHour)||0,E=parseFloat(Ee.overtimeHour)||0;if(Pe==="/")return;let T=he+E;if(Pe===""){const se=he*2;oe+=se,T=-se}F+=T,Ee.Day&&ne.add(Ee.Day);const U=Ee.ProjectID,ee=Ee.ProjectName||U,le=Ee.Role||"";if(U){Q.has(U)||Q.set(U,{projectId:U,projectName:ee,totalHours:0,roles:new Map});const se=Q.get(U);se.totalHours+=T,se.roles.has(le)||se.roles.set(le,{role:le,totalHours:0,salary:0});const ve=se.roles.get(le);ve.totalHours+=T,ve.salary+=o(le,T)}});const ge=Array.from(Q.values()).map(Ee=>{const Pe=Array.from(Ee.roles.values()).sort((E,T)=>T.totalHours-E.totalHours),he=Pe.reduce((E,T)=>E+T.salary,0);return{...Ee,roles:Pe,totalSalary:he}}).sort((Ee,Pe)=>Pe.totalHours-Ee.totalHours),xe=ge.reduce((Ee,Pe)=>Ee+Pe.totalSalary,0);console.log("Calculated salary data:",{totalHours:F,missedHours:oe,totalSalary:xe,daysWorked:ne.size,projectCount:ge.length}),d.value={totalHours:F,missedHours:oe,totalSalary:xe,daysWorked:ne.size,projectBreakdown:ge}}catch(A){console.error("Error loading salary data:",A),d.value=null}finally{u.value=!1}}return kn(()=>{y()}),(L,D)=>(K(),q("div",QK,[D[10]||(D[10]=c("h3",null,"  ",-1)),D[11]||(D[11]=c("div",{class:"warning-banner"},"           ",-1)),c("div",XK,[D[4]||(D[4]=c("label",null," :",-1)),c("div",JK,[c("button",{onClick:D[0]||(D[0]=A=>v("first-half")),class:mt(["period-btn",{active:a.value==="first-half"}])}," 1-15 (  ) ",2),c("button",{onClick:D[1]||(D[1]=A=>v("second-half")),class:mt(["period-btn",{active:a.value==="second-half"}])}," 16-"+P(p.value)+" (  ) ",3)]),c("div",ZK,[D[3]||(D[3]=c("label",null," :",-1)),ce(c("input",{type:"month","onUpdate:modelValue":D[2]||(D[2]=A=>l.value=A),onChange:y},null,544),[[Ne,l.value]])])]),u.value?(K(),q("div",eq,"  ... ")):d.value?(K(),q("div",tq,[c("div",nq,[c("div",rq,[c("h4",null,P(m.value),1),c("p",sq,P(g.value),1)]),c("div",iq,[c("div",oq,[D[5]||(D[5]=c("span",{class:"label"},"  :",-1)),c("span",aq,P(d.value.totalHours.toFixed(2))+" ",1)]),d.value.missedHours>0?(K(),q("div",lq,[D[6]||(D[6]=c("span",{class:"label"}," :",-1)),c("span",cq,P(d.value.missedHours.toFixed(2))+" ",1)])):be("",!0),d.value.totalSalary>0?(K(),q("div",uq,[D[7]||(D[7]=c("span",{class:"label"},"  :",-1)),c("span",dq,P(d.value.totalSalary.toLocaleString())+" ",1)])):be("",!0)]),d.value.projectBreakdown.length>0?(K(),q("div",hq,[D[8]||(D[8]=c("h5",null,":",-1)),c("div",fq,[(K(!0),q(Xe,null,ft(d.value.projectBreakdown,A=>(K(),q("div",{key:A.projectId,class:"project-card"},[c("div",pq,[c("span",mq,P(A.projectName),1),c("div",gq,[c("span",vq,P(A.totalHours.toFixed(2))+" ",1),A.totalSalary>0?(K(),q("span",yq,P(A.totalSalary.toLocaleString())+" ",1)):be("",!0)])]),c("div",_q,[(K(!0),q(Xe,null,ft(A.roles,C=>(K(),q("div",{key:C.role,class:"role-item"},[c("div",Eq,[c("span",Tq,P(C.role===""?"":C.role===""?"":""),1),c("span",wq,P(C.role),1)]),c("div",Cq,[c("span",Aq,P(C.totalHours.toFixed(2))+" ",1),C.salary>0?(K(),q("span",Iq,P(C.salary.toLocaleString())+" ",1)):be("",!0)])]))),128))])]))),128))])])):be("",!0),c("div",Sq,[D[9]||(D[9]=c("span",{class:"label"}," :",-1)),c("span",xq,P(d.value.daysWorked)+" ",1)])])])):u.value?be("",!0):(K(),q("div",bq,"     "))]))}},kq=gn(Rq,[["__scopeId","data-v-a380e257"]]),Pq={class:"salary-report-page"},Nq={class:"page-header"},Oq={__name:"SalaryReport",setup(n){return(e,t)=>(K(),q("div",Pq,[c("header",Nq,[c("button",{onClick:t[0]||(t[0]=r=>e.$router.push("/dashboard")),class:"back-btn"}," "),t[1]||(t[1]=c("h1",null,"  ",-1))]),fn(kq)]))}},Dq=gn(Oq,[["__scopeId","data-v-8c2fc283"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Dh={};Dh.version="0.18.5";var Zx=1252,Mq=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],eb=function(n){Mq.indexOf(n)!=-1&&(Zx=n)};function Fq(){eb(1252)}var su=function(n){eb(n)};function Lq(){su(1200),Fq()}var Ad=function(e){return String.fromCharCode(e)},GE=function(e){return String.fromCharCode(e)},Mh,io="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function iu(n){for(var e="",t=0,r=0,s=0,i=0,o=0,a=0,l=0,u=0;u<n.length;)t=n.charCodeAt(u++),i=t>>2,r=n.charCodeAt(u++),o=(t&3)<<4|r>>4,s=n.charCodeAt(u++),a=(r&15)<<2|s>>6,l=s&63,isNaN(r)?a=l=64:isNaN(s)&&(l=64),e+=io.charAt(i)+io.charAt(o)+io.charAt(a)+io.charAt(l);return e}function Fi(n){var e="",t=0,r=0,s=0,i=0,o=0,a=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<n.length;)i=io.indexOf(n.charAt(u++)),o=io.indexOf(n.charAt(u++)),t=i<<2|o>>4,e+=String.fromCharCode(t),a=io.indexOf(n.charAt(u++)),r=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(r)),l=io.indexOf(n.charAt(u++)),s=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Ot=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Vi=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function da(n){return Ot?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function zE(n){return Ot?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var us=function(e){return Ot?Vi(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function rp(n){if(typeof ArrayBuffer>"u")return us(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function Bu(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function Uq(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Xn=Ot?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Vi(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),s=0;for(e=0,t=0;e<n.length;t+=s,++e)if(s=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Bq(n){for(var e=[],t=0,r=n.length+250,s=da(n.length+255),i=0;i<n.length;++i){var o=n.charCodeAt(i);if(o<128)s[t++]=o;else if(o<2048)s[t++]=192|o>>6&31,s[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=n.charCodeAt(++i)&1023;s[t++]=240|o>>8&7,s[t++]=128|o>>2&63,s[t++]=128|a>>6&15|(o&3)<<4,s[t++]=128|a&63}else s[t++]=224|o>>12&15,s[t++]=128|o>>6&63,s[t++]=128|o&63;t>r&&(e.push(s.slice(0,t)),t=0,s=da(65535),r=65530)}return e.push(s.slice(0,t)),Xn(e)}var Fc=/\u0000/g,Id=/[\u0001-\u0006]/g;function ul(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function ds(n,e){var t=""+n;return t.length>=e?t:hn("0",e-t.length)+t}function Ov(n,e){var t=""+n;return t.length>=e?t:hn(" ",e-t.length)+t}function Fh(n,e){var t=""+n;return t.length>=e?t:t+hn(" ",e-t.length)}function Vq(n,e){var t=""+Math.round(n);return t.length>=e?t:hn("0",e-t.length)+t}function $q(n,e){var t=""+n;return t.length>=e?t:hn("0",e-t.length)+t}var YE=Math.pow(2,32);function Da(n,e){if(n>YE||n<-YE)return Vq(n,e);var t=Math.round(n);return $q(t,e)}function Lh(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var QE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Zp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Hq(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var mn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},XE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},jq={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Uh(n,e,t){for(var r=n<0?-1:1,s=n*r,i=0,o=1,a=0,l=1,u=0,d=0,f=Math.floor(s);u<e&&(f=Math.floor(s),a=f*o+i,d=f*u+l,!(s-f<5e-8));)s=1/(s-f),i=o,o=a,l=u,u=d;if(d>e&&(u>e?(d=l,a=i):(d=u,a=o)),!t)return[0,r*a,d];var p=Math.floor(r*a/d);return[p,r*a-p*d,d]}function Sd(n,e,t){if(n>2958465||n<0)return null;var r=n|0,s=Math.floor(86400*(n-r)),i=0,o=[],a={D:r,T:s,u:86400*(n-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++s==86400&&(a.T=s=0,++r,++a.D)),r===60)o=t?[1317,10,29]:[1900,2,29],i=3;else if(r===0)o=t?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),r<60&&(i=(i+6)%7),t&&(i=Qq(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=s%60,s=Math.floor(s/60),a.M=s%60,s=Math.floor(s/60),a.H=s,a.q=i,a}var tb=new Date(1899,11,31,0,0,0),Wq=tb.getTime(),Kq=new Date(1900,2,1,0,0,0);function nb(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=Kq&&(t+=24*60*60*1e3),(t-(Wq+(n.getTimezoneOffset()-tb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Dv(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function qq(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Gq(n){var e=n<0?12:11,t=Dv(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function zq(n){var e=Dv(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function Yq(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=Gq(n):e===10?t=n.toFixed(10).substr(0,12):t=zq(n),Dv(qq(t.toUpperCase()))}function v0(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Yq(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return wo(14,nb(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Qq(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function Xq(n,e,t,r){var s="",i=0,o=0,a=t.y,l,u=0;switch(n){case 98:a=t.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,u=e.length;break;case 3:return Zp[t.m-1][1];case 5:return Zp[t.m-1][0];default:return Zp[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,u=e.length;break;case 3:return QE[t.q][0];default:return QE[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?ds(t.S,e.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,i=Math.round(o*(t.S+t.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(s=ds(i,2+r),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=a,u=1;break}var d=u>0?ds(l,u):"";return d}function oo(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var rb=/%/g;function Jq(n,e,t){var r=e.replace(rb,""),s=e.length-r.length;return Ii(n,r,t*Math.pow(10,2*s))+hn("%",s)}function Zq(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ii(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function sb(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+sb(n,-e);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(e/Math.pow(10,i)).toPrecision(r+1+(s+i)%s),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,d){return l+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var ib=/# (\?+)( ?)\/( ?)(\d+)/;function eG(n,e,t){var r=parseInt(n[4],10),s=Math.round(e*r),i=Math.floor(s/r),o=s-i*r,a=r;return t+(i===0?"":""+i)+" "+(o===0?hn(" ",n[1].length+1+n[4].length):Ov(o,n[1].length)+n[2]+"/"+n[3]+ds(a,n[4].length))}function tG(n,e,t){return t+(e===0?"":""+e)+hn(" ",n[1].length+2+n[4].length)}var ob=/^#*0*\.([0#]+)/,ab=/\).*[0#]/,lb=/\(###\) ###\\?-####/;function Cr(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function JE(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function ZE(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function nG(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function rG(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function es(n,e,t){if(n.charCodeAt(0)===40&&!e.match(ab)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?es("n",r,t):"("+es("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Zq(n,e,t);if(e.indexOf("%")!==-1)return Jq(n,e,t);if(e.indexOf("E")!==-1)return sb(e,t);if(e.charCodeAt(0)===36)return"$"+es(n,e.substr(e.charAt(1)==" "?2:1),t);var s,i,o,a,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+Da(l,e.length);if(e.match(/^[#?]+$/))return s=Da(t,0),s==="0"&&(s=""),s.length>e.length?s:Cr(e.substr(0,e.length-s.length))+s;if(i=e.match(ib))return eG(i,l,u);if(e.match(/^#+0+$/))return u+Da(l,e.length-e.indexOf("0"));if(i=e.match(ob))return s=JE(t,i[1].length).replace(/^([^\.]+)$/,"$1."+Cr(i[1])).replace(/\.$/,"."+Cr(i[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+hn("0",Cr(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return u+JE(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return u+oo(Da(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+es(n,e,-t):oo(""+(Math.floor(t)+nG(t,i[1].length)))+"."+ds(ZE(t,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return es(n,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ul(es(n,e.replace(/[\\-]/g,""),t)),o=0,ul(ul(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(e.match(lb))return s=es(n,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),a=Uh(l,Math.pow(10,o)-1,!1),s=""+u,d=Ii("n",i[1],a[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=Fh(a[2],o),d.length<i[4].length&&(d=Cr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),a=Uh(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Ov(a[1],o)+i[2]+"/"+i[3]+Fh(a[2],o):hn(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Da(t,0),e.length<=s.length?s:Cr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=e.indexOf(".")-o,p=e.length-s.length-f;return Cr(e.substr(0,f)+s+e.substr(e.length-p))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=ZE(t,i[1].length),t<0?"-"+es(n,e,-t):oo(rG(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ds(0,3-g.length):"")+g})+"."+ds(o,i[1].length);switch(e){case"###,##0.00":return es(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=oo(Da(l,0));return m!=="0"?u+m:"";case"###,###.00":return es(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return es(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function sG(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ii(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function iG(n,e,t){var r=e.replace(rb,""),s=e.length-r.length;return Ii(n,r,t*Math.pow(10,2*s))+hn("%",s)}function cb(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+cb(n,-e);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(e/Math.pow(10,i)).toPrecision(r+1+(s+i)%s),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,d){return l+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function bs(n,e,t){if(n.charCodeAt(0)===40&&!e.match(ab)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?bs("n",r,t):"("+bs("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return sG(n,e,t);if(e.indexOf("%")!==-1)return iG(n,e,t);if(e.indexOf("E")!==-1)return cb(e,t);if(e.charCodeAt(0)===36)return"$"+bs(n,e.substr(e.charAt(1)==" "?2:1),t);var s,i,o,a,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+ds(l,e.length);if(e.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>e.length?s:Cr(e.substr(0,e.length-s.length))+s;if(i=e.match(ib))return tG(i,l,u);if(e.match(/^#+0+$/))return u+ds(l,e.length-e.indexOf("0"));if(i=e.match(ob))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Cr(i[1])).replace(/\.$/,"."+Cr(i[1])),s=s.replace(/\.(\d*)$/,function(g,v){return"."+v+hn("0",Cr(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return u+oo(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+bs(n,e,-t):oo(""+t)+"."+hn("0",i[1].length);if(i=e.match(/^#,#*,#0/))return bs(n,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ul(bs(n,e.replace(/[\\-]/g,""),t)),o=0,ul(ul(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(e.match(lb))return s=bs(n,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),a=Uh(l,Math.pow(10,o)-1,!1),s=""+u,d=Ii("n",i[1],a[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=Fh(a[2],o),d.length<i[4].length&&(d=Cr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),a=Uh(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Ov(a[1],o)+i[2]+"/"+i[3]+Fh(a[2],o):hn(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+t,e.length<=s.length?s:Cr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=e.indexOf(".")-o,p=e.length-s.length-f;return Cr(e.substr(0,f)+s+e.substr(e.length-p))}if(i=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+bs(n,e,-t):oo(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ds(0,3-g.length):"")+g})+"."+ds(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=oo(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return bs(n,e.slice(0,e.lastIndexOf(".")),t)+Cr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ii(n,e,t){return(t|0)===t?bs(n,e,t):es(n,e,t)}function oG(n){for(var e=[],t=!1,r=0,s=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(s,r-s),s=r+1}if(e[e.length]=n.substr(s),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var ub=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function db(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":Lh(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(ub))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function aG(n,e,t,r){for(var s=[],i="",o=0,a="",l="t",u,d,f,p="H";o<n.length;)switch(a=n.charAt(o)){case"G":if(!Lh(n,o))throw new Error("unrecognized character "+a+" in "+n);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=n.charCodeAt(++o))!==34&&o<n.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var m=n.charAt(++o),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(u==null&&(u=Sd(e,t,n.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:n.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Sd(e,t),u==null))return"";for(i=a;++o<n.length&&n.charAt(o).toLowerCase()===a;)i+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=p),s[s.length]={t:a,v:i},l=a;break;case"A":case"a":case"":var v={t:a,v:a};if(u==null&&(u=Sd(e,t)),n.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",p="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",o+=5,p="h"):n.substr(o,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",o+=5,p="h"):(v.t="t",++o),u==null&&v.t==="T")return"";s[s.length]=v,l=a;break;case"[":for(i=a;n.charAt(o++)!=="]"&&o<n.length;)i+=n.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(ub)){if(u==null&&(u=Sd(e,t),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",db(n)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=a;++o<n.length&&(a=n.charAt(o))==="0";)i+=a;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=a;++o<n.length&&"0#?.,E+-%".indexOf(a=n.charAt(o))>-1;)i+=a;s[s.length]={t:"n",v:i};break;case"?":for(i=a;n.charAt(++o)===a;)i+=a;s[s.length]={t:a,v:i},l=a;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=a;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)i+=n.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:a,v:a},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+n);s[s.length]={t:"t",v:a},++o;break}var y=0,L=0,D;for(o=s.length-1,l="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=p,l="h",y<1&&(y=1);break;case"s":(D=s[o].v.match(/\.0+$/))&&(L=Math.max(L,D[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=s[o].t;break;case"m":l==="s"&&(s[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[o].v.match(/[Hh]/)&&(y=1),y<2&&s[o].v.match(/[Mm]/)&&(y=2),y<3&&s[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var A="",C;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=Xq(s[o].t.charCodeAt(0),s[o].v,u,L),s[o].t="t";break;case"n":case"?":for(C=o+1;s[C]!=null&&((a=s[C].t)==="?"||a==="D"||(a===" "||a==="t")&&s[C+1]!=null&&(s[C+1].t==="?"||s[C+1].t==="t"&&s[C+1].v==="/")||s[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(s[C].v==="/"||s[C].v===" "&&s[C+1]!=null&&s[C+1].t=="?"));)s[o].v+=s[C].v,s[C]={v:"",t:";"},++C;A+=s[o].v,o=C-1;break;case"G":s[o].t="t",s[o].v=v0(e,t);break}var j="",z,w;if(A.length>0){A.charCodeAt(0)==40?(z=e<0&&A.charCodeAt(0)===45?-e:e,w=Ii("n",A,z)):(z=e<0&&r>1?-e:e,w=Ii("n",A,z),z<0&&s[0]&&s[0].t=="t"&&(w=w.substr(1),s[0].v="-"+s[0].v)),C=w.length-1;var R=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){R=o;break}var x=s.length;if(R===s.length&&w.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(C>=s[o].v.length-1?(C-=s[o].v.length,s[o].v=w.substr(C+1,s[o].v.length)):C<0?s[o].v="":(s[o].v=w.substr(0,C+1),C=-1),s[o].t="t",x=o);C>=0&&x<s.length&&(s[x].v=w.substr(0,C+1)+s[x].v)}else if(R!==s.length&&w.indexOf("E")===-1){for(C=w.indexOf(".")-1,o=R;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===R?s[o].v.indexOf(".")-1:s[o].v.length-1,j=s[o].v.substr(d+1);d>=0;--d)C>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(j=w.charAt(C--)+j);s[o].v=j,s[o].t="t",x=o}for(C>=0&&x<s.length&&(s[x].v=w.substr(0,C+1)+s[x].v),C=w.indexOf(".")+1,o=R;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==R)){for(d=s[o].v.indexOf(".")>-1&&o===R?s[o].v.indexOf(".")+1:0,j=s[o].v.substr(0,d);d<s[o].v.length;++d)C<w.length&&(j+=w.charAt(C++));s[o].v=j,s[o].t="t",x=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(z=r>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=Ii(s[o].t,s[o].v,z),s[o].t="t");var b="";for(o=0;o!==s.length;++o)s[o]!=null&&(b+=s[o].v);return b}var eT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tT(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function lG(n,e){var t=oG(n),r=t.length,s=t[r-1].indexOf("@");if(r<4&&s>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(eT),a=t[1].match(eT);return tT(e,o)?[r,t[0]]:tT(e,a)?[r,t[1]]:[r,t[o!=null&&a!=null?2:1]]}return[r,i]}function wo(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:mn)[n],r==null&&(r=t.table&&t.table[XE[n]]||mn[XE[n]]),r==null&&(r=jq[n]||"General");break}if(Lh(r,0))return v0(e,t);e instanceof Date&&(e=nb(e,t.date1904));var s=lG(r,e);if(Lh(s[1]))return v0(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return aG(s[1],e,t,s[0])}function hb(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(mn[t]==null){e<0&&(e=t);continue}if(mn[t]==n){e=t;break}}e<0&&(e=391)}return mn[e]=n,e}function sp(n){for(var e=0;e!=392;++e)n[e]!==void 0&&hb(n[e],e)}function ip(){mn=Hq()}var fb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cG(n){var e=typeof n=="number"?mn[n]:n;return e=e.replace(fb,"(\\d+)"),new RegExp("^"+e+"$")}function uG(n,e,t){var r=-1,s=-1,i=-1,o=-1,a=-1,l=-1;(e.match(fb)||[]).forEach(function(f,p){var m=parseInt(t[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=m;break;case"d":i=m;break;case"h":o=m;break;case"s":l=m;break;case"m":o>=0?a=m:s=m;break}}),l>=0&&a==-1&&s>=0&&(a=s,s=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:r==-1&&s==-1&&i==-1?d:u+"T"+d}var dG=function(){var n={};n.version="1.2.0";function e(){for(var w=0,R=new Array(256),x=0;x!=256;++x)w=x,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,R[x]=w;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function r(w){var R=0,x=0,b=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)N[b]=w[b];for(b=0;b!=256;++b)for(x=w[b],R=256+b;R<4096;R+=256)x=N[R]=x>>>8^w[x&255];var M=[];for(b=1;b!=16;++b)M[b-1]=typeof Int32Array<"u"?N.subarray(b*256,b*256+256):N.slice(b*256,b*256+256);return M}var s=r(t),i=s[0],o=s[1],a=s[2],l=s[3],u=s[4],d=s[5],f=s[6],p=s[7],m=s[8],g=s[9],v=s[10],y=s[11],L=s[12],D=s[13],A=s[14];function C(w,R){for(var x=R^-1,b=0,N=w.length;b<N;)x=x>>>8^t[(x^w.charCodeAt(b++))&255];return~x}function j(w,R){for(var x=R^-1,b=w.length-15,N=0;N<b;)x=A[w[N++]^x&255]^D[w[N++]^x>>8&255]^L[w[N++]^x>>16&255]^y[w[N++]^x>>>24]^v[w[N++]]^g[w[N++]]^m[w[N++]]^p[w[N++]]^f[w[N++]]^d[w[N++]]^u[w[N++]]^l[w[N++]]^a[w[N++]]^o[w[N++]]^i[w[N++]]^t[w[N++]];for(b+=15;N<b;)x=x>>>8^t[(x^w[N++])&255];return~x}function z(w,R){for(var x=R^-1,b=0,N=w.length,M=0,F=0;b<N;)M=w.charCodeAt(b++),M<128?x=x>>>8^t[(x^M)&255]:M<2048?(x=x>>>8^t[(x^(192|M>>6&31))&255],x=x>>>8^t[(x^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,F=w.charCodeAt(b++)&1023,x=x>>>8^t[(x^(240|M>>8&7))&255],x=x>>>8^t[(x^(128|M>>2&63))&255],x=x>>>8^t[(x^(128|F>>6&15|(M&3)<<4))&255],x=x>>>8^t[(x^(128|F&63))&255]):(x=x>>>8^t[(x^(224|M>>12&15))&255],x=x>>>8^t[(x^(128|M>>6&63))&255],x=x>>>8^t[(x^(128|M&63))&255]);return~x}return n.table=t,n.bstr=C,n.buf=j,n.str=z,n}(),Wt=function(){var e={};e.version="1.2.1";function t(V,X){for(var G=V.split("/"),Y=X.split("/"),J=0,Z=0,pe=Math.min(G.length,Y.length);J<pe;++J){if(Z=G[J].length-Y[J].length)return Z;if(G[J]!=Y[J])return G[J]<Y[J]?-1:1}return G.length-Y.length}function r(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:r(V.slice(0,-1));var X=V.lastIndexOf("/");return X===-1?V:V.slice(0,X+1)}function s(V){if(V.charAt(V.length-1)=="/")return s(V.slice(0,-1));var X=V.lastIndexOf("/");return X===-1?V:V.slice(X+1)}function i(V,X){typeof X=="string"&&(X=new Date(X));var G=X.getHours();G=G<<6|X.getMinutes(),G=G<<5|X.getSeconds()>>>1,V.write_shift(2,G);var Y=X.getFullYear()-1980;Y=Y<<4|X.getMonth()+1,Y=Y<<5|X.getDate(),V.write_shift(2,Y)}function o(V){var X=V.read_shift(2)&65535,G=V.read_shift(2)&65535,Y=new Date,J=G&31;G>>>=5;var Z=G&15;G>>>=4,Y.setMilliseconds(0),Y.setFullYear(G+1980),Y.setMonth(Z-1),Y.setDate(J);var pe=X&31;X>>>=5;var Ce=X&63;return X>>>=6,Y.setHours(X),Y.setMinutes(Ce),Y.setSeconds(pe<<1),Y}function a(V){jr(V,0);for(var X={},G=0;V.l<=V.length-4;){var Y=V.read_shift(2),J=V.read_shift(2),Z=V.l+J,pe={};switch(Y){case 21589:G=V.read_shift(1),G&1&&(pe.mtime=V.read_shift(4)),J>5&&(G&2&&(pe.atime=V.read_shift(4)),G&4&&(pe.ctime=V.read_shift(4))),pe.mtime&&(pe.mt=new Date(pe.mtime*1e3));break}V.l=Z,X[Y]=pe}return X}var l;function u(){return l||(l={})}function d(V,X){if(V[0]==80&&V[1]==75)return zl(V,X);if((V[0]|32)==109&&(V[1]|32)==105)return Gu(V,X);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var G=3,Y=512,J=0,Z=0,pe=0,Ce=0,me=0,ye=[],_e=V.slice(0,512);jr(_e,0);var Le=f(_e);switch(G=Le[0],G){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Le[1]==0)return zl(V,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}Y!==512&&(_e=V.slice(0,Y),jr(_e,28));var We=V.slice(0,Y);p(_e,G);var ze=_e.read_shift(4,"i");if(G===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);_e.l+=4,pe=_e.read_shift(4,"i"),_e.l+=4,_e.chk("00100000","Mini Stream Cutoff Size: "),Ce=_e.read_shift(4,"i"),J=_e.read_shift(4,"i"),me=_e.read_shift(4,"i"),Z=_e.read_shift(4,"i");for(var Ve=-1,Ge=0;Ge<109&&(Ve=_e.read_shift(4,"i"),!(Ve<0));++Ge)ye[Ge]=Ve;var ct=m(V,Y);y(me,Z,ct,Y,ye);var qt=D(ct,pe,ye,Y);qt[pe].name="!Directory",J>0&&Ce!==F&&(qt[Ce].name="!MiniFAT"),qt[ye[0]].name="!FAT",qt.fat_addrs=ye,qt.ssz=Y;var Ft={},an=[],ni=[],No=[];A(pe,qt,ct,an,J,Ft,ni,Ce),g(ni,No,an),an.shift();var ji={FileIndex:ni,FullPaths:No};return X&&X.raw&&(ji.raw={header:We,sectors:ct}),ji}function f(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(oe,"Header Signature: "),V.l+=16;var X=V.read_shift(2,"u");return[V.read_shift(2,"u"),X]}function p(V,X){var G=9;switch(V.l+=2,G=V.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function m(V,X){for(var G=Math.ceil(V.length/X)-1,Y=[],J=1;J<G;++J)Y[J-1]=V.slice(J*X,(J+1)*X);return Y[G-1]=V.slice(G*X),Y}function g(V,X,G){for(var Y=0,J=0,Z=0,pe=0,Ce=0,me=G.length,ye=[],_e=[];Y<me;++Y)ye[Y]=_e[Y]=Y,X[Y]=G[Y];for(;Ce<_e.length;++Ce)Y=_e[Ce],J=V[Y].L,Z=V[Y].R,pe=V[Y].C,ye[Y]===Y&&(J!==-1&&ye[J]!==J&&(ye[Y]=ye[J]),Z!==-1&&ye[Z]!==Z&&(ye[Y]=ye[Z])),pe!==-1&&(ye[pe]=Y),J!==-1&&Y!=ye[Y]&&(ye[J]=ye[Y],_e.lastIndexOf(J)<Ce&&_e.push(J)),Z!==-1&&Y!=ye[Y]&&(ye[Z]=ye[Y],_e.lastIndexOf(Z)<Ce&&_e.push(Z));for(Y=1;Y<me;++Y)ye[Y]===Y&&(Z!==-1&&ye[Z]!==Z?ye[Y]=ye[Z]:J!==-1&&ye[J]!==J&&(ye[Y]=ye[J]));for(Y=1;Y<me;++Y)if(V[Y].type!==0){if(Ce=Y,Ce!=ye[Ce])do Ce=ye[Ce],X[Y]=X[Ce]+"/"+X[Y];while(Ce!==0&&ye[Ce]!==-1&&Ce!=ye[Ce]);ye[Y]=-1}for(X[0]+="/",Y=1;Y<me;++Y)V[Y].type!==2&&(X[Y]+="/")}function v(V,X,G){for(var Y=V.start,J=V.size,Z=[],pe=Y;G&&J>0&&pe>=0;)Z.push(X.slice(pe*M,pe*M+M)),J-=M,pe=Bo(G,pe*4);return Z.length===0?Ie(0):Xn(Z).slice(0,V.size)}function y(V,X,G,Y,J){var Z=F;if(V===F){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var pe=G[V],Ce=(Y>>>2)-1;if(!pe)return;for(var me=0;me<Ce&&(Z=Bo(pe,me*4))!==F;++me)J.push(Z);y(Bo(pe,Y-4),X-1,G,Y,J)}}function L(V,X,G,Y,J){var Z=[],pe=[];J||(J=[]);var Ce=Y-1,me=0,ye=0;for(me=X;me>=0;){J[me]=!0,Z[Z.length]=me,pe.push(V[me]);var _e=G[Math.floor(me*4/Y)];if(ye=me*4&Ce,Y<4+ye)throw new Error("FAT boundary crossed: "+me+" 4 "+Y);if(!V[_e])break;me=Bo(V[_e],ye)}return{nodes:Z,data:cT([pe])}}function D(V,X,G,Y){var J=V.length,Z=[],pe=[],Ce=[],me=[],ye=Y-1,_e=0,Le=0,We=0,ze=0;for(_e=0;_e<J;++_e)if(Ce=[],We=_e+X,We>=J&&(We-=J),!pe[We]){me=[];var Ve=[];for(Le=We;Le>=0;){Ve[Le]=!0,pe[Le]=!0,Ce[Ce.length]=Le,me.push(V[Le]);var Ge=G[Math.floor(Le*4/Y)];if(ze=Le*4&ye,Y<4+ze)throw new Error("FAT boundary crossed: "+Le+" 4 "+Y);if(!V[Ge]||(Le=Bo(V[Ge],ze),Ve[Le]))break}Z[We]={nodes:Ce,data:cT([me])}}return Z}function A(V,X,G,Y,J,Z,pe,Ce){for(var me=0,ye=Y.length?2:0,_e=X[V].data,Le=0,We=0,ze;Le<_e.length;Le+=128){var Ve=_e.slice(Le,Le+128);jr(Ve,64),We=Ve.read_shift(2),ze=Bv(Ve,0,We-ye),Y.push(ze);var Ge={name:ze,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},ct=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);ct!==0&&(Ge.ct=C(Ve,Ve.l-8));var qt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);qt!==0&&(Ge.mt=C(Ve,Ve.l-8)),Ge.start=Ve.read_shift(4,"i"),Ge.size=Ve.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=F,Ge.name=""),Ge.type===5?(me=Ge.start,J>0&&me!==F&&(X[me].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",X[Ge.start]===void 0&&(X[Ge.start]=L(G,Ge.start,X.fat_addrs,X.ssz)),X[Ge.start].name=Ge.name,Ge.content=X[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:me!==F&&Ge.start!==F&&X[me]&&(Ge.content=v(Ge,X[me].data,(X[Ce]||{}).data))),Ge.content&&jr(Ge.content,0),Z[ze]=Ge,pe.push(Ge)}}function C(V,X){return new Date((qr(V,X+4)/1e7*Math.pow(2,32)+qr(V,X)/1e7-11644473600)*1e3)}function j(V,X){return u(),d(l.readFileSync(V),X)}function z(V,X){var G=X&&X.type;switch(G||Ot&&Buffer.isBuffer(V)&&(G="buffer"),G||"base64"){case"file":return j(V,X);case"base64":return d(us(Fi(V)),X);case"binary":return d(us(V),X)}return d(V,X)}function w(V,X){var G=X||{},Y=G.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=Y+"/",V.FileIndex[0]={name:Y,type:5}),G.CLSID&&(V.FileIndex[0].clsid=G.CLSID),R(V)}function R(V){var X="Sh33tJ5";if(!Wt.find(V,"/"+X)){var G=Ie(4);G[0]=55,G[1]=G[3]=50,G[2]=54,V.FileIndex.push({name:X,type:2,content:G,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+X),x(V)}}function x(V,X){w(V);for(var G=!1,Y=!1,J=V.FullPaths.length-1;J>=0;--J){var Z=V.FileIndex[J];switch(Z.type){case 0:Y?G=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(Z.R*Z.L*Z.C)&&(G=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!X)){var pe=new Date(1987,1,19),Ce=0,me=Object.create?Object.create(null):{},ye=[];for(J=0;J<V.FullPaths.length;++J)me[V.FullPaths[J]]=!0,V.FileIndex[J].type!==0&&ye.push([V.FullPaths[J],V.FileIndex[J]]);for(J=0;J<ye.length;++J){var _e=r(ye[J][0]);Y=me[_e],Y||(ye.push([_e,{name:s(_e).replace("/",""),type:1,clsid:ne,ct:pe,mt:pe,content:null}]),me[_e]=!0)}for(ye.sort(function(ze,Ve){return t(ze[0],Ve[0])}),V.FullPaths=[],V.FileIndex=[],J=0;J<ye.length;++J)V.FullPaths[J]=ye[J][0],V.FileIndex[J]=ye[J][1];for(J=0;J<ye.length;++J){var Le=V.FileIndex[J],We=V.FullPaths[J];if(Le.name=s(We).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||ne,J===0)Le.C=ye.length>1?1:-1,Le.size=0,Le.type=5;else if(We.slice(-1)=="/"){for(Ce=J+1;Ce<ye.length&&r(V.FullPaths[Ce])!=We;++Ce);for(Le.C=Ce>=ye.length?-1:Ce,Ce=J+1;Ce<ye.length&&r(V.FullPaths[Ce])!=r(We);++Ce);Le.R=Ce>=ye.length?-1:Ce,Le.type=1}else r(V.FullPaths[J+1]||"")==r(We)&&(Le.R=J+1),Le.type=2}}}function b(V,X){var G=X||{};if(G.fileType=="mad")return Kn(V,G);switch(x(V),G.fileType){case"zip":return Yl(V,G)}var Y=function(ze){for(var Ve=0,Ge=0,ct=0;ct<ze.FileIndex.length;++ct){var qt=ze.FileIndex[ct];if(qt.content){var Ft=qt.content.length;Ft>0&&(Ft<4096?Ve+=Ft+63>>6:Ge+=Ft+511>>9)}}for(var an=ze.FullPaths.length+3>>2,ni=Ve+7>>3,No=Ve+127>>7,ji=ni+Ge+an+No,As=ji+127>>7,xa=As<=109?0:Math.ceil((As-109)/127);ji+As+xa+127>>7>As;)xa=++As<=109?0:Math.ceil((As-109)/127);var Ur=[1,xa,As,No,an,Ge,Ve,0];return ze.FileIndex[0].size=Ve<<6,Ur[7]=(ze.FileIndex[0].start=Ur[0]+Ur[1]+Ur[2]+Ur[3]+Ur[4]+Ur[5])+(Ur[6]+7>>3),Ur}(V),J=Ie(Y[7]<<9),Z=0,pe=0;{for(Z=0;Z<8;++Z)J.write_shift(1,Q[Z]);for(Z=0;Z<8;++Z)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),Z=0;Z<3;++Z)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,Y[2]),J.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:F),J.write_shift(4,Y[3]),J.write_shift(-4,Y[1]?Y[0]-1:F),J.write_shift(4,Y[1]),Z=0;Z<109;++Z)J.write_shift(-4,Z<Y[2]?Y[1]+Z:-1)}if(Y[1])for(pe=0;pe<Y[1];++pe){for(;Z<236+pe*127;++Z)J.write_shift(-4,Z<Y[2]?Y[1]+Z:-1);J.write_shift(-4,pe===Y[1]-1?F:pe+1)}var Ce=function(ze){for(pe+=ze;Z<pe-1;++Z)J.write_shift(-4,Z+1);ze&&(++Z,J.write_shift(-4,F))};for(pe=Z=0,pe+=Y[1];Z<pe;++Z)J.write_shift(-4,ge.DIFSECT);for(pe+=Y[2];Z<pe;++Z)J.write_shift(-4,ge.FATSECT);Ce(Y[3]),Ce(Y[4]);for(var me=0,ye=0,_e=V.FileIndex[0];me<V.FileIndex.length;++me)_e=V.FileIndex[me],_e.content&&(ye=_e.content.length,!(ye<4096)&&(_e.start=pe,Ce(ye+511>>9)));for(Ce(Y[6]+7>>3);J.l&511;)J.write_shift(-4,ge.ENDOFCHAIN);for(pe=Z=0,me=0;me<V.FileIndex.length;++me)_e=V.FileIndex[me],_e.content&&(ye=_e.content.length,!(!ye||ye>=4096)&&(_e.start=pe,Ce(ye+63>>6)));for(;J.l&511;)J.write_shift(-4,ge.ENDOFCHAIN);for(Z=0;Z<Y[4]<<2;++Z){var Le=V.FullPaths[Z];if(!Le||Le.length===0){for(me=0;me<17;++me)J.write_shift(4,0);for(me=0;me<3;++me)J.write_shift(4,-1);for(me=0;me<12;++me)J.write_shift(4,0);continue}_e=V.FileIndex[Z],Z===0&&(_e.start=_e.size?_e.start-1:F);var We=Z===0&&G.root||_e.name;if(ye=2*(We.length+1),J.write_shift(64,We,"utf16le"),J.write_shift(2,ye),J.write_shift(1,_e.type),J.write_shift(1,_e.color),J.write_shift(-4,_e.L),J.write_shift(-4,_e.R),J.write_shift(-4,_e.C),_e.clsid)J.write_shift(16,_e.clsid,"hex");else for(me=0;me<4;++me)J.write_shift(4,0);J.write_shift(4,_e.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,_e.start),J.write_shift(4,_e.size),J.write_shift(4,0)}for(Z=1;Z<V.FileIndex.length;++Z)if(_e=V.FileIndex[Z],_e.size>=4096)if(J.l=_e.start+1<<9,Ot&&Buffer.isBuffer(_e.content))_e.content.copy(J,J.l,0,_e.size),J.l+=_e.size+511&-512;else{for(me=0;me<_e.size;++me)J.write_shift(1,_e.content[me]);for(;me&511;++me)J.write_shift(1,0)}for(Z=1;Z<V.FileIndex.length;++Z)if(_e=V.FileIndex[Z],_e.size>0&&_e.size<4096)if(Ot&&Buffer.isBuffer(_e.content))_e.content.copy(J,J.l,0,_e.size),J.l+=_e.size+63&-64;else{for(me=0;me<_e.size;++me)J.write_shift(1,_e.content[me]);for(;me&63;++me)J.write_shift(1,0)}if(Ot)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function N(V,X){var G=V.FullPaths.map(function(me){return me.toUpperCase()}),Y=G.map(function(me){var ye=me.split("/");return ye[ye.length-(me.slice(-1)=="/"?2:1)]}),J=!1;X.charCodeAt(0)===47?(J=!0,X=G[0].slice(0,-1)+X):J=X.indexOf("/")!==-1;var Z=X.toUpperCase(),pe=J===!0?G.indexOf(Z):Y.indexOf(Z);if(pe!==-1)return V.FileIndex[pe];var Ce=!Z.match(Id);for(Z=Z.replace(Fc,""),Ce&&(Z=Z.replace(Id,"!")),pe=0;pe<G.length;++pe)if((Ce?G[pe].replace(Id,"!"):G[pe]).replace(Fc,"")==Z||(Ce?Y[pe].replace(Id,"!"):Y[pe]).replace(Fc,"")==Z)return V.FileIndex[pe];return null}var M=64,F=-2,oe="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(V,X,G){u();var Y=b(V,G);l.writeFileSync(X,Y)}function Ee(V){for(var X=new Array(V.length),G=0;G<V.length;++G)X[G]=String.fromCharCode(V[G]);return X.join("")}function Pe(V,X){var G=b(V,X);switch(X&&X.type||"buffer"){case"file":return u(),l.writeFileSync(X.filename,G),G;case"binary":return typeof G=="string"?G:Ee(G);case"base64":return iu(typeof G=="string"?G:Ee(G));case"buffer":if(Ot)return Buffer.isBuffer(G)?G:Vi(G);case"array":return typeof G=="string"?us(G):G}return G}var he;function E(V){try{var X=V.InflateRaw,G=new X;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)he=V;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function T(V,X){if(!he)return Zs(V,X);var G=he.InflateRaw,Y=new G,J=Y._processChunk(V.slice(V.l),Y._finishFlushFlag);return V.l+=Y.bytesRead,J}function U(V){return he?he.deflateRawSync(V):Cn(V)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(V){var X=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(X>>16|X>>8|X)&255}for(var te=typeof Uint8Array<"u",O=te?new Uint8Array(256):[],H=0;H<256;++H)O[H]=ve(H);function I(V,X){var G=O[V&255];return X<=8?G>>>8-X:(G=G<<8|O[V>>8&255],X<=16?G>>>16-X:(G=G<<8|O[V>>16&255],G>>>24-X))}function S(V,X){var G=X&7,Y=X>>>3;return(V[Y]|(G<=6?0:V[Y+1]<<8))>>>G&3}function B(V,X){var G=X&7,Y=X>>>3;return(V[Y]|(G<=5?0:V[Y+1]<<8))>>>G&7}function ie(V,X){var G=X&7,Y=X>>>3;return(V[Y]|(G<=4?0:V[Y+1]<<8))>>>G&15}function ue(V,X){var G=X&7,Y=X>>>3;return(V[Y]|(G<=3?0:V[Y+1]<<8))>>>G&31}function re(V,X){var G=X&7,Y=X>>>3;return(V[Y]|(G<=1?0:V[Y+1]<<8))>>>G&127}function Re(V,X,G){var Y=X&7,J=X>>>3,Z=(1<<G)-1,pe=V[J]>>>Y;return G<8-Y||(pe|=V[J+1]<<8-Y,G<16-Y)||(pe|=V[J+2]<<16-Y,G<24-Y)||(pe|=V[J+3]<<24-Y),pe&Z}function Oe(V,X,G){var Y=X&7,J=X>>>3;return Y<=5?V[J]|=(G&7)<<Y:(V[J]|=G<<Y&255,V[J+1]=(G&7)>>8-Y),X+3}function Me(V,X,G){var Y=X&7,J=X>>>3;return G=(G&1)<<Y,V[J]|=G,X+1}function Se(V,X,G){var Y=X&7,J=X>>>3;return G<<=Y,V[J]|=G&255,G>>>=8,V[J+1]=G,X+8}function et(V,X,G){var Y=X&7,J=X>>>3;return G<<=Y,V[J]|=G&255,G>>>=8,V[J+1]=G&255,V[J+2]=G>>>8,X+16}function qe(V,X){var G=V.length,Y=2*G>X?2*G:X+5,J=0;if(G>=X)return V;if(Ot){var Z=zE(Y);if(V.copy)V.copy(Z);else for(;J<V.length;++J)Z[J]=V[J];return Z}else if(te){var pe=new Uint8Array(Y);if(pe.set)pe.set(V);else for(;J<G;++J)pe[J]=V[J];return pe}return V.length=Y,V}function Qe(V){for(var X=new Array(V),G=0;G<V;++G)X[G]=0;return X}function it(V,X,G){var Y=1,J=0,Z=0,pe=0,Ce=0,me=V.length,ye=te?new Uint16Array(32):Qe(32);for(Z=0;Z<32;++Z)ye[Z]=0;for(Z=me;Z<G;++Z)V[Z]=0;me=V.length;var _e=te?new Uint16Array(me):Qe(me);for(Z=0;Z<me;++Z)ye[J=V[Z]]++,Y<J&&(Y=J),_e[Z]=0;for(ye[0]=0,Z=1;Z<=Y;++Z)ye[Z+16]=Ce=Ce+ye[Z-1]<<1;for(Z=0;Z<me;++Z)Ce=V[Z],Ce!=0&&(_e[Z]=ye[Ce+16]++);var Le=0;for(Z=0;Z<me;++Z)if(Le=V[Z],Le!=0)for(Ce=I(_e[Z],Y)>>Y-Le,pe=(1<<Y+4-Le)-1;pe>=0;--pe)X[Ce|pe<<Le]=Le&15|Z<<4;return Y}var tt=te?new Uint16Array(512):Qe(512),lt=te?new Uint16Array(32):Qe(32);if(!te){for(var yt=0;yt<512;++yt)tt[yt]=0;for(yt=0;yt<32;++yt)lt[yt]=0}(function(){for(var V=[],X=0;X<32;X++)V.push(5);it(V,lt,32);var G=[];for(X=0;X<=143;X++)G.push(8);for(;X<=255;X++)G.push(9);for(;X<=279;X++)G.push(7);for(;X<=287;X++)G.push(8);it(G,tt,288)})();var Nn=function(){for(var X=te?new Uint8Array(32768):[],G=0,Y=0;G<se.length-1;++G)for(;Y<se[G+1];++Y)X[Y]=G;for(;Y<32768;++Y)X[Y]=29;var J=te?new Uint8Array(259):[];for(G=0,Y=0;G<le.length-1;++G)for(;Y<le[G+1];++Y)J[Y]=G;function Z(Ce,me){for(var ye=0;ye<Ce.length;){var _e=Math.min(65535,Ce.length-ye),Le=ye+_e==Ce.length;for(me.write_shift(1,+Le),me.write_shift(2,_e),me.write_shift(2,~_e&65535);_e-- >0;)me[me.l++]=Ce[ye++]}return me.l}function pe(Ce,me){for(var ye=0,_e=0,Le=te?new Uint16Array(32768):[];_e<Ce.length;){var We=Math.min(65535,Ce.length-_e);if(We<10){for(ye=Oe(me,ye,+(_e+We==Ce.length)),ye&7&&(ye+=8-(ye&7)),me.l=ye/8|0,me.write_shift(2,We),me.write_shift(2,~We&65535);We-- >0;)me[me.l++]=Ce[_e++];ye=me.l*8;continue}ye=Oe(me,ye,+(_e+We==Ce.length)+2);for(var ze=0;We-- >0;){var Ve=Ce[_e];ze=(ze<<5^Ve)&32767;var Ge=-1,ct=0;if((Ge=Le[ze])&&(Ge|=_e&-32768,Ge>_e&&(Ge-=32768),Ge<_e))for(;Ce[Ge+ct]==Ce[_e+ct]&&ct<250;)++ct;if(ct>2){Ve=J[ct],Ve<=22?ye=Se(me,ye,O[Ve+1]>>1)-1:(Se(me,ye,3),ye+=5,Se(me,ye,O[Ve-23]>>5),ye+=3);var qt=Ve<8?0:Ve-4>>2;qt>0&&(et(me,ye,ct-le[Ve]),ye+=qt),Ve=X[_e-Ge],ye=Se(me,ye,O[Ve]>>3),ye-=3;var Ft=Ve<4?0:Ve-2>>1;Ft>0&&(et(me,ye,_e-Ge-se[Ve]),ye+=Ft);for(var an=0;an<ct;++an)Le[ze]=_e&32767,ze=(ze<<5^Ce[_e])&32767,++_e;We-=ct-1}else Ve<=143?Ve=Ve+48:ye=Me(me,ye,1),ye=Se(me,ye,O[Ve]),Le[ze]=_e&32767,++_e}ye=Se(me,ye,0)-1}return me.l=(ye+7)/8|0,me.l}return function(me,ye){return me.length<8?Z(me,ye):pe(me,ye)}}();function Cn(V){var X=Ie(50+Math.floor(V.length*1.1)),G=Nn(V,X);return X.slice(0,G)}var yr=te?new Uint16Array(32768):Qe(32768),On=te?new Uint16Array(32768):Qe(32768),is=te?new Uint16Array(128):Qe(128),$i=1,An=1;function Rr(V,X){var G=ue(V,X)+257;X+=5;var Y=ue(V,X)+1;X+=5;var J=ie(V,X)+4;X+=4;for(var Z=0,pe=te?new Uint8Array(19):Qe(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,ye=te?new Uint8Array(8):Qe(8),_e=te?new Uint8Array(8):Qe(8),Le=pe.length,We=0;We<J;++We)pe[ee[We]]=Z=B(V,X),me<Z&&(me=Z),ye[Z]++,X+=3;var ze=0;for(ye[0]=0,We=1;We<=me;++We)_e[We]=ze=ze+ye[We-1]<<1;for(We=0;We<Le;++We)(ze=pe[We])!=0&&(Ce[We]=_e[ze]++);var Ve=0;for(We=0;We<Le;++We)if(Ve=pe[We],Ve!=0){ze=O[Ce[We]]>>8-Ve;for(var Ge=(1<<7-Ve)-1;Ge>=0;--Ge)is[ze|Ge<<Ve]=Ve&7|We<<3}var ct=[];for(me=1;ct.length<G+Y;)switch(ze=is[re(V,X)],X+=ze&7,ze>>>=3){case 16:for(Z=3+S(V,X),X+=2,ze=ct[ct.length-1];Z-- >0;)ct.push(ze);break;case 17:for(Z=3+B(V,X),X+=3;Z-- >0;)ct.push(0);break;case 18:for(Z=11+re(V,X),X+=7;Z-- >0;)ct.push(0);break;default:ct.push(ze),me<ze&&(me=ze);break}var qt=ct.slice(0,G),Ft=ct.slice(G);for(We=G;We<286;++We)qt[We]=0;for(We=Y;We<30;++We)Ft[We]=0;return $i=it(qt,yr,286),An=it(Ft,On,30),X}function Ia(V,X){if(V[0]==3&&!(V[1]&3))return[da(X),2];for(var G=0,Y=0,J=zE(X||1<<18),Z=0,pe=J.length>>>0,Ce=0,me=0;!(Y&1);){if(Y=B(V,G),G+=3,Y>>>1)Y>>1==1?(Ce=9,me=5):(G=Rr(V,G),Ce=$i,me=An);else{G&7&&(G+=8-(G&7));var ye=V[G>>>3]|V[(G>>>3)+1]<<8;if(G+=32,ye>0)for(!X&&pe<Z+ye&&(J=qe(J,Z+ye),pe=J.length);ye-- >0;)J[Z++]=V[G>>>3],G+=8;continue}for(;;){!X&&pe<Z+32767&&(J=qe(J,Z+32767),pe=J.length);var _e=Re(V,G,Ce),Le=Y>>>1==1?tt[_e]:yr[_e];if(G+=Le&15,Le>>>=4,!(Le>>>8&255))J[Z++]=Le;else{if(Le==256)break;Le-=257;var We=Le<8?0:Le-4>>2;We>5&&(We=0);var ze=Z+le[Le];We>0&&(ze+=Re(V,G,We),G+=We),_e=Re(V,G,me),Le=Y>>>1==1?lt[_e]:On[_e],G+=Le&15,Le>>>=4;var Ve=Le<4?0:Le-2>>1,Ge=se[Le];for(Ve>0&&(Ge+=Re(V,G,Ve),G+=Ve),!X&&pe<ze&&(J=qe(J,ze+100),pe=J.length);Z<ze;)J[Z]=J[Z-Ge],++Z}}}return X?[J,G+7>>>3]:[J.slice(0,Z),G+7>>>3]}function Zs(V,X){var G=V.slice(V.l||0),Y=Ia(G,X);return V.l+=Y[1],Y[0]}function Gl(V,X){if(V)typeof console<"u"&&console.error(X);else throw new Error(X)}function zl(V,X){var G=V;jr(G,0);var Y=[],J=[],Z={FileIndex:Y,FullPaths:J};w(Z,{root:X.root});for(var pe=G.length-4;(G[pe]!=80||G[pe+1]!=75||G[pe+2]!=5||G[pe+3]!=6)&&pe>=0;)--pe;G.l=pe+4,G.l+=4;var Ce=G.read_shift(2);G.l+=6;var me=G.read_shift(4);for(G.l=me,pe=0;pe<Ce;++pe){G.l+=20;var ye=G.read_shift(4),_e=G.read_shift(4),Le=G.read_shift(2),We=G.read_shift(2),ze=G.read_shift(2);G.l+=8;var Ve=G.read_shift(4),Ge=a(G.slice(G.l+Le,G.l+Le+We));G.l+=Le+We+ze;var ct=G.l;G.l=Ve+4,Ro(G,ye,_e,Z,Ge),G.l=ct}return Z}function Ro(V,X,G,Y,J){V.l+=2;var Z=V.read_shift(2),pe=V.read_shift(2),Ce=o(V);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var me=V.read_shift(4),ye=V.read_shift(4),_e=V.read_shift(4),Le=V.read_shift(2),We=V.read_shift(2),ze="",Ve=0;Ve<Le;++Ve)ze+=String.fromCharCode(V[V.l++]);if(We){var Ge=a(V.slice(V.l,V.l+We));(Ge[21589]||{}).mt&&(Ce=Ge[21589].mt),((J||{})[21589]||{}).mt&&(Ce=J[21589].mt)}V.l+=We;var ct=V.slice(V.l,V.l+ye);switch(pe){case 8:ct=T(V,_e);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+pe)}var qt=!1;Z&8&&(me=V.read_shift(4),me==134695760&&(me=V.read_shift(4),qt=!0),ye=V.read_shift(4),_e=V.read_shift(4)),ye!=X&&Gl(qt,"Bad compressed size: "+X+" != "+ye),_e!=G&&Gl(qt,"Bad uncompressed size: "+G+" != "+_e),ti(Y,ze,ct,{unsafe:!0,mt:Ce})}function Yl(V,X){var G=X||{},Y=[],J=[],Z=Ie(1),pe=G.compression?8:0,Ce=0,me=0,ye=0,_e=0,Le=0,We=V.FullPaths[0],ze=We,Ve=V.FileIndex[0],Ge=[],ct=0;for(me=1;me<V.FullPaths.length;++me)if(ze=V.FullPaths[me].slice(We.length),Ve=V.FileIndex[me],!(!Ve.size||!Ve.content||ze=="Sh33tJ5")){var qt=_e,Ft=Ie(ze.length);for(ye=0;ye<ze.length;++ye)Ft.write_shift(1,ze.charCodeAt(ye)&127);Ft=Ft.slice(0,Ft.l),Ge[Le]=dG.buf(Ve.content,0);var an=Ve.content;pe==8&&(an=U(an)),Z=Ie(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,Ce),Z.write_shift(2,pe),Ve.mt?i(Z,Ve.mt):Z.write_shift(4,0),Z.write_shift(-4,Ge[Le]),Z.write_shift(4,an.length),Z.write_shift(4,Ve.content.length),Z.write_shift(2,Ft.length),Z.write_shift(2,0),_e+=Z.length,Y.push(Z),_e+=Ft.length,Y.push(Ft),_e+=an.length,Y.push(an),Z=Ie(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,Ce),Z.write_shift(2,pe),Z.write_shift(4,0),Z.write_shift(-4,Ge[Le]),Z.write_shift(4,an.length),Z.write_shift(4,Ve.content.length),Z.write_shift(2,Ft.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,qt),ct+=Z.l,J.push(Z),ct+=Ft.length,J.push(Ft),++Le}return Z=Ie(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,Le),Z.write_shift(2,Le),Z.write_shift(4,ct),Z.write_shift(4,_e),Z.write_shift(2,0),Xn([Xn(Y),Xn(J),Z])}var Hi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ei(V,X){if(V.ctype)return V.ctype;var G=V.name||"",Y=G.match(/\.([^\.]+)$/);return Y&&Hi[Y[1]]||X&&(Y=(G=X).match(/[\.\\]([^\.\\])+$/),Y&&Hi[Y[1]])?Hi[Y[1]]:"application/octet-stream"}function Ku(V){for(var X=iu(V),G=[],Y=0;Y<X.length;Y+=76)G.push(X.slice(Y,Y+76));return G.join(`\r
`)+`\r
`}function Sa(V){var X=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var _e=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(_e.length==1?"0"+_e:_e)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],Y=X.split(`\r
`),J=0;J<Y.length;++J){var Z=Y[J];if(Z.length==0){G.push("");continue}for(var pe=0;pe<Z.length;){var Ce=76,me=Z.slice(pe,pe+Ce);me.charAt(Ce-1)=="="?Ce--:me.charAt(Ce-2)=="="?Ce-=2:me.charAt(Ce-3)=="="&&(Ce-=3),me=Z.slice(pe,pe+Ce),pe+=Ce,pe<Z.length&&(me+="="),G.push(me)}}return G.join(`\r
`)}function qu(V){for(var X=[],G=0;G<V.length;++G){for(var Y=V[G];G<=V.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+V[++G];X.push(Y)}for(var J=0;J<X.length;++J)X[J]=X[J].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return us(X.join(`\r
`))}function ko(V,X,G){for(var Y="",J="",Z="",pe,Ce=0;Ce<10;++Ce){var me=X[Ce];if(!me||me.match(/^\s*$/))break;var ye=me.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":Y=ye[2].trim();break;case"content-type":Z=ye[2].trim();break;case"content-transfer-encoding":J=ye[2].trim();break}}switch(++Ce,J.toLowerCase()){case"base64":pe=us(Fi(X.slice(Ce).join("")));break;case"quoted-printable":pe=qu(X.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var _e=ti(V,Y.slice(G.length),pe,{unsafe:!0});Z&&(_e.ctype=Z)}function Gu(V,X){if(Ee(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=X&&X.root||"",Y=(Ot&&Buffer.isBuffer(V)?V.toString("binary"):Ee(V)).split(`\r
`),J=0,Z="";for(J=0;J<Y.length;++J)if(Z=Y[J],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),G||(G=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),Z.slice(0,G.length)!=G););var pe=(Y[1]||"").match(/boundary="(.*?)"/);if(!pe)throw new Error("MAD cannot find boundary");var Ce="--"+(pe[1]||""),me=[],ye=[],_e={FileIndex:me,FullPaths:ye};w(_e);var Le,We=0;for(J=0;J<Y.length;++J){var ze=Y[J];ze!==Ce&&ze!==Ce+"--"||(We++&&ko(_e,Y.slice(Le,J),G),Le=J)}return _e}function Kn(V,X){var G=X||{},Y=G.boundary||"SheetJS";Y="------="+Y;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],Z=V.FullPaths[0],pe=Z,Ce=V.FileIndex[0],me=1;me<V.FullPaths.length;++me)if(pe=V.FullPaths[me].slice(Z.length),Ce=V.FileIndex[me],!(!Ce.size||!Ce.content||pe=="Sh33tJ5")){pe=pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var ye=Ce.content,_e=Ot&&Buffer.isBuffer(ye)?ye.toString("binary"):Ee(ye),Le=0,We=Math.min(1024,_e.length),ze=0,Ve=0;Ve<=We;++Ve)(ze=_e.charCodeAt(Ve))>=32&&ze<128&&++Le;var Ge=Le>=We*4/5;J.push(Y),J.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+pe),J.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),J.push("Content-Type: "+ei(Ce,pe)),J.push(""),J.push(Ge?Sa(_e):Ku(_e))}return J.push(Y+`--\r
`),J.join(`\r
`)}function zu(V){var X={};return w(X,V),X}function ti(V,X,G,Y){var J=Y&&Y.unsafe;J||w(V);var Z=!J&&Wt.find(V,X);if(!Z){var pe=V.FullPaths[0];X.slice(0,pe.length)==pe?pe=X:(pe.slice(-1)!="/"&&(pe+="/"),pe=(pe+X).replace("//","/")),Z={name:s(X),type:2},V.FileIndex.push(Z),V.FullPaths.push(pe),J||Wt.utils.cfb_gc(V)}return Z.content=G,Z.size=G?G.length:0,Y&&(Y.CLSID&&(Z.clsid=Y.CLSID),Y.mt&&(Z.mt=Y.mt),Y.ct&&(Z.ct=Y.ct)),Z}function Po(V,X){w(V);var G=Wt.find(V,X);if(G){for(var Y=0;Y<V.FileIndex.length;++Y)if(V.FileIndex[Y]==G)return V.FileIndex.splice(Y,1),V.FullPaths.splice(Y,1),!0}return!1}function dp(V,X,G){w(V);var Y=Wt.find(V,X);if(Y){for(var J=0;J<V.FileIndex.length;++J)if(V.FileIndex[J]==Y)return V.FileIndex[J].name=s(G),V.FullPaths[J]=G,!0}return!1}function hp(V){x(V,!0)}return e.find=N,e.read=z,e.parse=d,e.write=Pe,e.writeFile=xe,e.utils={cfb_new:zu,cfb_add:ti,cfb_del:Po,cfb_mov:dp,cfb_gc:hp,ReadShift:Uc,CheckField:Pb,prep_blob:jr,bconcat:Xn,use_zlib:E,_deflateRaw:Cn,_inflateRaw:Zs,consts:ge},e}();function hG(n){return typeof n=="string"?rp(n):Array.isArray(n)?Uq(n):n}function Vu(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=rp(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?au(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var s=new Blob([hG(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,n);if(typeof saveAs<"u")return saveAs(s,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:n,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=n,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(n);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=Bu(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function nr(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function nT(n,e){for(var t=[],r=nr(n),s=0;s!==r.length;++s)t[n[r[s]][e]]==null&&(t[n[r[s]][e]]=r[s]);return t}function Mv(n){for(var e=[],t=nr(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function op(n){for(var e=[],t=nr(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function fG(n){for(var e=[],t=nr(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var Bh=new Date(1899,11,30,0,0,0);function Fr(n,e){var t=n.getTime(),r=Bh.getTime()+(n.getTimezoneOffset()-Bh.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var pb=new Date,pG=Bh.getTime()+(pb.getTimezoneOffset()-Bh.getTimezoneOffset())*6e4,rT=pb.getTimezoneOffset();function mb(n){var e=new Date;return e.setTime(n*24*60*60*1e3+pG),e.getTimezoneOffset()!==rT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-rT)*6e4),e}var sT=new Date("2017-02-19T19:06:09.000Z"),gb=isNaN(sT.getFullYear())?new Date("2/19/17"):sT,mG=gb.getFullYear()==2017;function br(n,e){var t=new Date(n);if(mG)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(gb.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var s=n.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return n.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ap(n,e){if(Ot&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var r=[],s=0;s!=n.length;++s)r.push(String.fromCharCode(n[s]));return r.join("")}function Lr(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Lr(n[t]));return e}function hn(n,e){for(var t="";t.length<e;)t+=n;return t}function Si(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,i){return t=-t,i}),!isNaN(e=Number(r)))?e/t:e}var gG=["january","february","march","april","may","june","july","august","september","october","november","december"];function ou(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return t;var o=n.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&gG.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return r<0||r>8099?t:(s>0||i>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function Et(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Ot?r=Vi(t):r=Bq(t),Wt.utils.cfb_add(n,e,r)}Wt.utils.cfb_add(n,e,t)}else n.file(e,t)}function Fv(){return Wt.utils.cfb_new()}var Pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,vG={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lv=Mv(vG),Uv=/[&<>'"]/g,yG=/[\u0000-\u0008\u000b-\u001f]/g;function $t(n){var e=n+"";return e.replace(Uv,function(t){return Lv[t]}).replace(yG,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function iT(n){return $t(n).replace(/ /g,"_x0020_")}var vb=/[\u0000-\u001f]/g;function _G(n){var e=n+"";return e.replace(Uv,function(t){return Lv[t]}).replace(/\n/g,"<br/>").replace(vb,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function EG(n){var e=n+"";return e.replace(Uv,function(t){return Lv[t]}).replace(vb,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function TG(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function wG(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function em(n){for(var e="",t=0,r=0,s=0,i=0,o=0,a=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(s=n.charCodeAt(t++),r>191&&r<224){o=(r&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(i=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(s&63)<<6|i&63);continue}o=n.charCodeAt(t++),a=((r&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function oT(n){var e=da(2*n.length),t,r,s=1,i=0,o=0,a;for(r=0;r<n.length;r+=s)s=1,(a=n.charCodeAt(r))<128?t=a:a<224?(t=(a&31)*64+(n.charCodeAt(r+1)&63),s=2):a<240?(t=(a&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),s=3):(s=4,t=(a&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=t%256,e[i++]=t>>>8;return e.slice(0,i).toString("ucs2")}function aT(n){return Vi(n,"binary").toString("utf8")}var xd="foo bar baz",Lc=Ot&&(aT(xd)==em(xd)&&aT||oT(xd)==em(xd)&&oT)||em,au=Ot?function(n){return Vi(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,s=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},CG=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<n.length;++s)r=r.replace(n[s][0],n[s][1]);return r}}(),yb=/(^\s|\s$|\n)/;function Jn(n,e){return"<"+n+(e.match(yb)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function lu(n){return nr(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function $e(n,e,t){return"<"+n+(t!=null?lu(t):"")+(e!=null?(e.match(yb)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function y0(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function AG(n,e){switch(typeof n){case"string":var t=$e("vt:lpwstr",$t(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return $e((n|0)==n?"vt:i4":"vt:r8",$t(String(n)));case"boolean":return $e("vt:bool",n?"true":"false")}if(n instanceof Date)return $e("vt:filetime",y0(n));throw new Error("Unable to serialize "+n)}var $n={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},jl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IG(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),s=n[e+6]&15,i=5;i>=0;--i)s=s*256+n[e+i];return r==2047?s==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),t*Math.pow(2,r-52)*s)}function SG(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,o=r?-e:e;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var a=0;a<=5;++a,i/=256)n[t+a]=i&255;n[t+6]=(s&15)<<4|i&15,n[t+7]=s>>4|r}var lT=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var s=0,i=n[0][r].length;s<i;s+=t)e.push.apply(e,n[0][r].slice(s,s+t));return e},cT=Ot?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Vi(e)})):lT(n)}:lT,uT=function(n,e,t){for(var r=[],s=e;s<t;s+=2)r.push(String.fromCharCode(gc(n,s)));return r.join("").replace(Fc,"")},Bv=Ot?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Fc,""):uT(n,e,t)}:uT,dT=function(n,e,t){for(var r=[],s=e;s<e+t;++s)r.push(("0"+n[s].toString(16)).slice(-2));return r.join("")},_b=Ot?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):dT(n,e,t)}:dT,hT=function(n,e,t){for(var r=[],s=e;s<t;s++)r.push(String.fromCharCode(Ga(n,s)));return r.join("")},$u=Ot?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):hT(e,t,r)}:hT,Eb=function(n,e){var t=qr(n,e);return t>0?$u(n,e+4,e+4+t-1):""},Tb=Eb,wb=function(n,e){var t=qr(n,e);return t>0?$u(n,e+4,e+4+t-1):""},Cb=wb,Ab=function(n,e){var t=2*qr(n,e);return t>0?$u(n,e+4,e+4+t-1):""},Ib=Ab,Sb=function(e,t){var r=qr(e,t);return r>0?Bv(e,t+4,t+4+r):""},xb=Sb,bb=function(n,e){var t=qr(n,e);return t>0?$u(n,e+4,e+4+t):""},Rb=bb,kb=function(n,e){return IG(n,e)},Vh=kb,Vv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ot&&(Tb=function(e,t){if(!Buffer.isBuffer(e))return Eb(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Cb=function(e,t){if(!Buffer.isBuffer(e))return wb(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Ib=function(e,t){if(!Buffer.isBuffer(e))return Ab(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},xb=function(e,t){if(!Buffer.isBuffer(e))return Sb(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Rb=function(e,t){if(!Buffer.isBuffer(e))return bb(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Vh=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):kb(e,t)},Vv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ga=function(n,e){return n[e]},gc=function(n,e){return n[e+1]*256+n[e]},xG=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},qr=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Bo=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},bG=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Uc(n,e){var t="",r,s,i=[],o,a,l,u;switch(e){case"dbcs":if(u=this.l,Ot&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(gc(this,u)),u+=2;n*=2;break;case"utf8":t=$u(this,this.l,this.l+n);break;case"utf16le":n*=2,t=Bv(this,this.l,this.l+n);break;case"wstr":return Uc.call(this,n,"dbcs");case"lpstr-ansi":t=Tb(this,this.l),n=4+qr(this,this.l);break;case"lpstr-cp":t=Cb(this,this.l),n=4+qr(this,this.l);break;case"lpwstr":t=Ib(this,this.l),n=4+2*qr(this,this.l);break;case"lpp4":n=4+qr(this,this.l),t=xb(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+qr(this,this.l),t=Rb(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(o=Ga(this,this.l+n++))!==0;)i.push(Ad(o));t=i.join("");break;case"_wstr":for(n=0,t="";(o=gc(this,this.l+n))!==0;)i.push(Ad(o)),n+=2;n+=2,t=i.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ga(this,u),this.l=u+1,a=Uc.call(this,n-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+a;i.push(Ad(gc(this,u))),u+=2}t=i.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ga(this,u),this.l=u+1,a=Uc.call(this,n-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+a;i.push(Ad(Ga(this,u))),u+=1}t=i.join("");break;default:switch(n){case 1:return r=Ga(this,this.l),this.l++,r;case 2:return r=(e==="i"?xG:gc)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(r=(n>0?Bo:bG)(this,this.l),this.l+=4,r):(s=qr(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return n==8?s=Vh(this,this.l):s=Vh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;n=8;case 16:t=_b(this,this.l,n);break}}return this.l+=n,t}var RG=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},kG=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},PG=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function NG(n,e,t){var r=0,s=0;if(t==="dbcs"){for(s=0;s!=e.length;++s)PG(this,e.charCodeAt(s),this.l+2*s);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;r=e.length}else if(t==="hex"){for(;s<n;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+n,this.length);for(s=0;s<Math.min(e.length,n);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,RG(this,e,this.l);break;case 8:if(r=8,t==="f"){SG(this,e,this.l);break}case 16:break;case-4:r=4,kG(this,e,this.l);break}return this.l+=r,this}function Pb(n,e){var t=_b(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function jr(n,e){n.l=e,n.read_shift=Uc,n.chk=Pb,n.write_shift=NG}function Qs(n,e){n.l+=e}function Ie(n){var e=da(n);return jr(e,0),e}function Mr(){var n=[],e=Ot?256:2048,t=function(u){var d=Ie(u);return jr(d,0),d},r=t(e),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},i=function(u){return r&&u<r.length-r.l?r:(s(),r=t(Math.max(u+1,e)))},o=function(){return s(),Xn(n)},a=function(u){s(),r=u,r.l==null&&(r.l=r.length),i(e)};return{next:i,push:a,end:o,_bufs:n}}function De(n,e,t,r){var s=+e,i;if(!isNaN(s)){r||(r=IZ[s].p||(t||[]).length||0),i=1+(s>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var o=n.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Vv(t)&&n.push(t)}}function Bc(n,e,t){var r=Lr(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function fT(n,e,t){var r=Lr(n);return r.s=Bc(r.s,e.s,t),r.e=Bc(r.e,e.s,t),r}function Vc(n,e){if(n.cRel&&n.c<0)for(n=Lr(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Lr(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=jt(n);return!n.cRel&&n.cRel!=null&&(t=MG(t)),!n.rRel&&n.rRel!=null&&(t=OG(t)),t}function tm(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+pr(n.s.c)+":"+(n.e.cRel?"":"$")+pr(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+tr(n.s.r)+":"+(n.e.rRel?"":"$")+tr(n.e.r):Vc(n.s,e.biff)+":"+Vc(n.e,e.biff)}function $v(n){return parseInt(DG(n),10)-1}function tr(n){return""+(n+1)}function OG(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function DG(n){return n.replace(/\$(\d+)$/,"$1")}function Hv(n){for(var e=FG(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function pr(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function MG(n){return n.replace(/^([A-Z])/,"$$$1")}function FG(n){return n.replace(/^\$([A-Z])/,"$1")}function LG(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hn(n){for(var e=0,t=0,r=0;r<n.length;++r){var s=n.charCodeAt(r);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:e-1}}function jt(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Jr(n){var e=n.indexOf(":");return e==-1?{s:Hn(n),e:Hn(n)}:{s:Hn(n.slice(0,e)),e:Hn(n.slice(e+1))}}function Rn(n,e){return typeof e>"u"||typeof e=="number"?Rn(n.s,n.e):(typeof n!="string"&&(n=jt(n)),typeof e!="string"&&(e=jt(e)),n==e?n:n+":"+e)}function on(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,s=0,i=n.length;for(t=0;r<i&&!((s=n.charCodeAt(r)-64)<1||s>26);++r)t=26*t+s;for(e.s.c=--t,t=0;r<i&&!((s=n.charCodeAt(r)-48)<0||s>9);++r)t=10*t+s;if(e.s.r=--t,r===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=i&&!((s=n.charCodeAt(r)-64)<1||s>26);++r)t=26*t+s;for(e.e.c=--t,t=0;r!=i&&!((s=n.charCodeAt(r)-48)<0||s>9);++r)t=10*t+s;return e.e.r=--t,e}function pT(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=wo(n.z,t?Fr(e):e)}catch{}try{return n.w=wo((n.XF||{}).numFmtId||(t?14:0),t?Fr(e):e)}catch{return""+e}}function Li(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?Hu[n.v]||n.v:e==null?pT(n,n.v):pT(n,e))}function Ea(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function Nb(n,e,t){var r=t||{},s=n?Array.isArray(n):r.dense,i=n||(s?[]:{}),o=0,a=0;if(i&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?Hn(r.origin):r.origin;o=l.r,a=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=on(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[f].length;++p)if(!(typeof e[f][p]>"u")){var m={v:e[f][p]},g=o+f,v=a+p;if(u.s.r>g&&(u.s.r=g),u.s.c>v&&(u.s.c=v),u.e.r<g&&(u.e.r=g),u.e.c<v&&(u.e.c=v),e[f][p]&&typeof e[f][p]=="object"&&!Array.isArray(e[f][p])&&!(e[f][p]instanceof Date))m=e[f][p];else if(Array.isArray(m.v)&&(m.f=e[f][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(r.nullError)m.t="e",m.v=0;else if(r.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=r.dateNF||mn[14],r.cellDates?(m.t="d",m.w=wo(m.z,Fr(m.v))):(m.t="n",m.v=Fr(m.v),m.w=wo(m.z,m.v))):m.t="s";if(s)i[g]||(i[g]=[]),i[g][v]&&i[g][v].z&&(m.z=i[g][v].z),i[g][v]=m;else{var y=jt({c:v,r:g});i[y]&&i[y].z&&(m.z=i[y].z),i[y]=m}}}return u.s.c<1e7&&(i["!ref"]=Rn(u)),i}function Wl(n,e){return Nb(null,n,e)}function UG(n){return n.read_shift(4,"i")}function ys(n,e){return e||(e=Ie(4)),e.write_shift(4,n),e}function mr(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function jn(n,e){var t=!1;return e==null&&(t=!0,e=Ie(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function BG(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function VG(n,e){return e||(e=Ie(4)),e.write_shift(2,0),e.write_shift(2,0),e}function jv(n,e){var t=n.l,r=n.read_shift(1),s=mr(n),i=[],o={t:s,h:s};if(r&1){for(var a=n.read_shift(4),l=0;l!=a;++l)i.push(BG(n));o.r=i}else o.r=[{ich:0,ifnt:0}];return n.l=t+e,o}function $G(n,e){var t=!1;return e==null&&(t=!0,e=Ie(15+4*n.t.length)),e.write_shift(1,0),jn(n.t,e),t?e.slice(0,e.l):e}var HG=jv;function jG(n,e){var t=!1;return e==null&&(t=!0,e=Ie(23+4*n.t.length)),e.write_shift(1,1),jn(n.t,e),e.write_shift(4,1),VG({},e),t?e.slice(0,e.l):e}function ss(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Ta(n,e){return e==null&&(e=Ie(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function wa(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Ca(n,e){return e==null&&(e=Ie(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var WG=mr,Ob=jn;function Wv(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function $h(n,e){var t=!1;return e==null&&(t=!0,e=Ie(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var KG=mr,_0=Wv,Kv=$h;function Db(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var s=r===0?Vh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Bo(e,0)>>2;return t?s/100:s}function Mb(n,e){e==null&&(e=Ie(4));var t=0,r=0,s=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?s:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function Fb(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function qG(n,e){return e||(e=Ie(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Aa=Fb,Kl=qG;function ql(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function ha(n,e){return(e||Ie(8)).write_shift(8,n,"f")}function GG(n){var e={},t=n.read_shift(1),r=t>>>1,s=n.read_shift(1),i=n.read_shift(2,"i"),o=n.read_shift(1),a=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=s;var u=nz[s];u&&(e.rgb=IT(u));break;case 2:e.rgb=IT([o,a,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Hh(n,e){if(e||(e=Ie(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function zG(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function YG(n,e){e||(e=Ie(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var Lb=2,Hr=3,bd=11,jh=19,Rd=64,QG=65,XG=71,JG=4108,ZG=4126,Yn=80,mT={1:{n:"CodePage",t:Lb},2:{n:"Category",t:Yn},3:{n:"PresentationFormat",t:Yn},4:{n:"ByteCount",t:Hr},5:{n:"LineCount",t:Hr},6:{n:"ParagraphCount",t:Hr},7:{n:"SlideCount",t:Hr},8:{n:"NoteCount",t:Hr},9:{n:"HiddenCount",t:Hr},10:{n:"MultimediaClipCount",t:Hr},11:{n:"ScaleCrop",t:bd},12:{n:"HeadingPairs",t:JG},13:{n:"TitlesOfParts",t:ZG},14:{n:"Manager",t:Yn},15:{n:"Company",t:Yn},16:{n:"LinksUpToDate",t:bd},17:{n:"CharacterCount",t:Hr},19:{n:"SharedDoc",t:bd},22:{n:"HyperlinksChanged",t:bd},23:{n:"AppVersion",t:Hr,p:"version"},24:{n:"DigSig",t:QG},26:{n:"ContentType",t:Yn},27:{n:"ContentStatus",t:Yn},28:{n:"Language",t:Yn},29:{n:"Version",t:Yn},255:{},2147483648:{n:"Locale",t:jh},2147483651:{n:"Behavior",t:jh},1919054434:{}},gT={1:{n:"CodePage",t:Lb},2:{n:"Title",t:Yn},3:{n:"Subject",t:Yn},4:{n:"Author",t:Yn},5:{n:"Keywords",t:Yn},6:{n:"Comments",t:Yn},7:{n:"Template",t:Yn},8:{n:"LastAuthor",t:Yn},9:{n:"RevNumber",t:Yn},10:{n:"EditTime",t:Rd},11:{n:"LastPrinted",t:Rd},12:{n:"CreatedDate",t:Rd},13:{n:"ModifiedDate",t:Rd},14:{n:"PageCount",t:Hr},15:{n:"WordCount",t:Hr},16:{n:"CharCount",t:Hr},17:{n:"Thumbnail",t:XG},18:{n:"Application",t:Yn},19:{n:"DocSecurity",t:Hr},255:{},2147483648:{n:"Locale",t:jh},2147483651:{n:"Behavior",t:jh},1919054434:{}};function ez(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var tz=ez([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),nz=Lr(tz),Hu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rz={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},kd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ub(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bb(n,e){var t=fG(rz),r=[],s;r[r.length]=Pn,r[r.length]=$e("Types",null,{xmlns:$n.CT,"xmlns:xsd":$n.xsd,"xmlns:xsi":$n.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return $e("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){n[l]&&n[l].length>0&&(s=n[l][0],r[r.length]=$e("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:kd[l][e.bookType]||kd[l].xlsx}))},o=function(l){(n[l]||[]).forEach(function(u){r[r.length]=$e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:kd[l][e.bookType]||kd[l].xlsx})})},a=function(l){(n[l]||[]).forEach(function(u){r[r.length]=$e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[l][0]})})};return i("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Pt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vb(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function dl(n){var e=[Pn,$e("Relationships",null,{xmlns:$n.RELS})];return nr(n["!id"]).forEach(function(t){e[e.length]=$e("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Vt(n,e,t,r,s,i){if(s||(s={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,s.Id="rId"+e,s.Type=r,s.Target=t,[Pt.HLINK,Pt.XPATH,Pt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),n["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][s.Id]=s,n[("/"+s.Target).replace("//","/")]=s,e}function sz(n){var e=[Pn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function vT(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function iz(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function oz(n){var e=[Pn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(vT(n[t][0],n[t][1])),e.push(iz("",n[t][0]));return e.push(vT("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function $b(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Dh.version+"</meta:generator></office:meta></office:document-meta>"}var Qo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function nm(n,e,t,r,s){s[n]!=null||e==null||e===""||(s[n]=e,e=$t(e),r[r.length]=t?$e(n,e,t):Jn(n,e))}function Hb(n,e){var t=e||{},r=[Pn,$e("cp:coreProperties",null,{"xmlns:cp":$n.CORE_PROPS,"xmlns:dc":$n.dc,"xmlns:dcterms":$n.dcterms,"xmlns:dcmitype":$n.dcmitype,"xmlns:xsi":$n.xsi})],s={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&nm("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:y0(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),n.ModifiedDate!=null&&nm("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:y0(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var i=0;i!=Qo.length;++i){var o=Qo[i],a=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:n?n[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&nm(o[0],a,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var hl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Wb(n){var e=[],t=$e;return n||(n={}),n.Application="SheetJS",e[e.length]=Pn,e[e.length]=$e("Properties",null,{xmlns:$n.EXT_PROPS,"xmlns:vt":$n.vt}),hl.forEach(function(r){if(n[r[1]]!==void 0){var s;switch(r[2]){case"string":s=$t(String(n[r[1]]));break;case"bool":s=n[r[1]]?"true":"false";break}s!==void 0&&(e[e.length]=t(r[0],s))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+$t(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Kb(n){var e=[Pn,$e("Properties",null,{xmlns:$n.CUST_PROPS,"xmlns:vt":$n.vt})];if(!n)return e.join("");var t=1;return nr(n).forEach(function(s){++t,e[e.length]=$e("property",AG(n[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:$t(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function az(n,e){var t=[];return nr(yT).map(function(r){for(var s=0;s<Qo.length;++s)if(Qo[s][1]==r)return Qo[s];for(s=0;s<hl.length;++s)if(hl[s][1]==r)return hl[s];throw r}).forEach(function(r){if(n[r[1]]!=null){var s=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(Jn(yT[r[1]]||r[1],s))}}),$e("DocumentProperties",t.join(""),{xmlns:Kr.o})}function lz(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return n&&nr(n).forEach(function(i){if(Object.prototype.hasOwnProperty.call(n,i)){for(var o=0;o<Qo.length;++o)if(i==Qo[o][1])return;for(o=0;o<hl.length;++o)if(i==hl[o][1])return;for(o=0;o<t.length;++o)if(i==t[o])return;var a=n[i],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),s.push($e(iT(i),a,{"dt:dt":l}))}}),e&&nr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(n&&Object.prototype.hasOwnProperty.call(n,i))){var o=e[i],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),s.push($e(iT(i),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+Kr.o+'">'+s.join("")+"</"+r+">"}function cz(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),s=(t-r)/Math.pow(2,32);r*=1e7,s*=1e7;var i=r/Math.pow(2,32)|0;i>0&&(r=r%Math.pow(2,32),s+=i);var o=Ie(8);return o.write_shift(4,r),o.write_shift(4,s),o}function _T(n,e){var t=Ie(4),r=Ie(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Ie(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=cz(e);break;case 31:case 80:for(r=Ie(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Xn([t,r])}var qb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uz(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function ET(n,e,t){var r=Ie(8),s=[],i=[],o=8,a=0,l=Ie(8),u=Ie(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),i.push(l),s.push(u),o+=8+l.length,!e){u=Ie(8),u.write_shift(4,0),s.unshift(u);var d=[Ie(4)];for(d[0].write_shift(4,n.length),a=0;a<n.length;++a){var f=n[a][0];for(l=Ie(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Xn(d),i.unshift(l),o+=8+l.length}for(a=0;a<n.length;++a)if(!(e&&!e[n[a][0]])&&!(qb.indexOf(n[a][0])>-1||jb.indexOf(n[a][0])>-1)&&n[a][1]!=null){var p=n[a][1],m=0;if(e){m=+e[n[a][0]];var g=t[m];if(g.p=="version"&&typeof p=="string"){var v=p.split(".");p=(+v[0]<<16)+(+v[1]||0)}l=_T(g.t,p)}else{var y=uz(p);y==-1&&(y=31,p=String(p)),l=_T(y,p)}i.push(l),u=Ie(8),u.write_shift(4,e?m:2+a),s.push(u),o+=8+l.length}var L=8*(i.length+1);for(a=0;a<i.length;++a)s[a].write_shift(4,L),L+=i[a].length;return r.write_shift(4,o),r.write_shift(4,i.length),Xn([r].concat(s).concat(i))}function TT(n,e,t,r,s,i){var o=Ie(s?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Wt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var l=ET(n,t,r);if(a.push(l),s){var u=ET(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+l.length),a.push(u)}return Xn(a)}function dz(n,e){e||(e=Ie(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function hz(n,e){return n.read_shift(e)===1}function Ar(n,e){return e||(e=Ie(2)),e.write_shift(2,+!!n),e}function Gb(n){return n.read_shift(2,"u")}function ts(n,e){return e||(e=Ie(2)),e.write_shift(2,n),e}function zb(n,e,t){return t||(t=Ie(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function Yb(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=n.read_shift(1);i&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var o=r?n.read_shift(r,s):"";return o}function fz(n){var e=n.t||"",t=Ie(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Ie(2*e.length);r.write_shift(2*e.length,e,"utf16le");var s=[t,r];return Xn(s)}function pz(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var s=n.read_shift(1);return s===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function mz(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):pz(n,r,t)}function gz(n,e,t){if(t.biff>5)return mz(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function Qb(n,e,t){return t||(t=Ie(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function wT(n,e){e||(e=Ie(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function vz(n){var e=Ie(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var s=r.indexOf("#"),i=s>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)e.write_shift(4,o[t]);if(i==28)r=r.slice(1),wT(r,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));var a=s>-1?r.slice(0,s):r;for(e.write_shift(4,2*(a.length+1)),t=0;t<a.length;++t)e.write_shift(2,a.charCodeAt(t));e.write_shift(2,0),i&8&&wT(s>-1?r.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function fa(n,e,t,r){return r||(r=Ie(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function yz(n,e,t){var r=t.biff>8?4:2,s=n.read_shift(r),i=n.read_shift(r,"i"),o=n.read_shift(r,"i");return[s,i,o]}function _z(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),s=n.read_shift(2);return{s:{c:r,r:e},e:{c:s,r:t}}}function Xb(n,e){return e||(e=Ie(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function qv(n,e,t){var r=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ie(s);return i.write_shift(2,r),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Ez(n,e){var t=!e||e.biff==8,r=Ie(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function Tz(n,e){var t=!e||e.biff>=8?2:1,r=Ie(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function wz(n,e){var t=Ie(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],s=0;s<n.length;++s)r[s]=fz(n[s]);var i=Xn([t].concat(r));return i.parts=[t.length].concat(r.map(function(o){return o.length})),i}function Cz(){var n=Ie(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Az(n){var e=Ie(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Iz(n,e){var t=n.name||"Arial",r=e&&e.biff==5,s=r?15+t.length:16+2*t.length,i=Ie(s);return i.write_shift(2,n.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),i}function Sz(n,e,t,r){var s=Ie(10);return fa(n,e,r,s),s.write_shift(4,t),s}function xz(n,e,t,r,s){var i=!s||s.biff==8,o=Ie(8+ +i+(1+i)*t.length);return fa(n,e,r,o),o.write_shift(2,t.length),i&&o.write_shift(1,1),o.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),o}function bz(n,e,t,r){var s=t&&t.biff==5;r||(r=Ie(s?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(s?1:2,e.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return i.l==null&&(i.l=i.length),i}function Rz(n,e){var t=e.biff==8||!e.biff?4:2,r=Ie(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function CT(n,e,t,r){var s=t&&t.biff==5;r||(r=Ie(s?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var i=0;return n.numFmtId>0&&s&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function kz(n){var e=Ie(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Pz(n,e,t,r,s,i){var o=Ie(8);return fa(n,e,r,o),zb(t,i,o),o}function Nz(n,e,t,r){var s=Ie(14);return fa(n,e,r,s),ha(t,s),s}function Oz(n,e,t){if(t.biff<8)return Dz(n,e,t);for(var r=[],s=n.l+e,i=n.read_shift(t.biff>8?4:2);i--!==0;)r.push(yz(n,t.biff>8?12:6,t));if(n.l!=s)throw new Error("Bad ExternSheet: "+n.l+" != "+s);return r}function Dz(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=Yb(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function Mz(n){var e=Ie(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)Xb(n[t],e);return e}function Fz(n){var e=Ie(24),t=Hn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(r[s],16));return Xn([e,vz(n[1])])}function Lz(n){var e=n[1].Tooltip,t=Ie(10+2*(e.length+1));t.write_shift(2,2048);var r=Hn(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s=0;s<e.length;++s)t.write_shift(2,e.charCodeAt(s));return t.write_shift(2,0),t}function Uz(n){return n||(n=Ie(4)),n.write_shift(2,1),n.write_shift(2,1),n}function Bz(n,e,t){if(!t.cellStyles)return Qs(n,e);var r=t&&t.biff>=12?4:2,s=n.read_shift(r),i=n.read_shift(r),o=n.read_shift(r),a=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var u={s,e:i,w:o,ixfe:a,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function Vz(n,e){var t=Ie(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function $z(n){for(var e=Ie(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function Hz(n,e,t){var r=Ie(15);return Wu(r,n,e),r.write_shift(8,t,"f"),r}function jz(n,e,t){var r=Ie(9);return Wu(r,n,e),r.write_shift(2,t),r}var Wz=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Mv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(a,l){var u=[],d=da(1);switch(l.type){case"base64":d=us(Fi(a));break;case"binary":d=us(a);break;case"buffer":case"array":d=a;break}jr(d,0);var f=d.read_shift(1),p=!!(f&136),m=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,y=521;f==2&&(v=d.read_shift(2)),d.l+=3,f!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(y=d.read_shift(2));var L=d.read_shift(2),D=l.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(D=n[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var A=[],C={},j=Math.min(d.length,f==2?521:y-10-(m?264:0)),z=g?32:11;d.l<j&&d[d.l]!=13;)switch(C={},C.name=Mh.utils.decode(D,d.slice(d.l,d.l+z)).replace(/[\u0000\r\n].*$/g,""),d.l+=z,C.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(C.offset=d.read_shift(4)),C.len=d.read_shift(1),f==2&&(C.offset=d.read_shift(2)),C.dec=d.read_shift(1),C.name.length&&A.push(C),f!=2&&(d.l+=g?13:14),C.type){case"B":(!m||C.len!=8)&&l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var w=0,R=0;for(u[0]=[],R=0;R!=A.length;++R)u[0][R]=A[R].name;for(;v-- >0;){if(d[d.l]===42){d.l+=L;continue}for(++d.l,u[++w]=[],R=0,R=0;R!=A.length;++R){var x=d.slice(d.l,d.l+A[R].len);d.l+=A[R].len,jr(x,0);var b=Mh.utils.decode(D,x);switch(A[R].type){case"C":b.trim().length&&(u[w][R]=b.replace(/\s+$/,""));break;case"D":b.length===8?u[w][R]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):u[w][R]=b;break;case"F":u[w][R]=parseFloat(b.trim());break;case"+":case"I":u[w][R]=g?x.read_shift(-4,"i")^2147483648:x.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":u[w][R]=!0;break;case"N":case"F":u[w][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[w][R]="##MEMO##"+(g?parseInt(b.trim(),10):x.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(u[w][R]=+b||0);break;case"@":u[w][R]=new Date(x.read_shift(-8,"f")-621356832e5);break;case"T":u[w][R]=new Date((x.read_shift(4)-2440588)*864e5+x.read_shift(4));break;case"Y":u[w][R]=x.read_shift(4,"i")/1e4+x.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][R]=-x.read_shift(-8,"f");break;case"B":if(m&&A[R].len==8){u[w][R]=x.read_shift(8,"f");break}case"G":case"P":x.l+=A[R].len;break;case"0":if(A[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[R].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=A,u}function r(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Wl(t(a,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(a,l){try{return Ea(r(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&su(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Mr(),f=zh(a,{header:1,raw:!0,cellDates:!0}),p=f[0],m=f.slice(1),g=a["!cols"]||[],v=0,y=0,L=0,D=1;for(v=0;v<p.length;++v){if(((g[v]||{}).DBF||{}).name){p[v]=g[v].DBF.name,++L;continue}if(p[v]!=null){if(++L,typeof p[v]=="number"&&(p[v]=p[v].toString(10)),typeof p[v]!="string")throw new Error("DBF Invalid column name "+p[v]+" |"+typeof p[v]+"|");if(p.indexOf(p[v])!==v){for(y=0;y<1024;++y)if(p.indexOf(p[v]+"_"+y)==-1){p[v]+="_"+y;break}}}}var A=on(a["!ref"]),C=[],j=[],z=[];for(v=0;v<=A.e.c-A.s.c;++v){var w="",R="",x=0,b=[];for(y=0;y<m.length;++y)m[y][v]!=null&&b.push(m[y][v]);if(b.length==0||p[v]==null){C[v]="?";continue}for(y=0;y<b.length;++y){switch(typeof b[y]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=b[y]instanceof Date?"D":"C";break;default:R="C"}x=Math.max(x,String(b[y]).length),w=w&&w!=R?"C":R}x>250&&(x=250),R=((g[v]||{}).DBF||{}).type,R=="C"&&g[v].DBF.len>x&&(x=g[v].DBF.len),w=="B"&&R=="N"&&(w="N",z[v]=g[v].DBF.dec,x=g[v].DBF.len),j[v]=w=="C"||R=="N"?x:i[w]||0,D+=j[v],C[v]=w}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,m.length),N.write_shift(2,296+32*L),N.write_shift(2,D),v=0;v<4;++v)N.write_shift(4,0);for(N.write_shift(4,0|(+e[Zx]||3)<<8),v=0,y=0;v<p.length;++v)if(p[v]!=null){var M=d.next(32),F=(p[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,F,"sbcs"),M.write_shift(1,C[v]=="?"?"C":C[v],"sbcs"),M.write_shift(4,y),M.write_shift(1,j[v]||i[C[v]]||0),M.write_shift(1,z[v]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),y+=j[v]||i[C[v]]||0}var oe=d.next(264);for(oe.write_shift(4,13),v=0;v<65;++v)oe.write_shift(4,0);for(v=0;v<m.length;++v){var Q=d.next(D);for(Q.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(C[y]){case"L":Q.write_shift(1,m[v][y]==null?63:m[v][y]?84:70);break;case"B":Q.write_shift(8,m[v][y]||0,"f");break;case"N":var ne="0";for(typeof m[v][y]=="number"&&(ne=m[v][y].toFixed(z[y]||0)),L=0;L<j[y]-ne.length;++L)Q.write_shift(1,32);Q.write_shift(1,ne,"sbcs");break;case"D":m[v][y]?(Q.write_shift(4,("0000"+m[v][y].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(m[v][y].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+m[v][y].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(m[v][y]!=null?m[v][y]:"").slice(0,j[y]);for(Q.write_shift(1,ge,"sbcs"),L=0;L<j[y]-ge.length;++L)Q.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:r,from_sheet:o}}(),Kz=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+nr(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(p,m){var g=n[m];return typeof g=="number"?GE(g):g},r=function(p,m,g){var v=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?p:GE(v)};n["|"]=254;function s(p,m){switch(m.type){case"base64":return i(Fi(p),m);case"binary":return i(p,m);case"buffer":return i(Ot&&Buffer.isBuffer(p)?p.toString("binary"):Bu(p),m);case"array":return i(ap(p),m)}throw new Error("Unrecognized type "+m.type)}function i(p,m){var g=p.split(/[\n\r]+/),v=-1,y=-1,L=0,D=0,A=[],C=[],j=null,z={},w=[],R=[],x=[],b=0,N;for(+m.codepage>=0&&su(+m.codepage);L!==g.length;++L){b=0;var M=g[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),F=M.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),oe=F[0],Q;if(M.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&C.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,ge=!1,xe=!1,Ee=!1,Pe=-1,he=-1;for(D=1;D<F.length;++D)switch(F[D].charAt(0)){case"A":break;case"X":y=parseInt(F[D].slice(1))-1,ge=!0;break;case"Y":for(v=parseInt(F[D].slice(1))-1,ge||(y=0),N=A.length;N<=v;++N)A[N]=[];break;case"K":Q=F[D].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(Si(Q))?isNaN(ou(Q).getDate())||(Q=br(Q)):(Q=Si(Q),j!==null&&db(j)&&(Q=mb(Q))),ne=!0;break;case"E":Ee=!0;var E=jY(F[D].slice(1),{r:v,c:y});A[v][y]=[A[v][y],E];break;case"S":xe=!0,A[v][y]=[A[v][y],"S5S"];break;case"G":break;case"R":Pe=parseInt(F[D].slice(1))-1;break;case"C":he=parseInt(F[D].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+M)}if(ne&&(A[v][y]&&A[v][y].length==2?A[v][y][0]=Q:A[v][y]=Q,j=null),xe){if(Ee)throw new Error("SYLK shared formula cannot have own formula");var T=Pe>-1&&A[Pe][he];if(!T||!T[1])throw new Error("SYLK shared formula cannot find base");A[v][y][1]=WY(T[1],{r:v-Pe,c:y-he})}break;case"F":var U=0;for(D=1;D<F.length;++D)switch(F[D].charAt(0)){case"X":y=parseInt(F[D].slice(1))-1,++U;break;case"Y":for(v=parseInt(F[D].slice(1))-1,N=A.length;N<=v;++N)A[N]=[];break;case"M":b=parseInt(F[D].slice(1))/20;break;case"F":break;case"G":break;case"P":j=C[parseInt(F[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(x=F[D].slice(1).split(" "),N=parseInt(x[0],10);N<=parseInt(x[1],10);++N)b=parseInt(x[2],10),R[N-1]=b===0?{hidden:!0}:{wch:b},Gv(R[N-1]);break;case"C":y=parseInt(F[D].slice(1))-1,R[y]||(R[y]={});break;case"R":v=parseInt(F[D].slice(1))-1,w[v]||(w[v]={}),b>0?(w[v].hpt=b,w[v].hpx=nR(b)):b===0&&(w[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+M)}U<1&&(j=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+M)}}return w.length>0&&(z["!rows"]=w),R.length>0&&(z["!cols"]=R),m&&m.sheetRows&&(A=A.slice(0,m.sheetRows)),[A,z]}function o(p,m){var g=s(p,m),v=g[0],y=g[1],L=Wl(v,m);return nr(y).forEach(function(D){L[D]=y[D]}),L}function a(p,m){return Ea(o(p,m),m)}function l(p,m,g,v){var y="C;Y"+(g+1)+";X"+(v+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+Yv(p.f,{r:g,c:v}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,m){m.forEach(function(g,v){var y="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?y+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Wh(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Kh(g.wpx)),typeof g.wch=="number"&&(y+=Math.round(g.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function d(p,m){m.forEach(function(g,v){var y="F;";g.hidden?y+="M0;":g.hpt?y+="M"+20*g.hpt+";":g.hpx&&(y+="M"+20*qh(g.hpx)+";"),y.length>2&&p.push(y+"R"+(v+1))})}function f(p,m){var g=["ID;PWXL;N;E"],v=[],y=on(p["!ref"]),L,D=Array.isArray(p),A=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&u(g,p["!cols"]),p["!rows"]&&d(g,p["!rows"]),g.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var C=y.s.r;C<=y.e.r;++C)for(var j=y.s.c;j<=y.e.c;++j){var z=jt({r:C,c:j});L=D?(p[C]||[])[j]:p[z],!(!L||L.v==null&&(!L.f||L.F))&&v.push(l(L,p,C,j))}return g.join(A)+A+v.join(A)+A+"E"+A}return{to_workbook:a,to_sheet:o,from_sheet:f}}(),qz=function(){function n(i,o){switch(o.type){case"base64":return e(Fi(i),o);case"binary":return e(i,o);case"buffer":return e(Ot&&Buffer.isBuffer(i)?i.toString("binary"):Bu(i),o);case"array":return e(ap(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var a=i.split(`
`),l=-1,u=-1,d=0,f=[];d!==a.length;++d){if(a[d].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var p=a[d].trim().split(","),m=p[0],g=p[1];++d;for(var v=a[d]||"";(v.match(/["]/g)||[]).length&1&&d<a.length-1;)v+=`
`+a[++d];switch(v=v.trim(),+m){case-1:if(v==="BOT"){f[++l]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[l][u]=!0:v==="FALSE"?f[l][u]=!1:isNaN(Si(g))?isNaN(ou(g).getDate())?f[l][u]=g:f[l][u]=br(g):f[l][u]=Si(g),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[l][u++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function t(i,o){return Wl(n(i,o),o)}function r(i,o){return Ea(t(i,o),o)}var s=function(){var i=function(l,u,d,f,p){l.push(u),l.push(d+","+f),l.push('"'+p.replace(/"/g,'""')+'"')},o=function(l,u,d,f){l.push(u+","+d),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],d=on(l["!ref"]),f,p=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){o(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var v=jt({r:m,c:g});if(f=p?(l[m]||[])[g]:l[v],!f){o(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=wo(f.z||mn[14],Fr(br(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var L=`\r
`,D=u.join(L);return D}}();return{to_workbook:r,to_sheet:t,from_sheet:s}}(),Jb=function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,p){for(var m=f.split(`
`),g=-1,v=-1,y=0,L=[];y!==m.length;++y){var D=m[y].trim().split(":");if(D[0]==="cell"){var A=Hn(D[1]);if(L.length<=A.r)for(g=L.length;g<=A.r;++g)L[g]||(L[g]=[]);switch(g=A.r,v=A.c,D[2]){case"t":L[g][v]=n(D[3]);break;case"v":L[g][v]=+D[3];break;case"vtf":var C=D[D.length-1];case"vtc":switch(D[3]){case"nl":L[g][v]=!!+D[4];break;default:L[g][v]=+D[4];break}D[2]=="vtf"&&(L[g][v]=[L[g][v],C])}}}return p&&p.sheetRows&&(L=L.slice(0,p.sheetRows)),L}function r(f,p){return Wl(t(f,p),p)}function s(f,p){return Ea(r(f,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var p=[],m=[],g,v="",y=Jr(f["!ref"]),L=Array.isArray(f),D=y.s.r;D<=y.e.r;++D)for(var A=y.s.c;A<=y.e.c;++A)if(v=jt({r:D,c:A}),g=L?(f[D]||[])[A]:f[v],!(!g||g.v==null||g.t==="z")){switch(m=["cell",v,"t"],g.t){case"s":case"str":m.push(e(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=e(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var C=Fr(br(g.v));m[2]="vtc",m[3]="nd",m[4]=""+C,m[5]=g.w||wo(g.z||mn[14],C);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(f){return[i,o,a,o,u(f),l].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:d}}(),Gz=function(){function n(d,f,p,m,g){g.raw?f[p][m]=d:d===""||(d==="TRUE"?f[p][m]=!0:d==="FALSE"?f[p][m]=!1:isNaN(Si(d))?isNaN(ou(d).getDate())?f[p][m]=d:f[p][m]=br(d):f[p][m]=Si(d))}function e(d,f){var p=f||{},m=[];if(!d||d.length===0)return m;for(var g=d.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var y=10,L=0,D=0;D<=v;++D)L=g[D].indexOf(" "),L==-1?L=g[D].length:L++,y=Math.max(y,L);for(D=0;D<=v;++D){m[D]=[];var A=0;for(n(g[D].slice(0,y).trim(),m,D,A,p),A=1;A<=(g[D].length-y)/10+1;++A)n(g[D].slice(y+(A-1)*10,y+A*10).trim(),m,D,A,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(d){for(var f={},p=!1,m=0,g=0;m<d.length;++m)(g=d.charCodeAt(m))==34?p=!p:!p&&g in t&&(f[g]=(f[g]||0)+1);g=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m]);if(!g.length){f=r;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m])}return g.sort(function(v,y){return v[0]-y[0]||r[v[1]]-r[y[1]]}),t[g.pop()[1]]||44}function i(d,f){var p=f||{},m="",g=p.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=s(d.slice(0,1024)):p&&p.FS?m=p.FS:m=s(d.slice(0,1024));var y=0,L=0,D=0,A=0,C=0,j=m.charCodeAt(0),z=!1,w=0,R=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var x=p.dateNF!=null?cG(p.dateNF):null;function b(){var N=d.slice(A,C),M={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)M.t="z";else if(p.raw)M.t="s",M.v=N;else if(N.trim().length===0)M.t="s",M.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(M.t="s",M.v=N.slice(2,-1).replace(/""/g,'"')):KY(N)?(M.t="n",M.f=N.slice(1)):(M.t="s",M.v=N);else if(N=="TRUE")M.t="b",M.v=!0;else if(N=="FALSE")M.t="b",M.v=!1;else if(!isNaN(D=Si(N)))M.t="n",p.cellText!==!1&&(M.w=N),M.v=D;else if(!isNaN(ou(N).getDate())||x&&N.match(x)){M.z=p.dateNF||mn[14];var F=0;x&&N.match(x)&&(N=uG(N,p.dateNF,N.match(x)||[]),F=1),p.cellDates?(M.t="d",M.v=br(N,F)):(M.t="n",M.v=Fr(br(N,F))),p.cellText!==!1&&(M.w=wo(M.z,M.v instanceof Date?Fr(M.v):M.v)),p.cellNF||delete M.z}else M.t="s",M.v=N;if(M.t=="z"||(p.dense?(g[y]||(g[y]=[]),g[y][L]=M):g[jt({c:L,r:y})]=M),A=C+1,R=d.charCodeAt(A),v.e.c<L&&(v.e.c=L),v.e.r<y&&(v.e.r=y),w==j)++L;else if(L=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;C<d.length;++C)switch(w=d.charCodeAt(C)){case 34:R===34&&(z=!z);break;case j:case 10:case 13:if(!z&&b())break e;break}return C-A>0&&b(),g["!ref"]=Rn(v),g}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):Wl(e(d,f),f)}function a(d,f){var p="",m=f.type=="string"?[0,0,0,0]:iee(d,f);switch(f.type){case"base64":p=Fi(d);break;case"binary":p=d;break;case"buffer":f.codepage==65001?p=d.toString("utf8"):f.codepage&&typeof Mh<"u"||(p=Ot&&Buffer.isBuffer(d)?d.toString("binary"):Bu(d));break;case"array":p=ap(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=Lc(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Lc(p):f.type=="binary"&&typeof Mh<"u",p.slice(0,19)=="socialcalc:version:"?Jb.to_sheet(f.type=="string"?p:Lc(p),f):o(p,f)}function l(d,f){return Ea(a(d,f),f)}function u(d){for(var f=[],p=on(d["!ref"]),m,g=Array.isArray(d),v=p.s.r;v<=p.e.r;++v){for(var y=[],L=p.s.c;L<=p.e.c;++L){var D=jt({r:v,c:L});if(m=g?(d[v]||[])[L]:d[D],!m||m.v==null){y.push("          ");continue}for(var A=(m.w||(Li(m),m.w)||"").slice(0,10);A.length<10;)A+=" ";y.push(A+(L===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}(),AT=function(){function n(E,T,U){if(E){jr(E,E.l||0);for(var ee=U.Enum||Pe;E.l<E.length;){var le=E.read_shift(2),se=ee[le]||ee[65535],ve=E.read_shift(2),te=E.l+ve,O=se.f&&se.f(E,ve,U);if(E.l=te,T(O,se,le))return}}}function e(E,T){switch(T.type){case"base64":return t(us(Fi(E)),T);case"binary":return t(us(E),T);case"buffer":case"array":return t(E,T)}throw"Unsupported type "+T.type}function t(E,T){if(!E)return E;var U=T||{},ee=U.dense?[]:{},le="Sheet1",se="",ve=0,te={},O=[],H=[],I={s:{r:0,c:0},e:{r:0,c:0}},S=U.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)U.Enum=Pe,n(E,function(re,Re,Oe){switch(Oe){case 0:U.vers=re,re>=4096&&(U.qpro=!0);break;case 6:I=re;break;case 204:re&&(se=re);break;case 222:se=re;break;case 15:case 51:U.qpro||(re[1].v=re[1].v.slice(1));case 13:case 14:case 16:Oe==14&&(re[2]&112)==112&&(re[2]&15)>1&&(re[2]&15)<15&&(re[1].z=U.dateNF||mn[14],U.cellDates&&(re[1].t="d",re[1].v=mb(re[1].v))),U.qpro&&re[3]>ve&&(ee["!ref"]=Rn(I),te[le]=ee,O.push(le),ee=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ve=re[3],le=se||"Sheet"+(ve+1),se="");var Me=U.dense?(ee[re[0].r]||[])[re[0].c]:ee[jt(re[0])];if(Me){Me.t=re[1].t,Me.v=re[1].v,re[1].z!=null&&(Me.z=re[1].z),re[1].f!=null&&(Me.f=re[1].f);break}U.dense?(ee[re[0].r]||(ee[re[0].r]=[]),ee[re[0].r][re[0].c]=re[1]):ee[jt(re[0])]=re[1];break}},U);else if(E[2]==26||E[2]==14)U.Enum=he,E[2]==14&&(U.qpro=!0,E.l=0),n(E,function(re,Re,Oe){switch(Oe){case 204:le=re;break;case 22:re[1].v=re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(re[3]>ve&&(ee["!ref"]=Rn(I),te[le]=ee,O.push(le),ee=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ve=re[3],le="Sheet"+(ve+1)),S>0&&re[0].r>=S)break;U.dense?(ee[re[0].r]||(ee[re[0].r]=[]),ee[re[0].r][re[0].c]=re[1]):ee[jt(re[0])]=re[1],I.e.c<re[0].c&&(I.e.c=re[0].c),I.e.r<re[0].r&&(I.e.r=re[0].r);break;case 27:re[14e3]&&(H[re[14e3][0]]=re[14e3][1]);break;case 1537:H[re[0]]=re[1],re[0]==ve&&(le=re[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(ee["!ref"]=Rn(I),te[se||le]=ee,O.push(se||le),!H.length)return{SheetNames:O,Sheets:te};for(var B={},ie=[],ue=0;ue<H.length;++ue)te[O[ue]]?(ie.push(H[ue]||O[ue]),B[H[ue]]=te[H[ue]]||te[O[ue]]):(ie.push(H[ue]),B[H[ue]]={"!ref":"A1"});return{SheetNames:ie,Sheets:B}}function r(E,T){var U=T||{};if(+U.codepage>=0&&su(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=Mr(),le=on(E["!ref"]),se=Array.isArray(E),ve=[];He(ee,0,i(1030)),He(ee,6,l(le));for(var te=Math.min(le.e.r,8191),O=le.s.r;O<=te;++O)for(var H=tr(O),I=le.s.c;I<=le.e.c;++I){O===le.s.r&&(ve[I]=pr(I));var S=ve[I]+H,B=se?(E[O]||[])[I]:E[S];if(!(!B||B.t=="z"))if(B.t=="n")(B.v|0)==B.v&&B.v>=-32768&&B.v<=32767?He(ee,13,m(O,I,B.v)):He(ee,14,v(O,I,B.v));else{var ie=Li(B);He(ee,15,f(O,I,ie.slice(0,239)))}}return He(ee,1),ee.end()}function s(E,T){var U=T||{};if(+U.codepage>=0&&su(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=Mr();He(ee,0,o(E));for(var le=0,se=0;le<E.SheetNames.length;++le)(E.Sheets[E.SheetNames[le]]||{})["!ref"]&&He(ee,27,Ee(E.SheetNames[le],se++));var ve=0;for(le=0;le<E.SheetNames.length;++le){var te=E.Sheets[E.SheetNames[le]];if(!(!te||!te["!ref"])){for(var O=on(te["!ref"]),H=Array.isArray(te),I=[],S=Math.min(O.e.r,8191),B=O.s.r;B<=S;++B)for(var ie=tr(B),ue=O.s.c;ue<=O.e.c;++ue){B===O.s.r&&(I[ue]=pr(ue));var re=I[ue]+ie,Re=H?(te[B]||[])[ue]:te[re];if(!(!Re||Re.t=="z"))if(Re.t=="n")He(ee,23,b(B,ue,ve,Re.v));else{var Oe=Li(Re);He(ee,22,w(B,ue,ve,Oe.slice(0,239)))}}++ve}}return He(ee,1),ee.end()}function i(E){var T=Ie(2);return T.write_shift(2,E),T}function o(E){var T=Ie(26);T.write_shift(2,4096),T.write_shift(2,4),T.write_shift(4,0);for(var U=0,ee=0,le=0,se=0;se<E.SheetNames.length;++se){var ve=E.SheetNames[se],te=E.Sheets[ve];if(!(!te||!te["!ref"])){++le;var O=Jr(te["!ref"]);U<O.e.r&&(U=O.e.r),ee<O.e.c&&(ee=O.e.c)}}return U>8191&&(U=8191),T.write_shift(2,U),T.write_shift(1,le),T.write_shift(1,ee),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(1,1),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(4,0),T}function a(E,T,U){var ee={s:{c:0,r:0},e:{c:0,r:0}};return T==8&&U.qpro?(ee.s.c=E.read_shift(1),E.l++,ee.s.r=E.read_shift(2),ee.e.c=E.read_shift(1),E.l++,ee.e.r=E.read_shift(2),ee):(ee.s.c=E.read_shift(2),ee.s.r=E.read_shift(2),T==12&&U.qpro&&(E.l+=2),ee.e.c=E.read_shift(2),ee.e.r=E.read_shift(2),T==12&&U.qpro&&(E.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function l(E){var T=Ie(8);return T.write_shift(2,E.s.c),T.write_shift(2,E.s.r),T.write_shift(2,E.e.c),T.write_shift(2,E.e.r),T}function u(E,T,U){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(ee[0].c=E.read_shift(1),ee[3]=E.read_shift(1),ee[0].r=E.read_shift(2),E.l+=2):(ee[2]=E.read_shift(1),ee[0].c=E.read_shift(2),ee[0].r=E.read_shift(2)),ee}function d(E,T,U){var ee=E.l+T,le=u(E,T,U);if(le[1].t="s",U.vers==20768){E.l++;var se=E.read_shift(1);return le[1].v=E.read_shift(se,"utf8"),le}return U.qpro&&E.l++,le[1].v=E.read_shift(ee-E.l,"cstr"),le}function f(E,T,U){var ee=Ie(7+U.length);ee.write_shift(1,255),ee.write_shift(2,T),ee.write_shift(2,E),ee.write_shift(1,39);for(var le=0;le<ee.length;++le){var se=U.charCodeAt(le);ee.write_shift(1,se>=128?95:se)}return ee.write_shift(1,0),ee}function p(E,T,U){var ee=u(E,T,U);return ee[1].v=E.read_shift(2,"i"),ee}function m(E,T,U){var ee=Ie(7);return ee.write_shift(1,255),ee.write_shift(2,T),ee.write_shift(2,E),ee.write_shift(2,U,"i"),ee}function g(E,T,U){var ee=u(E,T,U);return ee[1].v=E.read_shift(8,"f"),ee}function v(E,T,U){var ee=Ie(13);return ee.write_shift(1,255),ee.write_shift(2,T),ee.write_shift(2,E),ee.write_shift(8,U,"f"),ee}function y(E,T,U){var ee=E.l+T,le=u(E,T,U);if(le[1].v=E.read_shift(8,"f"),U.qpro)E.l=ee;else{var se=E.read_shift(2);C(E.slice(E.l,E.l+se),le),E.l+=se}return le}function L(E,T,U){var ee=T&32768;return T&=-32769,T=(ee?E:0)+(T>=8192?T-16384:T),(ee?"":"$")+(U?pr(T):tr(T))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(E,T){jr(E,0);for(var U=[],ee=0,le="",se="",ve="",te="";E.l<E.length;){var O=E[E.l++];switch(O){case 0:U.push(E.read_shift(8,"f"));break;case 1:se=L(T[0].c,E.read_shift(2),!0),le=L(T[0].r,E.read_shift(2),!1),U.push(se+le);break;case 2:{var H=L(T[0].c,E.read_shift(2),!0),I=L(T[0].r,E.read_shift(2),!1);se=L(T[0].c,E.read_shift(2),!0),le=L(T[0].r,E.read_shift(2),!1),U.push(H+I+":"+se+le)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(E.read_shift(2));break;case 6:{for(var S="";O=E[E.l++];)S+=String.fromCharCode(O);U.push('"'+S.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:te=U.pop(),ve=U.pop(),U.push(["AND","OR"][O-20]+"("+ve+","+te+")");break;default:if(O<32&&A[O])te=U.pop(),ve=U.pop(),U.push(ve+A[O]+te);else if(D[O]){if(ee=D[O][1],ee==69&&(ee=E[E.l++]),ee>U.length){console.error("WK1 bad formula parse 0x"+O.toString(16)+":|"+U.join("|")+"|");return}var B=U.slice(-ee);U.length-=ee,U.push(D[O][0]+"("+B.join(",")+")")}else return O<=7?console.error("WK1 invalid opcode "+O.toString(16)):O<=24?console.error("WK1 unsupported op "+O.toString(16)):O<=30?console.error("WK1 invalid opcode "+O.toString(16)):O<=115?console.error("WK1 unsupported function opcode "+O.toString(16)):console.error("WK1 unrecognized opcode "+O.toString(16))}}U.length==1?T[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function j(E){var T=[{c:0,r:0},{t:"n",v:0},0];return T[0].r=E.read_shift(2),T[3]=E[E.l++],T[0].c=E[E.l++],T}function z(E,T){var U=j(E);return U[1].t="s",U[1].v=E.read_shift(T-4,"cstr"),U}function w(E,T,U,ee){var le=Ie(6+ee.length);le.write_shift(2,E),le.write_shift(1,U),le.write_shift(1,T),le.write_shift(1,39);for(var se=0;se<ee.length;++se){var ve=ee.charCodeAt(se);le.write_shift(1,ve>=128?95:ve)}return le.write_shift(1,0),le}function R(E,T){var U=j(E);U[1].v=E.read_shift(2);var ee=U[1].v>>1;if(U[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return U[1].v=ee,U}function x(E,T){var U=j(E),ee=E.read_shift(4),le=E.read_shift(4),se=E.read_shift(2);if(se==65535)return ee===0&&le===3221225472?(U[1].t="e",U[1].v=15):ee===0&&le===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ve=se&32768;return se=(se&32767)-16446,U[1].v=(1-ve*2)*(le*Math.pow(2,se+32)+ee*Math.pow(2,se)),U}function b(E,T,U,ee){var le=Ie(14);if(le.write_shift(2,E),le.write_shift(1,U),le.write_shift(1,T),ee==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var se=0,ve=0,te=0,O=0;return ee<0&&(se=1,ee=-ee),ve=Math.log2(ee)|0,ee/=Math.pow(2,ve-31),O=ee>>>0,O&2147483648||(ee/=2,++ve,O=ee>>>0),ee-=O,O|=2147483648,O>>>=0,ee*=Math.pow(2,32),te=ee>>>0,le.write_shift(4,te),le.write_shift(4,O),ve+=16383+(se?32768:0),le.write_shift(2,ve),le}function N(E,T){var U=x(E);return E.l+=T-14,U}function M(E,T){var U=j(E),ee=E.read_shift(4);return U[1].v=ee>>6,U}function F(E,T){var U=j(E),ee=E.read_shift(8,"f");return U[1].v=ee,U}function oe(E,T){var U=F(E);return E.l+=T-10,U}function Q(E,T){return E[E.l+T-1]==0?E.read_shift(T,"cstr"):""}function ne(E,T){var U=E[E.l++];U>T-1&&(U=T-1);for(var ee="";ee.length<U;)ee+=String.fromCharCode(E[E.l++]);return ee}function ge(E,T,U){if(!(!U.qpro||T<21)){var ee=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var le=E.read_shift(T-21,"cstr");return[ee,le]}}function xe(E,T){for(var U={},ee=E.l+T;E.l<ee;){var le=E.read_shift(2);if(le==14e3){for(U[le]=[0,""],U[le][0]=E.read_shift(2);E[E.l];)U[le][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return U}function Ee(E,T){var U=Ie(5+E.length);U.write_shift(2,14e3),U.write_shift(2,T);for(var ee=0;ee<E.length;++ee){var le=E.charCodeAt(ee);U[U.l++]=le>127?95:le}return U[U.l++]=0,U}var Pe={0:{n:"BOF",f:Gb},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:x},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:e}}(),zz=/^\s|\s$|[\t\n\r]/;function Zb(n,e){if(!e.bookSST)return"";var t=[Pn];t[t.length]=$e("sst",null,{xmlns:jl[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var s=n[r],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(zz)&&(i+=' xml:space="preserve"'),i+=">"+$t(s.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function Yz(n){return[n.read_shift(4),n.read_shift(4)]}function Qz(n,e){return e||(e=Ie(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var Xz=$G;function Jz(n){var e=Mr();De(e,159,Qz(n));for(var t=0;t<n.length;++t)De(e,19,Xz(n[t]));return De(e,160),e.end()}function Zz(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function eR(n){var e=0,t,r=Zz(n),s=r.length+1,i,o,a,l,u;for(t=da(s),t[0]=r.length,i=1;i!=s;++i)t[i]=r[i-1];for(i=s-1;i>=0;--i)o=t[i],a=e&16384?1:0,l=e<<1&32767,u=a|l,e=u^o;return e^52811}var eY=function(){function n(s,i){switch(i.type){case"base64":return e(Fi(s),i);case"binary":return e(s,i);case"buffer":return e(Ot&&Buffer.isBuffer(s)?s.toString("binary"):Bu(s),i);case"array":return e(ap(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var o=i||{},a=o.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,f){Array.isArray(a)&&(a[f]=[]);for(var p=/\\\w+\b/g,m=0,g,v=-1;g=p.exec(d);){switch(g[0]){case"\\cell":var y=d.slice(m,p.lastIndex-g[0].length);if(y[0]==" "&&(y=y.slice(1)),++v,y.length){var L={v:y,t:"s"};Array.isArray(a)?a[f][v]=L:a[jt({r:f,c:v})]=L}break}m=p.lastIndex}v>u.e.c&&(u.e.c=v)}),a["!ref"]=Rn(u),a}function t(s,i){return Ea(n(s,i),i)}function r(s){for(var i=["{\\rtf1\\ansi"],o=on(s["!ref"]),a,l=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=jt({r:u,c:d});a=l?(s[u]||[])[d]:s[f],!(!a||a.v==null&&(!a.f||a.F))&&(i.push(" "+(a.w||(Li(a),a.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}}();function IT(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var tY=6,xi=tY;function Wh(n){return Math.floor((n+Math.round(128/xi)/256)*xi)}function Kh(n){return Math.floor((n-5)/xi*100+.5)/100}function E0(n){return Math.round((n*xi+5)/xi*256)/256}function Gv(n){n.width?(n.wpx=Wh(n.width),n.wch=Kh(n.wpx),n.MDW=xi):n.wpx?(n.wch=Kh(n.wpx),n.width=E0(n.wch),n.MDW=xi):typeof n.wch=="number"&&(n.width=E0(n.wch),n.wpx=Wh(n.width),n.MDW=xi),n.customWidth&&delete n.customWidth}var nY=96,tR=nY;function qh(n){return n*96/tR}function nR(n){return n*tR/96}function rY(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=$e("numFmt",null,{numFmtId:r,formatCode:$t(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=$e("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function sY(n){var e=[];return e[e.length]=$e("cellXfs",null),n.forEach(function(t){e[e.length]=$e("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=$e("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function rR(n,e){var t=[Pn,$e("styleSheet",null,{xmlns:jl[0],"xmlns:vt":$n.vt})],r;return n.SSF&&(r=rY(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=sY(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function iY(n,e){var t=n.read_shift(2),r=mr(n);return[t,r]}function oY(n,e,t){t||(t=Ie(6+4*e.length)),t.write_shift(2,n),jn(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function aY(n,e,t){var r={};r.sz=n.read_shift(2)/20;var s=zG(n);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var i=n.read_shift(2);switch(i===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=n.read_shift(1);o!=0&&(r.underline=o);var a=n.read_shift(1);a>0&&(r.family=a);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=GG(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=mr(n),r}function lY(n,e){e||(e=Ie(25+4*32)),e.write_shift(2,n.sz*20),YG(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Hh(n.color,e);var r=0;return r=2,e.write_shift(1,r),jn(n.name,e),e.length>e.l?e.slice(0,e.l):e}var cY=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rm,uY=Qs;function ST(n,e){e||(e=Ie(4*3+8*7+16*1)),rm||(rm=Mv(cY));var t=rm[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(Hh({auto:1},e),Hh({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function dY(n,e){var t=n.l+e,r=n.read_shift(2),s=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:s}}function sR(n,e,t){t||(t=Ie(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function lc(n,e){return e||(e=Ie(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var hY=Qs;function fY(n,e){return e||(e=Ie(51)),e.write_shift(1,0),lc(null,e),lc(null,e),lc(null,e),lc(null,e),lc(null,e),e.length>e.l?e.slice(0,e.l):e}function pY(n,e){return e||(e=Ie(12+4*10)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),$h(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function mY(n,e,t){var r=Ie(2052);return r.write_shift(4,n),$h(e,r),$h(t,r),r.length>r.l?r.slice(0,r.l):r}function gY(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&++t}),t!=0&&(De(n,615,ys(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&De(n,44,oY(s,e[s]))}),De(n,616))}}function vY(n){var e=1;De(n,611,ys(e)),De(n,43,lY({sz:12,color:{theme:1},name:"Calibri",family:2})),De(n,612)}function yY(n){var e=2;De(n,603,ys(e)),De(n,45,ST({patternType:"none"})),De(n,45,ST({patternType:"gray125"})),De(n,604)}function _Y(n){var e=1;De(n,613,ys(e)),De(n,46,fY()),De(n,614)}function EY(n){var e=1;De(n,626,ys(e)),De(n,47,sR({numFmtId:0},65535)),De(n,627)}function TY(n,e){De(n,617,ys(e.length)),e.forEach(function(t){De(n,47,sR(t,0))}),De(n,618)}function wY(n){var e=1;De(n,619,ys(e)),De(n,48,pY({xfId:0,name:"Normal"})),De(n,620)}function CY(n){var e=0;De(n,505,ys(e)),De(n,506)}function AY(n){var e=0;De(n,508,mY(e,"TableStyleMedium9","PivotStyleMedium4")),De(n,509)}function IY(n,e){var t=Mr();return De(t,278),gY(t,n.SSF),vY(t),yY(t),_Y(t),EY(t),TY(t,e.cellXfs),wY(t),CY(t),AY(t),De(t,279),t.end()}function iR(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[Pn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function SY(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:mr(n)}}function xY(n){var e=Ie(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),jn(n.name,e),e.slice(0,e.l)}function bY(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function RY(n){var e=Ie(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function kY(n,e){var t=Ie(8+2*e.length);return t.write_shift(4,n),jn(e,t),t.slice(0,t.l)}function PY(n){return n.l+=4,n.read_shift(4)!=0}function NY(n,e){var t=Ie(8);return t.write_shift(4,n),t.write_shift(4,1),t}function OY(){var n=Mr();return De(n,332),De(n,334,ys(1)),De(n,335,xY({name:"XLDAPR",version:12e4,flags:3496657072})),De(n,336),De(n,339,kY(1,"XLDAPR")),De(n,52),De(n,35,ys(514)),De(n,4096,ys(0)),De(n,4097,ts(1)),De(n,36),De(n,53),De(n,340),De(n,337,NY(1)),De(n,51,RY([[1,0]])),De(n,338),De(n,333),n.end()}function oR(){var n=[Pn];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function DY(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=jt(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Ja=1024;function aR(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[$e("xml",null,{"xmlns:v":Kr.v,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:mv":Kr.mv}).replace(/\/>/,">"),$e("o:shapelayout",$e("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),$e("v:shapetype",[$e("v:stroke",null,{joinstyle:"miter"}),$e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Ja<n*1e3;)Ja+=1e3;return e.forEach(function(i){var o=Hn(i[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?$e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=$e("v:fill",l,a),d={on:"t",obscured:"t"};++Ja,s=s.concat(["<v:shape"+lu({id:"_x0000_s"+Ja,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,$e("v:shadow",null,d),$e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Jn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Jn("x:AutoFill","False"),Jn("x:Row",String(o.r)),Jn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function lR(n){var e=[Pn,$e("comments",null,{xmlns:jl[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(s){var i=$t(s.a);t.indexOf(i)==-1&&(t.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var s=0,i=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?s=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(s=t.indexOf($t(l.a))),i.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(Jn("t",$t(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,a=1;a<i.length;++a)o+=`Reply:
    `+i[a]+`
`;e.push(Jn("t",$t(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function MY(n,e,t){var r=[Pn,$e("ThreadedComments",null,{xmlns:$n.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};a==0?i=l.id:l.parentId=i,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),r.push($e("threadedComment",Jn("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function FY(n){var e=[Pn,$e("personList",null,{xmlns:$n.TCMNT,"xmlns:x":jl[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push($e("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function LY(n){var e={};e.iauthor=n.read_shift(4);var t=Aa(n);return e.rfx=t.s,e.ref=jt(t.s),n.l+=16,e}function UY(n,e){return e==null&&(e=Ie(36)),e.write_shift(4,n[1].iauthor),Kl(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var BY=mr;function VY(n){return jn(n.slice(0,54))}function $Y(n){var e=Mr(),t=[];return De(e,628),De(e,630),n.forEach(function(r){r[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),De(e,632,VY(s.a)))})}),De(e,631),De(e,633),n.forEach(function(r){r[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var i={s:Hn(r[0]),e:Hn(r[0])};De(e,635,UY([i,s])),s.t&&s.t.length>0&&De(e,637,jG(s)),De(e,636),delete s.iauthor})}),De(e,634),De(e,629),e.end()}function HY(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Wt.utils.cfb_add(n,s,e.FileIndex[r].content)}})}var cR=["xlsb","xlsm","xlam","biff8","xla"],jY=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,s,i,o){var a=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return a?d+=e.c:--d,l?u+=e.r:--u,s+(a?"":"$")+pr(d)+(l?"":"$")+tr(u)}return function(s,i){return e=i,s.replace(n,t)}}(),zv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Yv=function(){return function(e,t){return e.replace(zv,function(r,s,i,o,a,l){var u=Hv(o)-(i?0:t.c),d=$v(l)-(a?0:t.r),f=d==0?"":a?d+1:"["+d+"]",p=u==0?"":i?u+1:"["+u+"]";return s+"R"+f+"C"+p})}}();function WY(n,e){return n.replace(zv,function(t,r,s,i,o,a){return r+(s=="$"?s+i:pr(Hv(i)+e.c))+(o=="$"?o+a:tr($v(a)+e.r))})}function KY(n){return n.length!=1}function In(n){n.l+=1}function Co(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function uR(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return dR(n);t.biff==12&&(r=4)}var s=n.read_shift(r),i=n.read_shift(r),o=Co(n),a=Co(n);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function dR(n){var e=Co(n),t=Co(n),r=n.read_shift(1),s=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function qY(n,e,t){if(t.biff<8)return dR(n);var r=n.read_shift(t.biff==12?4:2),s=n.read_shift(t.biff==12?4:2),i=Co(n),o=Co(n);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function hR(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return GY(n);var r=n.read_shift(t&&t.biff==12?4:2),s=Co(n);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function GY(n){var e=Co(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function zY(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function YY(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return QY(n);var s=n.read_shift(r>=12?4:2),i=n.read_shift(2),o=(i&16384)>>14,a=(i&32768)>>15;if(i&=16383,a==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:a}}function QY(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),s==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:s,rRel:r}}function XY(n,e,t){var r=(n[n.l++]&96)>>5,s=uR(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,s]}function JY(n,e,t){var r=(n[n.l++]&96)>>5,s=n.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:n.l+=12,i=6;break;case 12:i=12;break}var o=uR(n,i,t);return[r,s,o]}function ZY(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function eQ(n,e,t){var r=(n[n.l++]&96)>>5,s=n.read_shift(2),i=8;if(t)switch(t.biff){case 5:n.l+=12,i=6;break;case 12:i=12;break}return n.l+=i,[r,s]}function tQ(n,e,t){var r=(n[n.l++]&96)>>5,s=qY(n,e-1,t);return[r,s]}function nQ(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function xT(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function rQ(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),s=[],i=0;i<=r;++i)s.push(n.read_shift(t&&t.biff==2?1:2));return s}function sQ(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function iQ(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function oQ(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function aQ(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function fR(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function lQ(n){return n.read_shift(2),fR(n)}function cQ(n){return n.read_shift(2),fR(n)}function uQ(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var s=hR(n,0,t);return[r,s]}function dQ(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var s=YY(n,0,t);return[r,s]}function hQ(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var i=hR(n,0,t);return[r,s,i]}function fQ(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(t&&t.biff<=3?1:2);return[fX[s],gR[s],r]}function pQ(n,e,t){var r=n[n.l++],s=n.read_shift(1),i=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:mQ(n);return[s,(i[0]===0?gR:hX)[i[1]]]}function mQ(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function gQ(n,e,t){n.l+=t&&t.biff==2?3:4}function vQ(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),s=n.read_shift(t&&t.biff==2?1:2);return[r,s]}function yQ(n){return n.l++,Hu[n.read_shift(1)]}function _Q(n){return n.l++,n.read_shift(2)}function EQ(n){return n.l++,n.read_shift(1)!==0}function TQ(n){return n.l++,ql(n)}function wQ(n,e,t){return n.l++,Yb(n,e-1,t)}function CQ(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=hz(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=Hu[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=ql(n);break;case 2:t[1]=gz(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function AQ(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),s=[],i=0;i!=r;++i)s.push((t.biff==12?Aa:_z)(n));return s}function IQ(n,e,t){var r=0,s=0;t.biff==12?(r=n.read_shift(4),s=n.read_shift(4)):(s=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--s==0&&(s=256));for(var i=0,o=[];i!=r&&(o[i]=[]);++i)for(var a=0;a!=s;++a)o[i][a]=CQ(n,t.biff);return o}function SQ(n,e,t){var r=n.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,i=n.read_shift(s);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,i]}function xQ(n,e,t){if(t.biff==5)return bQ(n);var r=n.read_shift(1)>>>5&3,s=n.read_shift(2),i=n.read_shift(4);return[r,s,i]}function bQ(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function RQ(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var s=n.read_shift(t&&t.biff==2?1:2);return[r,s]}function kQ(n,e,t){var r=n.read_shift(1)>>>5&3,s=n.read_shift(t&&t.biff==2?1:2);return[r,s]}function PQ(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function NQ(n,e,t){var r=(n[n.l++]&96)>>5,s=n.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return n.l+=i,[r,s]}var OQ=Qs,DQ=Qs,MQ=Qs;function ju(n,e,t){return n.l+=2,[zY(n)]}function Qv(n){return n.l+=6,[]}var FQ=ju,LQ=Qv,UQ=Qv,BQ=ju;function pR(n){return n.l+=2,[Gb(n),n.read_shift(2)&1]}var VQ=ju,$Q=pR,HQ=Qv,jQ=ju,WQ=ju,KQ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qQ(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),s=n.read_shift(2),i=n.read_shift(2),o=KQ[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:r,c:s,C:i}}function GQ(n){return n.l+=2,[n.read_shift(4)]}function zQ(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function YQ(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function QQ(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function XQ(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function JQ(n){return n.l+=4,[0,0]}var bT={1:{n:"PtgExp",f:vQ},2:{n:"PtgTbl",f:MQ},3:{n:"PtgAdd",f:In},4:{n:"PtgSub",f:In},5:{n:"PtgMul",f:In},6:{n:"PtgDiv",f:In},7:{n:"PtgPower",f:In},8:{n:"PtgConcat",f:In},9:{n:"PtgLt",f:In},10:{n:"PtgLe",f:In},11:{n:"PtgEq",f:In},12:{n:"PtgGe",f:In},13:{n:"PtgGt",f:In},14:{n:"PtgNe",f:In},15:{n:"PtgIsect",f:In},16:{n:"PtgUnion",f:In},17:{n:"PtgRange",f:In},18:{n:"PtgUplus",f:In},19:{n:"PtgUminus",f:In},20:{n:"PtgPercent",f:In},21:{n:"PtgParen",f:In},22:{n:"PtgMissArg",f:In},23:{n:"PtgStr",f:wQ},26:{n:"PtgSheet",f:zQ},27:{n:"PtgEndSheet",f:YQ},28:{n:"PtgErr",f:yQ},29:{n:"PtgBool",f:EQ},30:{n:"PtgInt",f:_Q},31:{n:"PtgNum",f:TQ},32:{n:"PtgArray",f:nQ},33:{n:"PtgFunc",f:fQ},34:{n:"PtgFuncVar",f:pQ},35:{n:"PtgName",f:SQ},36:{n:"PtgRef",f:uQ},37:{n:"PtgArea",f:XY},38:{n:"PtgMemArea",f:RQ},39:{n:"PtgMemErr",f:OQ},40:{n:"PtgMemNoMem",f:DQ},41:{n:"PtgMemFunc",f:kQ},42:{n:"PtgRefErr",f:PQ},43:{n:"PtgAreaErr",f:ZY},44:{n:"PtgRefN",f:dQ},45:{n:"PtgAreaN",f:tQ},46:{n:"PtgMemAreaN",f:QQ},47:{n:"PtgMemNoMemN",f:XQ},57:{n:"PtgNameX",f:xQ},58:{n:"PtgRef3d",f:hQ},59:{n:"PtgArea3d",f:JY},60:{n:"PtgRefErr3d",f:NQ},61:{n:"PtgAreaErr3d",f:eQ},255:{}},ZQ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},eX={1:{n:"PtgElfLel",f:pR},2:{n:"PtgElfRw",f:jQ},3:{n:"PtgElfCol",f:FQ},6:{n:"PtgElfRwV",f:WQ},7:{n:"PtgElfColV",f:BQ},10:{n:"PtgElfRadical",f:VQ},11:{n:"PtgElfRadicalS",f:HQ},13:{n:"PtgElfColS",f:LQ},15:{n:"PtgElfColSV",f:UQ},16:{n:"PtgElfRadicalLel",f:$Q},25:{n:"PtgList",f:qQ},29:{n:"PtgSxName",f:GQ},255:{}},tX={0:{n:"PtgAttrNoop",f:JQ},1:{n:"PtgAttrSemi",f:aQ},2:{n:"PtgAttrIf",f:iQ},4:{n:"PtgAttrChoose",f:rQ},8:{n:"PtgAttrGoto",f:sQ},16:{n:"PtgAttrSum",f:gQ},32:{n:"PtgAttrBaxcel",f:xT},33:{n:"PtgAttrBaxcel",f:xT},64:{n:"PtgAttrSpace",f:lQ},65:{n:"PtgAttrSpaceSemi",f:cQ},128:{n:"PtgAttrIfError",f:oQ},255:{}};function nX(n,e,t,r){if(r.biff<8)return Qs(n,e);for(var s=n.l+e,i=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=IQ(n,0,r),i.push(t[o][1]);break;case"PtgMemArea":t[o][2]=AQ(n,t[o][1],r),i.push(t[o][2]);break;case"PtgExp":r&&r.biff==12&&(t[o][1][1]=n.read_shift(4),i.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=s-n.l,e!==0&&i.push(Qs(n,e)),i}function rX(n,e,t){for(var r=n.l+e,s,i,o=[];r!=n.l;)e=r-n.l,i=n[n.l],s=bT[i]||bT[ZQ[i]],(i===24||i===25)&&(s=(i===24?eX:tX)[n[n.l+1]]),!s||!s.f?Qs(n,e):o.push([s.n,s.f(n,e,t)]);return o}function sX(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],s=[],i=0;i<r.length;++i){var o=r[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var iX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function oX(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function mR(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var s="";if(t.biff>8)switch(n[r[0]][0]){case 357:return s=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?s:s+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return n[r[0]][0][3]?(s=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function RT(n,e,t){var r=mR(n,e,t);return r=="#REF"?r:oX(r,t)}function Pl(n,e,t,r,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},a=[],l,u,d,f=0,p=0,m,g="";if(!n[0]||!n[0][0])return"";for(var v=-1,y="",L=0,D=n[0].length;L<D;++L){var A=n[0][L];switch(A[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),v>=0){switch(n[0][v][1][0]){case 0:y=hn(" ",n[0][v][1][1]);break;case 1:y=hn("\r",n[0][v][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][v][1][0])}u=u+y,v=-1}a.push(u+iX[A[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Bc(A[1][1],o,s),a.push(Vc(d,i));break;case"PtgRefN":d=t?Bc(A[1][1],t,s):A[1][1],a.push(Vc(d,i));break;case"PtgRef3d":f=A[1][1],d=Bc(A[1][2],o,s),g=RT(r,f,s),a.push(g+"!"+Vc(d,i));break;case"PtgFunc":case"PtgFuncVar":var C=A[1][0],j=A[1][1];C||(C=0),C&=127;var z=C==0?[]:a.slice(-C);a.length-=C,j==="User"&&(j=z.shift()),a.push(j+"("+z.join(",")+")");break;case"PtgBool":a.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(A[1]);break;case"PtgNum":a.push(String(A[1]));break;case"PtgStr":a.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(A[1]);break;case"PtgAreaN":m=fT(A[1][1],t?{s:t}:o,s),a.push(tm(m,s));break;case"PtgArea":m=fT(A[1][1],o,s),a.push(tm(m,s));break;case"PtgArea3d":f=A[1][1],m=A[1][2],g=RT(r,f,s),a.push(g+"!"+tm(m,s));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=A[1][2];var w=(r.names||[])[p-1]||(r[0]||[])[p],R=w?w.Name:"SH33TJSNAME"+String(p);R&&R.slice(0,6)=="_xlfn."&&!s.xlfn&&(R=R.slice(6)),a.push(R);break;case"PtgNameX":var x=A[1][1];p=A[1][2];var b;if(s.biff<=5)x<0&&(x=-x),r[x]&&(b=r[x][p]);else{var N="";if(((r[x]||[])[0]||[])[0]==14849||(((r[x]||[])[0]||[])[0]==1025?r[x][p]&&r[x][p].itab>0&&(N=r.SheetNames[r[x][p].itab-1]+"!"):N=r.SheetNames[p-1]+"!"),r[x]&&r[x][p])N+=r[x][p].Name;else if(r[0]&&r[0][p])N+=r[0][p].Name;else{var M=(mR(r,x,s)||"").split(";;");M[p-1]?N=M[p-1]:N+="SH33TJSERRX"}a.push(N);break}b||(b={Name:"SH33TJSERRY"}),a.push(b.Name);break;case"PtgParen":var F="(",oe=")";if(v>=0){switch(y="",n[0][v][1][0]){case 2:F=hn(" ",n[0][v][1][1])+F;break;case 3:F=hn("\r",n[0][v][1][1])+F;break;case 4:oe=hn(" ",n[0][v][1][1])+oe;break;case 5:oe=hn("\r",n[0][v][1][1])+oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][v][1][0])}v=-1}a.push(F+a.pop()+oe);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":d={c:A[1][1],r:A[1][0]};var Q={c:t.c,r:t.r};if(r.sharedf[jt(d)]){var ne=r.sharedf[jt(d)];a.push(Pl(ne,o,Q,r,s))}else{var ge=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){a.push(Pl(u[1],o,Q,r,s)),ge=!0;break}ge||a.push(A[1])}break;case"PtgArray":a.push("{"+sX(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&xe.indexOf(n[0][L][0])==-1){A=n[0][v];var Ee=!0;switch(A[1][0]){case 4:Ee=!1;case 0:y=hn(" ",A[1][1]);break;case 5:Ee=!1;case 1:y=hn("\r",A[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}a.push((Ee?y:"")+a.pop()+(Ee?"":y)),v=-1}}if(a.length>1&&s.WTF)throw new Error("bad formula stack");return a[0]}function aX(n){if(n==null){var e=Ie(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return ha(n);return ha(0)}function lX(n,e,t,r,s){var i=fa(e,t,s),o=aX(n.v),a=Ie(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var u=Ie(n.bf.length),d=0;d<n.bf.length;++d)u[d]=n.bf[d];var f=Xn([i,o,a,u]);return f}function lp(n,e,t){var r=n.read_shift(4),s=rX(n,r,t),i=n.read_shift(4),o=i>0?nX(n,i,s,t):null;return[s,o]}var cX=lp,cp=lp,uX=lp,dX=lp,hX={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},fX={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function pX(n){var e="of:="+n.replace(zv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function mX(n){return n.replace(/\./,"!")}var $c=typeof Map<"u";function Xv(n,e,t){var r=0,s=n.length;if(t){if($c?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var i=$c?t.get(e):t[e];r<i.length;++r)if(n[i[r]].t===e)return n.Count++,i[r]}}else for(;r<s;++r)if(n[r].t===e)return n.Count++,r;return n[s]={t:e},n.Count++,n.Unique++,t&&($c?(t.has(e)||t.set(e,[]),t.get(e).push(s)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(s))),s}function up(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(xi=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=Kh(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=E0(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function vR(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function bo(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],s=60,i=n.length;if(r==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){hb(e.z,s),t.ssf[s]=e.z,t.revssf[e.z]=r=s;break}}for(s=0;s!=i;++s)if(n[s].numFmtId===r)return s;return n[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function gX(n,e,t){if(n&&n["!ref"]){var r=on(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function vX(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+Rn(n[t])+'"/>';return e+"</mergeCells>"}function yX(n,e,t,r,s){var i=!1,o={},a=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}i=!0,o.codeName=au($t(l))}if(n&&n["!outline"]){var u={summaryBelow:1,summaryRight:1};n["!outline"].above&&(u.summaryBelow=0),n["!outline"].left&&(u.summaryRight=0),a=(a||"")+$e("outlinePr",null,u)}!i&&!a||(s[s.length]=$e("sheetPr",a,o))}var _X=["objects","scenarios","selectLockedCells","selectUnlockedCells"],EX=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function TX(n){var e={sheet:1};return _X.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),EX.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=eR(n.password).toString(16).toUpperCase()),$e("sheetProtection",null,e)}function wX(n){return vR(n),$e("pageMargins",null,n)}function CX(n,e){for(var t=["<cols>"],r,s=0;s!=e.length;++s)(r=e[s])&&(t[t.length]=$e("col",null,up(s,r)));return t[t.length]="</cols>",t.join("")}function AX(n,e,t,r){var s=typeof n.ref=="string"?n.ref:Rn(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,o=Jr(s);o.s.r==o.e.r&&(o.e.r=Jr(e["!ref"]).e.r,s=Rn(o));for(var a=0;a<i.length;++a){var l=i[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+s;break}}return a==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),$e("autoFilter",null,{ref:s})}function IX(n,e,t,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),$e("sheetViews",$e("sheetView",null,s),{})}function SX(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var s="",i=n.t,o=n.v;if(n.t!=="z")switch(n.t){case"b":s=n.v?"1":"0";break;case"n":s=""+n.v;break;case"e":s=Hu[n.v];break;case"d":r&&r.cellDates?s=br(n.v,-1).toISOString():(n=Lr(n),n.t="n",s=""+(n.v=Fr(br(n.v)))),typeof n.z>"u"&&(n.z=mn[14]);break;default:s=n.v;break}var a=Jn("v",$t(s)),l={r:e},u=bo(r.cellXfs,n,r);switch(u!==0&&(l.s=u),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Jn("v",""+Xv(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=i&&(n.t=i,n.v=o),typeof n.f=="string"&&n.f){var d=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;a=$e("f",$t(n.f),d)+(n.v!=null?a:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),$e("c",a,l)}function xX(n,e,t,r){var s=[],i=[],o=on(n["!ref"]),a="",l,u="",d=[],f=0,p=0,m=n["!rows"],g=Array.isArray(n),v={r:u},y,L=-1;for(p=o.s.c;p<=o.e.c;++p)d[p]=pr(p);for(f=o.s.r;f<=o.e.r;++f){for(i=[],u=tr(f),p=o.s.c;p<=o.e.c;++p){l=d[p]+u;var D=g?(n[f]||[])[p]:n[l];D!==void 0&&(a=SX(D,l,n,e))!=null&&i.push(a)}(i.length>0||m&&m[f])&&(v={r:u},m&&m[f]&&(y=m[f],y.hidden&&(v.hidden=1),L=-1,y.hpx?L=qh(y.hpx):y.hpt&&(L=y.hpt),L>-1&&(v.ht=L,v.customHeight=1),y.level&&(v.outlineLevel=y.level)),s[s.length]=$e("row",i.join(""),v))}if(m)for(;f<m.length;++f)m&&m[f]&&(v={r:f+1},y=m[f],y.hidden&&(v.hidden=1),L=-1,y.hpx?L=qh(y.hpx):y.hpt&&(L=y.hpt),L>-1&&(v.ht=L,v.customHeight=1),y.level&&(v.outlineLevel=y.level),s[s.length]=$e("row","",v));return s.join("")}function yR(n,e,t,r){var s=[Pn,$e("worksheet",null,{xmlns:jl[0],"xmlns:r":$n.r})],i=t.SheetNames[n],o=0,a="",l=t.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",d=on(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Rn(d)}r||(r={}),l["!comments"]=[];var f=[];yX(l,t,n,e,s),s[s.length]=$e("dimension",null,{ref:u}),s[s.length]=IX(l,e,n,t),e.sheetFormat&&(s[s.length]=$e("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=CX(l,l["!cols"])),s[o=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=xX(l,e),a.length>0&&(s[s.length]=a)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),l["!protect"]&&(s[s.length]=TX(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=AX(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=vX(l["!merges"]));var p=-1,m,g=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(m={ref:v[0]},v[1].Target.charAt(0)!="#"&&(g=Vt(r,-1,$t(v[1].Target).replace(/#.*$/,""),Pt.HLINK),m["r:id"]="rId"+g),(p=v[1].Target.indexOf("#"))>-1&&(m.location=$t(v[1].Target.slice(p+1))),v[1].Tooltip&&(m.tooltip=$t(v[1].Tooltip)),s[s.length]=$e("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=wX(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=Jn("ignoredErrors",$e("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=Vt(r,-1,"../drawings/drawing"+(n+1)+".xml",Pt.DRAW),s[s.length]=$e("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=f),l["!comments"].length>0&&(g=Vt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Pt.VML),s[s.length]=$e("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function bX(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var s=n.read_shift(2);n.l+=1;var i=n.read_shift(1);return n.l=r,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=s/20),t}function RX(n,e,t){var r=Ie(145),s=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var i=320;s.hpx?i=qh(s.hpx)*20:s.hpt&&(i=s.hpt*20),r.write_shift(2,i),r.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var u={r:n,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var f=-1,p=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var g=Array.isArray(t)?(t[u.r]||[])[u.c]:t[jt(u)];g&&(f<0&&(f=m),p=m)}f<0||(++a,r.write_shift(4,f),r.write_shift(4,p))}var v=r.l;return r.l=l,r.write_shift(4,a),r.l=v,r.length>r.l?r.slice(0,r.l):r}function kX(n,e,t,r){var s=RX(r,t,e);(s.length>17||(e["!rows"]||[])[r])&&De(n,0,s)}var PX=Aa,NX=Kl;function OX(){}function DX(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=WG(n),t}function MX(n,e,t){t==null&&(t=Ie(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var s=1;s<3;++s)t.write_shift(1,0);return Hh({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Ob(n,t),t.slice(0,t.l)}function FX(n){var e=ss(n);return[e]}function LX(n,e,t){return t==null&&(t=Ie(8)),Ta(e,t)}function UX(n){var e=wa(n);return[e]}function BX(n,e,t){return t==null&&(t=Ie(4)),Ca(e,t)}function VX(n){var e=ss(n),t=n.read_shift(1);return[e,t,"b"]}function $X(n,e,t){return t==null&&(t=Ie(9)),Ta(e,t),t.write_shift(1,n.v?1:0),t}function HX(n){var e=wa(n),t=n.read_shift(1);return[e,t,"b"]}function jX(n,e,t){return t==null&&(t=Ie(5)),Ca(e,t),t.write_shift(1,n.v?1:0),t}function WX(n){var e=ss(n),t=n.read_shift(1);return[e,t,"e"]}function KX(n,e,t){return t==null&&(t=Ie(9)),Ta(e,t),t.write_shift(1,n.v),t}function qX(n){var e=wa(n),t=n.read_shift(1);return[e,t,"e"]}function GX(n,e,t){return t==null&&(t=Ie(8)),Ca(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function zX(n){var e=ss(n),t=n.read_shift(4);return[e,t,"s"]}function YX(n,e,t){return t==null&&(t=Ie(12)),Ta(e,t),t.write_shift(4,e.v),t}function QX(n){var e=wa(n),t=n.read_shift(4);return[e,t,"s"]}function XX(n,e,t){return t==null&&(t=Ie(8)),Ca(e,t),t.write_shift(4,e.v),t}function JX(n){var e=ss(n),t=ql(n);return[e,t,"n"]}function ZX(n,e,t){return t==null&&(t=Ie(16)),Ta(e,t),ha(n.v,t),t}function eJ(n){var e=wa(n),t=ql(n);return[e,t,"n"]}function tJ(n,e,t){return t==null&&(t=Ie(12)),Ca(e,t),ha(n.v,t),t}function nJ(n){var e=ss(n),t=Db(n);return[e,t,"n"]}function rJ(n,e,t){return t==null&&(t=Ie(12)),Ta(e,t),Mb(n.v,t),t}function sJ(n){var e=wa(n),t=Db(n);return[e,t,"n"]}function iJ(n,e,t){return t==null&&(t=Ie(8)),Ca(e,t),Mb(n.v,t),t}function oJ(n){var e=ss(n),t=jv(n);return[e,t,"is"]}function aJ(n){var e=ss(n),t=mr(n);return[e,t,"str"]}function lJ(n,e,t){return t==null&&(t=Ie(12+4*n.v.length)),Ta(e,t),jn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function cJ(n){var e=wa(n),t=mr(n);return[e,t,"str"]}function uJ(n,e,t){return t==null&&(t=Ie(8+4*n.v.length)),Ca(e,t),jn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function dJ(n,e,t){var r=n.l+e,s=ss(n);s.r=t["!row"];var i=n.read_shift(1),o=[s,i,"b"];if(t.cellFormula){n.l+=2;var a=cp(n,r-n.l,t);o[3]=Pl(a,null,s,t.supbooks,t)}else n.l=r;return o}function hJ(n,e,t){var r=n.l+e,s=ss(n);s.r=t["!row"];var i=n.read_shift(1),o=[s,i,"e"];if(t.cellFormula){n.l+=2;var a=cp(n,r-n.l,t);o[3]=Pl(a,null,s,t.supbooks,t)}else n.l=r;return o}function fJ(n,e,t){var r=n.l+e,s=ss(n);s.r=t["!row"];var i=ql(n),o=[s,i,"n"];if(t.cellFormula){n.l+=2;var a=cp(n,r-n.l,t);o[3]=Pl(a,null,s,t.supbooks,t)}else n.l=r;return o}function pJ(n,e,t){var r=n.l+e,s=ss(n);s.r=t["!row"];var i=mr(n),o=[s,i,"str"];if(t.cellFormula){n.l+=2;var a=cp(n,r-n.l,t);o[3]=Pl(a,null,s,t.supbooks,t)}else n.l=r;return o}var mJ=Aa,gJ=Kl;function vJ(n,e){return e==null&&(e=Ie(4)),e.write_shift(4,n),e}function yJ(n,e){var t=n.l+e,r=Aa(n),s=Wv(n),i=mr(n),o=mr(n),a=mr(n);n.l=t;var l={rfx:r,relId:s,loc:i,display:a};return o&&(l.Tooltip=o),l}function _J(n,e){var t=Ie(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Kl({s:Hn(n[0]),e:Hn(n[0])},t),Kv("rId"+e,t);var r=n[1].Target.indexOf("#"),s=r==-1?"":n[1].Target.slice(r+1);return jn(s||"",t),jn(n[1].Tooltip||"",t),jn("",t),t.slice(0,t.l)}function EJ(){}function TJ(n,e,t){var r=n.l+e,s=Fb(n),i=n.read_shift(1),o=[s];if(o[2]=i,t.cellFormula){var a=cX(n,r-n.l,t);o[1]=a}else n.l=r;return o}function wJ(n,e,t){var r=n.l+e,s=Aa(n),i=[s];if(t.cellFormula){var o=dX(n,r-n.l,t);i[1]=o,n.l=r}else n.l=r;return i}function CJ(n,e,t){t==null&&(t=Ie(18));var r=up(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof r.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),t.write_shift(2,s),t}var _R=["left","right","top","bottom","header","footer"];function AJ(n){var e={};return _R.forEach(function(t){e[t]=ql(n)}),e}function IJ(n,e){return e==null&&(e=Ie(6*8)),vR(n),_R.forEach(function(t){ha(n[t],e)}),e}function SJ(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function xJ(n,e,t){t==null&&(t=Ie(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function bJ(n){var e=Ie(24);return e.write_shift(4,4),e.write_shift(4,1),Kl(n,e),e}function RJ(n,e){return e==null&&(e=Ie(16*4+2)),e.write_shift(2,n.password?eR(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function kJ(){}function PJ(){}function NJ(n,e,t,r,s,i,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=Lr(e),e.z=e.z||mn[14],e.v=Fr(br(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r:t,c:r};switch(l.s=bo(s.cellXfs,e,s),e.l&&i["!links"].push([jt(l),e.l]),e.c&&i["!comments"].push([jt(l),e.c]),e.t){case"s":case"str":return s.bookSST?(a=Xv(s.Strings,e.v,s.revStrings),l.t="s",l.v=a,o?De(n,18,XX(e,l)):De(n,7,YX(e,l))):(l.t="str",o?De(n,17,uJ(e,l)):De(n,6,lJ(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?De(n,13,iJ(e,l)):De(n,2,rJ(e,l)):o?De(n,16,tJ(e,l)):De(n,5,ZX(e,l)),!0;case"b":return l.t="b",o?De(n,15,jX(e,l)):De(n,4,$X(e,l)),!0;case"e":return l.t="e",o?De(n,14,GX(e,l)):De(n,3,KX(e,l)),!0}return o?De(n,12,BX(e,l)):De(n,1,LX(e,l)),!0}function OJ(n,e,t,r){var s=on(e["!ref"]||"A1"),i,o="",a=[];De(n,145);var l=Array.isArray(e),u=s.e.r;e["!rows"]&&(u=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=u;++d){o=tr(d),kX(n,e,s,d);var f=!1;if(d<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){d===s.s.r&&(a[p]=pr(p)),i=a[p]+o;var m=l?(e[d]||[])[p]:e[i];if(!m){f=!1;continue}f=NJ(n,m,d,p,r,e,f)}}De(n,146)}function DJ(n,e){!e||!e["!merges"]||(De(n,177,vJ(e["!merges"].length)),e["!merges"].forEach(function(t){De(n,176,gJ(t))}),De(n,178))}function MJ(n,e){!e||!e["!cols"]||(De(n,390),e["!cols"].forEach(function(t,r){t&&De(n,60,CJ(r,t))}),De(n,391))}function FJ(n,e){!e||!e["!ref"]||(De(n,648),De(n,649,bJ(on(e["!ref"]))),De(n,650))}function LJ(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var s=Vt(t,-1,r[1].Target.replace(/#.*$/,""),Pt.HLINK);De(n,494,_J(r,s))}}),delete e["!links"]}function UJ(n,e,t,r){if(e["!comments"].length>0){var s=Vt(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Pt.VML);De(n,551,Kv("rId"+s)),e["!legacy"]=s}}function BJ(n,e,t,r){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:Rn(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,a=Jr(i);a.s.r==a.e.r&&(a.e.r=Jr(e["!ref"]).e.r,i=Rn(a));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+i;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),De(n,161,Kl(on(i))),De(n,162)}}function VJ(n,e,t){De(n,133),De(n,137,xJ(e,t)),De(n,138),De(n,134)}function $J(n,e){e["!protect"]&&De(n,535,RJ(e["!protect"]))}function HJ(n,e,t,r){var s=Mr(),i=t.SheetNames[n],o=t.Sheets[i]||{},a=i;try{t&&t.Workbook&&(a=t.Workbook.Sheets[n].CodeName||a)}catch{}var l=on(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],De(s,129),(t.vbaraw||o["!outline"])&&De(s,147,MX(a,o["!outline"])),De(s,148,NX(l)),VJ(s,o,t.Workbook),MJ(s,o),OJ(s,o,n,e),$J(s,o),BJ(s,o,t,n),DJ(s,o),LJ(s,o,r),o["!margins"]&&De(s,476,IJ(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&FJ(s,o),UJ(s,o,n,r),De(s,130),s.end()}function jJ(n,e){n.l+=10;var t=mr(n);return{name:t}}var WJ=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function KJ(n){return!n.Workbook||!n.Workbook.WBProps?"false":wG(n.Workbook.WBProps.date1904)?"true":"false"}var qJ="][*?/\\".split("");function ER(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return qJ.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function GJ(n,e,t){n.forEach(function(r,s){ER(r);for(var i=0;i<s;++i)if(r==n[i])throw new Error("Duplicate Sheet Name: "+r);if(t){var o=e&&e[s]&&e[s].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function zJ(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];GJ(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)gX(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function TR(n){var e=[Pn];e[e.length]=$e("workbook",null,{xmlns:jl[0],"xmlns:r":$n.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(WJ.forEach(function(a){n.Workbook.WBProps[a[0]]!=null&&n.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=n.Workbook.WBProps[a[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=$e("workbookPr",null,r);var s=n.Workbook&&n.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=n.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==n.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=n.SheetNames.length;++i){var o={name:$t(n.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=$e("sheet",null,o)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=$e("definedName",$t(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function YJ(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=_0(n),t.name=mr(n),t}function QJ(n,e){return e||(e=Ie(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),Kv(n.strRelID,e),jn(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function XJ(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var s=e>8?mr(n):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function JJ(n,e){e||(e=Ie(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),Ob(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function ZJ(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var s=n.read_shift(4),i=KG(n),o=uX(n,0,t),a=Wv(n);n.l=r;var l={Name:i,Ptg:o};return s<268435455&&(l.Sheet=s),a&&(l.Comment=a),l}function eZ(n,e){De(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,s={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};De(n,156,QJ(s))}De(n,144)}function tZ(n,e){e||(e=Ie(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return jn("SheetJS",e),jn(Dh.version,e),jn(Dh.version,e),jn("7262",e),e.length>e.l?e.slice(0,e.l):e}function nZ(n,e){e||(e=Ie(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function rZ(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,s=-1,i=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&s==-1?s=r:t[r].Hidden==1&&i==-1&&(i=r);i>s||(De(n,135),De(n,158,nZ(s)),De(n,136))}}function sZ(n,e){var t=Mr();return De(t,131),De(t,128,tZ()),De(t,153,JJ(n.Workbook&&n.Workbook.WBProps||null)),rZ(t,n),eZ(t,n),De(t,132),t.end()}function iZ(n,e,t){return(e.slice(-4)===".bin"?sZ:TR)(n)}function oZ(n,e,t,r,s){return(e.slice(-4)===".bin"?HJ:yR)(n,t,r,s)}function aZ(n,e,t){return(e.slice(-4)===".bin"?IY:rR)(n,t)}function lZ(n,e,t){return(e.slice(-4)===".bin"?Jz:Zb)(n,t)}function cZ(n,e,t){return(e.slice(-4)===".bin"?$Y:lR)(n)}function uZ(n){return(n.slice(-4)===".bin"?OY:oR)()}function dZ(n,e){var t=[];return n.Props&&t.push(az(n.Props,e)),n.Custprops&&t.push(lz(n.Props,n.Custprops)),t.join("")}function hZ(){return""}function fZ(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,s){var i=[];i.push($e("NumberFormat",null,{"ss:Format":$t(mn[r.numFmtId])}));var o={"ss:ID":"s"+(21+s)};t.push($e("Style",i.join(""),o))}),$e("Styles",t.join(""))}function wR(n){return $e("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Yv(n.Ref,{r:0,c:0})})}function pZ(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var s=e[r];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(wR(s)))}return $e("Names",t.join(""))}function mZ(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,i=[],o=0;o<s.length;++o){var a=s[o];a.Sheet==t&&(a.Name.match(/^_xlfn\./)||i.push(wR(a)))}return i.join("")}function gZ(n,e,t,r){if(!n)return"";var s=[];if(n["!margins"]&&(s.push("<PageSetup>"),n["!margins"].header&&s.push($e("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&s.push($e("Footer",null,{"x:Margin":n["!margins"].footer})),s.push($e("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)s.push($e("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(r.Workbook.Sheets[i]&&!r.Workbook.Sheets[i].Hidden);++i);i==t&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),n["!protect"]&&(s.push(Jn("ProtectContents","True")),n["!protect"].objects&&s.push(Jn("ProtectObjects","True")),n["!protect"].scenarios&&s.push(Jn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?s.push(Jn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&s.push(Jn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){n["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":$e("WorksheetOptions",s.join(""),{xmlns:Kr.x})}function vZ(n){return n.map(function(e){var t=TG(e.t||""),r=$e("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return $e("Comment",r,{"ss:Author":e.a})}).join("")}function yZ(n,e,t,r,s,i,o){if(!n||n.v==null&&n.f==null)return"";var a={};if(n.f&&(a["ss:Formula"]="="+$t(Yv(n.f,o))),n.F&&n.F.slice(0,e.length)==e){var l=Hn(n.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(n.l&&n.l.Target&&(a["ss:HRef"]=$t(n.l.Target),n.l.Tooltip&&(a["x:HRefScreenTip"]=$t(n.l.Tooltip))),t["!merges"])for(var u=t["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(a["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(a["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",p="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",p=String(n.v);break;case"b":f="Boolean",p=n.v?"1":"0";break;case"e":f="Error",p=Hu[n.v];break;case"d":f="DateTime",p=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||mn[14]);break;case"s":f="String",p=EG(n.v||"");break}var m=bo(r.cellXfs,n,r);a["ss:StyleID"]="s"+(21+m),a["ss:Index"]=o.c+1;var g=n.v!=null?p:"",v=n.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(n.c||[]).length>0&&(v+=vZ(n.c)),$e("Cell",v,a)}function _Z(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=nR(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function EZ(n,e,t,r){if(!n["!ref"])return"";var s=on(n["!ref"]),i=n["!merges"]||[],o=0,a=[];n["!cols"]&&n["!cols"].forEach(function(y,L){Gv(y);var D=!!y.width,A=up(L,y),C={"ss:Index":L+1};D&&(C["ss:Width"]=Wh(A.width)),y.hidden&&(C["ss:Hidden"]="1"),a.push($e("Column",null,C))});for(var l=Array.isArray(n),u=s.s.r;u<=s.e.r;++u){for(var d=[_Z(u,(n["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var p=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>u)&&!(i[o].e.c<f)&&!(i[o].e.r<u)){(i[o].s.c!=f||i[o].s.r!=u)&&(p=!0);break}if(!p){var m={r:u,c:f},g=jt(m),v=l?(n[u]||[])[f]:n[g];d.push(yZ(v,g,n,e,t,r,m))}}d.push("</Row>"),d.length>2&&a.push(d.join(""))}return a.join("")}function TZ(n,e,t){var r=[],s=t.SheetNames[n],i=t.Sheets[s],o=i?mZ(i,e,n,t):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=i?EZ(i,e,n,t):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(gZ(i,e,n,t)),r.join("")}function wZ(n,e){e||(e={}),n.SSF||(n.SSF=Lr(mn)),n.SSF&&(ip(),sp(n.SSF),e.revssf=op(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],bo(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(dZ(n,e)),t.push(hZ()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push($e("Worksheet",TZ(r,e,n),{"ss:Name":$t(n.SheetNames[r])}));return t[2]=fZ(n,e),t[3]=pZ(n),Pn+$e("Workbook",t.join(""),{xmlns:Kr.ss,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:ss":Kr.ss,"xmlns:dt":Kr.dt,"xmlns:html":Kr.html})}var sm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function CZ(n,e){var t=[],r=[],s=[],i=0,o,a=nT(mT,"n"),l=nT(gT,"n");if(n.Props)for(o=nr(n.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(a,o[i])?t:Object.prototype.hasOwnProperty.call(l,o[i])?r:s).push([o[i],n.Props[o[i]]]);if(n.Custprops)for(o=nr(n.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(n.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(a,o[i])?t:Object.prototype.hasOwnProperty.call(l,o[i])?r:s).push([o[i],n.Custprops[o[i]]]);var u=[];for(i=0;i<s.length;++i)qb.indexOf(s[i][0])>-1||jb.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);r.length&&Wt.utils.cfb_add(e,"/SummaryInformation",TT(r,sm.SI,l,gT)),(t.length||u.length)&&Wt.utils.cfb_add(e,"/DocumentSummaryInformation",TT(t,sm.DSI,a,mT,u.length?u:null,sm.UDI))}function AZ(n,e){var t=e||{},r=Wt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Wt.utils.cfb_add(r,s,CR(n,t)),t.biff==8&&(n.Props||n.Custprops)&&CZ(n,r),t.biff==8&&n.vbaraw&&HY(r,Wt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var IZ={0:{f:bX},1:{f:FX},2:{f:nJ},3:{f:WX},4:{f:VX},5:{f:JX},6:{f:aJ},7:{f:zX},8:{f:pJ},9:{f:fJ},10:{f:dJ},11:{f:hJ},12:{f:UX},13:{f:sJ},14:{f:qX},15:{f:HX},16:{f:eJ},17:{f:cJ},18:{f:QX},19:{f:jv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ZJ},40:{},42:{},43:{f:aY},44:{f:iY},45:{f:uY},46:{f:hY},47:{f:dY},48:{},49:{f:UG},50:{},51:{f:bY},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Bz},62:{f:oJ},63:{f:DY},64:{f:kJ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:SJ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DX},148:{f:PX,p:16},151:{f:EJ},152:{},153:{f:XJ},154:{},155:{},156:{f:YJ},157:{},158:{},159:{T:1,f:Yz},160:{T:-1},161:{T:1,f:Aa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mJ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SY},336:{T:-1},337:{f:PY,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Oz},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:TJ},427:{f:wJ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:AJ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:OX},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:yJ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:BY},633:{T:1},634:{T:-1},635:{T:1,f:LY},636:{T:-1},637:{f:HG},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:jJ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:PJ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function He(n,e,t,r){var s=e;if(!isNaN(s)){var i=r||(t||[]).length||0,o=n.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&Vv(t)&&n.push(t)}}function SZ(n,e,t,r){var s=(t||[]).length||0;if(s<=8224)return He(n,e,t,s);var i=e;if(!isNaN(i)){for(var o=t.parts||[],a=0,l=0,u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;var d=n.next(4);for(d.write_shift(2,i),d.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u;l<s;){for(d=n.next(4),d.write_shift(2,60),u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;d.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u}}}function Wu(n,e,t){return n||(n=Ie(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function xZ(n,e,t,r){var s=Ie(9);return Wu(s,n,e),zb(t,r||"b",s),s}function bZ(n,e,t){var r=Ie(8+2*t.length);return Wu(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function RZ(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Fr(br(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?He(n,2,jz(t,r,s)):He(n,3,Hz(t,r,s));return;case"b":case"e":He(n,5,xZ(t,r,e.v,e.t));return;case"s":case"str":He(n,4,bZ(t,r,(e.v||"").slice(0,255)));return}He(n,1,Wu(null,t,r))}function kZ(n,e,t,r){var s=Array.isArray(e),i=on(e["!ref"]||"A1"),o,a="",l=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Rn(i)}for(var u=i.s.r;u<=i.e.r;++u){a=tr(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(l[d]=pr(d)),o=l[d]+a;var f=s?(e[u]||[])[d]:e[o];f&&RZ(n,f,u,d)}}}function PZ(n,e){for(var t=e||{},r=Mr(),s=0,i=0;i<n.SheetNames.length;++i)n.SheetNames[i]==t.sheet&&(s=i);if(s==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return He(r,t.biff==4?1033:t.biff==3?521:9,qv(n,16,t)),kZ(r,n.Sheets[n.SheetNames[s]],s,t),He(r,10),r.end()}function NZ(n,e,t){He(n,49,Iz({sz:12,name:"Arial"},t))}function OZ(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&He(n,1054,bz(s,e[s],t))})}function DZ(n,e){var t=Ie(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),He(n,2151,t),t=Ie(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Xb(on(e["!ref"]||"A1"),t),t.write_shift(4,4),He(n,2152,t)}function MZ(n,e){for(var t=0;t<16;++t)He(n,224,CT({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){He(n,224,CT(r,0,e))})}function FZ(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];He(n,440,Fz(r)),r[1].Tooltip&&He(n,2048,Lz(r))}delete e["!links"]}function LZ(n,e){if(e){var t=0;e.forEach(function(r,s){++t<=256&&r&&He(n,125,Vz(up(s,r),s))})}}function UZ(n,e,t,r,s){var i=16+bo(s.cellXfs,e,s);if(e.v==null&&!e.bf){He(n,513,fa(t,r,i));return}if(e.bf)He(n,6,lX(e,t,r,s,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?Fr(br(e.v)):e.v;He(n,515,Nz(t,r,o,i));break;case"b":case"e":He(n,517,Pz(t,r,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var a=Xv(s.Strings,e.v,s.revStrings);He(n,253,Sz(t,r,a,i))}else He(n,516,xz(t,r,(e.v||"").slice(0,255),i,s));break;default:He(n,513,fa(t,r,i))}}function BZ(n,e,t){var r=Mr(),s=t.SheetNames[n],i=t.Sheets[s]||{},o=(t||{}).Workbook||{},a=(o.Sheets||[])[n]||{},l=Array.isArray(i),u=e.biff==8,d,f="",p=[],m=on(i["!ref"]||"A1"),g=u?65536:16384;if(m.e.c>255||m.e.r>=g){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}He(r,2057,qv(t,16,e)),He(r,13,ts(1)),He(r,12,ts(100)),He(r,15,Ar(!0)),He(r,17,Ar(!1)),He(r,16,ha(.001)),He(r,95,Ar(!0)),He(r,42,Ar(!1)),He(r,43,Ar(!1)),He(r,130,ts(1)),He(r,128,kz()),He(r,131,Ar(!1)),He(r,132,Ar(!1)),u&&LZ(r,i["!cols"]),He(r,512,Rz(m,e)),u&&(i["!links"]=[]);for(var v=m.s.r;v<=m.e.r;++v){f=tr(v);for(var y=m.s.c;y<=m.e.c;++y){v===m.s.r&&(p[y]=pr(y)),d=p[y]+f;var L=l?(i[v]||[])[y]:i[d];L&&(UZ(r,L,v,y,e),u&&L.l&&i["!links"].push([d,L.l]))}}var D=a.CodeName||a.name||s;return u&&He(r,574,Az((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&He(r,229,Mz(i["!merges"])),u&&FZ(r,i),He(r,442,Qb(D)),u&&DZ(r,i),He(r,10),r.end()}function VZ(n,e,t){var r=Mr(),s=(n||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},a=t.biff==8,l=t.biff==5;if(He(r,2057,qv(n,5,t)),t.bookType=="xla"&&He(r,135),He(r,225,a?ts(1200):null),He(r,193,dz(2)),l&&He(r,191),l&&He(r,192),He(r,226),He(r,92,Ez("SheetJS",t)),He(r,66,ts(a?1200:1252)),a&&He(r,353,ts(0)),a&&He(r,448),He(r,317,$z(n.SheetNames.length)),a&&n.vbaraw&&He(r,211),a&&n.vbaraw){var u=o.CodeName||"ThisWorkbook";He(r,442,Qb(u))}He(r,156,ts(17)),He(r,25,Ar(!1)),He(r,18,Ar(!1)),He(r,19,ts(0)),a&&He(r,431,Ar(!1)),a&&He(r,444,ts(0)),He(r,61,Cz()),He(r,64,Ar(!1)),He(r,141,ts(0)),He(r,34,Ar(KJ(n)=="true")),He(r,14,Ar(!0)),a&&He(r,439,Ar(!1)),He(r,218,ts(0)),NZ(r,n,t),OZ(r,n.SSF,t),MZ(r,t),a&&He(r,352,Ar(!1));var d=r.end(),f=Mr();a&&He(f,140,Uz()),a&&t.Strings&&SZ(f,252,wz(t.Strings)),He(f,10);var p=f.end(),m=Mr(),g=0,v=0;for(v=0;v<n.SheetNames.length;++v)g+=(a?12:11)+(a?2:1)*n.SheetNames[v].length;var y=d.length+g+p.length;for(v=0;v<n.SheetNames.length;++v){var L=i[v]||{};He(m,133,Tz({pos:y,hs:L.Hidden||0,dt:0,name:n.SheetNames[v]},t)),y+=e[v].length}var D=m.end();if(g!=D.length)throw new Error("BS8 "+g+" != "+D.length);var A=[];return d.length&&A.push(d),D.length&&A.push(D),p.length&&A.push(p),Xn(A)}function $Z(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Lr(mn)),n&&n.SSF&&(ip(),sp(n.SSF),t.revssf=op(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Jv(t),t.cellXfs=[],bo(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var s=0;s<n.SheetNames.length;++s)r[r.length]=BZ(s,t,n);return r.unshift(VZ(n,r,t)),Xn(r)}function CR(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var s=Jr(r["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return $Z(n,e);case 4:case 3:case 2:return PZ(n,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function HZ(n,e,t,r){for(var s=n["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>t||s[u].s.c>o)&&!(s[u].e.r<t||s[u].e.c<o)){if(s[u].s.r<t||s[u].s.c<o){a=-1;break}a=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(a<0)){var d=jt({r:t,c:o}),f=r.dense?(n[t]||[])[o]:n[d],p=f&&f.v!=null&&(f.h||_G(f.w||(Li(f),f.w)||""))||"",m={};a>1&&(m.rowspan=a),l>1&&(m.colspan=l),r.editable?p='<span contenteditable="true">'+p+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),m.id=(r.id||"sjs")+"-"+d,i.push($e("td",p,m))}}var g="<tr>";return g+i.join("")+"</tr>"}var jZ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',WZ="</body></html>";function KZ(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function AR(n,e){var t=e||{},r=t.header!=null?t.header:jZ,s=t.footer!=null?t.footer:WZ,i=[r],o=Jr(n["!ref"]);t.dense=Array.isArray(n),i.push(KZ(n,o,t));for(var a=o.s.r;a<=o.e.r;++a)i.push(HZ(n,o,a,t));return i.push("</table>"+s),i.join("")}function IR(n,e,t){var r=t||{},s=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var o=typeof r.origin=="string"?Hn(r.origin):r.origin;s=o.r,i=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(n["!ref"]){var d=Jr(n["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],p=0,m=n["!rows"]||(n["!rows"]=[]),g=0,v=0,y=0,L=0,D=0,A=0;for(n["!cols"]||(n["!cols"]=[]);g<a.length&&v<l;++g){var C=a[g];if(kT(C)){if(r.display)continue;m[v]={hidden:!0}}var j=C.children;for(y=L=0;y<j.length;++y){var z=j[y];if(!(r.display&&kT(z))){var w=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):CG(z.innerHTML),R=z.getAttribute("data-z")||z.getAttribute("z");for(p=0;p<f.length;++p){var x=f[p];x.s.c==L+i&&x.s.r<v+s&&v+s<=x.e.r&&(L=x.e.c+1-i,p=-1)}A=+z.getAttribute("colspan")||1,((D=+z.getAttribute("rowspan")||1)>1||A>1)&&f.push({s:{r:v+s,c:L+i},e:{r:v+s+(D||1)-1,c:L+i+(A||1)-1}});var b={t:"s",v:w},N=z.getAttribute("data-t")||z.getAttribute("t")||"";w!=null&&(w.length==0?b.t=N||"z":r.raw||w.trim().length==0||N=="s"||(w==="TRUE"?b={t:"b",v:!0}:w==="FALSE"?b={t:"b",v:!1}:isNaN(Si(w))?isNaN(ou(w).getDate())||(b={t:"d",v:br(w)},r.cellDates||(b={t:"n",v:Fr(b.v)}),b.z=r.dateNF||mn[14]):b={t:"n",v:Si(w)})),b.z===void 0&&R!=null&&(b.z=R);var M="",F=z.getElementsByTagName("A");if(F&&F.length)for(var oe=0;oe<F.length&&!(F[oe].hasAttribute("href")&&(M=F[oe].getAttribute("href"),M.charAt(0)!="#"));++oe);M&&M.charAt(0)!="#"&&(b.l={Target:M}),r.dense?(n[v+s]||(n[v+s]=[]),n[v+s][L+i]=b):n[jt({c:L+i,r:v+s})]=b,u.e.c<L+i&&(u.e.c=L+i),L+=A}}++v}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,v-1+s),n["!ref"]=Rn(u),v>=l&&(n["!fullref"]=Rn((u.e.r=a.length-g+v-1+s,u))),n}function SR(n,e){var t=e||{},r=t.dense?[]:{};return IR(r,n,e)}function qZ(n,e){return Ea(SR(n,e),e)}function kT(n){var e="",t=GZ(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function GZ(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var zZ=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+lu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return Pn+e}}(),PT=function(){var n=function(i){return $t(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(i,o,a){var l=[];l.push('      <table:table table:name="'+$t(o.SheetNames[a])+`" table:style-name="ta1">
`);var u=0,d=0,f=Jr(i["!ref"]||"A1"),p=i["!merges"]||[],m=0,g=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)l.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",y=i["!rows"]||[];for(u=0;u<f.s.r;++u)v=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=f.e.r;++u){for(v=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+v+`>
`),d=0;d<f.s.c;++d)l.push(e);for(;d<=f.e.c;++d){var L=!1,D={},A="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>d)&&!(p[m].s.r>u)&&!(p[m].e.c<d)&&!(p[m].e.r<u)){(p[m].s.c!=d||p[m].s.r!=u)&&(L=!0),D["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,D["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(L){l.push(t);continue}var C=jt({r:u,c:d}),j=g?(i[u]||[])[d]:i[C];if(j&&j.f&&(D["table:formula"]=$t(pX(j.f)),j.F&&j.F.slice(0,C.length)==C)){var z=Jr(j.F);D["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,D["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!j){l.push(e);continue}switch(j.t){case"b":A=j.v?"TRUE":"FALSE",D["office:value-type"]="boolean",D["office:boolean-value"]=j.v?"true":"false";break;case"n":A=j.w||String(j.v||0),D["office:value-type"]="float",D["office:value"]=j.v||0;break;case"s":case"str":A=j.v==null?"":j.v,D["office:value-type"]="string";break;case"d":A=j.w||br(j.v).toISOString(),D["office:value-type"]="date",D["office:date-value"]=br(j.v).toISOString(),D["table:style-name"]="ce1";break;default:l.push(e);continue}var w=n(A);if(j.l&&j.l.Target){var R=j.l.Target;R=R.charAt(0)=="#"?"#"+mX(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),w=$e("text:a",w,{"xlink:href":R.replace(/&/g,"&amp;")})}l.push("          "+$e("table:table-cell",$e("text:p",w,{}),D)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Gv(f),f.ods=a;var p=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Pn],u=lu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=lu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push($b().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),s(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)l.push(r(o.Sheets[o.SheetNames[f]],o,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function xR(n,e){if(e.bookType=="fods")return PT(n,e);var t=Fv(),r="",s=[],i=[];return r="mimetype",Et(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Et(t,r,PT(n,e)),s.push([r,"text/xml"]),i.push([r,"ContentFile"]),r="styles.xml",Et(t,r,zZ(n,e)),s.push([r,"text/xml"]),i.push([r,"StylesFile"]),r="meta.xml",Et(t,r,Pn+$b()),s.push([r,"text/xml"]),i.push([r,"MetadataFile"]),r="manifest.rdf",Et(t,r,oz(i)),s.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Et(t,r,sz(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Gh(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function YZ(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):us(au(n))}function QZ(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Ao(n){var e=n.reduce(function(s,i){return s+i.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(s){t.set(s,r),r+=s.length}),t}function XZ(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var i=0;s>=1;++i,s/=256)n[e+i]=s&255;n[e+15]|=t>=0?0:128}function cu(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Lt(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function fl(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function Mn(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],s=cu(n,t),i=s&7;s=Math.floor(s/8);var o=0,a;if(s==0)break;switch(i){case 0:{for(var l=t[0];n[t[0]++]>=128;);a=n.slice(l,t[0])}break;case 5:o=4,a=n.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,a=n.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=cu(n,t),a=n.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(r))}var u={data:a,type:i};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function zn(n){var e=[];return n.forEach(function(t,r){t.forEach(function(s){s.data&&(e.push(Lt(r*8+s.type)),s.type==2&&e.push(Lt(s.data.length)),e.push(s.data))})}),Ao(e)}function as(n){for(var e,t=[],r=[0];r[0]<n.length;){var s=cu(n,r),i=Mn(n.slice(r[0],r[0]+s));r[0]+=s;var o={id:fl(i[1][0].data),messages:[]};i[2].forEach(function(a){var l=Mn(a.data),u=fl(l[3][0].data);o.messages.push({meta:l,data:n.slice(r[0],r[0]+u)}),r[0]+=u}),(e=i[3])!=null&&e[0]&&(o.merge=fl(i[3][0].data)>>>0>0),t.push(o)}return t}function Ma(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Lt(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Lt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Lt(o.data.length)}],r[2].push({data:zn(o.meta),type:2})});var i=zn(r);e.push(Lt(i.length)),e.push(i),s.forEach(function(o){return e.push(o)})}),Ao(e)}function JZ(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=cu(e,t),s=[];t[0]<e.length;){var i=e[t[0]]&3;if(i==0){var o=e[t[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[t[0]],a>1&&(o|=e[t[0]+1]<<8),a>2&&(o|=e[t[0]+2]<<16),a>3&&(o|=e[t[0]+3]<<24),o>>>=0,o++,t[0]+=a}s.push(e.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var l=0,u=0;if(i==1?(u=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,i==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),s=[Ao(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var d=Ao(s);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function ls(n){for(var e=[],t=0;t<n.length;){var r=n[t++],s=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(JZ(r,n.slice(t,t+s))),t+=s}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Ao(e)}function Fa(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),s=new Uint8Array(4);e.push(s);var i=Lt(r),o=i.length;e.push(i),r<=60?(o++,e.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),o+=r,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,t+=r}return Ao(e)}function im(n,e){var t=new Uint8Array(32),r=Gh(t),s=12,i=0;switch(t[0]=5,n.t){case"n":t[1]=2,XZ(t,s,n.v),i|=1,s+=16;break;case"b":t[1]=6,r.setFloat64(s,n.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(s,e.indexOf(n.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,i,!0),t.slice(0,s)}function om(n,e){var t=new Uint8Array(32),r=Gh(t),s=12,i=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(s,n.v,!0),i|=32,s+=8;break;case"b":t[2]=6,r.setFloat64(s,n.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(s,e.indexOf(n.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,i,!0),t.slice(0,s)}function zi(n){var e=Mn(n);return cu(e[1][0].data)}function ZZ(n,e,t){var r,s,i,o;if(!((r=n[6])!=null&&r[0])||!((s=n[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(i=n[8])==null?void 0:i[0])==null?void 0:o.data)&&fl(n[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,u=Gh(n[7][0].data),d=0,f=[],p=Gh(n[4][0].data),m=0,g=[],v=0;v<e.length;++v){if(e[v]==null){u.setUint16(v*2,65535,!0),p.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),p.setUint16(v*2,m,!0);var y,L;switch(typeof e[v]){case"string":y=im({t:"s",v:e[v]},t),L=om({t:"s",v:e[v]},t);break;case"number":y=im({t:"n",v:e[v]},t),L=om({t:"n",v:e[v]},t);break;case"boolean":y=im({t:"b",v:e[v]},t),L=om({t:"b",v:e[v]},t);break;default:throw new Error("Unsupported value "+e[v])}f.push(y),d+=y.length,g.push(L),m+=L.length,++l}for(n[2][0].data=Lt(l);v<n[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),p.setUint16(v*2,65535,!0);return n[6][0].data=Ao(f),n[3][0].data=Ao(g),l}function eee(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Jr(t["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Rn(r)));var i=zh(t,{range:r,header:1}),o=["~Sh33tJ5~"];i.forEach(function(T){return T.forEach(function(U){typeof U=="string"&&o.push(U)})});var a={},l=[],u=Wt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(T,U){return[T,u.FullPaths[U]]}).forEach(function(T){var U=T[0],ee=T[1];if(U.type==2&&U.name.match(/\.iwa/)){var le=U.content,se=ls(le),ve=as(se);ve.forEach(function(te){l.push(te.id),a[te.id]={deps:[],location:ee,type:fl(te.messages[0].meta[1][0].data)}})}}),l.sort(function(T,U){return T-U});var d=l.filter(function(T){return T>1}).map(function(T){return[T,Lt(T)]});u.FileIndex.map(function(T,U){return[T,u.FullPaths[U]]}).forEach(function(T){var U=T[0];if(T[1],!!U.name.match(/\.iwa/)){var ee=as(ls(U.content));ee.forEach(function(le){le.messages.forEach(function(se){d.forEach(function(ve){le.messages.some(function(te){return fl(te.meta[1][0].data)!=11006&&QZ(te.data,ve[1])})&&a[ve[0]].deps.push(le.id)})})})}});for(var f=Wt.find(u,a[1].location),p=as(ls(f.content)),m,g=0;g<p.length;++g){var v=p[g];v.id==1&&(m=v)}var y=zi(Mn(m.messages[0].data)[1][0].data);for(f=Wt.find(u,a[y].location),p=as(ls(f.content)),g=0;g<p.length;++g)v=p[g],v.id==y&&(m=v);for(y=zi(Mn(m.messages[0].data)[2][0].data),f=Wt.find(u,a[y].location),p=as(ls(f.content)),g=0;g<p.length;++g)v=p[g],v.id==y&&(m=v);for(y=zi(Mn(m.messages[0].data)[2][0].data),f=Wt.find(u,a[y].location),p=as(ls(f.content)),g=0;g<p.length;++g)v=p[g],v.id==y&&(m=v);var L=Mn(m.messages[0].data);{L[6][0].data=Lt(r.e.r+1),L[7][0].data=Lt(r.e.c+1);var D=zi(L[46][0].data),A=Wt.find(u,a[D].location),C=as(ls(A.content));{for(var j=0;j<C.length&&C[j].id!=D;++j);if(C[j].id!=D)throw"Bad ColumnRowUIDMapArchive";var z=Mn(C[j].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var w=0;w<=r.e.c;++w){var R=[];R[1]=R[2]=[{type:0,data:Lt(w+420690)}],z[1].push({type:2,data:zn(R)}),z[2].push({type:0,data:Lt(w)}),z[3].push({type:0,data:Lt(w)})}z[4]=[],z[5]=[],z[6]=[];for(var x=0;x<=r.e.r;++x)R=[],R[1]=R[2]=[{type:0,data:Lt(x+726270)}],z[4].push({type:2,data:zn(R)}),z[5].push({type:0,data:Lt(x)}),z[6].push({type:0,data:Lt(x)});C[j].messages[0].data=zn(z)}A.content=Fa(Ma(C)),A.size=A.content.length,delete L[46];var b=Mn(L[4][0].data);{b[7][0].data=Lt(r.e.r+1);var N=Mn(b[1][0].data),M=zi(N[2][0].data);A=Wt.find(u,a[M].location),C=as(ls(A.content));{if(C[0].id!=M)throw"Bad HeaderStorageBucket";var F=Mn(C[0].messages[0].data);for(x=0;x<i.length;++x){var oe=Mn(F[2][0].data);oe[1][0].data=Lt(x),oe[4][0].data=Lt(i[x].length),F[2][x]={type:F[2][0].type,data:zn(oe)}}C[0].messages[0].data=zn(F)}A.content=Fa(Ma(C)),A.size=A.content.length;var Q=zi(b[2][0].data);A=Wt.find(u,a[Q].location),C=as(ls(A.content));{if(C[0].id!=Q)throw"Bad HeaderStorageBucket";for(F=Mn(C[0].messages[0].data),w=0;w<=r.e.c;++w)oe=Mn(F[2][0].data),oe[1][0].data=Lt(w),oe[4][0].data=Lt(r.e.r+1),F[2][w]={type:F[2][0].type,data:zn(oe)};C[0].messages[0].data=zn(F)}A.content=Fa(Ma(C)),A.size=A.content.length;var ne=zi(b[4][0].data);(function(){for(var T=Wt.find(u,a[ne].location),U=as(ls(T.content)),ee,le=0;le<U.length;++le){var se=U[le];se.id==ne&&(ee=se)}var ve=Mn(ee.messages[0].data);{ve[3]=[];var te=[];o.forEach(function(I,S){te[1]=[{type:0,data:Lt(S)}],te[2]=[{type:0,data:Lt(1)}],te[3]=[{type:2,data:YZ(I)}],ve[3].push({type:2,data:zn(te)})})}ee.messages[0].data=zn(ve);var O=Ma(U),H=Fa(O);T.content=H,T.size=T.content.length})();var ge=Mn(b[3][0].data);{var xe=ge[1][0];delete ge[2];var Ee=Mn(xe.data);{var Pe=zi(Ee[2][0].data);(function(){for(var T=Wt.find(u,a[Pe].location),U=as(ls(T.content)),ee,le=0;le<U.length;++le){var se=U[le];se.id==Pe&&(ee=se)}var ve=Mn(ee.messages[0].data);{delete ve[6],delete ge[7];var te=new Uint8Array(ve[5][0].data);ve[5]=[];for(var O=0,H=0;H<=r.e.r;++H){var I=Mn(te);O+=ZZ(I,i[H],o),I[1][0].data=Lt(H),ve[5].push({data:zn(I),type:2})}ve[1]=[{type:0,data:Lt(r.e.c+1)}],ve[2]=[{type:0,data:Lt(r.e.r+1)}],ve[3]=[{type:0,data:Lt(O)}],ve[4]=[{type:0,data:Lt(r.e.r+1)}]}ee.messages[0].data=zn(ve);var S=Ma(U),B=Fa(S);T.content=B,T.size=T.content.length})()}xe.data=zn(Ee)}b[3][0].data=zn(ge)}L[4][0].data=zn(b)}m.messages[0].data=zn(L);var he=Ma(p),E=Fa(he);return f.content=E,f.size=f.content.length,u}function tee(n){return function(t){for(var r=0;r!=n.length;++r){var s=n[r];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Jv(n){tee([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function nee(n,e){return e.bookType=="ods"?xR(n,e):e.bookType=="numbers"?eee(n,e):e.bookType=="xlsb"?ree(n,e):see(n,e)}function ree(n,e){Ja=1024,n&&!n.SSF&&(n.SSF=Lr(mn)),n&&n.SSF&&(ip(),sp(n.SSF),e.revssf=op(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$c?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=cR.indexOf(e.bookType)>-1,s=Ub();Jv(e=e||{});var i=Fv(),o="",a=0;if(e.cellXfs=[],bo(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",Et(i,o,Hb(n.Props,e)),s.coreprops.push(o),Vt(e.rels,2,o,Pt.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,Et(i,o,Wb(n.Props)),s.extprops.push(o),Vt(e.rels,3,o,Pt.EXT_PROPS),n.Custprops!==n.Props&&nr(n.Custprops||{}).length>0&&(o="docProps/custom.xml",Et(i,o,Kb(n.Custprops)),s.custprops.push(o),Vt(e.rels,4,o,Pt.CUST_PROPS)),a=1;a<=n.SheetNames.length;++a){var d={"!id":{}},f=n.Sheets[n.SheetNames[a-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+a+"."+t,Et(i,o,oZ(a-1,o,e,n,d)),s.sheets.push(o),Vt(e.wbrels,-1,"worksheets/sheet"+a+"."+t,Pt.WS[0])}if(f){var m=f["!comments"],g=!1,v="";m&&m.length>0&&(v="xl/comments"+a+"."+t,Et(i,v,cZ(m,v)),s.comments.push(v),Vt(d,-1,"../comments"+a+"."+t,Pt.CMNT),g=!0),f["!legacy"]&&g&&Et(i,"xl/drawings/vmlDrawing"+a+".vml",aR(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Et(i,Vb(o),dl(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,Et(i,o,lZ(e.Strings,o,e)),s.strs.push(o),Vt(e.wbrels,-1,"sharedStrings."+t,Pt.SST)),o="xl/workbook."+t,Et(i,o,iZ(n,o)),s.workbooks.push(o),Vt(e.rels,1,o,Pt.WB),o="xl/theme/theme1.xml",Et(i,o,iR(n.Themes,e)),s.themes.push(o),Vt(e.wbrels,-1,"theme/theme1.xml",Pt.THEME),o="xl/styles."+t,Et(i,o,aZ(n,o,e)),s.styles.push(o),Vt(e.wbrels,-1,"styles."+t,Pt.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",Et(i,o,n.vbaraw),s.vba.push(o),Vt(e.wbrels,-1,"vbaProject.bin",Pt.VBA)),o="xl/metadata."+t,Et(i,o,uZ(o)),s.metadata.push(o),Vt(e.wbrels,-1,"metadata."+t,Pt.XLMETA),Et(i,"[Content_Types].xml",Bb(s,e)),Et(i,"_rels/.rels",dl(e.rels)),Et(i,"xl/_rels/workbook."+t+".rels",dl(e.wbrels)),delete e.revssf,delete e.ssf,i}function see(n,e){Ja=1024,n&&!n.SSF&&(n.SSF=Lr(mn)),n&&n.SSF&&(ip(),sp(n.SSF),e.revssf=op(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$c?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=cR.indexOf(e.bookType)>-1,s=Ub();Jv(e=e||{});var i=Fv(),o="",a=0;if(e.cellXfs=[],bo(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",Et(i,o,Hb(n.Props,e)),s.coreprops.push(o),Vt(e.rels,2,o,Pt.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,Et(i,o,Wb(n.Props)),s.extprops.push(o),Vt(e.rels,3,o,Pt.EXT_PROPS),n.Custprops!==n.Props&&nr(n.Custprops||{}).length>0&&(o="docProps/custom.xml",Et(i,o,Kb(n.Custprops)),s.custprops.push(o),Vt(e.rels,4,o,Pt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,a=1;a<=n.SheetNames.length;++a){var f={"!id":{}},p=n.Sheets[n.SheetNames[a-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+a+"."+t,Et(i,o,yR(a-1,e,n,f)),s.sheets.push(o),Vt(e.wbrels,-1,"worksheets/sheet"+a+"."+t,Pt.WS[0])}if(p){var g=p["!comments"],v=!1,y="";if(g&&g.length>0){var L=!1;g.forEach(function(D){D[1].forEach(function(A){A.T==!0&&(L=!0)})}),L&&(y="xl/threadedComments/threadedComment"+a+"."+t,Et(i,y,MY(g,d,e)),s.threadedcomments.push(y),Vt(f,-1,"../threadedComments/threadedComment"+a+"."+t,Pt.TCMNT)),y="xl/comments"+a+"."+t,Et(i,y,lR(g)),s.comments.push(y),Vt(f,-1,"../comments"+a+"."+t,Pt.CMNT),v=!0}p["!legacy"]&&v&&Et(i,"xl/drawings/vmlDrawing"+a+".vml",aR(a,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Et(i,Vb(o),dl(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,Et(i,o,Zb(e.Strings,e)),s.strs.push(o),Vt(e.wbrels,-1,"sharedStrings."+t,Pt.SST)),o="xl/workbook."+t,Et(i,o,TR(n)),s.workbooks.push(o),Vt(e.rels,1,o,Pt.WB),o="xl/theme/theme1.xml",Et(i,o,iR(n.Themes,e)),s.themes.push(o),Vt(e.wbrels,-1,"theme/theme1.xml",Pt.THEME),o="xl/styles."+t,Et(i,o,rR(n,e)),s.styles.push(o),Vt(e.wbrels,-1,"styles."+t,Pt.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",Et(i,o,n.vbaraw),s.vba.push(o),Vt(e.wbrels,-1,"vbaProject.bin",Pt.VBA)),o="xl/metadata."+t,Et(i,o,oR()),s.metadata.push(o),Vt(e.wbrels,-1,"metadata."+t,Pt.XLMETA),d.length>1&&(o="xl/persons/person.xml",Et(i,o,FY(d)),s.people.push(o),Vt(e.wbrels,-1,"persons/person.xml",Pt.PEOPLE)),Et(i,"[Content_Types].xml",Bb(s,e)),Et(i,"_rels/.rels",dl(e.rels)),Et(i,"xl/_rels/workbook."+t+".rels",dl(e.wbrels)),delete e.revssf,delete e.ssf,i}function iee(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Fi(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function bR(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Vu(e.file,Wt.write(n,{type:Ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Wt.write(n,e)}function oee(n,e){var t=Lr(e||{}),r=nee(n,t);return aee(r,t)}function aee(n,e){var t={},r=Ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var s=n.FullPaths?Wt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(rp(s))}return e.password&&typeof encrypt_agile<"u"?bR(encrypt_agile(s,e.password),e):e.type==="file"?Vu(e.file,s):e.type=="string"?Lc(s):s}function lee(n,e){var t=e||{},r=AZ(n,t);return bR(r,t)}function Rs(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return iu(au(r));case"binary":return au(r);case"string":return n;case"file":return Vu(e.file,r,"utf8");case"buffer":return Ot?Vi(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Rs(r,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function cee(n,e){switch(e.type){case"base64":return iu(n);case"binary":return n;case"string":return n;case"file":return Vu(e.file,n,"binary");case"buffer":return Ot?Vi(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Pd(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?iu(t):e.type=="string"?Lc(t):t;case"file":return Vu(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function Zv(n,e){Lq(),zJ(n);var t=Lr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=Zv(n,t);return t.type="array",rp(r)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=n.SheetNames.indexOf(t.sheet),!n.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Rs(wZ(n,t),t);case"slk":case"sylk":return Rs(Kz.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"htm":case"html":return Rs(AR(n.Sheets[n.SheetNames[s]],t),t);case"txt":return cee(RR(n.Sheets[n.SheetNames[s]],t),t);case"csv":return Rs(ey(n.Sheets[n.SheetNames[s]],t),t,"\uFEFF");case"dif":return Rs(qz.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"dbf":return Pd(Wz.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"prn":return Rs(Gz.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"rtf":return Rs(eY.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"eth":return Rs(Jb.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"fods":return Rs(xR(n,t),t);case"wk1":return Pd(AT.sheet_to_wk1(n.Sheets[n.SheetNames[s]],t),t);case"wk3":return Pd(AT.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Pd(CR(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),lee(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return oee(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function uee(n,e,t,r,s,i,o,a){var l=tr(t),u=a.defval,d=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:t,enumerable:!1})}catch{p.__rowNum__=t}else p.__rowNum__=t;if(!o||n[t])for(var m=e.s.c;m<=e.e.c;++m){var g=o?n[t][m]:n[r[m]+l];if(g===void 0||g.t===void 0){if(u===void 0)continue;i[m]!=null&&(p[i[m]]=u);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[m]!=null){if(v==null)if(g.t=="e"&&v===null)p[i[m]]=null;else if(u!==void 0)p[i[m]]=u;else if(d&&v===null)p[i[m]]=null;else continue;else p[i[m]]=d&&(g.t!=="n"||g.t==="n"&&a.rawNumbers!==!1)?v:Li(g,v,a);v!=null&&(f=!1)}}return{row:p,isempty:f}}function zh(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,s=1,i=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:n["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof d){case"string":l=on(d);break;case"number":l=on(n["!ref"]),l.s.r=d;break;default:l=d}r>0&&(s=0);var f=tr(l.s.r),p=[],m=[],g=0,v=0,y=Array.isArray(n),L=l.s.r,D=0,A={};y&&!n[L]&&(n[L]=[]);var C=u.skipHidden&&n["!cols"]||[],j=u.skipHidden&&n["!rows"]||[];for(D=l.s.c;D<=l.e.c;++D)if(!(C[D]||{}).hidden)switch(p[D]=pr(D),t=y?n[L][D]:n[p[D]+f],r){case 1:i[D]=D-l.s.c;break;case 2:i[D]=p[D];break;case 3:i[D]=u.header[D-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),a=o=Li(t,null,u),v=A[o]||0,!v)A[o]=1;else{do a=o+"_"+v++;while(A[a]);A[o]=v,A[a]=1}i[D]=a}for(L=l.s.r+s;L<=l.e.r;++L)if(!(j[L]||{}).hidden){var z=uee(n,l,L,p,r,i,y,u);(z.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(m[g++]=z.row)}return m.length=g,m}var NT=/"/g;function dee(n,e,t,r,s,i,o,a){for(var l=!0,u=[],d="",f=tr(t),p=e.s.c;p<=e.e.c;++p)if(r[p]){var m=a.dense?(n[t]||[])[p]:n[r[p]+f];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(a.rawNumbers&&m.t=="n"?m.v:Li(m,null,a));for(var g=0,v=0;g!==d.length;++g)if((v=d.charCodeAt(g))===s||v===i||v===34||a.forceQuotes){d='"'+d.replace(NT,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(NT,'""')+'"')):d="";u.push(d)}return a.blankrows===!1&&l?null:u.join(o)}function ey(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var s=on(n["!ref"]),i=r.FS!==void 0?r.FS:",",o=i.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];r.dense=Array.isArray(n);for(var p=r.skipHidden&&n["!cols"]||[],m=r.skipHidden&&n["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(p[g]||{}).hidden||(f[g]=pr(g));for(var v=0,y=s.s.r;y<=s.e.r;++y)(m[y]||{}).hidden||(d=dee(n,s,y,f,o,l,i,r),d!=null&&(r.strip&&(d=d.replace(u,"")),(d||r.blankrows!==!1)&&t.push((v++?a:"")+d)));return delete r.dense,t.join("")}function RR(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=ey(n,e);return t}function hee(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var s=on(n["!ref"]),i="",o=[],a,l=[],u=Array.isArray(n);for(a=s.s.c;a<=s.e.c;++a)o[a]=pr(a);for(var d=s.s.r;d<=s.e.r;++d)for(i=tr(d),a=s.s.c;a<=s.e.c;++a)if(e=o[a]+i,t=u?(n[d]||[])[a]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function kR(n,e,t){var r=t||{},s=+!r.skipHeader,i=n||{},o=0,a=0;if(i&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?Hn(r.origin):r.origin;o=l.r,a=l.c}var u,d={s:{c:0,r:0},e:{c:a,r:o+e.length-1+s}};if(i["!ref"]){var f=on(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+e.length-1+s)}else o==-1&&(o=0,d.e.r=e.length-1+s);var p=r.header||[],m=0;e.forEach(function(v,y){nr(v).forEach(function(L){(m=p.indexOf(L))==-1&&(p[m=p.length]=L);var D=v[L],A="z",C="",j=jt({c:a+m,r:o+y+s});u=uu(i,j),D&&typeof D=="object"&&!(D instanceof Date)?i[j]=D:(typeof D=="number"?A="n":typeof D=="boolean"?A="b":typeof D=="string"?A="s":D instanceof Date?(A="d",r.cellDates||(A="n",D=Fr(D)),C=r.dateNF||mn[14]):D===null&&r.nullError&&(A="e",D=0),u?(u.t=A,u.v=D,delete u.w,delete u.R,C&&(u.z=C)):i[j]=u={t:A,v:D},C&&(u.z=C))})}),d.e.c=Math.max(d.e.c,a+p.length-1);var g=tr(o);if(s)for(m=0;m<p.length;++m)i[pr(m+a)+g]={t:"s",v:p[m]};return i["!ref"]=Rn(d),i}function fee(n,e){return kR(null,n,e)}function uu(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=Hn(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?uu(n,jt(e)):uu(n,jt({r:e,c:t||0}))}function pee(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function mee(){return{SheetNames:[],Sheets:{}}}function gee(n,e,t,r){var s=1;if(!t)for(;s<=65535&&n.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||t;for(++s;s<=65535&&n.SheetNames.indexOf(t=o+s)!=-1;++s);}if(ER(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function vee(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=pee(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function yee(n,e){return n.z=e,n}function PR(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function _ee(n,e,t){return PR(n,"#"+e,t)}function Eee(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function Tee(n,e,t,r){for(var s=typeof e!="string"?e:on(e),i=typeof e=="string"?e:Rn(e),o=s.s.r;o<=s.e.r;++o)for(var a=s.s.c;a<=s.e.c;++a){var l=uu(n,o,a);l.t="n",l.F=i,delete l.v,o==s.s.r&&a==s.s.c&&(l.f=t,r&&(l.D=!0))}return n}var NR={encode_col:pr,encode_row:tr,encode_cell:jt,encode_range:Rn,decode_col:Hv,decode_row:$v,split_cell:LG,decode_cell:Hn,decode_range:Jr,format_cell:Li,sheet_add_aoa:Nb,sheet_add_json:kR,sheet_add_dom:IR,aoa_to_sheet:Wl,json_to_sheet:fee,table_to_sheet:SR,table_to_book:qZ,sheet_to_csv:ey,sheet_to_txt:RR,sheet_to_json:zh,sheet_to_html:AR,sheet_to_formulae:hee,sheet_to_row_object_array:zh,sheet_get_cell:uu,book_new:mee,book_append_sheet:gee,book_set_sheet_visibility:vee,cell_set_number_format:yee,cell_set_hyperlink:PR,cell_set_internal_link:_ee,cell_add_comment:Eee,sheet_set_array_formula:Tee,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const wee={class:"ta-summary-container"},Cee={class:"filters-section"},Aee={class:"filter-group"},Iee={class:"filter-group"},See=["disabled"],xee={key:0,class:"stats-section"},bee={class:"stat-card reference"},Ree={class:"stat-content"},kee={class:"stat-value"},Pee={class:"stat-detail"},Nee={class:"stat-card"},Oee={class:"stat-content"},Dee={class:"stat-value"},Mee={class:"stat-card"},Fee={class:"stat-content"},Lee={class:"stat-value"},Uee={class:"stat-card"},Bee={class:"stat-content"},Vee={class:"stat-value"},$ee={class:"stat-card"},Hee={class:"stat-content"},jee={class:"stat-value"},Wee={key:1,class:"loading"},Kee={key:2,class:"table-container"},qee={class:"table-header"},Gee={class:"summary-table"},zee={class:"employee-cell"},Yee={class:"employee-name"},Qee={class:"employee-id"},Xee={class:"hours-cell worked"},Jee={class:"hours-cell rest"},Zee={class:"hours-cell missed"},ete={class:"hours-cell total"},tte={class:"days-cell"},nte={class:"day-badges"},rte={key:0,class:"day-badge worked"},ste={key:1,class:"day-separator"},ite={key:2,class:"day-badge rest"},ote={key:3,class:"day-separator"},ate={key:4,class:"day-badge missed"},lte={class:"total-row"},cte={class:"hours-cell worked"},ute={class:"hours-cell rest"},dte={class:"hours-cell missed"},hte={class:"hours-cell total"},fte={key:3,class:"no-data"},pte={__name:"SupervisorTASummary",setup(n){const e=ae(!1),t=ae([]),r=new Date,s=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,i=ae(s),o=ae("full"),a=ae("employeeName"),l=ae(!0),u=["2024-01-01","2024-02-12","2024-02-13","2024-02-14","2024-03-08","2024-06-01","2024-07-11","2024-07-12","2024-07-13","2024-11-26","2025-01-01","2025-01-29","2025-01-30","2025-01-31","2025-03-08","2025-06-01","2025-07-11","2025-07-12","2025-07-13","2025-11-26","2026-01-01","2026-02-17","2026-02-18","2026-02-19","2026-03-08","2026-06-01","2026-07-11","2026-07-12","2026-07-13","2026-11-26","2027-01-01","2027-02-06","2027-02-07","2027-02-08","2027-03-08","2027-06-01","2027-07-11","2027-07-12","2027-07-13","2027-11-26"],d=Be(()=>{const[j,z]=i.value.split("-");let w,R;o.value==="full"?(w=1,R=new Date(parseInt(j),parseInt(z),0).getDate()):[w,R]=o.value.split("-").map(Number);let x=0;for(let b=w;b<=R;b++){const N=`${j}-${z}-${String(b).padStart(2,"0")}`,F=new Date(N).getDay();F===0||F===6||u.includes(N)||x++}return x}),f=Be(()=>d.value*8),p=Be(()=>{const j=[...t.value];return j.sort((z,w)=>{const R=z[a.value],x=w[a.value];return typeof R=="number"&&typeof x=="number"?l.value?R-x:x-R:l.value?String(R).localeCompare(String(x),"mn"):String(x).localeCompare(String(R),"mn")}),j}),m=Be(()=>t.value.reduce((j,z)=>j+z.workedHours,0)),g=Be(()=>t.value.reduce((j,z)=>j+z.restHours,0)),v=Be(()=>t.value.reduce((j,z)=>j+z.missedHours,0)),y=Be(()=>t.value.reduce((j,z)=>j+z.totalHours,0));async function L(){e.value=!0;try{const[j,z]=i.value.split("-");let w,R;o.value==="full"?(w=1,R=new Date(parseInt(j),parseInt(z),0).getDate()):[w,R]=o.value.split("-").map(Number);const x=`${j}-${z}-${String(w).padStart(2,"0")}`,b=`${j}-${z}-${String(R).padStart(2,"0")}`;console.log("Loading summary for range:",x,"to",b);const N=xr(Yt(Ct,"timeAttendance"),Ir("Day",">=",x),Ir("Day","<=",b)),F=(await Zt(N)).docs.map(Q=>Q.data());console.log(`Loaded ${F.length} records`);const oe=new Map;F.forEach(Q=>{const ne=Q.EmployeeFirstName||"Unknown",ge=Q.EmployeeID||"";oe.has(ne)||oe.set(ne,{employeeName:ne,employeeId:ge,workedHours:0,restHours:0,missedHours:0,totalHours:0,workedDays:0,restDays:0,missedDays:0});const xe=oe.get(ne),Ee=parseFloat(Q.WorkingHour)||0,Pe=Q.Status||"";Pe===""||Pe===""||Pe===""?(xe.workedHours+=Ee,Ee>0&&xe.workedDays++):Pe==="/"||Pe.includes("")||Pe.includes("")?(xe.restHours+=Ee,Ee>0&&xe.restDays++):Pe===""&&(xe.missedHours+=Ee,Ee>0&&xe.missedDays++),xe.totalHours+=Ee}),t.value=Array.from(oe.values()),console.log(`Processed ${t.value.length} employees`)}catch(j){console.error("Error loading summary:",j)}finally{e.value=!1}}function D(j){a.value===j?l.value=!l.value:(a.value=j,l.value=!1)}function A(){const[j,z]=i.value.split("-");if(o.value==="full")return`${j}/${z}`;const[w,R]=o.value.split("-");return`${j}/${z}/${w} - ${j}/${z}/${R}`}function C(){const j={SheetNames:["Summary"],Sheets:{}},w=[["","ID"," ","/",""," "," "," "," "],...p.value.map(M=>[M.employeeName,M.employeeId,M.workedHours.toFixed(2),M.restHours.toFixed(2),M.missedHours.toFixed(2),M.totalHours.toFixed(2),M.workedDays,M.restDays,M.missedDays]),["","",m.value.toFixed(2),g.value.toFixed(2),v.value.toFixed(2),y.value.toFixed(2),"","",""]],R=NR.aoa_to_sheet(w);R["!cols"]=[{wch:20},{wch:10},{wch:15},{wch:18},{wch:12},{wch:12},{wch:15},{wch:15},{wch:15}],j.Sheets.Summary=R;const x=Zv(j,{bookType:"xlsx",type:"array"}),b=new Blob([x],{type:"application/octet-stream"}),N=document.createElement("a");N.href=URL.createObjectURL(b),N.download=`TA_Summary_${A().replace(/\//g,"-")}.xlsx`,N.click()}return kn(()=>{L()}),(j,z)=>(K(),q("div",wee,[z[23]||(z[23]=c("h3",null,"   ()",-1)),c("div",Cee,[c("div",Aee,[z[7]||(z[7]=c("label",null," :",-1)),ce(c("input",{type:"month","onUpdate:modelValue":z[0]||(z[0]=w=>i.value=w),onChange:L},null,544),[[Ne,i.value]])]),c("div",Iee,[z[9]||(z[9]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":z[1]||(z[1]=w=>o.value=w),onChange:L},[...z[8]||(z[8]=[c("option",{value:"full"}," ",-1),c("option",{value:"1-15"},"1-15",-1),c("option",{value:"16-31"},"16-31",-1)])],544),[[st,o.value]])]),c("button",{onClick:L,class:"btn-refresh",disabled:e.value},P(e.value?" ...":" "),9,See)]),!e.value&&t.value.length>0?(K(),q("div",xee,[c("div",bee,[z[11]||(z[11]=c("div",{class:"stat-icon"},"",-1)),c("div",Ree,[z[10]||(z[10]=c("div",{class:"stat-label"},"  ()",-1)),c("div",kee,P(d.value)+" ",1),c("div",Pee,P(f.value.toFixed(0))+" ",1)])]),c("div",Nee,[z[13]||(z[13]=c("div",{class:"stat-icon"},"",-1)),c("div",Oee,[z[12]||(z[12]=c("div",{class:"stat-label"}," ",-1)),c("div",Dee,P(t.value.length),1)])]),c("div",Mee,[z[15]||(z[15]=c("div",{class:"stat-icon"},"",-1)),c("div",Fee,[z[14]||(z[14]=c("div",{class:"stat-label"},"  ",-1)),c("div",Lee,P(m.value.toFixed(2))+"",1)])]),c("div",Uee,[z[17]||(z[17]=c("div",{class:"stat-icon"},"",-1)),c("div",Bee,[z[16]||(z[16]=c("div",{class:"stat-label"},"/",-1)),c("div",Vee,P(g.value.toFixed(2))+"",1)])]),c("div",$ee,[z[19]||(z[19]=c("div",{class:"stat-icon"},"",-1)),c("div",Hee,[z[18]||(z[18]=c("div",{class:"stat-label"}," ",-1)),c("div",jee,P(v.value.toFixed(2))+"",1)])])])):be("",!0),e.value?(K(),q("div",Wee,"   ... ")):t.value.length>0?(K(),q("div",Kee,[c("div",qee,[c("span",null,P(A()),1),c("button",{onClick:C,class:"btn-export"}," Excel ")]),c("table",Gee,[c("thead",null,[c("tr",null,[c("th",{onClick:z[2]||(z[2]=w=>D("employeeName")),class:"sortable"},"  "+P(a.value==="employeeName"?l.value?"":"":""),1),c("th",{onClick:z[3]||(z[3]=w=>D("workedHours")),class:"sortable hours-col"},"   "+P(a.value==="workedHours"?l.value?"":"":""),1),c("th",{onClick:z[4]||(z[4]=w=>D("restHours")),class:"sortable hours-col"}," / "+P(a.value==="restHours"?l.value?"":"":""),1),c("th",{onClick:z[5]||(z[5]=w=>D("missedHours")),class:"sortable hours-col"},"  "+P(a.value==="missedHours"?l.value?"":"":""),1),c("th",{onClick:z[6]||(z[6]=w=>D("totalHours")),class:"sortable hours-col"},"   "+P(a.value==="totalHours"?l.value?"":"":""),1),z[20]||(z[20]=c("th",{class:"days-col"}," ",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(p.value,w=>(K(),q("tr",{key:w.employeeName},[c("td",zee,[c("div",Yee,P(w.employeeName),1),c("div",Qee,"ID: "+P(w.employeeId),1)]),c("td",Xee,P(w.workedHours.toFixed(2))+"",1),c("td",Jee,P(w.restHours.toFixed(2))+"",1),c("td",Zee,P(w.missedHours.toFixed(2))+"",1),c("td",ete,P(w.totalHours.toFixed(2))+"",1),c("td",tte,[c("div",nte,[w.workedDays>0?(K(),q("span",rte,P(w.workedDays)+" ",1)):be("",!0),w.workedDays>0&&(w.restDays>0||w.missedDays>0)?(K(),q("span",ste," / ")):be("",!0),w.restDays>0?(K(),q("span",ite,P(w.restDays)+" ",1)):be("",!0),w.restDays>0&&w.missedDays>0?(K(),q("span",ote," / ")):be("",!0),w.missedDays>0?(K(),q("span",ate,P(w.missedDays)+" ",1)):be("",!0)])])]))),128))]),c("tfoot",null,[c("tr",lte,[z[21]||(z[21]=c("td",null,[c("strong",null,":")],-1)),c("td",cte,[c("strong",null,P(m.value.toFixed(2))+"",1)]),c("td",ute,[c("strong",null,P(g.value.toFixed(2))+"",1)]),c("td",dte,[c("strong",null,P(v.value.toFixed(2))+"",1)]),c("td",hte,[c("strong",null,P(y.value.toFixed(2))+"",1)]),z[22]||(z[22]=c("td",null,null,-1))])])])])):e.value?be("",!0):(K(),q("div",fte,"     "))]))}},mte=gn(pte,[["__scopeId","data-v-6a6b9887"]]),OT={ID:"ID",EMPLOYEE_ID:"EmployeeID",PROJECT_ID:"ProjectID",EMPLOYEE_FIRST_NAME:"EmployeeFirstName",EMPLOYEE_LAST_NAME:"EmployeeLastName",ROLE:"Role",PROJECT_NAME:"ProjectName",DAY:"Day",WEEK:"Week",WEEK_DAY:"WeekDay",START_TIME:"startTime",END_TIME:"endTime",WORKING_HOUR:"WorkingHour",OVERTIME_HOUR:"overtimeHour",STATUS:"Status",COMMENT:"comment",SYNCED_TO_EXCEL:"syncedToExcel",LAST_SYNCED_AT:"lastSyncedAt"},gte={TIME_ATTENDANCE:"timeAttendance",TIME_ATTENDANCE_REQUESTS:"timeAttendanceRequests",PROJECTS:"projects",EMPLOYEES:"employees",CUSTOMERS:"customers",FINANCIAL_TRANSACTIONS:"financialTransactions",USERS:"users"},vte={class:"ta-modal"},yte={class:"ta-modal-header"},_te={class:"ta-modal-body"},Ete={class:"ta-filters"},Tte={key:0,class:"ta-loading"},wte={key:1,class:"ta-table-container"},Cte={class:"ta-table"},Ate={class:"number-cell"},Ite={class:"number-cell"},Ste={class:"number-cell total-cell"},xte={class:"ta-totals-row"},bte={class:"number-cell ta-total-value"},Rte={class:"number-cell ta-total-value"},kte={class:"number-cell ta-total-value"},Pte={key:2,class:"ta-no-data"},Nte={__name:"TimeAttendanceModal",props:{show:Boolean,projectId:[String,Number]},emits:["close"],setup(n,{emit:e}){const t=n,r=ae([]),s=ae(!1),i=ae(""),o=ae(OT.DAY),a=ae(!1);Ti(()=>t.projectId,async g=>{g&&t.show&&await l()}),Ti(()=>t.show,async g=>{g&&t.projectId?await l():g||(r.value=[],i.value="")});async function l(){s.value=!0;try{const g=Yt(Ct,gte.TIME_ATTENDANCE),v=xr(g,Ir(OT.PROJECT_ID,"==",parseInt(t.projectId))),y=await Zt(v);r.value=y.docs.map(L=>({id:L.id,...L.data()})),console.log(`Loaded ${r.value.length} time attendance records for project ${t.projectId}`),r.value.length>0&&console.log("Sample record:",r.value[0])}catch(g){console.error("Error loading time attendance:",g),alert("    : "+g.message)}finally{s.value=!1}}function u(g){o.value===g?a.value=!a.value:(o.value=g,a.value=!0)}const d=Be(()=>{let g=[...r.value];if(i.value.trim()){const v=i.value.toLowerCase();g=g.filter(y=>{var L,D,A,C;return((L=y.EmployeeFirstName)==null?void 0:L.toLowerCase().includes(v))||((D=y.FirstName)==null?void 0:D.toLowerCase().includes(v))||((A=y.Role)==null?void 0:A.toLowerCase().includes(v))||((C=y.Day)==null?void 0:C.toLowerCase().includes(v))})}return g}),f=Be(()=>{const g=[...d.value];return g.sort((v,y)=>{const L=v[o.value]||"",D=y[o.value]||"";return typeof L=="number"&&typeof D=="number"?a.value?L-D:D-L:a.value?String(L).localeCompare(String(D),"mn"):String(D).localeCompare(String(L),"mn")}),g}),p=Be(()=>d.value.reduce((g,v)=>g+(parseFloat(v.WorkingHour)||0),0)),m=Be(()=>d.value.reduce((g,v)=>g+(parseFloat(v.overtimeHour)||0),0));return(g,v)=>n.show?(K(),q("div",{key:0,class:"modal-overlay",onClick:v[7]||(v[7]=nn(y=>g.$emit("close"),["self"]))},[c("div",vte,[c("div",yte,[c("h3",null,"   -  #"+P(n.projectId),1),c("button",{onClick:v[0]||(v[0]=y=>g.$emit("close")),class:"btn-close-modal"},"")]),c("div",_te,[c("div",Ete,[ce(c("input",{type:"text","onUpdate:modelValue":v[1]||(v[1]=y=>i.value=y),placeholder:"  ...",class:"ta-search-input"},null,512),[[Ne,i.value]])]),s.value?(K(),q("div",Tte,"   ...")):d.value.length>0?(K(),q("div",wte,[c("table",Cte,[c("thead",null,[c("tr",null,[c("th",{onClick:v[2]||(v[2]=y=>u("Day")),class:"sortable"},"  "+P(o.value==="Day"?a.value?"":"":""),1),c("th",{onClick:v[3]||(v[3]=y=>u("EmployeeFirstName")),class:"sortable"},"  "+P(o.value==="EmployeeFirstName"?a.value?"":"":""),1),c("th",{onClick:v[4]||(v[4]=y=>u("Role")),class:"sortable"},"  "+P(o.value==="Role"?a.value?"":"":""),1),c("th",{onClick:v[5]||(v[5]=y=>u("WorkingHour")),class:"sortable number-col"},"   "+P(o.value==="WorkingHour"?a.value?"":"":""),1),c("th",{onClick:v[6]||(v[6]=y=>u("overtimeHour")),class:"sortable number-col"},"   "+P(o.value==="overtimeHour"?a.value?"":"":""),1),v[8]||(v[8]=c("th",{class:"number-col"}," ",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(f.value,y=>(K(),q("tr",{key:y.id},[c("td",null,P(y.Day||"-"),1),c("td",null,P(y.EmployeeFirstName||y.FirstName||"-"),1),c("td",null,P(y.Role||"-"),1),c("td",Ate,P(y.WorkingHour||0),1),c("td",Ite,P(y.overtimeHour||0),1),c("td",Ste,P((y.WorkingHour||0)+(y.overtimeHour||0)),1)]))),128))]),c("tfoot",null,[c("tr",xte,[v[9]||(v[9]=c("td",{colspan:"3",class:"ta-totals-label"}," :",-1)),c("td",bte,P(p.value.toFixed(2)),1),c("td",Rte,P(m.value.toFixed(2)),1),c("td",kte,P((p.value+m.value).toFixed(2)),1)])])])])):(K(),q("div",Pte,"     "))])])])):be("",!0)}},Ote=gn(Nte,[["__scopeId","data-v-ce0041b6"]]),Dte={class:"project-summary-container"},Mte={class:"filter-buttons-section"},Fte={class:"filter-count"},Lte={class:"filter-count"},Ute={class:"filter-count"},Bte={class:"filter-count"},Vte={class:"filter-count"},$te={class:"filter-count"},Hte={class:"filter-count"},jte={class:"filters-section"},Wte={class:"filter-group"},Kte={class:"filter-group"},qte=["disabled"],Gte=["disabled"],zte={key:0,class:"loading"},Yte={key:1,class:"table-container"},Qte={class:"table-header"},Xte={class:"summary-table"},Jte={class:"project-id-cell"},Zte={key:1},ene={key:1},tne={key:1},nne={class:"number-cell"},rne={key:1},sne={class:"number-cell"},ine={class:"number-cell"},one={key:1},ane={key:1},lne={class:"number-cell financial-hr"},cne={class:"number-cell financial-hr"},une={class:"number-cell financial-hr"},dne={class:"number-cell financial-hr"},hne={class:"number-cell financial-hr"},fne={class:"number-cell financial-car"},pne={class:"number-cell financial-car"},mne={class:"number-cell financial-car"},gne={class:"number-cell financial-material"},vne={class:"number-cell financial-material"},yne={class:"number-cell financial-material"},_ne={class:"number-cell",style:{"background-color":"#fef3c7"}},Ene={class:"number-cell financial-total"},Tne={class:"number-cell summary-main"},wne={style:{color:"#10b981","font-weight":"600"}},Cne={class:"number-cell summary-main"},Ane={style:{color:"#ef4444","font-weight":"600"}},Ine={class:"number-cell summary-main"},Sne={class:"number-cell summary-detail"},xne={class:"number-cell summary-detail"},bne={class:"number-cell summary-detail"},Rne={class:"number-cell summary-detail"},kne={class:"number-cell summary-detail"},Pne={class:"actions-cell"},Nne=["onClick","disabled"],One=["onClick"],Dne=["onClick"],Mne=["onClick"],Fne={key:0},Lne={class:"totals-row"},Une={class:"number-cell financial-hr"},Bne={class:"number-cell financial-hr"},Vne={class:"number-cell financial-hr"},$ne={class:"number-cell financial-hr"},Hne={class:"number-cell financial-hr"},jne={class:"number-cell financial-car"},Wne={class:"number-cell financial-car"},Kne={class:"number-cell financial-car"},qne={class:"number-cell financial-material"},Gne={class:"number-cell financial-material"},zne={class:"number-cell financial-material"},Yne={class:"number-cell",style:{"background-color":"#fef3c7"}},Qne={style:{"font-weight":"700"}},Xne={class:"number-cell financial-total"},Jne={key:1},Zne={class:"totals-row"},ere={class:"number-cell summary-main"},tre={style:{color:"#10b981","font-weight":"700"}},nre={class:"number-cell summary-main"},rre={style:{color:"#ef4444","font-weight":"700"}},sre={class:"number-cell summary-main"},ire={class:"number-cell summary-detail"},ore={class:"number-cell summary-detail"},are={class:"number-cell summary-detail"},lre={class:"number-cell summary-detail"},cre={class:"number-cell summary-detail"},ure={key:2,class:"no-data"},dre={style:{display:"none"}},hre={__name:"ProjectSummary",setup(n){const e=xo(),t=ae(!1),r=ae(!1),s=ae([]),i=ae(""),o=ae(""),a=ae("default"),l=ae(null),u=ae(!1),d=ae(null),f=ae(null),p=ae(!1),m=ae({customer:"",siteLocation:"",ResponsibleEmp:"",HourPerformance:0,EngineerHand:0,referenceIdfromCustomer:""}),g=ae("id"),v=ae(!1),y=Be(()=>{let te=[...s.value];if(i.value&&(te=te.filter(O=>(O.Status||"").trim()===i.value)),o.value.trim()){const O=o.value.toLowerCase();te=te.filter(H=>{var I,S,B;return((I=H.id)==null?void 0:I.toString().toLowerCase().includes(O))||((S=H.name)==null?void 0:S.toLowerCase().includes(O))||((B=H.customer)==null?void 0:B.toLowerCase().includes(O))})}return te}),L=Be(()=>{const te=[...y.value];return te.sort((O,H)=>{const I=O[g.value]||"",S=H[g.value]||"";return typeof I=="number"&&typeof S=="number"?v.value?I-S:S-I:v.value?String(I).localeCompare(String(S),"mn"):String(S).localeCompare(String(I),"mn")}),te}),D=Be(()=>y.value.reduce((te,O)=>te+(O.IncomeHR||0),0)),A=Be(()=>y.value.reduce((te,O)=>te+(O.ExpenceHR||0),0)),C=Be(()=>y.value.reduce((te,O)=>te+(O.ExpenceHRBonus||0),0)),j=Be(()=>y.value.reduce((te,O)=>te+(O.ExpenseHRFromTrx||0),0)),z=Be(()=>y.value.reduce((te,O)=>te+(O.ProfitHR||0),0)),w=Be(()=>y.value.reduce((te,O)=>te+(O.IncomeCar||0),0)),R=Be(()=>y.value.reduce((te,O)=>te+(O.ExpenceCar||0),0)),x=Be(()=>y.value.reduce((te,O)=>te+(O.ProfitCar||0),0)),b=Be(()=>y.value.reduce((te,O)=>te+(O.IncomeMaterial||0),0)),N=Be(()=>y.value.reduce((te,O)=>te+(O.ExpenceMaterial||0),0)),M=Be(()=>y.value.reduce((te,O)=>te+(O.ProfitMaterial||0),0)),F=Be(()=>y.value.reduce((te,O)=>te+(O.additionalValue||0),0)),oe=Be(()=>y.value.reduce((te,O)=>te+(O.TotalProfit||0),0)),Q=Be(()=>y.value.reduce((te,O)=>te+(O.TotalIncome||0),0)),ne=Be(()=>y.value.reduce((te,O)=>te+(O.TotalExpence||0),0)),ge=Be(()=>y.value.reduce((te,O)=>te+(O.TotalHRExpence||0),0)),xe=Be(()=>y.value.reduce((te,O)=>te+(O.ExpenceHSE||0),0));function Ee(te){return s.value.filter(O=>(O.Status||"").trim()===te).length}function Pe(te){i.value=te}async function he(){if(confirm("    ? (Income HR  Profit HR  )")){r.value=!0;try{const te=await fetch("https://us-central1-munkh-zaisan.cloudfunctions.net/recalculateAllProjects",{method:"POST",headers:{"Content-Type":"application/json"}});if(!te.ok)throw new Error("Failed to recalculate projects");const O=await te.json();alert(` ! ${O.updated}  `),await E()}catch(te){console.error("Error recalculating projects:",te),alert("  : "+te.message)}finally{r.value=!1}}}async function E(){t.value=!0;try{await e.fetchProjects(),s.value=e.projects,console.log(`Loaded ${s.value.length} projects`);const te=[...new Set(s.value.map(O=>O.Status))];console.log("Unique statuses in database:",te)}catch(te){console.error("Error loading projects:",te)}finally{t.value=!1}}function T(te){g.value===te?v.value=!v.value:(g.value=te,v.value=!0)}function U(te){f.value=te.id,m.value={customer:te.customer||"",siteLocation:te.siteLocation||"",ResponsibleEmp:te.ResponsibleEmp||"",HourPerformance:te.HourPerformance||0,EngineerHand:te.EngineerHand||0,referenceIdfromCustomer:te.referenceIdfromCustomer||""}}function ee(te){l.value&&l.value.openProjectById&&l.value.openProjectById(te.id)}function le(){f.value=null,m.value={customer:"",siteLocation:"",ResponsibleEmp:"",HourPerformance:0,EngineerHand:0,referenceIdfromCustomer:""}}async function se(te){p.value=!0;try{const O=Hs(Ct,"projects",te.docId);await Ff(O,{customer:m.value.customer,siteLocation:m.value.siteLocation,ResponsibleEmp:m.value.ResponsibleEmp,HourPerformance:Number(m.value.HourPerformance),EngineerHand:Number(m.value.EngineerHand),referenceIdfromCustomer:m.value.referenceIdfromCustomer,updatedAt:new Date().toISOString()});const H=s.value.findIndex(I=>I.id===te.id);H!==-1&&Object.assign(s.value[H],m.value),console.log("Project updated successfully"),le()}catch(O){console.error("Error updating project:",O),alert(" : "+O.message)}finally{p.value=!1}}function ve(){const te={SheetNames:["Projects"],Sheets:{}};let O;a.value==="financial"?O=["ID","","",""," %"," "," "," "," HR"," HR"," "," Car"," Car"," Material"," Material"," "]:a.value==="summary"?O=["ID","","",""," "," "," "," "," "," "," ",""]:O=["ID","","",""," %"," "," "," "];const H=[O,...L.value.map(re=>{const Re=[re.id,re.customer||"-",re.siteLocation||"-",re.ResponsibleEmp||"-"];return a.value==="financial"?[...Re,re.HourPerformance?re.HourPerformance.toFixed(2):"-",re.BaseAmount||"-",re.EngineerHand||"-",re.referenceIdfromCustomer||"-",re.IncomeHR||"-",re.ExpenceHR||"-",re.ExpenceHRBonus||"-",re.IncomeCar||"-",re.ExpenceCar||"-",re.IncomeMaterial||"-",re.ExpenceMaterial||"-",re.TotalProfit||"-"]:a.value==="summary"?[...Re,re.TotalIncome||"-",re.TotalExpence||"-",re.TotalProfit||"-",re.TotalHRExpence||"-",re.ExpenceCar||"-",re.ExpenceMaterial||"-",re.ExpenceHSE||"-",re.additionalValue||"-"]:[...Re,re.HourPerformance?re.HourPerformance.toFixed(2):"-",re.BaseAmount||"-",re.EngineerHand||"-",re.referenceIdfromCustomer||"-"]})],I=NR.aoa_to_sheet(H);I["!cols"]=[{wch:8},{wch:30},{wch:25},{wch:20},{wch:15},{wch:20},{wch:15},{wch:20}],te.Sheets.Projects=I;const S=Zv(te,{bookType:"xlsx",type:"array"}),B=new Blob([S],{type:"application/octet-stream"}),ie=document.createElement("a");ie.href=URL.createObjectURL(B);const ue=new Date().toISOString().split("T")[0];ie.download=`Projects_${ue}.xlsx`,ie.click()}return kn(async()=>{await E()}),(te,O)=>(K(),q(Xe,null,[c("div",Dte,[O[60]||(O[60]=c("h3",null,"  ",-1)),c("div",Mte,[c("button",{onClick:O[0]||(O[0]=H=>Pe("")),class:mt(["filter-btn","filter-all",{active:i.value===""}])},[O[45]||(O[45]=c("span",{class:"filter-label"},"",-1)),c("span",Fte,P(s.value.length),1)],2),c("button",{onClick:O[1]||(O[1]=H=>Pe(" ")),class:mt(["filter-btn","filter-working",{active:i.value===" "}])},[O[46]||(O[46]=c("span",{class:"filter-label"}," ",-1)),c("span",Lte,P(Ee(" ")),1)],2),c("button",{onClick:O[2]||(O[2]=H=>Pe("")),class:mt(["filter-btn","filter-planned",{active:i.value===""}])},[O[47]||(O[47]=c("span",{class:"filter-label"},"",-1)),c("span",Ute,P(Ee("")),1)],2),c("button",{onClick:O[3]||(O[3]=H=>Pe("  ")),class:mt(["filter-btn","filter-handover",{active:i.value==="  "}])},[O[48]||(O[48]=c("span",{class:"filter-label"},"  ",-1)),c("span",Bte,P(Ee("  ")),1)],2),c("button",{onClick:O[4]||(O[4]=H=>Pe("   ")),class:mt(["filter-btn","filter-invoice",{active:i.value==="   "}])},[O[49]||(O[49]=c("span",{class:"filter-label"},"   ",-1)),c("span",Vte,P(Ee("   ")),1)],2),c("button",{onClick:O[5]||(O[5]=H=>Pe(" ")),class:mt(["filter-btn","filter-award",{active:i.value===" "}])},[O[50]||(O[50]=c("span",{class:"filter-label"}," ",-1)),c("span",$te,P(Ee(" ")),1)],2),c("button",{onClick:O[6]||(O[6]=H=>Pe("")),class:mt(["filter-btn","filter-finished",{active:i.value===""}])},[O[51]||(O[51]=c("span",{class:"filter-label"},"",-1)),c("span",Hte,P(Ee("")),1)],2)]),c("div",jte,[c("div",Wte,[O[52]||(O[52]=c("label",null,":",-1)),ce(c("input",{type:"text","onUpdate:modelValue":O[7]||(O[7]=H=>o.value=H),placeholder:"   ..."},null,512),[[Ne,o.value]])]),c("div",Kte,[O[54]||(O[54]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":O[8]||(O[8]=H=>a.value=H),class:"view-selector"},[...O[53]||(O[53]=[c("option",{value:"default"}," ",-1),c("option",{value:"financial"}," ",-1),c("option",{value:"summary"}," ",-1)])],512),[[st,a.value]])]),c("button",{onClick:E,class:"btn-refresh",disabled:t.value},P(t.value?" ...":" "),9,qte),c("button",{onClick:he,class:"btn-recalculate",disabled:r.value},P(r.value?" ...":"   "),9,Gte)]),t.value?(K(),q("div",zte,"   ... ")):y.value.length>0?(K(),q("div",Yte,[c("div",Qte,[c("span",null,"  ("+P(y.value.length)+")",1),c("button",{onClick:ve,class:"btn-export"}," Excel ")]),c("table",Xte,[c("thead",null,[c("tr",null,[c("th",{onClick:O[9]||(O[9]=H=>T("id")),class:"sortable"}," ID "+P(g.value==="id"?v.value?"":"":""),1),c("th",{onClick:O[10]||(O[10]=H=>T("customer")),class:"sortable"},"  "+P(g.value==="customer"?v.value?"":"":""),1),c("th",{onClick:O[11]||(O[11]=H=>T("siteLocation")),class:"sortable"},"  "+P(g.value==="siteLocation"?v.value?"":"":""),1),c("th",{onClick:O[12]||(O[12]=H=>T("ResponsibleEmp")),class:"sortable"},"  "+P(g.value==="ResponsibleEmp"?v.value?"":"":""),1),a.value==="default"?(K(),q(Xe,{key:0},[c("th",{onClick:O[13]||(O[13]=H=>T("HourPerformance")),class:"sortable"},"  % "+P(g.value==="HourPerformance"?v.value?"":"":""),1),c("th",{onClick:O[14]||(O[14]=H=>T("BaseAmount")),class:"sortable"},"   "+P(g.value==="BaseAmount"?v.value?"":"":""),1),c("th",{onClick:O[15]||(O[15]=H=>T("EngineerHand")),class:"sortable"},"   "+P(g.value==="EngineerHand"?v.value?"":"":""),1),c("th",{onClick:O[16]||(O[16]=H=>T("referenceIdfromCustomer")),class:"sortable"},"   "+P(g.value==="referenceIdfromCustomer"?v.value?"":"":""),1)],64)):a.value==="financial"?(K(),q(Xe,{key:1},[c("th",{onClick:O[17]||(O[17]=H=>T("IncomeHR")),class:"sortable financial-hr"},"  HR "+P(g.value==="IncomeHR"?v.value?"":"":""),1),c("th",{onClick:O[18]||(O[18]=H=>T("ExpenceHR")),class:"sortable financial-hr"},"  HR "+P(g.value==="ExpenceHR"?v.value?"":"":""),1),c("th",{onClick:O[19]||(O[19]=H=>T("ExpenceHRBonus")),class:"sortable financial-hr"},"   "+P(g.value==="ExpenceHRBonus"?v.value?"":"":""),1),c("th",{onClick:O[20]||(O[20]=H=>T("ExpenseHRFromTrx")),class:"sortable financial-hr wrap-text"}," //    "+P(g.value==="ExpenseHRFromTrx"?v.value?"":"":""),1),c("th",{onClick:O[21]||(O[21]=H=>T("ProfitHR")),class:"sortable financial-hr"},"  HR "+P(g.value==="ProfitHR"?v.value?"":"":""),1),c("th",{onClick:O[22]||(O[22]=H=>T("IncomeCar")),class:"sortable financial-car"},"  Car "+P(g.value==="IncomeCar"?v.value?"":"":""),1),c("th",{onClick:O[23]||(O[23]=H=>T("ExpenceCar")),class:"sortable financial-car"},"  Car "+P(g.value==="ExpenceCar"?v.value?"":"":""),1),c("th",{onClick:O[24]||(O[24]=H=>T("ProfitCar")),class:"sortable financial-car"},"  Car "+P(g.value==="ProfitCar"?v.value?"":"":""),1),c("th",{onClick:O[25]||(O[25]=H=>T("IncomeMaterial")),class:"sortable financial-material"},"  Material "+P(g.value==="IncomeMaterial"?v.value?"":"":""),1),c("th",{onClick:O[26]||(O[26]=H=>T("ExpenceMaterial")),class:"sortable financial-material"},"  Material "+P(g.value==="ExpenceMaterial"?v.value?"":"":""),1),c("th",{onClick:O[27]||(O[27]=H=>T("ProfitMaterial")),class:"sortable financial-material"},"  Material "+P(g.value==="ProfitMaterial"?v.value?"":"":""),1),c("th",{onClick:O[28]||(O[28]=H=>T("additionalValue")),class:"sortable",style:{"background-color":"#fef3c7"}},"   "+P(g.value==="additionalValue"?v.value?"":"":""),1),c("th",{onClick:O[29]||(O[29]=H=>T("TotalProfit")),class:"sortable financial-total"},"   "+P(g.value==="TotalProfit"?v.value?"":"":""),1)],64)):a.value==="summary"?(K(),q(Xe,{key:2},[c("th",{onClick:O[30]||(O[30]=H=>T("TotalIncome")),class:"sortable summary-main"},"   "+P(g.value==="TotalIncome"?v.value?"":"":""),1),c("th",{onClick:O[31]||(O[31]=H=>T("TotalExpence")),class:"sortable summary-main"},"   "+P(g.value==="TotalExpence"?v.value?"":"":""),1),c("th",{onClick:O[32]||(O[32]=H=>T("TotalProfit")),class:"sortable summary-main"},"   "+P(g.value==="TotalProfit"?v.value?"":"":""),1),c("th",{onClick:O[33]||(O[33]=H=>T("TotalHRExpence")),class:"sortable summary-detail"},"   "+P(g.value==="TotalHRExpence"?v.value?"":"":""),1),c("th",{onClick:O[34]||(O[34]=H=>T("ExpenceCar")),class:"sortable summary-detail"},"    "+P(g.value==="ExpenceCar"?v.value?"":"":""),1),c("th",{onClick:O[35]||(O[35]=H=>T("ExpenceMaterial")),class:"sortable summary-detail"},"    "+P(g.value==="ExpenceMaterial"?v.value?"":"":""),1),c("th",{onClick:O[36]||(O[36]=H=>T("ExpenceHSE")),class:"sortable summary-detail"},"   "+P(g.value==="ExpenceHSE"?v.value?"":"":""),1),c("th",{onClick:O[37]||(O[37]=H=>T("additionalValue")),class:"sortable summary-detail"},"  "+P(g.value==="additionalValue"?v.value?"":"":""),1)],64)):be("",!0),O[55]||(O[55]=c("th",{class:"actions-col"},"",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(L.value,H=>(K(),q("tr",{key:H.id},[c("td",Jte,P(H.id),1),c("td",null,[f.value===H.id?ce((K(),q("input",{key:0,"onUpdate:modelValue":O[38]||(O[38]=I=>m.value.customer=I),type:"text",class:"edit-input"},null,512)),[[Ne,m.value.customer]]):(K(),q("span",Zte,P(H.customer||"-"),1))]),c("td",null,[f.value===H.id?ce((K(),q("input",{key:0,"onUpdate:modelValue":O[39]||(O[39]=I=>m.value.siteLocation=I),type:"text",class:"edit-input"},null,512)),[[Ne,m.value.siteLocation]]):(K(),q("span",ene,P(H.siteLocation||"-"),1))]),c("td",null,[f.value===H.id?ce((K(),q("input",{key:0,"onUpdate:modelValue":O[40]||(O[40]=I=>m.value.ResponsibleEmp=I),type:"text",class:"edit-input"},null,512)),[[Ne,m.value.ResponsibleEmp]]):(K(),q("span",tne,P(H.ResponsibleEmp||"-"),1))]),a.value==="default"?(K(),q(Xe,{key:0},[c("td",nne,[f.value===H.id?ce((K(),q("input",{key:0,"onUpdate:modelValue":O[41]||(O[41]=I=>m.value.HourPerformance=I),type:"number",step:"0.01",class:"edit-input"},null,512)),[[Ne,m.value.HourPerformance,void 0,{number:!0}]]):(K(),q("span",rne,P(H.HourPerformance?H.HourPerformance.toFixed(2)+"%":"-"),1))]),c("td",sne,[c("span",null,P(H.BaseAmount?H.BaseAmount.toLocaleString():"-"),1)]),c("td",ine,[f.value===H.id?ce((K(),q("input",{key:0,"onUpdate:modelValue":O[42]||(O[42]=I=>m.value.EngineerHand=I),type:"number",class:"edit-input"},null,512)),[[Ne,m.value.EngineerHand,void 0,{number:!0}]]):(K(),q("span",one,P(H.EngineerHand?H.EngineerHand.toLocaleString():"-"),1))]),c("td",null,[f.value===H.id?ce((K(),q("input",{key:0,"onUpdate:modelValue":O[43]||(O[43]=I=>m.value.referenceIdfromCustomer=I),type:"text",class:"edit-input"},null,512)),[[Ne,m.value.referenceIdfromCustomer]]):(K(),q("span",ane,P(H.referenceIdfromCustomer||"-"),1))])],64)):a.value==="financial"?(K(),q(Xe,{key:1},[c("td",lne,[c("span",null,P(H.IncomeHR?H.IncomeHR.toLocaleString():"-"),1)]),c("td",cne,[c("span",null,P(H.ExpenceHR?H.ExpenceHR.toLocaleString():"-"),1)]),c("td",une,[c("span",null,P(H.ExpenceHRBonus?H.ExpenceHRBonus.toLocaleString():"-"),1)]),c("td",dne,[c("span",null,P(H.ExpenseHRFromTrx?H.ExpenseHRFromTrx.toLocaleString():"-"),1)]),c("td",hne,[c("span",{style:wt({color:(H.ProfitHR||0)>=0?"#10b981":"#ef4444",fontWeight:600})},P(H.ProfitHR?H.ProfitHR.toLocaleString():"-"),5)]),c("td",fne,[c("span",null,P(H.IncomeCar?H.IncomeCar.toLocaleString():"-"),1)]),c("td",pne,[c("span",null,P(H.ExpenceCar?H.ExpenceCar.toLocaleString():"-"),1)]),c("td",mne,[c("span",{style:wt({color:(H.ProfitCar||0)>=0?"#10b981":"#ef4444",fontWeight:600})},P(H.ProfitCar?H.ProfitCar.toLocaleString():"-"),5)]),c("td",gne,[c("span",null,P(H.IncomeMaterial?H.IncomeMaterial.toLocaleString():"-"),1)]),c("td",vne,[c("span",null,P(H.ExpenceMaterial?H.ExpenceMaterial.toLocaleString():"-"),1)]),c("td",yne,[c("span",{style:wt({color:(H.ProfitMaterial||0)>=0?"#10b981":"#ef4444",fontWeight:600})},P(H.ProfitMaterial?H.ProfitMaterial.toLocaleString():"-"),5)]),c("td",_ne,[c("span",null,P(H.additionalValue?H.additionalValue.toLocaleString():"-"),1)]),c("td",Ene,[c("span",{style:wt({color:(H.TotalProfit||0)>=0?"#10b981":"#ef4444",fontWeight:600})},P(H.TotalProfit?H.TotalProfit.toLocaleString():"-"),5)])],64)):a.value==="summary"?(K(),q(Xe,{key:2},[c("td",Tne,[c("span",wne,P(H.TotalIncome?H.TotalIncome.toLocaleString():"-"),1)]),c("td",Cne,[c("span",Ane,P(H.TotalExpence?H.TotalExpence.toLocaleString():"-"),1)]),c("td",Ine,[c("span",{style:wt({color:(H.TotalProfit||0)>=0?"#10b981":"#ef4444",fontWeight:600})},P(H.TotalProfit?H.TotalProfit.toLocaleString():"-"),5)]),c("td",Sne,[c("span",null,P(H.TotalHRExpence?H.TotalHRExpence.toLocaleString():"-"),1)]),c("td",xne,[c("span",null,P(H.ExpenceCar?H.ExpenceCar.toLocaleString():"-"),1)]),c("td",bne,[c("span",null,P(H.ExpenceMaterial?H.ExpenceMaterial.toLocaleString():"-"),1)]),c("td",Rne,[c("span",null,P(H.ExpenceHSE?H.ExpenceHSE.toLocaleString():"-"),1)]),c("td",kne,[c("span",null,P(H.additionalValue?H.additionalValue.toLocaleString():"-"),1)])],64)):be("",!0),c("td",Pne,[f.value===H.id?(K(),q(Xe,{key:0},[c("button",{onClick:I=>se(H),class:"btn-save",disabled:p.value},"",8,Nne),c("button",{onClick:le,class:"btn-cancel"},"")],64)):(K(),q(Xe,{key:1},[c("button",{onClick:I=>ee(H),class:"btn-view",title:" "},"",8,One),c("button",{onClick:I=>U(H),class:"btn-edit",title:""},"",8,Dne),c("button",{onClick:I=>{u.value=!0,d.value=H.id},class:"btn-ta",title:"  "},"",8,Mne)],64))])]))),128))]),a.value==="financial"?(K(),q("tfoot",Fne,[c("tr",Lne,[O[56]||(O[56]=c("td",{colspan:"4",class:"totals-label"}," :",-1)),c("td",Une,P(D.value.toLocaleString()),1),c("td",Bne,P(A.value.toLocaleString()),1),c("td",Vne,P(C.value.toLocaleString()),1),c("td",$ne,P(j.value.toLocaleString()),1),c("td",Hne,[c("span",{style:wt({color:z.value>=0?"#10b981":"#ef4444",fontWeight:700})},P(z.value.toLocaleString()),5)]),c("td",jne,P(w.value.toLocaleString()),1),c("td",Wne,P(R.value.toLocaleString()),1),c("td",Kne,[c("span",{style:wt({color:x.value>=0?"#10b981":"#ef4444",fontWeight:700})},P(x.value.toLocaleString()),5)]),c("td",qne,P(b.value.toLocaleString()),1),c("td",Gne,P(N.value.toLocaleString()),1),c("td",zne,[c("span",{style:wt({color:M.value>=0?"#10b981":"#ef4444",fontWeight:700})},P(M.value.toLocaleString()),5)]),c("td",Yne,[c("span",Qne,P(F.value.toLocaleString()),1)]),c("td",Xne,[c("span",{style:wt({color:oe.value>=0?"#10b981":"#ef4444",fontWeight:700})},P(oe.value.toLocaleString()),5)]),O[57]||(O[57]=c("td",null,null,-1))])])):a.value==="summary"?(K(),q("tfoot",Jne,[c("tr",Zne,[O[58]||(O[58]=c("td",{colspan:"4",class:"totals-label"}," :",-1)),c("td",ere,[c("span",tre,P(Q.value.toLocaleString()),1)]),c("td",nre,[c("span",rre,P(ne.value.toLocaleString()),1)]),c("td",sre,[c("span",{style:wt({color:oe.value>=0?"#10b981":"#ef4444",fontWeight:700})},P(oe.value.toLocaleString()),5)]),c("td",ire,P(ge.value.toLocaleString()),1),c("td",ore,P(R.value.toLocaleString()),1),c("td",are,P(N.value.toLocaleString()),1),c("td",lre,P(xe.value.toLocaleString()),1),c("td",cre,P(F.value.toLocaleString()),1),O[59]||(O[59]=c("td",null,null,-1))])])):be("",!0)])])):t.value?be("",!0):(K(),q("div",ure,"     ")),c("div",dre,[fn(Qx,{ref_key:"projectManagementRef",ref:l},null,512)])]),fn(Ote,{show:u.value,projectId:d.value,onClose:O[44]||(O[44]=H=>{u.value=!1,d.value=null})},null,8,["show","projectId"])],64))}},fre=gn(hre,[["__scopeId","data-v-43169f43"]]),pre=pa("financialTransactions",{state:()=>({transactions:[],loading:!1,error:null}),getters:{getTransactionById:n=>e=>n.transactions.find(t=>t.id===e),getTransactionsByProject:n=>e=>n.transactions.filter(t=>t.projectID===e),getTransactionsByType:n=>e=>n.transactions.filter(t=>t.type===e),totalAmountByProject:n=>e=>n.transactions.filter(t=>t.projectID===e).reduce((t,r)=>t+(parseFloat(r.amount)||0),0),totalAmountByType:n=>e=>n.transactions.filter(t=>t.type===e).reduce((t,r)=>t+(parseFloat(r.amount)||0),0)},actions:{async fetchTransactions(){this.loading=!0,this.error=null;try{const n=xr(Yt(Ct,"financialTransactions"),Ng("date","desc"));aI(n,e=>{this.transactions=e.docs.map(t=>({id:t.id,...t.data()})),this.loading=!1},e=>{console.error("Error fetching financial transactions:",e),this.error=e.message,this.loading=!1})}catch(n){console.error("Error setting up transactions listener:",n),this.error=n.message,this.loading=!1}}}}),mre={class:"management-section"},gre={class:"management-buttons"},vre={class:"item-list"},yre={class:"list-controls"},_re={class:"sum-display"},Ere={class:"transactions-table-container"},Tre={class:"transactions-table"},wre={class:"amount"},Cre=["onClick"],Are={class:"modal-content large-modal"},Ire={class:"modal-header"},Sre={class:"form-row"},xre={class:"form-group"},bre={class:"form-group"},Rre=["value"],kre={class:"form-row"},Pre={class:"form-group"},Nre={class:"form-group"},Ore=["required","disabled"],Dre=["value"],Mre={class:"form-row"},Fre={class:"form-group"},Lre={class:"form-group"},Ure=["required","disabled"],Bre={class:"form-row"},Vre={class:"form-group"},$re={class:"form-row"},Hre={class:"form-group checkbox-group"},jre={class:"form-group checkbox-group"},Wre={class:"form-row"},Kre={class:"form-group full-width"},qre={class:"form-actions"},Gre={type:"submit",class:"btn-submit"},zre={class:"modal-content"},Yre={class:"form-row"},Qre={class:"form-group"},Xre={class:"form-group"},Jre={class:"radio-group"},Zre={class:"form-row"},ese={class:"form-group full-width"},tse=["value"],nse={class:"form-row"},rse={class:"form-group full-width"},sse={class:"employee-list"},ise=["value"],ose={class:"form-actions"},ase=["disabled"],lse=["disabled"],cse={class:"modal-content settings-modal"},use={class:"form-row"},dse={class:"form-group"},hse={class:"form-group"},fse={__name:"FinancialTransactionManagement",setup(n){const e=pre(),t=xo(),r=_a();ae(!1);const s=ae(!1),i=ae(!1),o=ae(!1),a=ae(!1),l=ae(!1),u=ae(""),d=ae(""),f=ae(""),p=ae(""),m=ae("date"),g=ae("desc"),v=ae(""),y=ae(""),L=ae("0"),D=ae({date:new Date().toISOString().split("T")[0],type:" ",projectID:"",projectLocation:"",selectedEmployees:[]}),A=ae({foodAmount:15e3,tripAmount:55e3}),C=ae({id:"",date:"",projectID:"",projectLocation:"",employeeID:"",employeeFirstName:"",amount:0,type:"",purpose:"",ebarimt:!1,:!1,comment:""}),j=Be(()=>t.projects.filter(I=>I.Status===" ").sort((I,S)=>{const B=parseInt(I.id)||0,ie=parseInt(S.id)||0;return B-ie})),z=Be(()=>r.employees.filter(I=>I.State===" ").sort((I,S)=>{const B=I.FirstName||"",ie=S.FirstName||"";return B.localeCompare(ie)})),w=Be(()=>r.employees.filter(I=>I.State===" ").sort((I,S)=>{const B=I.FirstName||"",ie=S.FirstName||"";return B.localeCompare(ie)})),R=Be(()=>{let I=w.value;if(d.value){const S=d.value.toLowerCase();I=I.filter(B=>{var ie,ue;return((ie=B.FirstName)==null?void 0:ie.toLowerCase().includes(S))||((ue=B.Id)==null?void 0:ue.toString().includes(S))})}return I}),x=Be(()=>{let I=[...e.transactions];if(u.value){const S=u.value.toLowerCase();I=I.filter(B=>{var ie,ue,re,Re,Oe,Me;return((ie=B.projectID)==null?void 0:ie.toLowerCase().includes(S))||((ue=B.projectLocation)==null?void 0:ue.toLowerCase().includes(S))||((re=B.employeeID)==null?void 0:re.toLowerCase().includes(S))||((Re=B.employeeFirstName)==null?void 0:Re.toLowerCase().includes(S))||((Oe=B.comment)==null?void 0:Oe.toLowerCase().includes(S))||((Me=B.type)==null?void 0:Me.toLowerCase().includes(S))})}return p.value&&(I=I.filter(S=>S.purpose===p.value)),f.value&&(I=I.filter(S=>S.type===f.value)),I.sort((S,B)=>{let ie,ue;switch(m.value){case"date":ie=new Date(S.date||0),ue=new Date(B.date||0);break;case"amount":ie=parseFloat(S.amount)||0,ue=parseFloat(B.amount)||0;break;case"project":return ie=(S.projectID||"").toLowerCase(),ue=(B.projectID||"").toLowerCase(),g.value==="asc"?ie.localeCompare(ue):ue.localeCompare(ie);case"employee":return ie=(S.employeeFirstName||"").toLowerCase(),ue=(B.employeeFirstName||"").toLowerCase(),g.value==="asc"?ie.localeCompare(ue):ue.localeCompare(ie);case"type":return ie=(S.type||"").toLowerCase(),ue=(B.type||"").toLowerCase(),g.value==="asc"?ie.localeCompare(ue):ue.localeCompare(ie);case"purpose":return ie=(S.purpose||"").toLowerCase(),ue=(B.purpose||"").toLowerCase(),g.value==="asc"?ie.localeCompare(ue):ue.localeCompare(ie);default:return 0}return g.value==="asc"?ie-ue:ue-ie}),I}),b=Be(()=>x.value.reduce((I,S)=>I+(parseFloat(S.amount)||0),0));function N(I){if(!I)return"";if(typeof I=="number"&&I>1e3){const B=new Date(1899,11,30),ie=new Date(B.getTime()+I*864e5);return`${ie.getFullYear()}.${String(ie.getMonth()+1).padStart(2,"0")}.${String(ie.getDate()).padStart(2,"0")}`}const S=new Date(I);return isNaN(S.getTime())?I:`${S.getFullYear()}.${String(S.getMonth()+1).padStart(2,"0")}.${String(S.getDate()).padStart(2,"0")}`}function M(I){return!I&&I!==0?"0":Number(I).toLocaleString("en-US")}function F(I){m.value===I?g.value=g.value==="asc"?"desc":"asc":(m.value=I,g.value=I==="date"||I==="amount"?"desc":"asc")}function oe(I){return m.value!==I?"":g.value==="asc"?"":""}function Q(I){let S=I.target.value.replace(/[^\d]/g,"");C.value.amount=parseFloat(S)||0,S?L.value=parseInt(S).toLocaleString("en-US"):L.value="0"}function ne(){C.value.amount?L.value=C.value.amount.toLocaleString("en-US"):L.value="0"}function ge(){const I=t.projects.find(S=>S.id===C.value.projectID);I&&(C.value.projectLocation=I.siteLocation||"")}function xe(){const I=r.employees.find(S=>S.Id===C.value.employeeID);I&&(C.value.employeeFirstName=I.FirstName||"")}function Ee(){C.value.purpose!==""&&(C.value.projectID="",C.value.projectLocation="",C.value.type="")}function Pe(){a.value=!1,C.value={id:"",date:new Date().toISOString().split("T")[0],projectID:"",projectLocation:"",employeeID:"",employeeFirstName:"",amount:0,type:"",purpose:"",ebarimt:!1,:!1,comment:""},L.value="0",s.value=!0}function he(I){a.value=!0,C.value={...I},L.value=I.amount?I.amount.toLocaleString("en-US"):"0",s.value=!0}function E(){s.value=!1,C.value={id:"",date:"",projectID:"",projectLocation:"",employeeID:"",employeeLastName:"",amount:0,type:"",purpose:"",ebarimt:!1,:!1,comment:""}}async function T(){try{const I=a.value?"update":"create",S=await qa(I,C.value);if(S.success)H(S.message,"success"),E();else if(S.error==="DUPLICATE_FOOD_WARNING"&&S.needsConfirmation){if(confirm(S.message)){C.value.confirmDuplicate=!0;const ie=await qa(I,C.value);ie.success?(H(ie.message,"success"),E()):H(ie.error||"Operation failed","error")}}else H(S.error||"Operation failed","error")}catch(I){console.error("Error submitting transaction:",I),H(I.message||"Failed to save transaction","error")}}async function U(){if(confirm("     ?"))try{const I=await qa("delete",C.value);I.success?(H(I.message,"success"),E()):H(I.error||"Delete failed","error")}catch(I){console.error("Error deleting transaction:",I),H(I.message||"Failed to delete transaction","error")}}function ee(){D.value={date:new Date().toISOString().split("T")[0],type:" ",projectID:"",projectLocation:"",selectedEmployees:[]},d.value="",i.value=!0}function le(){const I=t.projects.find(S=>S.id===D.value.projectID);I&&(D.value.projectLocation=I.siteLocation||"")}function se(){i.value=!1,D.value={date:new Date().toISOString().split("T")[0],type:" ",projectID:"",projectLocation:"",selectedEmployees:[]}}async function ve(){if(D.value.selectedEmployees.length===0){H("Please select at least one employee","error");return}if(!l.value)try{l.value=!0;let I=0,S=0,B=[],ie=[];for(const re of D.value.selectedEmployees){const Re=r.employees.find(Se=>Se.Id===re);if(!Re)continue;const Oe=D.value.type===" "?A.value.foodAmount:A.value.tripAmount,Me={date:D.value.date,projectID:D.value.projectID,projectLocation:D.value.projectLocation,employeeID:Re.Id,employeeFirstName:Re.FirstName||"",amount:Oe,type:D.value.type,purpose:"/",ebarimt:!1,:!1,comment:""};try{const Se=await qa("create",Me);Se.success?I++:Se.error==="DUPLICATE_FOOD_WARNING"&&Se.needsConfirmation?B.push({employee:Re,transaction:Me}):(S++,ie.push({employeeName:Re.FirstName,error:Se.error}),console.error(`Failed for ${Re.FirstName}: ${Se.error}`))}catch(Se){S++,ie.push({employeeName:Re.FirstName,error:Se.message||"Unknown error"}),console.error(`Error for ${Re.FirstName}:`,Se)}}if(B.length>0){const re=B.map(Oe=>Oe.employee.FirstName).join(", ");if(confirm(`     1   :

${re}

   ?`))for(const{employee:Oe,transaction:Me}of B){Me.confirmDuplicate=!0;try{const Se=await qa("create",Me);Se.success?I++:(S++,ie.push({employeeName:Oe.FirstName,error:Se.error}))}catch(Se){S++,ie.push({employeeName:Oe.FirstName,error:Se.message||"Unknown error"})}}}let ue="";if(I>0&&(ue=` ${I}   `),S>0){const re=ie.map((Re,Oe)=>`${Oe+1}. ${Re.employeeName}
   ${Re.error}`).join(`

`);I>0?alert(`${ue}

 ${S}  :

${re}`):alert(`    :

${re}`)}else I>0&&(H(ue,"success"),se())}catch(I){console.error("Error creating bulk transactions:",I),H(I.message||"Failed to create bulk transactions","error")}finally{l.value=!1}}function te(){o.value=!1}async function O(){try{const I=Hs(Ct,"settings","financialTransaction");await Fg(I,A.value,{merge:!0}),H("Settings saved successfully","success"),te()}catch(I){console.error("Error saving settings:",I),H("Failed to save settings: "+I.message,"error")}}function H(I,S){v.value=I,y.value=S,setTimeout(()=>{v.value=""},5e3)}return kn(async()=>{await e.fetchTransactions(),await t.fetchProjects(),await r.fetchEmployees();try{const I=Hs(Ct,"settings","financialTransaction"),S=await Mf(I);if(S.exists()){const B=S.data();A.value.foodAmount=B.foodAmount||15e3,A.value.tripAmount=B.tripAmount||55e3}else A.value.foodAmount=15e3,A.value.tripAmount=55e3}catch(I){console.error("Error loading settings:",I)}}),(I,S)=>(K(),q("div",mre,[S[62]||(S[62]=c("h4",null,"Financial Transaction Management",-1)),c("div",gre,[c("button",{onClick:Pe,class:"action-btn add-btn"}," + Add Transaction "),c("button",{onClick:ee,class:"action-btn add-btn"}," + /  "),c("button",{onClick:S[0]||(S[0]=B=>o.value=!0),class:"action-btn settings-btn"},"  Settings ")]),c("div",vre,[S[37]||(S[37]=c("h5",null,"Financial Transactions",-1)),c("div",yre,[ce(c("input",{"onUpdate:modelValue":S[1]||(S[1]=B=>u.value=B),type:"text",placeholder:"Search by project, employee, comment...",class:"search-input"},null,512),[[Ne,u.value]]),ce(c("select",{"onUpdate:modelValue":S[2]||(S[2]=B=>p.value=B),class:"filter-select"},[...S[28]||(S[28]=[Ls('<option value="" data-v-e43c3a5f>All Purposes</option><option value="" data-v-e43c3a5f></option><option value=" " data-v-e43c3a5f> </option><option value=" / " data-v-e43c3a5f> / </option><option value=" " data-v-e43c3a5f> </option><option value="  " data-v-e43c3a5f>  </option><option value="/" data-v-e43c3a5f>/</option>',7)])],512),[[st,p.value]]),ce(c("select",{"onUpdate:modelValue":S[3]||(S[3]=B=>f.value=B),class:"filter-select"},[...S[29]||(S[29]=[Ls('<option value="" data-v-e43c3a5f>All Types</option><option value=" " data-v-e43c3a5f> </option><option value="" data-v-e43c3a5f></option><option value="   " data-v-e43c3a5f>   </option><option value=" " data-v-e43c3a5f> </option><option value="" data-v-e43c3a5f></option>',6)])],512),[[st,f.value]]),c("div",_re,[S[30]||(S[30]=c("strong",null,"Total:",-1)),bt(" "+P(M(b.value))+" ",1)])]),c("div",Ere,[c("table",Tre,[c("thead",null,[c("tr",null,[c("th",{onClick:S[4]||(S[4]=B=>F("date")),class:"sortable"}," Date "+P(oe("date")),1),c("th",{onClick:S[5]||(S[5]=B=>F("project")),class:"sortable"}," Project "+P(oe("project")),1),c("th",{onClick:S[6]||(S[6]=B=>F("employee")),class:"sortable"}," Employee "+P(oe("employee")),1),c("th",{onClick:S[7]||(S[7]=B=>F("amount")),class:"sortable"}," Amount "+P(oe("amount")),1),c("th",{onClick:S[8]||(S[8]=B=>F("type")),class:"sortable"}," Type "+P(oe("type")),1),c("th",{onClick:S[9]||(S[9]=B=>F("purpose")),class:"sortable"}," Purpose "+P(oe("purpose")),1),S[31]||(S[31]=c("th",null,"ebarimt",-1)),S[32]||(S[32]=c("th",null,"",-1)),S[33]||(S[33]=c("th",null,"Comment",-1)),S[34]||(S[34]=c("th",null,"Action",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(x.value,B=>(K(),q("tr",{key:B.id},[c("td",null,P(N(B.date)),1),c("td",null,[bt(P(B.projectID),1),S[35]||(S[35]=c("br",null,null,-1)),c("small",null,P(B.projectLocation),1)]),c("td",null,[bt(P(B.employeeID),1),S[36]||(S[36]=c("br",null,null,-1)),c("small",null,P(B.employeeFirstName),1)]),c("td",wre,P(M(B.amount))+"",1),c("td",null,P(B.type),1),c("td",null,P(B.purpose),1),c("td",null,P(B.ebarimt?"":""),1),c("td",null,P(B.?"":""),1),c("td",null,[c("small",null,P(B.comment),1)]),c("td",null,[c("button",{onClick:ie=>he(B),class:"btn-edit-small"},"Edit",8,Cre)])]))),128))])])])]),s.value?(K(),q("div",{key:0,class:"modal-overlay",onClick:nn(E,["self"])},[c("div",Are,[c("div",Ire,[c("h4",null,P(a.value?"Edit Transaction":"Add New Transaction"),1),c("button",{class:"close-btn",onClick:E},"")]),c("form",{onSubmit:nn(T,["prevent"]),class:"item-form"},[c("div",Sre,[c("div",xre,[S[38]||(S[38]=c("label",null,"Date *",-1)),ce(c("input",{"onUpdate:modelValue":S[10]||(S[10]=B=>C.value.date=B),type:"date",required:"",class:"form-input"},null,512),[[Ne,C.value.date]])]),c("div",bre,[S[40]||(S[40]=c("label",null,"Employee *",-1)),ce(c("select",{"onUpdate:modelValue":S[11]||(S[11]=B=>C.value.employeeID=B),required:"",class:"form-input",onChange:xe},[S[39]||(S[39]=c("option",{value:""},"Select Employee",-1)),(K(!0),q(Xe,null,ft(z.value,B=>(K(),q("option",{key:B.id,value:B.Id},P(B.FirstName)+" ("+P(B.Id)+") ",9,Rre))),128))],544),[[st,C.value.employeeID]])])]),c("div",kre,[c("div",Pre,[S[42]||(S[42]=c("label",null,"Purpose *",-1)),ce(c("select",{"onUpdate:modelValue":S[12]||(S[12]=B=>C.value.purpose=B),required:"",class:"form-input",onChange:Ee},[...S[41]||(S[41]=[Ls('<option value="" data-v-e43c3a5f>Select Purpose</option><option value="" data-v-e43c3a5f></option><option value=" " data-v-e43c3a5f> </option><option value=" / " data-v-e43c3a5f> / </option><option value=" " data-v-e43c3a5f> </option><option value="  " data-v-e43c3a5f>  </option>',6)])],544),[[st,C.value.purpose]])]),c("div",Nre,[c("label",null,"Project "+P(C.value.purpose===""?"*":""),1),ce(c("select",{"onUpdate:modelValue":S[13]||(S[13]=B=>C.value.projectID=B),required:C.value.purpose==="",class:"form-input",onChange:ge,disabled:C.value.purpose!==""},[S[43]||(S[43]=c("option",{value:""},"Select Project",-1)),(K(!0),q(Xe,null,ft(j.value,B=>(K(),q("option",{key:B.id,value:B.id},P(B.id)+" - "+P(B.siteLocation),9,Dre))),128))],40,Ore),[[st,C.value.projectID]])])]),c("div",Mre,[c("div",Fre,[S[44]||(S[44]=c("label",null,"Project Location",-1)),ce(c("input",{"onUpdate:modelValue":S[14]||(S[14]=B=>C.value.projectLocation=B),type:"text",readonly:"",class:"form-input",placeholder:"Auto-filled from project"},null,512),[[Ne,C.value.projectLocation]])]),c("div",Lre,[c("label",null,"Type "+P(C.value.purpose===""?"*":""),1),ce(c("select",{"onUpdate:modelValue":S[15]||(S[15]=B=>C.value.type=B),required:C.value.purpose==="",class:"form-input",disabled:C.value.purpose!==""},[...S[45]||(S[45]=[c("option",{value:""},"Select Type",-1),c("option",{value:" "}," ",-1),c("option",{value:""},"",-1),c("option",{value:"   "},"   ",-1)])],8,Ure),[[st,C.value.type]])])]),c("div",Bre,[c("div",Vre,[S[46]||(S[46]=c("label",null,"Amount *",-1)),ce(c("input",{"onUpdate:modelValue":S[16]||(S[16]=B=>L.value=B),type:"text",required:"",class:"form-input",placeholder:"0",onInput:Q,onBlur:ne},null,544),[[Ne,L.value]])])]),c("div",$re,[c("div",Hre,[c("label",null,[ce(c("input",{type:"checkbox","onUpdate:modelValue":S[17]||(S[17]=B=>C.value.ebarimt=B)},null,512),[[Go,C.value.ebarimt]]),S[47]||(S[47]=c("span",null,"ebarimt",-1))])]),c("div",jre,[c("label",null,[ce(c("input",{type:"checkbox","onUpdate:modelValue":S[18]||(S[18]=B=>C.value.=B)},null,512),[[Go,C.value.]]),S[48]||(S[48]=c("span",null,"",-1))])])]),c("div",Wre,[c("div",Kre,[S[49]||(S[49]=c("label",null,"",-1)),ce(c("textarea",{"onUpdate:modelValue":S[19]||(S[19]=B=>C.value.comment=B),class:"form-input",rows:"3",placeholder:"Add detailed comment..."},null,512),[[Ne,C.value.comment]])])]),c("div",qre,[c("button",Gre,P(a.value?"Update Transaction":"Add Transaction"),1),c("button",{type:"button",onClick:E,class:"btn-cancel"},"Cancel"),a.value?(K(),q("button",{key:0,type:"button",onClick:U,class:"btn-delete"}," Delete ")):be("",!0)])],32)])])):be("",!0),i.value?(K(),q("div",{key:1,class:"modal-overlay",onClick:nn(se,["self"])},[c("div",zre,[c("div",{class:"modal-header"},[S[50]||(S[50]=c("h4",null,"/ ",-1)),c("button",{class:"close-btn",onClick:se},"")]),c("form",{onSubmit:nn(ve,["prevent"]),class:"item-form"},[c("div",Yre,[c("div",Qre,[S[51]||(S[51]=c("label",null,"Date *",-1)),ce(c("input",{"onUpdate:modelValue":S[20]||(S[20]=B=>D.value.date=B),type:"date",required:"",class:"form-input"},null,512),[[Ne,D.value.date]])]),c("div",Xre,[S[54]||(S[54]=c("label",null,"Type *",-1)),c("div",Jre,[c("label",null,[ce(c("input",{type:"radio","onUpdate:modelValue":S[21]||(S[21]=B=>D.value.type=B),value:" ",required:""},null,512),[[h_,D.value.type]]),S[52]||(S[52]=c("span",null," ",-1))]),c("label",null,[ce(c("input",{type:"radio","onUpdate:modelValue":S[22]||(S[22]=B=>D.value.type=B),value:"",required:""},null,512),[[h_,D.value.type]]),S[53]||(S[53]=c("span",null,"",-1))])])])]),c("div",Zre,[c("div",ese,[S[56]||(S[56]=c("label",null,"Project *",-1)),ce(c("select",{"onUpdate:modelValue":S[23]||(S[23]=B=>D.value.projectID=B),onChange:le,required:"",class:"form-input"},[S[55]||(S[55]=c("option",{value:""},"Select Project",-1)),(K(!0),q(Xe,null,ft(j.value,B=>(K(),q("option",{key:B.id,value:B.id},P(B.id)+" - "+P(B.siteLocation||"No location"),9,tse))),128))],544),[[st,D.value.projectID]])])]),c("div",nse,[c("div",rse,[S[57]||(S[57]=c("label",null,"Select Employees *",-1)),ce(c("input",{"onUpdate:modelValue":S[24]||(S[24]=B=>d.value=B),type:"text",placeholder:"Search employees...",class:"form-input",style:{"margin-bottom":"10px"}},null,512),[[Ne,d.value]]),c("div",sse,[(K(!0),q(Xe,null,ft(R.value,B=>(K(),q("div",{key:B.id,class:"employee-checkbox"},[c("label",null,[ce(c("input",{type:"checkbox",value:B.Id,"onUpdate:modelValue":S[25]||(S[25]=ie=>D.value.selectedEmployees=ie)},null,8,ise),[[Go,D.value.selectedEmployees]]),c("span",null,P(B.FirstName)+" ("+P(B.Id)+")",1)])]))),128))])])]),c("div",ose,[c("button",{type:"submit",class:"btn-submit",disabled:l.value},P(l.value?"Creating...":"Create Transactions"),9,ase),c("button",{type:"button",onClick:se,class:"btn-cancel",disabled:l.value},"Cancel",8,lse)])],32)])])):be("",!0),o.value?(K(),q("div",{key:2,class:"modal-overlay",onClick:nn(te,["self"])},[c("div",cse,[c("div",{class:"modal-header"},[S[58]||(S[58]=c("h4",null," Food & Trip Amount Settings",-1)),c("button",{class:"close-btn",onClick:te},"")]),c("form",{onSubmit:nn(O,["prevent"]),class:"item-form"},[c("div",use,[c("div",dse,[S[59]||(S[59]=c("label",null,"Food Money Amount (MNT) *",-1)),ce(c("input",{"onUpdate:modelValue":S[26]||(S[26]=B=>A.value.foodAmount=B),type:"number",required:"",class:"form-input",placeholder:"10000"},null,512),[[Ne,A.value.foodAmount,void 0,{number:!0}]])]),c("div",hse,[S[60]||(S[60]=c("label",null,"Trip Money Amount (MNT) *",-1)),ce(c("input",{"onUpdate:modelValue":S[27]||(S[27]=B=>A.value.tripAmount=B),type:"number",required:"",class:"form-input",placeholder:"75000"},null,512),[[Ne,A.value.tripAmount,void 0,{number:!0}]])])]),c("div",{class:"form-actions"},[S[61]||(S[61]=c("button",{type:"submit",class:"btn-submit"}," Save Settings ",-1)),c("button",{type:"button",onClick:te,class:"btn-cancel"},"Cancel")])],32)])])):be("",!0),v.value?(K(),q("div",{key:3,class:mt(["message",y.value])},P(v.value),3)):be("",!0)]))}},pse=gn(fse,[["__scopeId","data-v-e43c3a5f"]]),mse={class:"management-section"},gse={class:"item-list"},vse={class:"list-controls"},yse=["value"],_se=["value"],Ese={class:"warehouse-table-container"},Tse={class:"warehouse-table"},wse={class:"quantity"},Cse={class:"amount"},Ase={class:"amount"},Ise=["onClick"],Sse={class:"modal-content large-modal"},xse={class:"modal-header"},bse={class:"form-row"},Rse={class:"form-group"},kse={class:"form-group"},Pse={id:"category-list"},Nse=["value"],Ose={class:"form-row"},Dse={class:"form-group"},Mse={id:"status-list"},Fse=["value"],Lse={class:"form-group"},Use={class:"form-row"},Bse={class:"form-group"},Vse={class:"form-group"},$se={class:"form-row"},Hse={class:"form-group"},jse={class:"form-group"},Wse=["value"],Kse={class:"form-row"},qse={class:"form-group"},Gse={class:"form-group"},zse={class:"form-row"},Yse={class:"form-group"},Qse={class:"form-group"},Xse=["value"],Jse={class:"form-row"},Zse={class:"form-group full-width"},eie={class:"form-row"},tie={class:"form-group full-width"},nie={class:"form-actions"},rie={type:"submit",class:"btn-submit"},sie={class:"modal-content"},iie={class:"form-group"},oie={key:0,class:"form-group"},aie=["value"],lie={key:1},cie={class:"form-row"},uie={class:"form-group"},die={class:"form-group"},hie={class:"form-row"},fie={class:"form-group"},pie={class:"form-group"},mie={class:"form-row"},gie={class:"form-group"},vie={class:"form-group"},yie={class:"form-group"},_ie={class:"form-group"},Eie={class:"form-group"},Tie={class:"form-group"},wie={key:0,class:"hint"},Cie={class:"form-group"},Aie={class:"form-group"},Iie={__name:"WarehouseManagement",setup(n){const e=xo();ae(!1);const t=ae(!1),r=ae(!1),s=ae(""),i=ae(""),o=ae(""),a=ae("Name"),l=ae("asc"),u=ae([]),d=ae([]),f=ae([]),p=ae(""),m=ae({id:"",Name:"",Category:"",Status:"",Specs:"",unit:"",quantity:0,Location:"",Supplier:"",Date:"",code:"",unitPrice:0,Comment:"",CurrentProjectID:"",CurrentProjectName:""});kn(async()=>{await y()});const g=Be(()=>e.projects.filter(E=>E.projectStatus!==""&&E.projectStatus!=="Closed")),v=Be(()=>{let E=[...u.value];if(s.value.trim()){const T=s.value.toLowerCase();E=E.filter(U=>(U.Name||"").toLowerCase().includes(T)||(U.Category||"").toLowerCase().includes(T)||(U.code||"").toLowerCase().includes(T)||(U.Specs||"").toLowerCase().includes(T)||(U.Comment||"").toLowerCase().includes(T))}return i.value&&(E=E.filter(T=>T.Category===i.value)),o.value&&(E=E.filter(T=>T.Status===o.value)),E.sort((T,U)=>{let ee=T[a.value]||"",le=U[a.value]||"";return a.value==="quantity"||a.value==="unitPrice"?(ee=parseFloat(ee)||0,le=parseFloat(le)||0):(ee=String(ee).toLowerCase(),le=String(le).toLowerCase()),l.value==="asc"?ee<le?-1:ee>le?1:0:ee>le?-1:ee<le?1:0}),E});async function y(){try{const E=await Zt(Yt(Ct,"warehouse"));u.value=[];const T=new Set,U=new Set;E.forEach(ee=>{const le={id:ee.id,...ee.data()};u.value.push(le),le.Category&&T.add(le.Category),le.Status&&U.add(le.Status)}),d.value=Array.from(T).sort(),f.value=Array.from(U).sort()}catch(E){console.error("Error loading warehouse items:",E),alert("Failed to load warehouse items: "+E.message)}}function L(E){return E?new Intl.NumberFormat("en-US").format(E):"0"}function D(E){if(!E)return"";if(typeof E=="number"&&E>1e3){const T=new Date(1899,11,30);return new Date(T.getTime()+E*864e5).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}try{const T=new Date(E);return isNaN(T.getTime())?E:T.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return E}}function A(E){const T=(E||"").toLowerCase();return T.includes("available")||T.includes("")?"status-badge status-available":T.includes("use")||T.includes("")?"status-badge status-in-use":T.includes("low")||T.includes("")?"status-badge status-low":"status-badge"}function C(E){a.value===E?l.value=l.value==="asc"?"desc":"asc":(a.value=E,l.value="asc")}function j(E){return a.value!==E?"":l.value==="asc"?"":""}function z(){r.value=!1,m.value={id:"",Name:"",Category:"",Status:"",Specs:"",unit:"",quantity:0,Location:"",Supplier:"",Date:"",code:"",unitPrice:0,Comment:"",CurrentProjectID:"",CurrentProjectName:""},p.value="",t.value=!0}function w(E){r.value=!0,m.value={...E},p.value=L(E.unitPrice),t.value=!0}function R(E){const T=E.target.value.replace(/,/g,"");m.value.unitPrice=parseFloat(T)||0}function x(){p.value=L(m.value.unitPrice)}function b(){if(m.value.CurrentProjectID){const E=e.projects.find(T=>T.id===m.value.CurrentProjectID);E&&(m.value.CurrentProjectName=E.siteLocation||"")}else m.value.CurrentProjectName=""}async function N(){try{const E={...m.value,quantity:parseFloat(m.value.quantity)||0,unitPrice:parseFloat(m.value.unitPrice)||0};if(r.value){const T=await mc("update",E);if(T.success){const U=u.value.findIndex(ee=>ee.id===E.id);U!==-1&&(u.value[U]={...E}),alert("Item updated successfully!"),F()}else alert("Failed to update item: "+T.error)}else{const T=await mc("create",E);T.success?(u.value.push(T.item),alert("Item added successfully!"),F()):alert("Failed to add item: "+T.error)}await y()}catch(E){console.error("Error saving warehouse item:",E),alert("Error saving item: "+E.message)}}async function M(){if(confirm("Are you sure you want to delete this item?"))try{const E=await mc("delete",{id:m.value.id});E.success?(u.value=u.value.filter(T=>T.id!==m.value.id),alert("Item deleted successfully!"),F()):alert("Failed to delete item: "+E.error)}catch(E){console.error("Error deleting warehouse item:",E),alert("Error deleting item: "+E.message)}}function F(){t.value=!1,r.value=!1,m.value={id:"",Name:"",Category:"",Status:"",Specs:"",unit:"",quantity:0,Location:"",Supplier:"",Date:"",code:"",unitPrice:0,Comment:"",CurrentProjectID:"",CurrentProjectName:""},p.value=""}const oe=ae(!1),Q=ae({itemSelection:"",WarehouseID:"",WarehouseName:"",quantity:0,date:new Date().toISOString().split("T")[0],purpose:"",newItem:{Name:"",Category:"",Status:"",Specs:"",unit:"",Location:"",Supplier:"",code:"",unitPrice:0}}),ne=Be(()=>Q.value.itemSelection==="existing"&&Q.value.WarehouseID?u.value.find(E=>E.id===Q.value.WarehouseID):null);function ge(){Q.value={itemSelection:"",WarehouseID:"",WarehouseName:"",quantity:0,date:new Date().toISOString().split("T")[0],purpose:"",newItem:{Name:"",Category:"",Status:"",Specs:"",unit:"",Location:"",Supplier:"",code:"",unitPrice:0}},oe.value=!0}function xe(){Q.value.WarehouseID="",Q.value.WarehouseName=""}function Ee(){const E=ne.value;E&&(Q.value.WarehouseName=E.Name)}async function Pe(){try{let E=Q.value.WarehouseID,T=Q.value.WarehouseName;if(Q.value.itemSelection==="new"){const se={...Q.value.newItem,quantity:0,Date:Q.value.date},ve=await mc("create",se);if(!ve.success){alert("Failed to create new item: "+ve.error);return}E=ve.item.id,T=ve.item.Name,u.value.push(ve.item)}const U={action:"create",date:Q.value.date,type:"",WarehouseID:E,WarehouseName:T,quantity:Q.value.quantity,requestedEmpID:"",requestedEmpName:"",projectID:"",ProjectName:""},{manageWarehouseTransaction:ee}=await Jo(async()=>{const{manageWarehouseTransaction:se}=await Promise.resolve().then(()=>ru);return{manageWarehouseTransaction:se}},void 0),le=await ee(U);le.success?(alert("Income transaction added successfully!"),await y(),he()):alert("Failed to add income transaction: "+le.error)}catch(E){console.error("Error adding income transaction:",E),alert("Error: "+E.message)}}function he(){oe.value=!1}return(E,T)=>(K(),q("div",mse,[T[82]||(T[82]=c("h4",null,"Warehouse Management",-1)),c("div",{class:"management-buttons"},[c("button",{onClick:z,class:"action-btn add-btn"}," + Add Item "),c("button",{onClick:ge,class:"action-btn income-btn"},"  Add Income () ")]),c("div",gse,[T[48]||(T[48]=c("h5",null,"Warehouse Items",-1)),c("div",vse,[ce(c("input",{"onUpdate:modelValue":T[0]||(T[0]=U=>s.value=U),type:"text",placeholder:"Search by name, category, code...",class:"search-input"},null,512),[[Ne,s.value]]),ce(c("select",{"onUpdate:modelValue":T[1]||(T[1]=U=>i.value=U),class:"filter-select"},[T[35]||(T[35]=c("option",{value:""},"All Categories",-1)),(K(!0),q(Xe,null,ft(d.value,U=>(K(),q("option",{key:U,value:U},P(U),9,yse))),128))],512),[[st,i.value]]),ce(c("select",{"onUpdate:modelValue":T[2]||(T[2]=U=>o.value=U),class:"filter-select"},[T[36]||(T[36]=c("option",{value:""},"All Statuses",-1)),(K(!0),q(Xe,null,ft(f.value,U=>(K(),q("option",{key:U,value:U},P(U),9,_se))),128))],512),[[st,o.value]])]),c("div",Ese,[c("table",Tse,[c("thead",null,[c("tr",null,[c("th",{onClick:T[3]||(T[3]=U=>C("Name")),class:"sortable"}," Name "+P(j("Name")),1),c("th",{onClick:T[4]||(T[4]=U=>C("Category")),class:"sortable"}," Category "+P(j("Category")),1),c("th",{onClick:T[5]||(T[5]=U=>C("Status")),class:"sortable"}," Status "+P(j("Status")),1),T[37]||(T[37]=c("th",null,"Specs",-1)),T[38]||(T[38]=c("th",null,"Unit",-1)),c("th",{onClick:T[6]||(T[6]=U=>C("quantity")),class:"sortable"}," Quantity "+P(j("quantity")),1),T[39]||(T[39]=c("th",null,"Location",-1)),T[40]||(T[40]=c("th",null,"Supplier",-1)),T[41]||(T[41]=c("th",null,"Date",-1)),T[42]||(T[42]=c("th",null,"Code",-1)),c("th",{onClick:T[7]||(T[7]=U=>C("unitPrice")),class:"sortable"}," Unit Price "+P(j("unitPrice")),1),T[43]||(T[43]=c("th",null,"Total Value",-1)),T[44]||(T[44]=c("th",null,"Current Project",-1)),T[45]||(T[45]=c("th",null,"Comment",-1)),T[46]||(T[46]=c("th",null,"Action",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(v.value,U=>(K(),q("tr",{key:U.id},[c("td",null,[c("strong",null,P(U.Name),1)]),c("td",null,P(U.Category),1),c("td",null,[c("span",{class:mt(A(U.Status))},P(U.Status),3)]),c("td",null,[c("small",null,P(U.Specs),1)]),c("td",null,P(U.unit),1),c("td",wse,P(L(U.quantity)),1),c("td",null,P(U.Location),1),c("td",null,[c("small",null,P(U.Supplier),1)]),c("td",null,P(D(U.Date)),1),c("td",null,P(U.code),1),c("td",Cse,P(L(U.unitPrice))+"",1),c("td",Ase,P(L(U.quantity*U.unitPrice))+"",1),c("td",null,[c("small",null,[bt(P(U.CurrentProjectID),1),T[47]||(T[47]=c("br",null,null,-1)),bt(P(U.CurrentProjectName),1)])]),c("td",null,[c("small",null,P(U.Comment),1)]),c("td",null,[c("button",{onClick:ee=>w(U),class:"btn-edit-small"},"Edit",8,Ise)])]))),128))])])])]),t.value?(K(),q("div",{key:0,class:"modal-overlay",onClick:nn(F,["self"])},[c("div",Sse,[c("div",xse,[c("h4",null,P(r.value?"Edit Warehouse Item":"Add New Item"),1),c("button",{class:"close-btn",onClick:F},"")]),c("form",{onSubmit:nn(N,["prevent"]),class:"item-form"},[c("div",bse,[c("div",Rse,[T[49]||(T[49]=c("label",null,"Name *",-1)),ce(c("input",{"onUpdate:modelValue":T[8]||(T[8]=U=>m.value.Name=U),type:"text",required:"",class:"form-input",placeholder:"Item name"},null,512),[[Ne,m.value.Name]])]),c("div",kse,[T[50]||(T[50]=c("label",null,"Category *",-1)),ce(c("input",{"onUpdate:modelValue":T[9]||(T[9]=U=>m.value.Category=U),type:"text",required:"",class:"form-input",list:"category-list",placeholder:"Category"},null,512),[[Ne,m.value.Category]]),c("datalist",Pse,[(K(!0),q(Xe,null,ft(d.value,U=>(K(),q("option",{key:U,value:U},P(U),9,Nse))),128))])])]),c("div",Ose,[c("div",Dse,[T[51]||(T[51]=c("label",null,"Status",-1)),ce(c("input",{"onUpdate:modelValue":T[10]||(T[10]=U=>m.value.Status=U),type:"text",class:"form-input",list:"status-list",placeholder:"Status"},null,512),[[Ne,m.value.Status]]),c("datalist",Mse,[(K(!0),q(Xe,null,ft(f.value,U=>(K(),q("option",{key:U,value:U},P(U),9,Fse))),128))])]),c("div",Lse,[T[52]||(T[52]=c("label",null,"Code",-1)),ce(c("input",{"onUpdate:modelValue":T[11]||(T[11]=U=>m.value.code=U),type:"text",class:"form-input",placeholder:"Item code"},null,512),[[Ne,m.value.code]])])]),c("div",Use,[c("div",Bse,[T[53]||(T[53]=c("label",null,"Unit",-1)),ce(c("input",{"onUpdate:modelValue":T[12]||(T[12]=U=>m.value.unit=U),type:"text",class:"form-input",placeholder:"e.g., pcs, kg, m"},null,512),[[Ne,m.value.unit]])]),c("div",Vse,[T[54]||(T[54]=c("label",null,"Quantity",-1)),ce(c("input",{"onUpdate:modelValue":T[13]||(T[13]=U=>m.value.quantity=U),type:"number",step:"0.01",class:"form-input",placeholder:"0"},null,512),[[Ne,m.value.quantity,void 0,{number:!0}]])])]),c("div",$se,[c("div",Hse,[T[55]||(T[55]=c("label",null,"Unit Price",-1)),ce(c("input",{"onUpdate:modelValue":T[14]||(T[14]=U=>p.value=U),type:"text",class:"form-input",placeholder:"0",onInput:R,onBlur:x},null,544),[[Ne,p.value]])]),c("div",jse,[T[56]||(T[56]=c("label",null,"Total Value",-1)),c("input",{value:L(m.value.quantity*m.value.unitPrice),type:"text",readonly:"",class:"form-input",style:{"background-color":"#f5f5f5"}},null,8,Wse)])]),c("div",Kse,[c("div",qse,[T[57]||(T[57]=c("label",null,"Location",-1)),ce(c("input",{"onUpdate:modelValue":T[15]||(T[15]=U=>m.value.Location=U),type:"text",class:"form-input",placeholder:"Storage location"},null,512),[[Ne,m.value.Location]])]),c("div",Gse,[T[58]||(T[58]=c("label",null,"Supplier",-1)),ce(c("input",{"onUpdate:modelValue":T[16]||(T[16]=U=>m.value.Supplier=U),type:"text",class:"form-input",placeholder:"Supplier name"},null,512),[[Ne,m.value.Supplier]])])]),c("div",zse,[c("div",Yse,[T[59]||(T[59]=c("label",null,"Date",-1)),ce(c("input",{"onUpdate:modelValue":T[17]||(T[17]=U=>m.value.Date=U),type:"date",class:"form-input"},null,512),[[Ne,m.value.Date]])]),c("div",Qse,[T[61]||(T[61]=c("label",null,"Current Project",-1)),ce(c("select",{"onUpdate:modelValue":T[18]||(T[18]=U=>m.value.CurrentProjectID=U),class:"form-input",onChange:b},[T[60]||(T[60]=c("option",{value:""},"Select Project",-1)),(K(!0),q(Xe,null,ft(g.value,U=>(K(),q("option",{key:U.id,value:U.id},P(U.id)+" - "+P(U.siteLocation),9,Xse))),128))],544),[[st,m.value.CurrentProjectID]])])]),c("div",Jse,[c("div",Zse,[T[62]||(T[62]=c("label",null,"Specifications",-1)),ce(c("textarea",{"onUpdate:modelValue":T[19]||(T[19]=U=>m.value.Specs=U),class:"form-input",rows:"2",placeholder:"Technical specifications..."},null,512),[[Ne,m.value.Specs]])])]),c("div",eie,[c("div",tie,[T[63]||(T[63]=c("label",null,"Comment",-1)),ce(c("textarea",{"onUpdate:modelValue":T[20]||(T[20]=U=>m.value.Comment=U),class:"form-input",rows:"2",placeholder:"Additional notes..."},null,512),[[Ne,m.value.Comment]])])]),c("div",nie,[c("button",rie,P(r.value?"Update Item":"Add Item"),1),c("button",{type:"button",onClick:F,class:"btn-cancel"},"Cancel"),r.value?(K(),q("button",{key:0,type:"button",onClick:M,class:"btn-delete"}," Delete ")):be("",!0)])],32)])])):be("",!0),oe.value?(K(),q("div",{key:1,class:"modal-overlay",onClick:nn(he,["self"])},[c("div",sie,[c("div",{class:"modal-header"},[T[64]||(T[64]=c("h4",null," Add Income Transaction ()",-1)),c("button",{class:"close-btn",onClick:he},"")]),c("form",{onSubmit:nn(Pe,["prevent"]),class:"item-form"},[c("div",iie,[T[66]||(T[66]=c("label",null,"Warehouse Item *",-1)),ce(c("select",{"onUpdate:modelValue":T[21]||(T[21]=U=>Q.value.itemSelection=U),onChange:xe,required:""},[...T[65]||(T[65]=[c("option",{value:""},"Select Item",-1),c("option",{value:"existing"},"Select Existing Item",-1),c("option",{value:"new"},"Create New Item",-1)])],544),[[st,Q.value.itemSelection]])]),Q.value.itemSelection==="existing"?(K(),q("div",oie,[T[68]||(T[68]=c("label",null,"Select Item *",-1)),ce(c("select",{"onUpdate:modelValue":T[22]||(T[22]=U=>Q.value.WarehouseID=U),onChange:Ee,required:""},[T[67]||(T[67]=c("option",{value:""},"Choose an item",-1)),(K(!0),q(Xe,null,ft(u.value,U=>(K(),q("option",{key:U.id,value:U.id},P(U.Name)+" ("+P(U.Category)+") - Current: "+P(U.quantity)+" "+P(U.unit),9,aie))),128))],544),[[st,Q.value.WarehouseID]])])):be("",!0),Q.value.itemSelection==="new"?(K(),q("div",lie,[c("div",cie,[c("div",uie,[T[69]||(T[69]=c("label",null,"Item Name *",-1)),ce(c("input",{"onUpdate:modelValue":T[23]||(T[23]=U=>Q.value.newItem.Name=U),type:"text",required:""},null,512),[[Ne,Q.value.newItem.Name]])]),c("div",die,[T[70]||(T[70]=c("label",null,"Category *",-1)),ce(c("input",{"onUpdate:modelValue":T[24]||(T[24]=U=>Q.value.newItem.Category=U),type:"text",required:"",list:"category-list"},null,512),[[Ne,Q.value.newItem.Category]])])]),c("div",hie,[c("div",fie,[T[71]||(T[71]=c("label",null,"Unit *",-1)),ce(c("input",{"onUpdate:modelValue":T[25]||(T[25]=U=>Q.value.newItem.unit=U),type:"text",required:"",placeholder:"e.g., kg, pieces, m"},null,512),[[Ne,Q.value.newItem.unit]])]),c("div",pie,[T[72]||(T[72]=c("label",null,"Unit Price",-1)),ce(c("input",{"onUpdate:modelValue":T[26]||(T[26]=U=>Q.value.newItem.unitPrice=U),type:"number",step:"0.01",min:"0"},null,512),[[Ne,Q.value.newItem.unitPrice,void 0,{number:!0}]])])]),c("div",mie,[c("div",gie,[T[73]||(T[73]=c("label",null,"Code",-1)),ce(c("input",{"onUpdate:modelValue":T[27]||(T[27]=U=>Q.value.newItem.code=U),type:"text"},null,512),[[Ne,Q.value.newItem.code]])]),c("div",vie,[T[74]||(T[74]=c("label",null,"Status",-1)),ce(c("input",{"onUpdate:modelValue":T[28]||(T[28]=U=>Q.value.newItem.Status=U),type:"text",list:"status-list"},null,512),[[Ne,Q.value.newItem.Status]])])]),c("div",yie,[T[75]||(T[75]=c("label",null,"Supplier",-1)),ce(c("input",{"onUpdate:modelValue":T[29]||(T[29]=U=>Q.value.newItem.Supplier=U),type:"text"},null,512),[[Ne,Q.value.newItem.Supplier]])]),c("div",_ie,[T[76]||(T[76]=c("label",null,"Location",-1)),ce(c("input",{"onUpdate:modelValue":T[30]||(T[30]=U=>Q.value.newItem.Location=U),type:"text"},null,512),[[Ne,Q.value.newItem.Location]])]),c("div",Eie,[T[77]||(T[77]=c("label",null,"Specifications",-1)),ce(c("textarea",{"onUpdate:modelValue":T[31]||(T[31]=U=>Q.value.newItem.Specs=U),rows:"2"},null,512),[[Ne,Q.value.newItem.Specs]])])])):be("",!0),c("div",Tie,[T[78]||(T[78]=c("label",null,"Quantity *",-1)),ce(c("input",{"onUpdate:modelValue":T[32]||(T[32]=U=>Q.value.quantity=U),type:"number",step:"0.01",min:"0.01",required:""},null,512),[[Ne,Q.value.quantity,void 0,{number:!0}]]),Q.value.itemSelection==="existing"&&ne.value?(K(),q("small",wie," Current quantity: "+P(ne.value.quantity)+" "+P(ne.value.unit),1)):be("",!0)]),c("div",Cie,[T[79]||(T[79]=c("label",null,"Date",-1)),ce(c("input",{"onUpdate:modelValue":T[33]||(T[33]=U=>Q.value.date=U),type:"date",required:""},null,512),[[Ne,Q.value.date]])]),c("div",Aie,[T[80]||(T[80]=c("label",null,"Purpose / Notes",-1)),ce(c("textarea",{"onUpdate:modelValue":T[34]||(T[34]=U=>Q.value.purpose=U),rows:"2",placeholder:"Reason for adding items..."},null,512),[[Ne,Q.value.purpose]])]),c("div",{class:"form-actions"},[T[81]||(T[81]=c("button",{type:"submit",class:"btn-submit"},"Add Income",-1)),c("button",{type:"button",onClick:he,class:"btn-cancel"},"Cancel")])],32)])])):be("",!0)]))}},Sie=gn(Iie,[["__scopeId","data-v-2c2ae650"]]),xie={name:"WarehouseTransactionManagement",setup(){const n=ae([]),e=ae([]),t=ae([]),r=ae([]),s=ae(!1),i=ae(!1),o=ae(null),a=ae(""),l=ae(""),u=ae("date"),d=ae("desc"),f=ae({date:new Date().toISOString().split("T")[0],type:"",WarehouseID:"",WarehouseName:"",quantity:0,requestedEmpID:"",requestedEmpName:"",projectID:"",ProjectName:""}),p=async()=>{try{const ne=await Zt(Yt(Ct,"warehouseTransactions"));n.value=ne.docs.map(ge=>({id:ge.id,...ge.data()}))}catch(ne){console.error("Error loading transactions:",ne),alert("Failed to load transactions: "+ne.message)}},m=async()=>{try{const ne=await Zt(Yt(Ct,"warehouse"));e.value=ne.docs.map(ge=>({id:ge.id,...ge.data()}))}catch(ne){console.error("Error loading warehouse items:",ne)}},g=async()=>{try{const ne=await Zt(Yt(Ct,"employees"));t.value=ne.docs.map(ge=>({id:ge.id,...ge.data()}))}catch(ne){console.error("Error loading employees:",ne)}},v=async()=>{try{const ne=await Zt(Yt(Ct,"projects"));r.value=ne.docs.map(ge=>({id:ge.id,...ge.data()}))}catch(ne){console.error("Error loading projects:",ne)}},y=Be(()=>e.value.find(ne=>ne.id===f.value.WarehouseID)),L=Be(()=>{let ne=[...n.value];if(a.value){const ge=a.value.toLowerCase();ne=ne.filter(xe=>{var Ee,Pe,he,E;return((Ee=xe.WarehouseName)==null?void 0:Ee.toLowerCase().includes(ge))||((Pe=xe.requestedEmpName)==null?void 0:Pe.toLowerCase().includes(ge))||((he=xe.ProjectName)==null?void 0:he.toLowerCase().includes(ge))||((E=xe.WarehouseID)==null?void 0:E.toLowerCase().includes(ge))})}return l.value&&(ne=ne.filter(ge=>ge.type===l.value)),ne.sort((ge,xe)=>{let Ee=ge[u.value],Pe=xe[u.value];return typeof Ee=="string"&&(Ee=Ee.toLowerCase()),typeof Pe=="string"&&(Pe=Pe.toLowerCase()),Ee<Pe?d.value==="asc"?-1:1:Ee>Pe?d.value==="asc"?1:-1:0}),ne}),D=()=>{i.value=!1,o.value=null,f.value={date:new Date().toISOString().split("T")[0],type:"",WarehouseID:"",WarehouseName:"",quantity:0,requestedEmpID:"",requestedEmpName:"",projectID:"",ProjectName:""},s.value=!0},A=ne=>{i.value=!0,o.value=ne.id,f.value={date:ne.date,type:ne.type,WarehouseID:ne.WarehouseID,WarehouseName:ne.WarehouseName,quantity:ne.quantity,requestedEmpID:ne.requestedEmpID||"",requestedEmpName:ne.requestedEmpName||"",projectID:ne.projectID||"",ProjectName:ne.ProjectName||""},s.value=!0},C=async ne=>{if(confirm("Are you sure you want to delete this transaction?"))try{const ge=await g0({action:"delete",id:ne.id});ge.success?(alert("Transaction deleted successfully"),await p()):alert("Error: "+ge.error)}catch(ge){console.error("Error deleting transaction:",ge),alert("Failed to delete transaction: "+ge.message)}},j=async()=>{try{const ne={action:i.value?"update":"create",...f.value};i.value&&(ne.id=o.value);const ge=await g0(ne);ge.success?(alert(`Transaction ${i.value?"updated":"created"} successfully!`),await p(),await m(),z()):alert("Error: "+ge.error)}catch(ne){console.error("Error saving transaction:",ne),alert("Failed to save transaction: "+ne.message)}},z=()=>{s.value=!1,i.value=!1,o.value=null},w=()=>{const ne=y.value;ne&&(f.value.WarehouseName=ne.Name)},R=()=>{const ne=t.value.find(ge=>ge.id===f.value.requestedEmpID);ne?f.value.requestedEmpName=`${ne.FirstName} ${ne.LastName}`:f.value.requestedEmpName=""},x=()=>{const ne=r.value.find(ge=>ge.id===f.value.projectID);ne?f.value.ProjectName=ne.ProjectName:f.value.ProjectName=""},b=ne=>{u.value===ne?d.value=d.value==="asc"?"desc":"asc":(u.value=ne,d.value="asc")},N=ne=>u.value!==ne?"":d.value==="asc"?"":"",M=ne=>ne===""?"type-income":"type-expense",F=ne=>ne===""?"transaction-income":"transaction-expense",oe=ne=>{if(!ne)return"";if(!isNaN(ne)&&Number(ne)>1e3){const xe=new Date(1899,11,30);return new Date(xe.getTime()+Number(ne)*864e5).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}const ge=new Date(ne);return isNaN(ge.getTime())?ne:ge.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},Q=ne=>ne==null?"0":Number(ne).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});return kn(async()=>{await Promise.all([p(),m(),g(),v()])}),{transactions:n,warehouseItems:e,employees:t,projects:r,showForm:s,isEditMode:i,searchQuery:a,filterType:l,formData:f,selectedWarehouseItem:y,filteredTransactions:L,handleAddTransaction:D,editTransaction:A,deleteTransaction:C,handleSubmit:j,closeForm:z,onWarehouseItemChange:w,onEmployeeChange:R,onProjectChange:x,sortByColumn:b,getSortIcon:N,getTypeClass:M,getTransactionClass:F,formatDate:oe,formatNumber:Q}}},bie={class:"management-section"},Rie={class:"management-buttons"},kie={class:"item-list"},Pie={class:"list-controls"},Nie={class:"warehouse-table-container"},Oie={class:"warehouse-table"},Die={class:"quantity"},Mie={class:"quantity"},Fie={key:0},Lie={key:1},Uie={key:0},Bie={key:1},Vie=["onClick"],$ie=["onClick"],Hie={class:"modal-content"},jie={class:"modal-header"},Wie={class:"form-group"},Kie={class:"form-group"},qie={class:"form-group"},Gie=["value"],zie={class:"form-group"},Yie={key:0,class:"hint"},Qie={class:"form-group"},Xie=["value"],Jie={class:"form-group"},Zie=["value"],eoe={class:"form-buttons"},toe={type:"submit",class:"btn-submit"};function noe(n,e,t,r,s,i){return K(),q("div",bie,[e[39]||(e[39]=c("h4",null,"Warehouse Transaction Management",-1)),c("div",Rie,[c("button",{onClick:e[0]||(e[0]=(...o)=>r.handleAddTransaction&&r.handleAddTransaction(...o)),class:"action-btn add-btn"}," + Add Transaction ")]),c("div",kie,[e[28]||(e[28]=c("h5",null,"Warehouse Transactions",-1)),c("div",Pie,[ce(c("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.searchQuery=o),type:"text",placeholder:"Search by warehouse, employee, project...",class:"search-input"},null,512),[[Ne,r.searchQuery]]),ce(c("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.filterType=o),class:"filter-select"},[...e[20]||(e[20]=[c("option",{value:""},"All Types",-1),c("option",{value:""}," (Income)",-1),c("option",{value:""}," (Expense)",-1)])],512),[[st,r.filterType]])]),c("div",Nie,[c("table",Oie,[c("thead",null,[c("tr",null,[c("th",{onClick:e[3]||(e[3]=o=>r.sortByColumn("date")),class:"sortable"}," Date "+P(r.getSortIcon("date")),1),c("th",{onClick:e[4]||(e[4]=o=>r.sortByColumn("type")),class:"sortable"}," Type "+P(r.getSortIcon("type")),1),e[21]||(e[21]=c("th",null,"Warehouse Item",-1)),c("th",{onClick:e[5]||(e[5]=o=>r.sortByColumn("quantity")),class:"sortable"}," Quantity "+P(r.getSortIcon("quantity")),1),c("th",{onClick:e[6]||(e[6]=o=>r.sortByColumn("leftover")),class:"sortable"}," Leftover "+P(r.getSortIcon("leftover")),1),e[22]||(e[22]=c("th",null,"Requested By",-1)),e[23]||(e[23]=c("th",null,"Project",-1)),e[24]||(e[24]=c("th",null,"Actions",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(r.filteredTransactions,o=>(K(),q("tr",{key:o.id,class:mt(r.getTransactionClass(o.type))},[c("td",null,P(r.formatDate(o.date)),1),c("td",null,[c("span",{class:mt(r.getTypeClass(o.type))},P(o.type),3)]),c("td",null,[c("strong",null,P(o.WarehouseName),1),e[25]||(e[25]=c("br",null,null,-1)),c("small",null,"ID: "+P(o.WarehouseID),1)]),c("td",Die,P(r.formatNumber(o.quantity)),1),c("td",Mie,P(r.formatNumber(o.leftover)),1),c("td",null,[o.requestedEmpName?(K(),q("span",Fie,[bt(P(o.requestedEmpName)+" ",1),e[26]||(e[26]=c("br",null,null,-1)),c("small",null,"ID: "+P(o.requestedEmpID),1)])):(K(),q("span",Lie,"-"))]),c("td",null,[o.ProjectName?(K(),q("span",Uie,[bt(P(o.ProjectName)+" ",1),e[27]||(e[27]=c("br",null,null,-1)),c("small",null,"ID: "+P(o.projectID),1)])):(K(),q("span",Bie,"-"))]),c("td",null,[c("button",{onClick:a=>r.editTransaction(o),class:"btn-edit-small"},"Edit",8,Vie),c("button",{onClick:a=>r.deleteTransaction(o),class:"btn-delete-small"},"Delete",8,$ie)])],2))),128))])])])]),r.showForm?(K(),q("div",{key:0,class:"modal-overlay",onClick:e[19]||(e[19]=nn((...o)=>r.closeForm&&r.closeForm(...o),["self"]))},[c("div",Hie,[c("div",jie,[c("h4",null,P(r.isEditMode?"Edit Transaction":"Add New Transaction"),1),c("button",{class:"close-btn",onClick:e[7]||(e[7]=(...o)=>r.closeForm&&r.closeForm(...o))},"")]),c("form",{onSubmit:e[18]||(e[18]=nn((...o)=>r.handleSubmit&&r.handleSubmit(...o),["prevent"])),class:"item-form"},[c("div",Wie,[e[29]||(e[29]=c("label",{for:"date"},"Date *",-1)),ce(c("input",{id:"date","onUpdate:modelValue":e[8]||(e[8]=o=>r.formData.date=o),type:"date",required:""},null,512),[[Ne,r.formData.date]])]),c("div",Kie,[e[31]||(e[31]=c("label",{for:"type"},"Type *",-1)),ce(c("select",{id:"type","onUpdate:modelValue":e[9]||(e[9]=o=>r.formData.type=o),required:""},[...e[30]||(e[30]=[c("option",{value:""},"Select Type",-1),c("option",{value:""}," (Income - Add Material)",-1),c("option",{value:""}," (Expense - Request Material)",-1)])],512),[[st,r.formData.type]])]),c("div",qie,[e[33]||(e[33]=c("label",{for:"warehouseItem"},"Warehouse Item *",-1)),ce(c("select",{id:"warehouseItem","onUpdate:modelValue":e[10]||(e[10]=o=>r.formData.WarehouseID=o),onChange:e[11]||(e[11]=(...o)=>r.onWarehouseItemChange&&r.onWarehouseItemChange(...o)),required:""},[e[32]||(e[32]=c("option",{value:""},"Select Warehouse Item",-1)),(K(!0),q(Xe,null,ft(r.warehouseItems,o=>(K(),q("option",{key:o.id,value:o.id},P(o.Name)+" (Available: "+P(o.quantity)+" "+P(o.unit)+") ",9,Gie))),128))],544),[[st,r.formData.WarehouseID]])]),c("div",zie,[e[34]||(e[34]=c("label",{for:"quantity"},"Quantity *",-1)),ce(c("input",{id:"quantity","onUpdate:modelValue":e[12]||(e[12]=o=>r.formData.quantity=o),type:"number",min:"0.01",step:"0.01",required:""},null,512),[[Ne,r.formData.quantity,void 0,{number:!0}]]),r.selectedWarehouseItem?(K(),q("small",Yie," Available: "+P(r.selectedWarehouseItem.quantity)+" "+P(r.selectedWarehouseItem.unit),1)):be("",!0)]),c("div",Qie,[e[36]||(e[36]=c("label",{for:"employee"},"Requested By",-1)),ce(c("select",{id:"employee","onUpdate:modelValue":e[13]||(e[13]=o=>r.formData.requestedEmpID=o),onChange:e[14]||(e[14]=(...o)=>r.onEmployeeChange&&r.onEmployeeChange(...o))},[e[35]||(e[35]=c("option",{value:""},"Select Employee (Optional)",-1)),(K(!0),q(Xe,null,ft(r.employees,o=>(K(),q("option",{key:o.id,value:o.id},P(o.FirstName)+" "+P(o.LastName)+" ("+P(o.id)+") ",9,Xie))),128))],544),[[st,r.formData.requestedEmpID]])]),c("div",Jie,[e[38]||(e[38]=c("label",{for:"project"},"Project",-1)),ce(c("select",{id:"project","onUpdate:modelValue":e[15]||(e[15]=o=>r.formData.projectID=o),onChange:e[16]||(e[16]=(...o)=>r.onProjectChange&&r.onProjectChange(...o))},[e[37]||(e[37]=c("option",{value:""},"Select Project (Optional)",-1)),(K(!0),q(Xe,null,ft(r.projects,o=>(K(),q("option",{key:o.id,value:o.id},P(o.ProjectName)+" ("+P(o.id)+") ",9,Zie))),128))],544),[[st,r.formData.projectID]])]),c("div",eoe,[c("button",toe,P(r.isEditMode?"Update Transaction":"Add Transaction"),1),c("button",{type:"button",onClick:e[17]||(e[17]=(...o)=>r.closeForm&&r.closeForm(...o)),class:"btn-cancel"},"Cancel")])],32)])])):be("",!0)])}const roe=gn(xie,[["render",noe],["__scopeId","data-v-90612a12"]]),soe={name:"WarehouseRequestForm",setup(){const n=Js(),e=xo(),t=ae([]),r=ae([]),s=ae(!1),i=ae({WarehouseID:"",WarehouseName:"",quantity:0,projectID:"",ProjectName:"",purpose:""}),o=Be(()=>t.value.find(y=>y.id===i.value.WarehouseID)),a=Be(()=>e.projects.filter(y=>y.projectStatus!==""&&y.projectStatus!=="Closed")),l=async()=>{try{const y=await Zt(Yt(Ct,"warehouse"));t.value=y.docs.map(L=>({id:L.id,...L.data()})).filter(L=>L.quantity>0).sort((L,D)=>L.Name.localeCompare(D.Name))}catch(y){console.error("Error loading warehouse items:",y),alert("Failed to load warehouse items")}},u=async()=>{var y;try{if(!((y=n.userData)!=null&&y.employeeId)){console.log("No employee ID found");return}const L=xr(Yt(Ct,"warehouseRequests"),Ir("requestedEmpID","==",n.userData.employeeId)),D=await Zt(L);r.value=D.docs.map(A=>({id:A.id,...A.data()})).sort((A,C)=>{var w,R,x,b;const j=((R=(w=A.requestedAt)==null?void 0:w.toDate)==null?void 0:R.call(w))||new Date(0);return(((b=(x=C.requestedAt)==null?void 0:x.toDate)==null?void 0:b.call(x))||new Date(0))-j})}catch(L){console.error("Error loading requests:",L)}},d=()=>{o.value&&(i.value.WarehouseName=o.value.Name)},f=()=>{const y=e.projects.find(L=>L.id===i.value.projectID);y&&(i.value.ProjectName=y.siteLocation||y.ProjectName||"")},p=async()=>{var y;if(i.value.quantity>(((y=o.value)==null?void 0:y.quantity)||0)){alert("Requested quantity exceeds available stock!");return}s.value=!0;try{const{manageWarehouseRequest:L}=await Jo(async()=>{const{manageWarehouseRequest:A}=await Promise.resolve().then(()=>ru);return{manageWarehouseRequest:A}},void 0),D=await L({action:"create",request:{WarehouseID:i.value.WarehouseID,WarehouseName:i.value.WarehouseName,quantity:i.value.quantity,requestedEmpID:n.userData.employeeId,requestedEmpName:`${n.userData.employeeFirstName} ${n.userData.employeeLastName}`,projectID:i.value.projectID,ProjectName:i.value.ProjectName,purpose:i.value.purpose}});D.success?(alert("Request submitted successfully!"),g(),await u()):alert("Failed to submit request: "+D.error)}catch(L){console.error("Error submitting request:",L),alert("Error submitting request: "+L.message)}finally{s.value=!1}},m=async y=>{if(confirm("Cancel this request?"))try{const{manageWarehouseRequest:L}=await Jo(async()=>{const{manageWarehouseRequest:A}=await Promise.resolve().then(()=>ru);return{manageWarehouseRequest:A}},void 0),D=await L({action:"delete",requestId:y});D.success?(alert("Request cancelled"),await u()):alert("Failed to cancel request: "+D.error)}catch(L){console.error("Error cancelling request:",L),alert("Error: "+L.message)}},g=()=>{i.value={WarehouseID:"",WarehouseName:"",quantity:0,projectID:"",ProjectName:"",purpose:""}},v=y=>{if(!y)return"";try{return(y.toDate?y.toDate():new Date(y)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}};return kn(async()=>{await Promise.all([l(),u()])}),{formData:i,selectedItem:o,activeProjects:a,warehouseItems:t,myRequests:r,submitting:s,onItemChange:d,onProjectChange:f,handleSubmit:p,deleteRequest:m,resetForm:g,formatDate:v}}},ioe={class:"warehouse-request-form"},ooe={class:"form-group"},aoe=["value"],loe={class:"form-group"},coe=["max"],uoe={key:0,class:"hint"},doe={key:1,class:"error"},hoe={class:"form-group"},foe=["value"],poe={class:"form-group"},moe={class:"form-actions"},goe=["disabled"],voe={class:"my-requests"},yoe={key:0,class:"no-requests"},_oe={key:1,class:"requests-list"},Eoe={class:"request-header"},Toe={class:"request-item"},woe={class:"request-details"},Coe={key:0},Aoe={key:1},Ioe={key:0,class:"request-actions"},Soe=["onClick"];function xoe(n,e,t,r,s,i){var o,a,l;return K(),q("div",ioe,[e[23]||(e[23]=c("h3",null,"Request Warehouse Materials",-1)),c("form",{onSubmit:e[7]||(e[7]=nn((...u)=>r.handleSubmit&&r.handleSubmit(...u),["prevent"]))},[c("div",ooe,[e[9]||(e[9]=c("label",{for:"warehouseItem"},"Warehouse Item *",-1)),ce(c("select",{id:"warehouseItem","onUpdate:modelValue":e[0]||(e[0]=u=>r.formData.WarehouseID=u),onChange:e[1]||(e[1]=(...u)=>r.onItemChange&&r.onItemChange(...u)),required:""},[e[8]||(e[8]=c("option",{value:""},"Select item to request",-1)),(K(!0),q(Xe,null,ft(r.warehouseItems,u=>(K(),q("option",{key:u.id,value:u.id},P(u.Name)+" ("+P(u.Category)+") - Available: "+P(u.quantity)+" "+P(u.unit),9,aoe))),128))],544),[[st,r.formData.WarehouseID]])]),c("div",loe,[e[10]||(e[10]=c("label",{for:"quantity"},"Quantity Needed *",-1)),ce(c("input",{id:"quantity","onUpdate:modelValue":e[2]||(e[2]=u=>r.formData.quantity=u),type:"number",step:"0.01",min:"0.01",max:((o=r.selectedItem)==null?void 0:o.quantity)||999999,required:""},null,8,coe),[[Ne,r.formData.quantity,void 0,{number:!0}]]),r.selectedItem?(K(),q("small",uoe," Available: "+P(r.selectedItem.quantity)+" "+P(r.selectedItem.unit),1)):be("",!0),r.formData.quantity>(((a=r.selectedItem)==null?void 0:a.quantity)||0)?(K(),q("small",doe," Insufficient quantity! ")):be("",!0)]),c("div",hoe,[e[12]||(e[12]=c("label",{for:"project"},"Project *",-1)),ce(c("select",{id:"project","onUpdate:modelValue":e[3]||(e[3]=u=>r.formData.projectID=u),onChange:e[4]||(e[4]=(...u)=>r.onProjectChange&&r.onProjectChange(...u)),required:""},[e[11]||(e[11]=c("option",{value:""},"Select project",-1)),(K(!0),q(Xe,null,ft(r.activeProjects,u=>(K(),q("option",{key:u.id,value:u.id},P(u.id)+" - "+P(u.siteLocation),9,foe))),128))],544),[[st,r.formData.projectID]])]),c("div",poe,[e[13]||(e[13]=c("label",{for:"purpose"},"Purpose / Reason *",-1)),ce(c("textarea",{id:"purpose","onUpdate:modelValue":e[5]||(e[5]=u=>r.formData.purpose=u),rows:"3",required:"",placeholder:"Explain why you need these materials..."},null,512),[[Ne,r.formData.purpose]])]),c("div",moe,[c("button",{type:"submit",class:"btn-submit",disabled:r.submitting||r.formData.quantity>(((l=r.selectedItem)==null?void 0:l.quantity)||0)},P(r.submitting?"Submitting...":"Submit Request"),9,goe),c("button",{type:"button",onClick:e[6]||(e[6]=(...u)=>r.resetForm&&r.resetForm(...u)),class:"btn-cancel"},"Reset")])],32),c("div",voe,[e[22]||(e[22]=c("h4",null,"My Requests",-1)),r.myRequests.length===0?(K(),q("div",yoe," No requests yet ")):(K(),q("div",_oe,[(K(!0),q(Xe,null,ft(r.myRequests,u=>(K(),q("div",{key:u.id,class:mt(["request-card","status-"+u.status])},[c("div",Eoe,[c("span",Toe,P(u.WarehouseName),1),c("span",{class:mt(["request-status","badge-"+u.status])},P(u.status),3)]),c("div",woe,[c("p",null,[e[14]||(e[14]=c("strong",null,"Quantity:",-1)),bt(" "+P(u.quantity),1)]),c("p",null,[e[15]||(e[15]=c("strong",null,"Project:",-1)),bt(" "+P(u.ProjectName||u.projectID),1)]),c("p",null,[e[16]||(e[16]=c("strong",null,"Purpose:",-1)),bt(" "+P(u.purpose),1)]),c("p",null,[e[17]||(e[17]=c("strong",null,"Requested:",-1)),bt(" "+P(r.formatDate(u.requestedAt)),1)]),u.status==="approved"?(K(),q("p",Coe,[e[18]||(e[18]=c("strong",null,"Approved:",-1)),bt(" "+P(r.formatDate(u.approvedAt)),1)])):be("",!0),u.status==="rejected"?(K(),q("p",Aoe,[e[19]||(e[19]=c("strong",null,"Rejected:",-1)),bt(" "+P(r.formatDate(u.rejectedAt)),1),e[20]||(e[20]=c("br",null,null,-1)),e[21]||(e[21]=c("strong",null,"Reason:",-1)),bt(" "+P(u.rejectionReason),1)])):be("",!0)]),u.status==="pending"?(K(),q("div",Ioe,[c("button",{onClick:d=>r.deleteRequest(u.id),class:"btn-delete-small"},"Cancel Request",8,Soe)])):be("",!0)],2))),128))]))])])}const boe=gn(soe,[["render",xoe],["__scopeId","data-v-9fad183e"]]),Roe={class:"public-projects"},koe={key:0,class:"password-screen"},Poe={class:"password-card"},Noe={key:0,class:"error-message"},Ooe={key:1,class:"projects-view"},Doe={class:"filter-section"},Moe=["value"],Foe={key:0,class:"loading"},Loe={key:1,class:"table-container"},Uoe={class:"projects-table"},Boe={class:"number-cell"},Voe={class:"number-cell highlight"},$oe={class:"totals-row"},Hoe={class:"number-cell"},joe={class:"number-cell highlight"},Woe={key:2,class:"no-data"},DT="munkhzaisan2026",Koe={__name:"PublicProjects",setup(n){const e=ae(!1),t=ae(""),r=ae(""),s=ae(!1),i=ae([]),o=ae("ProjectName"),a=ae(!0),l=ae("");kn(()=>{sessionStorage.getItem("publicProjectsAuth")==="true"&&(e.value=!0,f())});function u(){t.value===DT?(e.value=!0,sessionStorage.setItem("publicProjectsAuth","true"),r.value="",f()):r.value="   "}function d(){e.value=!1,sessionStorage.removeItem("publicProjectsAuth"),t.value="",i.value=[]}async function f(){s.value=!0;try{const w=await uI(dI,"getPublicProjects")({password:DT});w.data.success?i.value=w.data.data:(console.error("Failed to load projects:",w.data),i.value=[])}catch(z){console.error("Error loading projects:",z),r.value="   "}finally{s.value=!1}}const p=Be(()=>{let z=i.value;return l.value&&(z=z.filter(w=>w.Status===l.value)),z}),m=Be(()=>[...new Set(i.value.map(w=>w.Status).filter(w=>w))].sort((w,R)=>w.localeCompare(R,"mn"))),g=Be(()=>{const z=[...p.value];return z.sort((w,R)=>{const x=w[o.value]||"",b=R[o.value]||"";return typeof x=="number"&&typeof b=="number"?a.value?x-b:b-x:a.value?String(x).localeCompare(String(b),"mn"):String(b).localeCompare(String(x),"mn")}),z}),v=Be(()=>p.value.reduce((z,w)=>z+(w.additionalHour||0),0)),y=Be(()=>v.value*6e4);function L(z){o.value===z?a.value=!a.value:(o.value=z,a.value=!0)}function D(z){return o.value!==z?"":a.value?"":""}function A(z){return z?parseFloat(z).toFixed(2):"0"}function C(z){return z?new Intl.NumberFormat("mn-MN").format(Math.round(z))+"":"0"}function j(z){return{:"status-planned"," ":"status-active","  ":"status-handover","   ":"status-billing"," ":"status-bonus",:"status-completed"}[z]||"status-default"}return(z,w)=>(K(),q("div",Roe,[e.value?(K(),q("div",Ooe,[c("div",{class:"header"},[w[7]||(w[7]=c("h2",null,"    ",-1)),c("button",{onClick:d,class:"btn-logout"},"")]),c("div",Doe,[w[9]||(w[9]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":w[1]||(w[1]=R=>l.value=R)},[w[8]||(w[8]=c("option",{value:""},"",-1)),(K(!0),q(Xe,null,ft(m.value,R=>(K(),q("option",{key:R,value:R},P(R),9,Moe))),128))],512),[[st,l.value]])]),s.value?(K(),q("div",Foe," ...")):p.value.length>0?(K(),q("div",Loe,[c("table",Uoe,[c("thead",null,[c("tr",null,[c("th",{onClick:w[2]||(w[2]=R=>L("ProjectName")),class:"sortable"},"   "+P(D("ProjectName")),1),c("th",{onClick:w[3]||(w[3]=R=>L("Status")),class:"sortable"},"  "+P(D("Status")),1),c("th",{onClick:w[4]||(w[4]=R=>L("additionalHour")),class:"sortable number-col"},"   "+P(D("additionalHour")),1),w[10]||(w[10]=c("th",{class:"number-col"},"  ()",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(g.value,R=>(K(),q("tr",{key:R.id},[c("td",null,P(R.ProjectName||R.siteLocation||"-"),1),c("td",null,[c("span",{class:mt(["status-badge",j(R.Status)])},P(R.Status),3)]),c("td",Boe,P(A(R.additionalHour)),1),c("td",Voe,P(C(R.additionalHour*6e4)),1)]))),128))]),c("tfoot",null,[c("tr",$oe,[w[11]||(w[11]=c("td",{colspan:"2"},[c("strong",null," :")],-1)),c("td",Hoe,[c("strong",null,P(A(v.value)),1)]),c("td",joe,[c("strong",null,P(C(y.value)),1)])])])])])):(K(),q("div",Woe,"     "))])):(K(),q("div",koe,[c("div",Poe,[w[5]||(w[5]=c("h2",null," ",-1)),w[6]||(w[6]=c("p",null,"       ",-1)),ce(c("input",{"onUpdate:modelValue":w[0]||(w[0]=R=>t.value=R),type:"password",placeholder:" ",onKeyup:zw(u,["enter"]),class:"password-input"},null,544),[[Ne,t.value]]),c("button",{onClick:u,class:"btn-submit"},""),r.value?(K(),q("div",Noe,P(r.value),1)):be("",!0)])]))]))}},qoe=gn(Koe,[["__scopeId","data-v-2cf6fcb3"]]),Goe={class:"public-ta-summary"},zoe={key:0,class:"password-screen"},Yoe={class:"password-card"},Qoe={key:0,class:"error-message"},Xoe={key:1,class:"ta-summary-view"},Joe={class:"filters-section"},Zoe={class:"filter-group"},eae={class:"filter-group"},tae=["disabled"],nae={key:0,class:"stats-section"},rae={class:"stat-card reference"},sae={class:"stat-content"},iae={class:"stat-value"},oae={class:"stat-detail"},aae={class:"stat-card"},lae={class:"stat-content"},cae={class:"stat-value"},uae={class:"stat-card"},dae={class:"stat-content"},hae={class:"stat-value"},fae={class:"stat-card"},pae={class:"stat-content"},mae={class:"stat-value"},gae={class:"stat-card"},vae={class:"stat-content"},yae={class:"stat-value"},_ae={key:1,class:"loading"},Eae={key:2,class:"table-container"},Tae={class:"table-header"},wae={class:"summary-table"},Cae={class:"employee-cell"},Aae={class:"employee-name"},Iae={class:"employee-id"},Sae={class:"hours-cell worked"},xae={class:"hours-cell rest"},bae={class:"hours-cell missed"},Rae={class:"hours-cell total"},kae={class:"days-cell"},Pae={class:"day-badges"},Nae={key:0,class:"day-badge worked"},Oae={key:1,class:"day-separator"},Dae={key:2,class:"day-badge rest"},Mae={key:3,class:"day-separator"},Fae={key:4,class:"day-badge missed"},Lae={class:"total-row"},Uae={class:"hours-cell worked"},Bae={class:"hours-cell rest"},Vae={class:"hours-cell missed"},$ae={class:"hours-cell total"},Hae={key:3,class:"no-data"},MT="munkhzaisan2026",jae={__name:"PublicTASummary",setup(n){const e=ae(!1),t=ae(""),r=ae(""),s=ae(!1),i=ae([]),o=new Date,a=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`,l=ae(a),u=ae("full"),d=ae("employeeName"),f=ae(!0),p=["2024-01-01","2024-02-12","2024-02-13","2024-02-14","2024-03-08","2024-06-01","2024-07-11","2024-07-12","2024-07-13","2024-11-26","2025-01-01","2025-01-29","2025-01-30","2025-01-31","2025-03-08","2025-06-01","2025-07-11","2025-07-12","2025-07-13","2025-11-26","2026-01-01","2026-02-17","2026-02-18","2026-02-19","2026-03-08","2026-06-01","2026-07-11","2026-07-12","2026-07-13","2026-11-26","2027-01-01","2027-02-06","2027-02-07","2027-02-08","2027-03-08","2027-06-01","2027-07-11","2027-07-12","2027-07-13","2027-11-26"],m=Be(()=>{const[x,b]=l.value.split("-");let N,M;u.value==="full"?(N=1,M=new Date(parseInt(x),parseInt(b),0).getDate()):[N,M]=u.value.split("-").map(Number);let F=0;for(let oe=N;oe<=M;oe++){const Q=`${x}-${b}-${String(oe).padStart(2,"0")}`,ne=new Date(Q).getDay();ne!==0&&ne!==6&&!p.includes(Q)&&F++}return F}),g=Be(()=>m.value*8),v=Be(()=>{const x=[...i.value];return x.sort((b,N)=>{const M=b[d.value],F=N[d.value];return typeof M=="number"&&typeof F=="number"?f.value?M-F:F-M:f.value?String(M).localeCompare(String(F),"mn"):String(F).localeCompare(String(M),"mn")}),x}),y=Be(()=>i.value.reduce((x,b)=>x+b.workedHours,0)),L=Be(()=>i.value.reduce((x,b)=>x+b.restHours,0)),D=Be(()=>i.value.reduce((x,b)=>x+b.missedHours,0)),A=Be(()=>i.value.reduce((x,b)=>x+b.totalHours,0));kn(()=>{sessionStorage.getItem("publicTASummaryAuth")==="true"&&(e.value=!0,z())});function C(){t.value===MT?(e.value=!0,sessionStorage.setItem("publicTASummaryAuth","true"),r.value="",z()):r.value="   "}function j(){e.value=!1,sessionStorage.removeItem("publicTASummaryAuth"),t.value="",i.value=[]}async function z(){s.value=!0;try{const[x,b]=l.value.split("-");let N,M;u.value==="full"?(N=1,M=new Date(parseInt(x),parseInt(b),0).getDate()):[N,M]=u.value.split("-").map(Number);const oe=await uI(dI,"getPublicTASummary")({password:MT,year:x,month:b,startDay:N,endDay:M});oe.data.success?i.value=oe.data.data:(console.error("Failed to load summary:",oe.data),i.value=[])}catch(x){console.error("Error loading summary:",x),r.value="   "}finally{s.value=!1}}function w(x){d.value===x?f.value=!f.value:(d.value=x,f.value=!0)}function R(){const[x,b]=l.value.split("-");if(u.value==="full")return`${x}/${b}`;const[N,M]=u.value.split("-");return`${x}/${b}/${N} - ${x}/${b}/${M}`}return(x,b)=>(K(),q("div",Goe,[e.value?(K(),q("div",Xoe,[c("div",{class:"header"},[b[10]||(b[10]=c("h2",null,"  ",-1)),c("button",{onClick:j,class:"btn-logout"},"")]),c("div",Joe,[c("div",Zoe,[b[11]||(b[11]=c("label",null," :",-1)),ce(c("input",{type:"month","onUpdate:modelValue":b[1]||(b[1]=N=>l.value=N),onChange:z},null,544),[[Ne,l.value]])]),c("div",eae,[b[13]||(b[13]=c("label",null,":",-1)),ce(c("select",{"onUpdate:modelValue":b[2]||(b[2]=N=>u.value=N),onChange:z},[...b[12]||(b[12]=[c("option",{value:"full"}," ",-1),c("option",{value:"1-15"},"1-15",-1),c("option",{value:"16-31"},"16-31",-1)])],544),[[st,u.value]])]),c("button",{onClick:z,class:"btn-refresh",disabled:s.value},P(s.value?" ...":" "),9,tae)]),!s.value&&i.value.length>0?(K(),q("div",nae,[c("div",rae,[b[15]||(b[15]=c("div",{class:"stat-icon"},"",-1)),c("div",sae,[b[14]||(b[14]=c("div",{class:"stat-label"},"  ()",-1)),c("div",iae,P(m.value)+" ",1),c("div",oae,P(g.value.toFixed(0))+" ",1)])]),c("div",aae,[b[17]||(b[17]=c("div",{class:"stat-icon"},"",-1)),c("div",lae,[b[16]||(b[16]=c("div",{class:"stat-label"}," ",-1)),c("div",cae,P(i.value.length),1)])]),c("div",uae,[b[19]||(b[19]=c("div",{class:"stat-icon"},"",-1)),c("div",dae,[b[18]||(b[18]=c("div",{class:"stat-label"},"  ",-1)),c("div",hae,P(y.value.toFixed(2))+"",1)])]),c("div",fae,[b[21]||(b[21]=c("div",{class:"stat-icon"},"",-1)),c("div",pae,[b[20]||(b[20]=c("div",{class:"stat-label"},"/",-1)),c("div",mae,P(L.value.toFixed(2))+"",1)])]),c("div",gae,[b[23]||(b[23]=c("div",{class:"stat-icon"},"",-1)),c("div",vae,[b[22]||(b[22]=c("div",{class:"stat-label"}," ",-1)),c("div",yae,P(D.value.toFixed(2))+"",1)])])])):be("",!0),s.value?(K(),q("div",_ae,"   ... ")):i.value.length>0?(K(),q("div",Eae,[c("div",Tae,[c("span",null,P(R()),1)]),c("table",wae,[c("thead",null,[c("tr",null,[c("th",{onClick:b[3]||(b[3]=N=>w("employeeName")),class:"sortable"},"  "+P(d.value==="employeeName"?f.value?"":"":""),1),c("th",{onClick:b[4]||(b[4]=N=>w("workedHours")),class:"sortable hours-col"},"   "+P(d.value==="workedHours"?f.value?"":"":""),1),c("th",{onClick:b[5]||(b[5]=N=>w("restHours")),class:"sortable hours-col"}," / "+P(d.value==="restHours"?f.value?"":"":""),1),c("th",{onClick:b[6]||(b[6]=N=>w("missedHours")),class:"sortable hours-col"},"  "+P(d.value==="missedHours"?f.value?"":"":""),1),c("th",{onClick:b[7]||(b[7]=N=>w("totalHours")),class:"sortable hours-col"},"   "+P(d.value==="totalHours"?f.value?"":"":""),1),b[24]||(b[24]=c("th",{class:"days-col"}," ",-1))])]),c("tbody",null,[(K(!0),q(Xe,null,ft(v.value,N=>(K(),q("tr",{key:N.employeeName},[c("td",Cae,[c("div",Aae,P(N.employeeName),1),c("div",Iae,"ID: "+P(N.employeeId),1)]),c("td",Sae,P(N.workedHours.toFixed(2))+"",1),c("td",xae,P(N.restHours.toFixed(2))+"",1),c("td",bae,P(N.missedHours.toFixed(2))+"",1),c("td",Rae,P(N.totalHours.toFixed(2))+"",1),c("td",kae,[c("div",Pae,[N.workedDays>0?(K(),q("span",Nae,P(N.workedDays)+" ",1)):be("",!0),N.workedDays>0&&(N.restDays>0||N.missedDays>0)?(K(),q("span",Oae," / ")):be("",!0),N.restDays>0?(K(),q("span",Dae,P(N.restDays)+" ",1)):be("",!0),N.restDays>0&&N.missedDays>0?(K(),q("span",Mae," / ")):be("",!0),N.missedDays>0?(K(),q("span",Fae,P(N.missedDays)+" ",1)):be("",!0)])])]))),128))]),c("tfoot",null,[c("tr",Lae,[b[25]||(b[25]=c("td",null,[c("strong",null,":")],-1)),c("td",Uae,[c("strong",null,P(y.value.toFixed(2))+"",1)]),c("td",Bae,[c("strong",null,P(L.value.toFixed(2))+"",1)]),c("td",Vae,[c("strong",null,P(D.value.toFixed(2))+"",1)]),c("td",$ae,[c("strong",null,P(A.value.toFixed(2))+"",1)]),b[26]||(b[26]=c("td",null,null,-1))])])])])):s.value?be("",!0):(K(),q("div",Hae,"     "))])):(K(),q("div",zoe,[c("div",Yoe,[b[8]||(b[8]=c("h2",null," ",-1)),b[9]||(b[9]=c("p",null,"       ",-1)),ce(c("input",{"onUpdate:modelValue":b[0]||(b[0]=N=>t.value=N),type:"password",placeholder:" ",onKeyup:zw(C,["enter"]),class:"password-input"},null,544),[[Ne,t.value]]),c("button",{onClick:C,class:"btn-submit"},""),r.value?(K(),q("div",Qoe,P(r.value),1)):be("",!0)])]))]))}},Wae=gn(jae,[["__scopeId","data-v-859f7bf2"]]),Kae=[{path:"/",redirect:"/login"},{path:"/public-projects",name:"PublicProjects",component:qoe,meta:{public:!0}},{path:"/public-ta-summary",name:"PublicTASummary",component:Wae,meta:{public:!0}},{path:"/login",name:"Login",component:m8},{path:"/register",name:"Register",component:S8,meta:{requiresAuth:!0}},{path:"/supervisor-register",name:"SupervisorRegister",component:U8,meta:{requiresMicrosoft:!0}},{path:"/dashboard",name:"Dashboard",component:yK,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/time-attendance-request",name:"TimeAttendanceRequest",component:YK,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/salary-report",name:"SalaryReport",component:Dq,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/supervisor-ta-summary",name:"SupervisorTASummary",component:mte,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/project-summary",name:"ProjectSummary",component:fre,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/financial-transactions",name:"FinancialTransactions",component:pse,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/warehouse",name:"Warehouse",component:Sie,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/warehouse-transactions",name:"WarehouseTransactions",component:roe,meta:{requiresAuth:!0,requiresRegistration:!0}},{path:"/warehouse-requests",name:"WarehouseRequests",component:boe,meta:{requiresAuth:!0,requiresRegistration:!0}}],OR=a8({history:B5(),routes:Kae});OR.beforeEach(async(n,e,t)=>{const r=Js();if(n.meta.public){t();return}for(;r.loading;)await new Promise(s=>setTimeout(s,100));if(n.path==="/supervisor-register"){r.msalAccount?t():t("/login");return}n.meta.requiresAuth&&!r.user?t("/login"):n.meta.requiresRegistration&&!r.userData?t("/register"):n.path==="/login"&&r.user?r.userData?t("/dashboard"):t("/register"):t()});const ty=wP(t5);ty.use(IP());ty.use(OR);ty.mount("#app");
